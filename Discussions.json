{"data":[{"node":{"id":"D_kwDOBkswNc4ASpyy","author":{"login":"duranmla"},"title":"With the introduction of 5.x.x, can we filter using related models?","body":"Having two models like:\r\n\r\n```graphql\r\ntype Project\r\n  @model\r\n  @auth(\r\n    rules: [\r\n      { allow: private }\r\n      { allow: public, operations: [read], provider: apiKey }\r\n      # This allow lambda to make CRUD operations\r\n      { allow: private, provider: iam }\r\n    ]\r\n  ) {\r\n  id: ID!\r\n  name: String!\r\n  description: String!\r\n  location: String!\r\n  problem: String!\r\n  solution: String!\r\n  mediaHTML: String!\r\n  image: String!\r\n  launchPlan: String!\r\n  status: ProjectStatus! @default(value: \"DRAFT\")\r\n  tags: [Tag] @manyToMany(relationName: \"ProjectTagConnection\")\r\n  organisers: [Organiser] @manyToMany(relationName: \"ProjectOrganiserConnection\")\r\n  participants: [Participant]\r\n    @manyToMany(relationName: \"ProjectParticipantConnection\")\r\n  posts: [Post] @hasMany(indexName: \"byProject\", fields: [\"id\"])\r\n  totalLove: Int @default(value: \"0\")\r\n  totalCred: Int @default(value: \"0\")\r\n}\r\n```\r\n\r\nand \r\n\r\n```graphql\r\ntype Tag\r\n  @model\r\n  @auth(\r\n    rules: [\r\n      { allow: private }\r\n      # This allow lambda to make CRUD operations\r\n      { allow: private, provider: iam }\r\n      { allow: public, operations: [read], provider: apiKey }\r\n    ]\r\n  ) {\r\n  id: ID!\r\n  name: String!\r\n  image: String!\r\n  projects: [Project] @manyToMany(relationName: \"ProjectTagConnection\")\r\n  # Tag with lower number will be shown first\r\n  priority: Int @default(value: \"1000\")\r\n}\r\n```\r\n\r\nAfter making the update to `aws-amplify` version 5.x.x I see that types allow me to write something like:\r\n\r\n```ts\r\nconst projects = await DataStore.query(Project, (p) => p.tags.tag.name.eq('desertification'))\r\n```\r\n\r\n**But that does not work**, I am miss understanding the types? Is there any way to make this work _(filter projects by tags in a single query with DataStore?)_\r\n\r\n> Side note: the other approach is to filter using the join table but as it is auto generated I am not able to sync that table when guest users use the application _(it fails as it tries to use amazon cognito pool)_ then that lead me to create a manual model for a join table but I already have data in production which I guess will get deleted if I do the manual setup of the model. What I am doing now is to use graphQL to ge the join table data _(explicitly selecting the authMode to 'API_KEY',)_ and then go from there.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AQyJr","author":{"login":"knuspertante"},"title":"GraphQL Pagination with nexttoken from nested entity (2nd-level)","body":"Hey guys, \r\n\r\ncurrently I've the following query (generated by amplify cli).\r\n\r\n```graphql\r\nexport const taskByOutCompany = /* GraphQL */ `\r\n  query TaskByOutCompany(\r\n    $outCompanyID: ID\r\n    $createdAt: ModelStringKeyConditionInput\r\n    $sortDirection: ModelSortDirection\r\n    $filter: ModelTaskFilterInput\r\n    $limit: Int\r\n    $nextToken: String\r\n  ) {\r\n    taskByOutCompany(\r\n      outCompanyID: $outCompanyID\r\n      createdAt: $createdAt\r\n      sortDirection: $sortDirection\r\n      filter: $filter\r\n      limit: $limit\r\n      nextToken: $nextToken\r\n    ) {\r\n      items {\r\n        id\r\n        inCompanyID\r\n        inCompany {\r\n          id\r\n          address\r\n          name\r\n          type\r\n          patternInCompany {\r\n            nextToken\r\n          }\r\n          patternOutCompany {\r\n            nextToken\r\n          }\r\n          taskInCompany {\r\n            nextToken\r\n          }\r\n          taskOutCompany {\r\n            nextToken\r\n          }\r\n          createdAt\r\n          updatedAt\r\n        }\r\n        outCompanyID\r\n        outCompany {\r\n          id\r\n          address\r\n          name\r\n          type\r\n          patternInCompany {\r\n            nextToken\r\n          }\r\n          patternOutCompany {\r\n            nextToken\r\n          }\r\n          taskInCompany {\r\n            nextToken\r\n          }\r\n          taskOutCompany {\r\n            nextToken\r\n          }\r\n          createdAt\r\n          updatedAt\r\n        }\r\n        files {\r\n          items {\r\n            URI\r\n            type\r\n            patternID\r\n            taskID\r\n            groupsCanAccess\r\n            status\r\n            amountOfPositions\r\n            order\r\n            createdAt\r\n            updatedAt\r\n          }\r\n          nextToken\r\n        }\r\n        tags\r\n        status\r\n        cache\r\n        groupsCanAccess\r\n        reference\r\n        createdAt\r\n        updatedAt\r\n        version\r\n      }\r\n      nextToken\r\n    }\r\n  }\r\n`;\r\n```\r\n\r\n\r\nNow my question when the \"2nd-Level-Query\" files have a nextToken how can I query more files? Actually I do not found any documentation about this here https://docs.aws.amazon.com/appsync/latest/devguide/aws-appsync-real-time-enhanced-filtering.html and here https://docs.amplify.aws/lib/graphqlapi/query-data/q/platform/js/#paginating-queries","upvoteCount":3,"comments":{"edges":[{"node":{"author":{"login":"funes79"},"body":"Hi, I had the same issue/question. Here is how you can do that. Write a custom query and add parameter to the files section, like this:\r\n\r\n```\r\nexport const taskByOutCompany = /* GraphQL */ `\r\n  query TaskByOutCompany(\r\n    $outCompanyID: ID\r\n    $createdAt: ModelStringKeyConditionInput\r\n    $sortDirection: ModelSortDirection\r\n    $filter: ModelTaskFilterInput\r\n    $limit: Int\r\n    $nextToken: String,\r\n    $nextFileToken: String,\r\n  ) {\r\n...\r\n...\r\n       files(nextToken: $nextFileToken) {\r\n          items {\r\n            URI\r\n            type\r\n            patternID\r\n            taskID\r\n            groupsCanAccess\r\n            status\r\n            amountOfPositions\r\n            order\r\n            createdAt\r\n            updatedAt\r\n          }\r\n          nextToken\r\n        }\r\n```"}}]}}},{"node":{"id":"D_kwDOBkswNc4ARpzc","author":{"login":"kyosukedev"},"title":"How to add Dropdown list into formFields","body":"I have a question about creating a registration web page using 'react'.\r\nI want to change the input fields in formFields to dropdown list selection. Can you tell me how to implement this?\r\n\r\n-------------------------------------------\r\n```import { Authenticator} from '@aws-amplify/ui-react';\r\nimport '@aws-amplify/ui-react/styles.css';\r\nimport React from 'react';\r\nimport {Amplify} from 'aws-amplify';\r\nimport awsconfig from './aws-exports';\r\nAmplify.configure(awsconfig);\r\n\r\nconst formFields = {\r\n  signUp: {\r\n    given_name: {\r\n      placeholder: 'Enter your given name',\r\n    },\r\n    password: {\r\n      order: \r\n    }\r\n  },  \r\n };\r\n \r\n\r\nexport default function App() {\r\n  return (\r\n    <Authenticator \r\n    formFields={formFields}\r\n    >\r\n      {({ signOut, user }) => (\r\n        <main>\r\n          <h1>Hello {user.username}</h1>\r\n          <button onClick={signOut}>Sign out</button>\r\n        </main>\r\n      )}\r\n    </Authenticator>\r\n  );\r\n}\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4ARqjR","author":{"login":"kyosukedev"},"title":"How to add google-recapcha to Amplify,react","body":"What kind of code should we write to introduce 'recapcha' for the implementation of the member registration page using 'Amplify'?\r\n\r\n'Amplify' has the ability to optionally create a lambda about google recapcha, but I don't know how to achieve this with 'Authentificator'.\r\nDoes anyone have an idea to make this happen?\r\n\r\n\r\n\r\n--------------------------------------------------------\r\nimport { Authenticator} from '@aws-amplify/ui-react';\r\nimport '@aws-amplify/ui-react/styles.css';\r\nimport React from 'react';\r\nimport {Amplify} from 'aws-amplify';\r\nimport awsconfig from './aws-exports';\r\nAmplify.configure(awsconfig);\r\n\r\nconst formFields = {\r\nsignUp: {\r\nname: {\r\nplaceholder: 'Enter your name',\r\norder: 1\r\n},\r\nemail: {\r\nplaceholder: 'Enter your email adress',\r\norder:4\r\n},\r\npassword: {\r\norder: 5\r\n},\r\nconfirm_password: {\r\norder: 6\r\n},\r\n\r\n},\r\n};\r\n\r\nexport default function App() {\r\n  return (\r\n    <Authenticator \r\n    formFields={formFields}\r\n    initialState=\"signIn\"\r\n    loginMechanisms={['email']}\r\n    >\r\n\r\n      {({ signOut, user }) => (\r\n        <main>\r\n          <h1>Hello {user.username}</h1>\r\n          <button onClick={signOut}>Sign out</button>\r\n        </main>\r\n      )}\r\n    </Authenticator>\r\n  );\r\n}\r\n\r\n<img width=\"895\" alt=\"62326685-018ff980-b4af-11e9-82a8-fc98a54a7a04\" src=\"https://user-images.githubusercontent.com/119325537/205780510-45cdf7fd-d588-4faf-9f3e-1a103fdf40b4.png\">\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AP80B","author":{"login":"cmason9"},"title":"Amplify push/pull overwrites manual API configuration","body":"Im not sure if this is a bug or not or whether i have just not done the steps correctly. I have followed this guide (https://docs.amplify.aws/lib/restapi/existing-resources/q/platform/ios/) on Amplify docs to configure an existing API Gateway into my iOS Swift app manually. I have successfully added the api JSON block to the amplifyconfiguration.json file and configured it with my iOS app and it is working as expected. \r\n\r\nThe problem I am facing is if i do an amplify push or an amplify pull in the terminal my amplifyconfiguration.json gets overwritten and the api json block is no longer in the file and therefore is no longer configured within my app so I am unable to hit the endpoints I need to unless i configure it again. \r\n\r\nI there a way in which i can push the api configuration that I have set up in the amplifyconfiguration.json file to the amplify backend hosted on AWS? \r\n\r\nAny help great appreciated. \r\n\r\nThanks ","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"ChristianTrummer99"},"body":"Ever find an answer to this? I have the same question. "}},{"node":{"author":{"login":"haverchuck"},"body":"@cmason9 @ChristianTrummer99  - I've created an [issue](https://github.com/aws-amplify/amplify-cli/issues/11534) based on this discussion and transferred it to the amplify-cli repository."}}]}}},{"node":{"id":"D_kwDOBkswNc4ARolf","author":{"login":"belfortf"},"title":"Correct way to work with a many-to-many relationship in Amplify. Unable to make mutation with provided code.","body":"I have modelled a many-to-many relationship in Amplify between Product and Order. However, I cannot pass a productID when creating an Order. I get the error :\r\n\r\n> The variables input contains a field name 'products' that is not defined for input object type 'CreateOrderInput'\r\n\r\n### Product Model\r\n\r\n`type Product @model @auth(rules: [{allow: public}]) {\r\n  id: ID!\r\n  name: String\r\n  price: Int\r\n  Orders: [Order] @manyToMany(relationName: \"ProductOrder\")\r\n}`\r\n\r\n### Order Model\r\n\r\n`type Order @model @auth(rules: [{allow: public}]) {\r\n  id: ID!\r\n  totalprice: Int\r\n  products: [Product] @manyToMany(relationName: \"ProductOrder\")\r\n}`\r\n\r\nAs per documentation, amplify creates a join table \"ProductOrder\" in dynamodb.\r\n\r\n### createProduct according to Amplify\r\n\r\nAmplify tells me that I can create a product with:\r\n\r\n`const newProduct = await API.graphql({\r\n    query: createProduct,\r\n    variables: {\r\n        input: {\r\n        \"name\": \"Lorem ipsum dolor sit amet\",\r\n        \"price\": 1020,\r\n        \"Orders\": [],\r\n    }\r\n    }\r\n});`\r\n\r\nAs I don't have any orders yet, I create a product without linking it to an order. All working fine.\r\n\r\n### createOrder according to Amplify\r\n\r\n`const newOrder = await API.graphql({\r\n    query: createOrder,\r\n    variables: {\r\n        input: {\r\n        \"totalprice\": 1020,\r\n        \"products\": [],\r\n    }\r\n    }\r\n});\r\n`\r\nSo, when I want to create an order (and already have a product), I'm getting the error message I've mentioned above.\r\n\r\nI analyze 'CreateOrderInput' and indeed it looks like this:\r\n\r\n`input CreateOrderInput {\r\n    id: ID\r\n    totalprice: Int!\r\n}`\r\n\r\nSo, basically what is the correct way of creating a new Order and passing a productID with it? Do I have to create the Order and then manually call createProductOrder and manually create a record in the join table (ProductOrder) ?\r\n\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb241MTky","author":{"login":"tsteelematc"},"title":"amplify storage add/update - NoSQL - can't get more than the partition key into DynamoDB : - (","body":"Anybody else having this problem?\r\n\r\nThe CLI seems to *not* put any additional attributes into the template...\r\n\r\nEven if I manually add one, it doesn't make its way into DynamoDB.\r\n\r\n![image](https://user-images.githubusercontent.com/21085175/83343670-23226300-a2c3-11ea-8d37-ef82f4e79b7c.png)\r\n\r\n\r\n","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"tsteelematc"},"body":"Same result, only the partition key column if I create DB via...\r\n\r\namplify api add\r\n\r\nWonder what I'm missing?\r\n\r\nThanks."}},{"node":{"author":{"login":"hhcalder92"},"body":"Same, I just did an upgrade of amplify on an existing project and ran into this with hosting bucket and DynamoDB templates. Not sure what version I was on, but I am on `10.5.1` now. "}}]}}},{"node":{"id":"D_kwDOBkswNc4ARlPw","author":{"login":"ecc7220"},"title":"UI Component AmplifyS3Image from @aws-amplify/ui-react/legacy gone?","body":"Hi all,\r\n\r\nI was using AmplifyS3Image from \"@aws-amplify/ui-react/legacy\" but it seems not to be there anymore in amplify-js 5.0.4?\r\nI found also this in the most recent docs: [Link to doc with reference to AmplifyS3Image](https://docs.amplify.aws/ui/storage/tracking-events/q/framework/react/)\r\n\r\nI need urgently a solution to this, can somebody please point me into the right direction?\r\n\r\nThank you in advance.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"cwomack"},"body":"Hello, @ecc7220 👋.  The legacy ui-react/legacy was deprecated with v5+ of Amplify (see [here](https://github.com/aws-amplify/amplify-js/releases/tag/aws-amplify%405.0.0#:~:text=%40aws%2Damplify/ui%2Dreact%40%22%3C%201.x%22)).  Was this page referenced in the docs somewhere? Or possibly bookmarked from previous use? Curious to know how you came across it. "}}]}}},{"node":{"id":"D_kwDOBkswNc4ARjxS","author":{"login":"XinyueZ"},"title":"AWS, Cognito, forgotPassword. Is that true that the user must try once with wrong password?","body":"I've tried to call `forgotPassword` flow directly without any Cognito login behavior. I did not get any exception after calling `forgotPassword` and got **nothing** returned and **NO SMS** to my device.\r\n\r\nWhen I did one login with a wrong password, after I called forgotPassword, I got the return info of API defined and saw the SMS on my device.\r\n\r\nIs that true that AWS allows the `forgotPassword` **flow** only when the user experiences one false login attempt?\r\n\r\nthank you.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"tannerabread"},"body":"Hi @XinyueZ, you are using the Amplify auth method `forgotPassword` like [shown here](https://docs.amplify.aws/lib/auth/manageusers/q/platform/js/#forgot-password)? I don't believe it should require you to make a wrong login first "}}]}}},{"node":{"id":"D_kwDOBkswNc4ARkzY","author":{"login":"tomaszkiewicz"},"title":"DataStore save operation blocked until sync is completed","body":"Hi, \r\n\r\nI'm developing an application that is based on AWS Amplify Datastore, the \"selling point\" for Datastore was it's speed when accessing data, however I encountered some problem after I started working with more items in my Datastore.\r\n\r\nThe behavior I observe is especially visible on mobile devices (probably due to network & cpu) and is as follows:\r\n\r\n- when app is loaded it displays some items from Datastore\r\n- user can also add new items to Datastore from simple text field\r\n- however, saving that new item is blocked until sync operations is completed\r\n- after the sync is completed (I observe it using Hub events) the saving works as expected and it it instant\r\n\r\nI wonder is it by design that sync operations block saving? \r\nFor me it's a real issue as the user has to wait sometimes dozen seconds for sync to be completed before he can add anything new.\r\n\r\nBest regards\r\n\r\nŁukasz Tomaszkiewicz","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4ARkRF","author":{"login":"amirmishani"},"title":"Datastore custom Id usage question","body":"With the new updates to Amplify and Appsync I have a few questions:\r\n\r\n1. Datastore now accepts [custom Ids](https://docs.amplify.aws/lib/datastore/advanced-workflows/q/platform/js/) by adding the `@primaryKey` directive to a field. Does this mean that we can now pass the custom Id's value to `DataStore.save()` and set that ourself?\r\n \r\n2. [Datastore docs](https://docs.amplify.aws/lib/datastore/advanced-workflows/q/platform/js/#determine-when-the-primary-key-field-is-auto-populated-upon-record-creation) also mention that in the following scenario with the existence of explicit `id` field in sort key, the \"primary key\" is auto-populated, is this correct? Because in this scenario it makes more sense that we pass the primary key and have Datastore auto-generate the sort key (id field).\r\n\r\n```graphql\r\ntype Customer@model {  \r\n  country: String! @primaryKey\r\n    (sortKeyFields: [\"id\"])\r\n  id: ID!\r\n  firstName: String\r\n  lastName: String\r\n}\r\n```\r\n\r\n3. GraphQL, [the docs](https://docs.amplify.aws/cli/graphql/custom-business-logic/) mention 3 ways to set custom logic: Lambda function, HTTP and VTL. However Appsync now offer direct DynamoDB [Javascript resolvers](https://aws.amazon.com/about-aws/whats-new/2022/11/aws-appsync-javascript-graphql-api-resolvers/) (similar to VTL). Does Amplify support that? Any plans to support it and any plans to switch from VTL to Javascript resolvers?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4ARgMK","author":{"login":"Rajan-Gupta1"},"title":"Should Password Reset Work When User is in FORCE_CHANGE_PASSWORD State","body":"When a user is registered with Cognito and its one time password has expired, user is unable to come to Amplify and Reset Password when Account Status is FORCE_CHANGE_PASSWORD\r\n\r\nHow is a user expected to reset a password if the original temporary password expired?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4ARbOR","author":{"login":"rosayos"},"title":"How to add Sort Key to Tables created (in Models) with Amplify Studio?","body":"Hello 👋\r\nI'm new to AWS Amplify. Today I have been reading about best practices for DynamoDB design.\r\nI have 2 questions about creating a Model (which creates a DynamoDB Table) with Amplify Studio.\r\n- How do I change the name of the Partition Key? It looks like by default it calls \"id\".\r\n- How do I add Sort Key to this table? I have read that I need to specify the Sort Key before creating a Dynamo Table (I can't do it afterwards), but when I create a model through Amplify Studio, there's no option, just add field name.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"chrisbonifacio"},"body":"Amplify Studio creates the GraphQL API with DataStore enabled. Unfortunately neither custom nor composite primary keys are supported by DataStore yet. This is a feature that is currently being developed and planned for release in the near future.\n\nPlease stay tuned for updates!\n\nIn the meantime, in order to use custom primary keys and sort keys you would have to disable DataStore/Conflict Detection via the Amplify CLI by running `amplify update api`. Then, you can edit the local schema in the amplify/api/<apiName> folder.\n\nNow with this non-DataStore GraphQL API you can change the name of the primary key field and add sort keys as you need them, at least until the feature is released for DataStore which you can then re-enable if you need the offline capabilities."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMzc2","author":{"login":"qxy180009"},"title":"aws-configure not working properly","body":"I has installed the latest version of amplify-cli in my WIN10. I run `amplify configure`, everything is good until I was asked to type in my new created IAM access key id and my secret access key. I copied them from the csv I downloaded but it shows me the error that `You did NOT enter valid keys. New user setup failed.` The error message is quite simple and I don't know how to solve it.\r\n![image](https://user-images.githubusercontent.com/50066931/80870813-7676a680-8c6e-11ea-83b1-0f501d632fb0.png)\r\nThe key and id are correct. So I suppose it may be because I used another IAM role to access before and that causes the conflict. Does anyone meet this problem before?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"ChristianMarchetta"},"body":"I have the exact same problem. \r\nDid you manage to solve this problem? If so, could you please share your solution?"}},{"node":{"author":{"login":"amhinson"},"body":"This appears to be an issue with the Amplify CLI. I'd suggest opening an issue on [their repo](https://github.com/aws-amplify/amplify-cli), since this one is just for the JavaScript libraries."}}]}}},{"node":{"id":"D_kwDOBkswNc4ARbbu","author":{"login":"Kfirhuja"},"title":"App analytics to an existing (non amplify) backend","body":"Hi,\r\nI have an App written in react-native in FE that uses amplify library to connect/authenticate against an existing BE, that was generated using aws-cdk and not amplify. \r\nExisting BE consist of: Cognito, Appsync, Lambda, Pinpoint.\r\n\r\nI want to connect the App to analytics using the existing BE services and start see sign-in sign-ups, failure to authenticate, sessions event and of course adding my own one.\r\n\r\nI've tried adding: aws_mobile_analytics_app_id, aws_mobile_analytics_app_region to aws-exports.ts and even configured congnito client to integrate with pinpoint project, but don't see any activity in pinpoint's project analytics.\r\n\r\nAlso, didn't find documentation regarding how an App register and endpoint to and existing pinpoint/cognito services.\r\n\r\nThanks in advance.\r\nKfir\r\n<img width=\"1492\" alt=\"image\" src=\"https://user-images.githubusercontent.com/22073232/201897216-4175682a-e374-47b6-877e-5bdf101e6912.png\">\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4ARZ4V","author":{"login":"saraank"},"title":"Terminate session after some times without any action","body":"Hi,\r\nI use amplify to log into my react app.\r\nI have a requirement that if the user has been inactive for 15 minutes his session will be terminated and he will have to log in again.\r\nhow can I do that?\r\nWhen I use await Auth.currentSession() it refreshes the token automatically and I can't figure out that the access token has expired","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMjk3OQ==","author":{"login":"ranjeev75"},"title":"Updating table with lambda function not working - Possible Bug","body":"I have created a DynamoDB table with amplify:\r\n\r\n`type Tags @model {\r\n    id: ID!\r\n    count: Int\r\n    name: String!\r\n}`\r\n\r\nI wanted to see if I could use a lambda to increment the count value and created a function(hello world) with amplify:\r\n\r\n```\r\nconst aws = require('aws-sdk');\r\nconst region = process.env.REGION;\r\nconst docClient = new aws.DynamoDB.DocumentClient({ region });\r\n\r\nexports.handler = async (event, context) => {\r\n    const { tags } = event.arguments;\r\n    const TableName = `Tags-dsfe3rm-${process.env.ENV}`;\r\n    const params = {\r\n        TableName,\r\n        Key: { id: '1234567890' },\r\n        UpdateExpression: 'SET count = count + :incr',\r\n        ExpressionAttributeValues: {\r\n            ':incr': { N: '1' },\r\n        },\r\n    };\r\n\r\n    try {\r\n        docClient.update(params, (err, data) => {\r\n            if (err) console.log('Error updating item =>', err);\r\n            else console.log('Successfully updated item =>', data);\r\n        });\r\n    } catch (e) {\r\n        console.error(e);\r\n    }\r\n    context.done(null, `Success - ${JSON.stringify(tags)}`);\r\n};\r\n``` \r\n\r\nFrom the cloudWatch logs I can see the function running but the item is not updated with the incremented value and I don't see any of the console logs being hit in cloudWatch.\r\n\r\nI'm not sure what I'm doing wrong/ missing but how can I essentially 'wire' up the lambda so it does update the table?","upvoteCount":3,"comments":{"edges":[{"node":{"author":{"login":"BrianHHough"},"body":"Has anyone (or @ranjeev75) been able to figure this one out? I've read some stack overflow posts but they were from '16, so not sure how relevant they would be here. I'll reply back if I figure out any updates on this."}},{"node":{"author":{"login":"BrianHHough"},"body":"@ranjeev75 — figured out the issue with the above! So the new dynamodb.DocumentClient() means you don't have to specify the type for the input. In the `ExpressionAttributeValues` you can specific this simply like this `\":inc\": 1`. Also, you were calling the async function inside of the exports.handler which might have had some unintended issues with the promise you get back from DynamoDB. @mtliendo has a great blog post on DynamoDB Streams in Lambda in case this might fit your use-case: https://blog.focusotter.com/serverless-contact-form-using-aws-amplify\r\n\r\nI've added updates to your code which I tested on my end and works well for anyone trying to make a counter. Hopefully this is helpful for you or anyone facing this type of requirement! \r\n\r\ncc: @david-mcafee @chrisbonifacio @undefobj @BrianHHough \r\n\r\n```javascript\r\nconst aws = require('aws-sdk');\r\nconst region = process.env.REGION;\r\nconst docClient = new aws.DynamoDB.DocumentClient({ region });\r\n\r\nasync function runUpdateCounter(){\r\n    const { tags } = event.arguments;\r\n    // const TableName = `Tags-dsfe3rm-${process.env.ENV}`;\r\n    const number = 1;\r\n\r\n    try {\r\n        var params = {\r\n                TableName: `Tags-dsfe3rm-${process.env.ENV}`,\r\n                Key: { \r\n                        id: '1234567890' \r\n                },\r\n                UpdateExpression: 'SET #count = #count + :incr',\r\n                ExpressionAttributeValues: {\r\n                    ':incr':  number,\r\n                },\r\n                ExpressionAttributeNames: {\r\n                    '#count':  'count',\r\n                },\r\n                ReturnValues: \"UPDATED_NEW\"\r\n    };\r\n        var result = await docClient.update(params, function(err, data) {\r\n            if (err) console.log('Error updating item =>', err);\r\n            else console.log('Successfully updated item =>', data);\r\n        }).promise();\r\n        return console.log(JSON.stringify(result));\r\n    } catch (error) { \r\n        console.log(error);\r\n    }\r\n}\r\n\r\n\r\nexports.handler = async (event, context) => {\r\n    try {\r\n        const result = await runUpdateCounter();\r\n    } catch (e) {\r\n        console.error(e);\r\n    }\r\n    return Promise.resolve('Successfully processed Lambda <> DynamoDB');\r\n};\r\n```"}}]}}},{"node":{"id":"D_kwDOBkswNc4AQXjF","author":{"login":"YawarOsman"},"title":"CognitoUserSession is not valid because idToken is null.","body":"I'm trying to login to AWS Amplify in flutter it works perfectly on IOS simulator and my real phone but when i want to login in `android emulator` it shows this error below:\r\n\r\n\r\n```\r\nD/AWSMobileClient(10755): Inspecting user state details\r\nD/AWSMobileClient(10755): waitForSignIn: userState:SIGNED_OUT\r\nW/CognitoUserSession(10755): CognitoUserSession is not valid because idToken is null.\r\nD/AWSMobileClient(10755): Sending password.\r\nD/AWSMobileClient(10755): Using USER_SRP_AUTH for flow type.\r\nE/amplify:flutter:auth_cognito(10755): AuthException\r\nI/flutter (10755): Sign in failed\r\n```\r\n\r\nI login with `await Amplify.Auth.signIn(\r\n                    username: 'xxxx@gmail.com,\r\n                    password: 'xxxxxxx',\r\n                  );`.\r\n\r\nI've chosen `email` in the configuration that is why i put `email` instead of `usename` it's no problem\r\n\r\n\r\n**Additional Context:**\r\n\r\n-   amplify_flutter: ^0.6.5\r\n-   amplify_auth_cognito: ^0.6.5\r\n-   amplify_datastore: ^0.6.5\r\n-   amplify_storage_s3: ^0.6.5","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"sammyodiagbe"},"body":"Were you able to fix this error because I am also running into the same issue\r\n"}}]}}},{"node":{"id":"D_kwDOBkswNc4ARXM9","author":{"login":"mdwt"},"title":"GraphQL @auth - Combine owner and groups authorization rules","body":"I have a multi tenant application in AWS Amplify, I'm using the Custom-attribute-based multi-tenancy described [here](https://docs.aws.amazon.com/cognito/latest/developerguide/custom-attribute-based-multi-tenancy.html)\r\n\r\nAll models have a composite key with \"company\" being the unique tenant ID, and the Cognito user pool has a custom attribute `custom:company` which links the user to the tenant data.\r\n\r\nExample type below:\r\n\r\n```\r\ntype Customer @model\r\n    @key(fields: [\"company\", \"id\"])\r\n    @auth(rules: [\r\n         { allow: owner, ownerField: \"company\", identityClaim: \"custom:company\"},\r\n         { allow: groups, groups: [\"Member\"], operations: [read] },\r\n         { allow: groups, groups: [\"Admin\"]},\r\n    ])\r\n{\r\n  company: ID!\r\n  id: ID!\r\n  ...\r\n}\r\n```\r\n\r\nI want to add user groups to Cognito to manage the operations that different users can perform - e.g. `Admin` users can perform all operations, but `Member` users can only perform read\r\n\r\nThe problem is the first `owner` auth rule will match for anyone with the matching `custom:company` attribute, regardless of their Group.\r\n\r\nIs there a way to combine owner and group @auth rules - i.e. both owner and groups need to pass to have access to an item?\r\n\r\nFor example - users of the `Member` group are only allowed to *read* when their `custom:company` attribute matches the company of the model\r\n\r\nAnother example - anyone with a matching `custom:company` attribute has read access to an item, but only `Admin` have write access","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4ARXMZ","author":{"login":"bls-lehoai"},"title":"How to add cors filter to graphql endpoint?","body":"we are developing an amplify app, using js client library, client is written in VueJS and hosted on S3. Now we wanna secure our site by adding cors, which allow only our site can request graphql api. There is no configuration to do it.\r\nPlease help, thanks.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4ARVpO","author":{"login":"filipmicanek98"},"title":"api resolvers context","body":"I am using the following models below and I need to perform some custom logic in one of the generated resolvers using this [approach](https://docs.amplify.aws/cli/graphql/custom-business-logic/#override-amplify-generated-resolvers) The user model is not being tied to user in cognito, but its ID is saved in a custom attribute.  Is there a way to somehow access the ID through context in `getEvent` resolver template without passing any arguments, besides eventId?\r\n```\r\ntype User @model {\r\n  id: ID!\r\n ...other attributes\r\n}\r\n```\r\n```\r\ntype Event @model {\r\n  id: ID!\r\n  participants: [ID]\r\n ...other attributes\r\n}\r\n```\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4ARTA-","author":{"login":"duranmla"},"title":"Where I can find answer to understand `Lazy` preffix on models with amplify 10.4.0","body":"I made an update to my cli and on the next push all my models have a `Lazy` version of the models. This of course is not something bad as it is auto generated code, but where I can find information about it? I have done a quick search on amplify docs and release notes at Github and I can't see anything. \r\n\r\nThanks for the work! 🙌","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APdwn","author":{"login":"YoussefAlmardini"},"title":"DataStore - Data won't be synchronized. No GraphQL endpoint configured. Did you forget `Amplify.configure(awsconfig)`?","body":"Please help, i spent 2 days trying simply to use Datastore of amplify. Am building NPM package to wrap an Amplify project backend. Auth works good but datastore not.\r\nAm testing code with ts-node and Jest. It is package so i do not have a framework.\r\n\r\n\r\nWhen i call the save function it does not work and throw this warning:\r\n\r\n<!-- begin snippet: js hide: false console: true babel: false -->\r\n\r\n<!-- language: lang-js -->\r\n\r\n    [WARN] 24:08.886 DataStore - Data won't be synchronized. No GraphQL endpoint configured. Did you forget `Amplify.configure(awsconfig)`? {\r\n      config: {\r\n        authProviders: undefined,\r\n        maxRecordsToSync: 10000,\r\n        syncPageSize: 1000\r\n      }\r\n    }\r\n\r\n\r\n<!-- end snippet -->\r\n\r\nMy api endpoint is 100% correct, also the api-key. The backend works in another project built with react. But in my case (NPM package) it does not work.\r\n\r\n\r\nThe script am trying to run:\r\n\r\n<!-- begin snippet: js hide: false console: true babel: false -->\r\n\r\n<!-- language: lang-js -->\r\n\r\n    import { DataStore } from '@aws-amplify/datastore';\r\n    import { AccountDetails }  from '@/models';\r\n    import { SignUp } from \"@/Authentication/SignUp\";\r\n    import InvalidAccountRequirementsException from \"@/Exceptions/InvalidAccountRequirementsException\";\r\n    import \"@/app.config\";\r\n\r\n    /**\r\n     * @name CreateAccount\r\n     * @description:\r\n     *      build the correct pattern to check specific string type.\r\n     *\r\n     * @type function\r\n     * @param email\r\n     * @param password\r\n     * @param hasOwnCompany\r\n     * @param optInMarketingEmail\r\n     * @param tacAgreed\r\n     * @constructor\r\n     * @return {Promise<AccountDetails>}\r\n     */\r\n    const CreateAccount = async (\r\n        email: string,\r\n        password: string,\r\n        hasOwnCompany: boolean,\r\n        optInMarketingEmail: boolean,\r\n        tacAgreed: boolean,\r\n    ): Promise<AccountDetails> => {\r\n\r\n        if (!tacAgreed) {\r\n            throw new InvalidAccountRequirementsException('Terms and conditions mus be agreed');\r\n        }\r\n\r\n        const user = await SignUp(email, password);\r\n\r\n        return await DataStore.save(\r\n            new AccountDetails({\r\n                cognitoSubId: user.userSub,\r\n                email: email,\r\n                optInMarketingEmail: optInMarketingEmail,\r\n                tacAgreed: tacAgreed,\r\n                hasOwnCompany: hasOwnCompany,\r\n            })\r\n        );\r\n    }\r\n\r\n    export default CreateAccount;\r\n\r\n\r\n<!-- end snippet -->\r\n\r\napp.conf.ts\r\n\r\n<!-- begin snippet: js hide: false console: true babel: false -->\r\n\r\n<!-- language: lang-js -->\r\n\r\n    import Amplify from 'aws-amplify';\r\n    import awsExports from '@/aws-exports';\r\n\r\n    Amplify.configure(awsExports);\r\n\r\n\r\n<!-- end snippet -->\r\n\r\npackage.json\r\n\r\n<!-- begin snippet: js hide: false console: true babel: false -->\r\n\r\n<!-- language: lang-js -->\r\n\r\n    {\r\n        \"name\": \"@financiallease/driver-seat-amplify-api\",\r\n        \"version\": \"1.0.0\",\r\n        \"description\": \"\",\r\n        \"author\": \"itsupport@financiallease.nl\",\r\n        \"main\": \"dist/financiallease.cjs.js\",\r\n        \"module\": \"dist/financiallease.es.js\",\r\n        \"browser\": \"dist/financiallease.js\",\r\n        \"license\": \"ISC\",\r\n        \"scripts\": {\r\n            \"build\": \"rollup -c\",\r\n            \"lint\": \"eslint --config eslint.config.js '{src,test}/**/*.ts' --no-ignore\",\r\n            \"autoformat\": \"eslint --config eslint.config.js '{src,test}/**/*.ts' --no-ignore --fix\",\r\n            \"test\": \"jest -c jest.config.ts\",\r\n            \"coverage\": \"jest --collectCoverage --coverageDirectory=\\\"./coverage\\\" --ci --reporters=default --reporters=jest-junit --watchAll=false\",\r\n            \"docs:generate\": \"typedoc --readme README.md --entryPoints src --entryPointStrategy expand --out docs --theme hierarchy --name \\\"Driver Seat Amplify Api - docs\\\" --includeVersion\",\r\n            \"amplify-modelgen\": \"node amplify/scripts/amplify-modelgen.js\",\r\n            \"amplify-push\": \"node amplify/scripts/amplify-push.js\"\r\n        },\r\n        \"publishConfig\": {\r\n            \"@financiallease:registry\": \"https://gitlab.com/api/v4/projects/35071033/packages/npm/\"\r\n        },\r\n        \"dependencies\": {\r\n            \"@aws-amplify/core\": \"^4.5.1\",\r\n            \"@aws-amplify/datastore\": \"^3.11.0\",\r\n            \"@rollup/plugin-alias\": \"^3.1.9\",\r\n            \"aws-amplify\": \"^4.3.19\",\r\n            \"dotenv\": \"^16.0.0\",\r\n            \"ts-node\": \"^10.7.0\",\r\n            \"typescript\": \"^4.6.3\"\r\n        },\r\n        \"devDependencies\": {\r\n            \"@babel/core\": \"^7.17.9\",\r\n            \"@babel/preset-env\": \"^7.16.11\",\r\n            \"@babel/preset-typescript\": \"^7.16.7\",\r\n            \"@rollup/plugin-babel\": \"^5.3.1\",\r\n            \"@rollup/plugin-commonjs\": \"^21.0.3\",\r\n            \"@rollup/plugin-node-resolve\": \"^13.1.3\",\r\n            \"@rollup/plugin-typescript\": \"^8.3.1\",\r\n            \"@types/amplify\": \"^1.1.25\",\r\n            \"@types/jest\": \"^27.4.1\",\r\n            \"@types/node\": \"^17.0.30\",\r\n            \"@typescript-eslint/eslint-plugin\": \"^5.18.0\",\r\n            \"@typescript-eslint/parser\": \"^5.18.0\",\r\n            \"babel-jest\": \"^28.0.3\",\r\n            \"babel-plugin-module-resolver\": \"^4.1.0\",\r\n            \"eslint\": \"^8.12.0\",\r\n            \"eslint-import-resolver-alias\": \"^1.1.2\",\r\n            \"eslint-plugin-react\": \"^7.29.4\",\r\n            \"esm\": \"^3.2.25\",\r\n            \"jest\": \"^27.5.1\",\r\n            \"jest-junit\": \"^13.2.0\",\r\n            \"jsdoc\": \"^3.6.10\",\r\n            \"nodemon\": \"^2.0.16\",\r\n            \"rollup\": \"^2.70.1\",\r\n            \"rollup-plugin-terser\": \"^7.0.2\",\r\n            \"ts-jest\": \"^27.1.4\",\r\n            \"tsconfig-paths\": \"^3.14.1\",\r\n            \"tslib\": \"^2.3.1\",\r\n            \"typedoc\": \"^0.22.15\",\r\n            \"typedoc-theme-hierarchy\": \"^1.1.1\",\r\n            \"ini\": \"^1.3.5\",\r\n            \"inquirer\": \"^6.5.1\"\r\n        }\r\n    }\r\n\r\n<!-- end snippet -->\r\n\r\nAny ideas?","upvoteCount":4,"comments":{"edges":[{"node":{"author":{"login":"tomyates"},"body":"I'm getting this error too.\r\nI have a ReactJS app and a React Native app and the React Native app gives me this warning.\r\nI'm using aws-amplify version 4.3.21."}},{"node":{"author":{"login":"svidgen"},"body":"Try upgrading to the latest version (`4.3.24`) and remove the superfluous deps:\r\n\r\n```\r\n        \"@aws-amplify/core\": \"^4.5.1\",\r\n        \"@aws-amplify/datastore\": \"^3.11.0\",\r\n```\r\n\r\nThen wipe your `node_modules` and reinstall, please. Including the core `aws-amplify` package *and* individual packages can sometimes cause instability.\r\n\r\nThe latest version should may give you a little more logging to help troubleshoot."}},{"node":{"author":{"login":"youssef-almardini"},"body":"Well, I just deleted the amplify directory in my base code and run:\r\n`amplify pull --appId <APP_ID> --envName <ENV>`\r\nAfter that everything works again"}}]}}},{"node":{"id":"D_kwDOBkswNc4ARSIL","author":{"login":"codermpl"},"title":"currentUserCredentials vs currentCredentials","body":"Hello, what's the difference between currentUserCredentials and currentCredentials and when should I use each one? I haven't found anything in the documentation that goes over when to use each. Looking through the code currentCredentials seems to get new credentials if the credentials are expired. While currentUserCredentials has different logic and gets new credentials every time for me.","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4ARQTE","author":{"login":"wahidzzz"},"title":"DataStore : Cascading Delete Flag for Delete - Enable/Disable Deleting Child Element for Relational Data","body":"I am working on Web App that has multi-relational data, I want understand is there a way to disable cascading delete? \r\n\r\nBased on this comment : https://github.com/aws-amplify/amplify-js/issues/9553#issuecomment-1030285612\r\n\r\n\"When deleting the parent in a Has One relationship the current expected behavior, for our JS implementation of DataStore, is for the child to get deleted as well, similar to Many-to-many relationships.\"\r\n\r\nI want to keep the Child once parent is been deleted.\r\n\r\n\r\n","upvoteCount":0,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4ARQFa","author":{"login":"akterstack"},"title":"Prevent XSS attack for CookieStorage - amazon-cognito-identity-js","body":"We are using `CookieStorage` to store auth tokens of logged in users. But later we found that this library store token as client side cookie without `HttpOnly` flag. So we are very scared about XSS at this moment. \r\n\r\nShould we stop using this library or is there any approach to safe the users token/sessions.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4ARP24","author":{"login":"fredcool"},"title":"[Amplify Auth][Cognito] How to persist user session from authenticateUser() to authorize endpoint","body":"Trying to resolve this issue for few weeks but still no luck. Really appreciated for any hints or solutions.\r\nI have built a web application utilized Cognito and amazon-cognito-identity-js SDK for user registrations and user sign-in.\r\nIn this web application, I have integrated a 3rd party SASS in the iframe which used OIDC flow (https://docs.aws.amazon.com/cognito/latest/developerguide/authorization-endpoint.html) to authenticate users.\r\nHere is the flow which caused the issue:\r\n1. Users signed in through my web application. I used authenticateUser() from amazon-cognito-identity-js. I am certain that the users have signed in and able to get id token, access token and refresh token. Therefore, I assumed the Cognito should have this user in the session.\r\n2. Users accessed the 3rd party SASS. It redirected users to my Cognito authorize endpoint and then it redirected users to login page (but the users already signed in from my web application). Here is the point. I assumed this user already in the session so it should automatically return the authorization code without sign in again. Initially I thought it could be the iframe, so I have the same OIDC flow set up on my web application. But even I signed in from the step 1, the authorize endpoint still redirected me to the login page.\r\n\r\nIs there a way to sync the session to the authorize endpoint? Really appreciated! ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4ARLuT","author":{"login":"shopizer-ecommerce"},"title":"Where can i find and translate confirmsignup message","body":"When i an creating a new user with verification email the UI displays a text that seems to be hard to find and can not figure out a way to translate it\r\n\r\nHere is the text displayed\r\n\r\nYour code is on the way. To log in, enter the code we emailed to ..@ . It may take a minute to arrive.\r\n\r\nAny idea on his i can have this translated using\r\nI18n.putVocabularies\r\n\r\nor anything else\r\n\r\nThanks","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"tannerabread"},"body":"It should just be hiding the email. \r\ne.g. test@test.com becomes `..@..` or something similar.\r\n\r\nIs this what you were asking about?"}},{"node":{"author":{"login":"shopizer-ecommerce"},"body":"As a cliarification need to translate the paragraph from \r\n\r\nYour code is on the way. To log in, enter the code we emailed to cd...@yahoo.com\r\nin an other language. \r\n\r\nI18n.putVocabularies requires the exact sentence and the email stuff\r\n"}},{"node":{"author":{"login":"kennu"},"body":"Looks like the actual strings (for React UI) are defined here: https://github.com/aws-amplify/amplify-ui/blob/477a005935f242b49e776d42054810bc5d115857/packages/react/src/components/Authenticator/ConfirmSignUp/ConfirmSignUp.tsx#L39\r\n\r\n```\r\n  const emailMessage = translate(\r\n    'Your code is on the way. To log in, enter the code we emailed to'\r\n  );\r\n  ...\r\n  const minutesMessage = translate('It may take a minute to arrive.');\r\n```\r\n\r\n"}}]}}},{"node":{"id":"D_kwDOBkswNc4ARJh2","author":{"login":"BroMattMiller"},"title":"Using amazon-cognito-identity-js in a Service Worker","body":"In the browser I want to serve all Cognito auth tokens from a service worker, both for security and for ease of automatically adding tokens into Authorization request headers. However, I see that localStorage is used to hold all this stuff, and localStorage is disallowed in a service worker. Should I just change the cache storage functions to use a service worker cache, or am I missing some easier way?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"BroMattMiller"},"body":"I see now that the api doesn't rely on localStorage, but just uses memory if localStorage isn't available. So, this isn't an issue. And, it ended up making more sense to operate the service worker in between the Cognito api and the fetches it makes to the back end, so it's really a non-issue."}}]}}},{"node":{"id":"D_kwDOBkswNc4ARKu_","author":{"login":"pptavozl"},"title":"GraphQL subscription: filtering not working","body":"Hello, i was reading documentation about GraphQL [subscription filtering ](https://docs.amplify.aws/lib/graphqlapi/subscribe-data/q/platform/js/#using-amplify-graphql-client)\r\n\r\nexample code: \r\n\r\n```\r\n// Only subscribe to creation of Todo, if the todo \"type\" is \"Personal\"\r\nconst subscription = API.graphql(\r\n    graphqlOperation(subscriptions.onCreateTodo, {\r\n      filter: {\r\n        type: { eq: \"Personal\" }\r\n      }\r\n    })\r\n).subscribe({\r\n    next: ({ provider, value }) => console.log({ provider, value }),\r\n    error: error => console.warn(error)\r\n});\r\n```\r\n\r\n\r\nim using similar code, but AppSync onCreateMyTableData not giving me filter parameters,\r\n\r\n\r\nschema I'm using:\r\n```\r\ntype MyTableData  @model @auth(rules: [{ allow: public }]) {\r\n\tid: ID!\r\n\tfeedbackId: String!\r\n\t\t@index(\r\n\t\t\tname: \"byFeedback\"\r\n\t\t\tqueryField: \"feedbackMessagesByFeedback\"\r\n\t\t\tsortKeyFields: [\"createdAt\"]\r\n\t\t)\r\n\tmessage: String!\r\n\tuser: String!\r\n\tcreatedAt: AWSDateTime\r\n}\r\n```\r\n\r\n\r\nNot filtering code I'm using:\r\n```\r\nconst observer = API.graphql(\r\n\t\t\tgraphqlOperation(onCreateMyTableData, {\r\n\t\t\t\tfilter: {\r\n\t\t\t\t\tfeedbackId: { eq: feedbackId }\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t).subscribe({\r\n    next: ({ provider, value }) => console.log({ provider, value }),\r\n    error: error => console.warn(error)\r\n});\r\n```\r\n\r\n\r\nAnyone knows if i need to add something else to Schema?\r\n\r\n\r\nThanks for reading","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AQnav","author":{"login":"stefanomiccoli"},"title":"subscribe to user info on page load","body":"The scenario: we want to store user info (cognito groups, token etc) as soon as this is available after loading the angular application. We have therefore two cases:\r\n1. previously unauthenticated user loads the page, is shown the login form, authenticates, authenticated section of the application is loaded\r\n2. previously authenticated user loads the page, authenticated section of the application is shown\r\n\r\nOur need: as soon as user info is available, store it in a custom service, that will be responsible to fetch user preferences and other stuff. Before updating to amplify@4 I remember ending up with the function `onAuthUIStateChange` to listen to auth state changes after realizing that `Hub.listen` would not trigger any event when loading a page as already logged in (use case 2 above)\r\n\r\nOur problem: I followed the very [concise documentation](https://ui.docs.amplify.aws/angular/connected-components/authenticator/configuration) for angular. I get the login component for unauthenticate users and the protected content for the authenticated users. So far so good. But now I have to listen to user changes. Unfortunately `AuthenticatorService` does not expose any method or property to subscribe to an observable for the user status as one would reasonably expected by an angular library, `Hub.listen` does not trigger any event when loading the page as already authenticated (consistent with previous behavior, still doesnt make sense to me) and `onAuthUIStateChange` is not invoked at all (although being part of the library and not deprecated).\r\n\r\nSo, what is the official/standard way of listening for changes to the user status in angular using the latest version of the amplify library?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"abdallahshaban557"},"body":"Hi @stefanomiccoli  - do you want to listen to all user profile changes? or are you looking for it after the user has been registered or created? "}},{"node":{"author":{"login":"stefanomiccoli"},"body":"any feedback?"}}]}}},{"node":{"id":"D_kwDOBkswNc4ARGfL","author":{"login":"SFaraji"},"title":"Cognito Hosted UI - Passwordless Option","body":"Hi team, \r\n\r\nPlease allow passwordless option for Hosted UI by allowing to remove the mandatory password field from both sign up and sign in form.\r\n\r\nThis is a must feature to support.\r\n\r\nThanks,","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4ARFjE","author":{"login":"Arnav7501"},"title":"User pool client xxxx does not exist.","body":"if i try to use Auth.signup or Auth.signin, it gives me this error","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4ARE2F","author":{"login":"Nivethan-Ar"},"title":"oauth2/token endpoint gives invalid_client error","body":"after signing in the user using hosted ui i get the code then i send the post request like  following to get the access token\r\n![image](https://user-images.githubusercontent.com/63112138/196002838-ad8c3ef0-a15f-41fd-8199-815deeb240c6.png)\r\n\r\n**headers**\r\n![image](https://user-images.githubusercontent.com/63112138/196002844-ed643381-1694-4cb0-97d8-0d842161e3e9.png)\r\n\r\ni created this pool without client secret so the Authorization header is just in \"Basic App_client_id\" format\r\n\r\nwhat mistake i'm making? why i'm not getting the access token?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AREVf","author":{"login":"joaovitorzv"},"title":"retrieve tokens from local storage then set as cookies","body":"I have a remix app setup with amplify auth and headless Authentication from `@aws-amplify/ui-react`, I can sign in and out successfully and make SSR requests with the `withSSRContext` with no problems.\r\n\r\nproblem is when the user closes the browser and re-opens it again i would like to keep the user logged in, it partially happens since the user tokens are kept stored in the local storage but the cookies aren't, based on [this issue comment](https://github.com/aws-amplify/amplify-js/issues/8011#issuecomment-1012025277) i've been trying to restore the cookies from the local storage by calling the `Auth.currentAuthenticatedUser()` on **client first** then redirecting, but had no success. Is this the correct way to fix this problem or am i missing something here?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AREB8","author":{"login":"BohdanShuliaka"},"title":"Forgot password resend code.","body":"Hello everyone! Ive faced an issue with \"forgot password\" functionality. Im reusing Auth API in order to create custom auth flow, and I want to recreate my own forgot pass screen but I cannot find any API call or method for \"resend code\" which is present in the hosted UI.\r\nHow can I cower that? I googled everything and I see that there is no solution yet. I hope Im wrong 🙂\r\n![image](https://user-images.githubusercontent.com/32823029/195799020-28c34d04-031e-4ab7-bfc7-195d3cb7c8b1.png)\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4ARBfF","author":{"login":"nolde"},"title":"Federated Sign-In with `amazon-cognito-identity-js`","body":"Hello!\r\n\r\nI am using a Cognito User Pool for my application, along with Google as an identify provider configured against it. I am not using Amplify in any way, other than using the [`amazon-cognito-identity-js`](https://github.com/aws-amplify/amplify-js/tree/master/packages/amazon-cognito-identity-js) library that is part of this repository.\r\n\r\nWhen handling direct login, all works fine, using the examples provided [here](https://github.com/aws-amplify/amplify-js/tree/master/packages/amazon-cognito-identity-js), simple calling `authenticateUser` and away I go. However, the library does not seem to have any specific methods to handle external identity providers.\r\n\r\nSo far, I have used the same endpoints used by Cognito's hosted UI to login using Google, and this works to some extent, as I can get redirect to my app with the tokens being carried over with hash parameters, but then I do not know how to create a user session using these tokens. If I just try to `new CognitoUserSession`, I get failures (`this.accessToken.getIssuedAt is not a function at CognitoUserSession2.calculateClockDrift\"`). And I can't seem to find any specific methods I should be using for that... what am I missing?\r\n\r\nThe reason I am trying to do that is for built-in features, like editing user details, or refreshing tokens.\r\n\r\nI've found two related questions here:\r\n\r\n- https://github.com/aws-amplify/amplify-js/discussions/9589\r\n    + no response\r\n- https://github.com/aws-amplify/amplify-js/discussions/5554\r\n    + kind of similar to what I want, using amplify auth without setting up Amplify... but I am NOT using Amplify in any way, and it it seems like a Cognito Identify Pool is required... which I don't use, I just have the User Pool with Identity Providers attached.\r\n\r\nAnyone did something similar?\r\n\r\nThanks in advance.\r\n","upvoteCount":5,"comments":{"edges":[{"node":{"author":{"login":"nolde"},"body":"Ok, for anyone tyring to do the same, there are two options:\r\n\r\n1. You can use just the auth part of amplify with no obvious problems. Although their docs make it seem like an Identity Pool is required, that is not actually true. You can use just the User Pool and still have proper federated login support.\r\n\r\n2. If you do not want the bloat of Amplify stuff you do not need, you can use just 'amazon-cognito-identity-js'. After you exchange the code for the tokens, you can do the following:\r\n    ```js\r\n    const session = new CognitoUserSession({\r\n      IdToken: new CognitoIdToken({ IdToken: response.id_token }),\r\n      RefreshToken: new CognitoRefreshToken({ RefreshToken: response.refresh_token }),\r\n      AccessToken: new CognitoAccessToken({ AccessToken: response.access_token })\r\n    })\r\n    const username = session.getIdToken().decodePayload()['cognito:username']\r\n    const user = new CognitoUser({ Username: username, Pool: userPool })\r\n    user.setAuthenticationFlowType('USER_SRP_AUTH') // optional\r\n    user.setSignInUserSession(session)\r\n    ```\r\n    The last method seems to properly save the session into the store, and update the `LastAuthUser` to the correct one, allowing you to `userPool.getCurrentUser()` correctly. There is still an issue with the session not being prefilled when you get the user from this method; you can retrieve it by using `user.getSession((err, session) => user.setSignInUserSession(session))`.\r\n\r\nHopefully one these options works for you. I might publish a repo with a test app for people in need of examples."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjQ2MTEx","author":{"login":"vadimmelnicuk"},"title":"How to call GraphQL API mutations within a Lambda?","body":"Hey, I cannot get my head around the proper way of calling GraphQL API mutations from AWS Lambdas. I am using the method decribed in the official documentation [https://docs.amplify.aws/cli/function#signing-a-request-from-lambda](https://docs.amplify.aws/cli/function#signing-a-request-from-lambda), please see below:\r\n\r\n```\r\nconst updateTodo = `\r\nmutation updateTodo($input: UpdateTodoInput!) {\r\n  updateTodo(input: $input) {\r\n    id\r\n    active\r\n  }\r\n}`\r\n\r\nlet req = new AWS.HttpRequest(process.env.API_APINAME_GRAPHQLAPIENDPOINTOUTPUT, process.env.REGION)\r\nreq.method = 'POST'\r\nreq.path = '/graphql'\r\nreq.headers.host = new urlParse(process.env.API_APINAME_GRAPHQLAPIENDPOINTOUTPUT).hostname.toString()\r\nreq.headers['Content-Type'] = 'application/json'\r\nreq.body = JSON.stringify({\r\n  query: updateTodo,\r\n  operationName: 'updateTodo',\r\n  variables: {\r\n    input: {\r\n      id: todo.Item.id,\r\n      active: true\r\n    }\r\n  }\r\n})\r\n\r\nlet signer = new AWS.Signers.V4(req, 'appsync', true);\r\nsigner.addAuthorization(AWS.config.credentials, AWS.util.date.getDate())\r\n\r\nconst data = await new Promise((resolve, reject) => {\r\n  let httpRequest = https.request({...req, host: req.headers.host}, (result) => {\r\n    result.on('data', (data) => {\r\n      resolve(JSON.parse(data.toString()));\r\n    })\r\n  })\r\n  httpRequest.write(req.body)\r\n  httpRequest.end()\r\n})\r\n```\r\n\r\nHowever, I tend to get the following error as a response to my mutations:\r\n```\r\nerrors: [\r\n  {\r\n    errorType: 'UnauthorizedException',\r\n    message: 'Permission denied'\r\n  }\r\n]\r\n```\r\n\r\nAlso, here is my GraphQL Schema:\r\n\r\n```\r\ntype Todo\r\n@model(subscriptions: {level: public})\r\n@auth (rules: [\r\n  {allow: groups, groups: [\"Admin\"]},\r\n  {allow: owner},\r\n  {allow: private, operations: [read]},\r\n  {allow: public, operations: [read], provider: iam}\r\n])\r\n{\r\n  id: ID!\r\n  active: Boolean\r\n}\r\n```\r\n\r\nPlease note, I have enabled CRUD access to my GprahQL API for my lambda function. My AppSync auth methods are set to primary Cognitor User Pools and secondary IAM.\r\n\r\nWhat am I doing wrong?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"eliecer2000"},"body":"Hello, I think you need to add `create/update` to your `iam` rule.\r\n\r\n` {allow: public, operations: [read, create, update], provider: iam}`"}},{"node":{"author":{"login":"robsaffi"},"body":"Hi Eliecer,\nThank you for looking into this further. Where should I add that code to add create/update to my iam rule? Is that on the User model on my schema.graphql?\n\nThanks,\nRob\n\n> On Apr 19, 2022, at 12:45 PM, Eliecer Rangel ***@***.***> wrote:\n> \n> \n> Hello, I think you need to add create/update to your iam rule.\n> \n> {allow: public, operations: [read, create, update], provider: iam}\n> \n> —\n> Reply to this email directly, view it on GitHub <https://github.com/aws-amplify/amplify-js/discussions/7854#discussioncomment-2594783>, or unsubscribe <https://github.com/notifications/unsubscribe-auth/AIQWYA5MEVW3QEIXFFCCR2LVF3PJ3ANCNFSM4YPGNFZQ>.\n> You are receiving this because you commented.\n> \n\n"}},{"node":{"author":{"login":"robsaffi"},"body":"Thank you for clarifying that. Unfortunately, I’m getting the same result, even with that additional auth rule.\n\nWhen I create a new User, the “owner” field is still not automatically filled with the logged in cognito user name, as it does when I create a user through the iOS Amplify CreateUser function.\n\nAnything else I should be doing to make sure the user name is passed to the GraphQL API to fill that value?\n\nThanks,\nRob\n\n> On Apr 19, 2022, at 1:36 PM, Eliecer Rangel ***@***.***> wrote:\n> \n> \n> If you have to place it in your model, it should be like this.\n> \n> type Todo\n> @model(subscriptions: {level: public})\n> @auth (rules: [\n>   {allow: groups, groups: [\"Admin\"]},\n>   {allow: owner},\n>   {allow: private, operations: [read]},\n>   {allow: public, operations: [read, create, update], provider: iam}\n> ])\n> {\n>   id: ID!\n>   active: Boolean\n> }\n> Sorry for not being more specific.\n> \n> —\n> Reply to this email directly, view it on GitHub <https://github.com/aws-amplify/amplify-js/discussions/7854#discussioncomment-2595134>, or unsubscribe <https://github.com/notifications/unsubscribe-auth/AIQWYAYJOTSKEWBQTQACG33VF3VIFANCNFSM4YPGNFZQ>.\n> You are receiving this because you commented.\n> \n\n"}}]}}},{"node":{"id":"D_kwDOBkswNc4AODnj","author":{"login":"solomolo1"},"title":"can amazon-cognito be used strictly in the backend?","body":"Hi all, \r\n\r\nI am just trying to implement cognito in my app, specifically using the `amazon-cognito-identity-js` library. I managed to set up cognito (including sign up, login, change password, sign out) strictly in the backend (nodejs/express). And when I log in on my front end, I am able to do so successfully and the session persists across pages, even though I am never passing `localstorage` cognito tokens to the backend and I am never storing any of the tokens in the frontend either (obviously because `localstorage` doesn't exist in the backend).Is this happening because all of the session data is stored server side? So Cognito is able to recognize the session purely in the backend as I have implemented it? Is this a good approach to follow? \r\n\r\nAny help is greatly appreciated. Thanks so much!","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"achinthaprem"},"body":"Hi,\r\n\r\nI know I'm late to the discussion.\r\n\r\nI also have an application with the `amazon-cognito-identity-js` library in a node js backend. There was no issue until we were going to implement TOTP MFA. The issue arises when you have to make 2 requests (1st to obtain the QR code data and 2nd to verify the TOTP code) to set up MFA initially for a user. The library can't preserve the session between the 2 requests and cannot set up MFA and throws NotAuthorizedException."}},{"node":{"author":{"login":"rain89146"},"body":"So, I just discovered it today, they are using a variable to cache the result in the backend, which means if u have two client browsers open side by side, once u logged in one, and the other one becomes logged in as well. I even tried it on different types of browsers. I also tried on custom storage class, but no luck from there too. I guess aws-sdk is still a better solution."}}]}}},{"node":{"id":"D_kwDOBkswNc4ARANS","author":{"login":"Datascientistzxcv"},"title":"SSG CI/CD nextjs deployement on Amplify","body":"I am trying to deploy SSG nextjs application on Amplify all stages passing successfully when i tried to open the URL getting 404 error \r\ndo i need to include any rewrite rules\r\n\r\nthis is the amplify.yml file\r\n![image](https://user-images.githubusercontent.com/55860087/194743618-5f83b991-fba9-4e4d-a867-48b9300b06ec.png)\r\n\r\ngetting this error after deployment\r\n![image](https://user-images.githubusercontent.com/55860087/194743585-b41c553e-c60f-48de-a173-857edf1bd5cf.png)\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4ARAEV","author":{"login":"anni1236012"},"title":"Amplify GraphQL No Crendentials Error in NextJs Application","body":"NextJs Application is working perfectly fine locally but after pushing the fronted to AWS I'm getting the run time error  **No Credentials** in _**callback.js**_ api \r\n\r\n\r\nNo Build time error so I assume aws-exports.js file is built correctly during the build but I don't know if it is built with the required details like API key on AWS. \r\n\r\nI have already tried multiple suggestions like disable Analytics: true  as suggested in couple of other discussions but none of them worked for me. Build my project multiple times from scratch by re-installing all the dependencies but no luck. \r\n\r\n**callback.js API**\r\n```\r\nimport { API, graphqlOperation } from 'aws-amplify';\r\nimport {getAuth} from \"../../../../src/graphql/queries\"\r\nimport {createAuth} from \"../../../../src/graphql/mutations\"\r\n\r\nexport default async function callback(req, res) {\r\n      const record = await API.graphql(graphqlOperation(getAuth, {emailId: \"abc@gmail.com\"}))\r\n      res.status(200).json({ record });\r\n}\r\n```\r\n**aws-exports.js**\r\n```\r\n/* eslint-disable */\r\n// WARNING: DO NOT EDIT. This file is automatically generated by AWS Amplify. It will be overwritten.\r\n\r\nconst awsmobile = {\r\n    \"aws_project_region\": \"us-east-1\",\r\n    \"aws_appsync_graphqlEndpoint\": \"https://dummyUrl.appsync-api.us-east-1.amazonaws.com/graphql\",\r\n    \"aws_appsync_region\": \"us-east-1\",\r\n    \"aws_appsync_authenticationType\": \"API_KEY\",\r\n    \"aws_appsync_apiKey\": \"da2-************\"\r\n};\r\n\r\nexport default awsmobile;\r\n```\r\n\r\n**_app.js**\r\n```\r\n\r\nimport {Amplify} from 'aws-amplify';\r\nimport config from \"../aws-exports\"\r\nAmplify.configure(config)\r\n\r\nfunction MyApp({ Component, pageProps: { session, ...pageProps } }) {\r\n // App logic\r\n\r\n})\r\n\r\n```\r\n\r\n**GraphQL Schema**\r\n```\r\ntype Auth @model @auth(rules: [{ allow: public }])  {\r\n  emailId: ID! @primaryKey\r\n  name: String\r\n  screen_name: String\r\n  profile_img: String\r\n  userSession: String\r\n  tokenType: String\r\n  accessToken: String\r\n  accessSecret: String\r\n  refreshToken: String\r\n  accessScope: String\r\n}\r\n```\r\n\r\n\r\n**Package.json**\r\n```\r\n\"dependencies\": {\r\n    \"@emoji-mart/data\": \"^1.0.6\",\r\n    \"@emoji-mart/react\": \"^1.0.1\",\r\n    \"aes256\": \"^1.1.0\",\r\n    \"aws-amplify\": \"^4.3.37\",\r\n    \"emoji-mart\": \"^5.2.2\",\r\n    \"formidable\": \"^2.0.1\",\r\n    \"js-cookie\": \"^3.0.1\",\r\n    \"next\": \"12.3.1\",\r\n    \"react\": \"18.2.0\",\r\n    \"react-datepicker\": \"^4.8.0\",\r\n    \"react-dom\": \"18.2.0\",\r\n  },\r\n```\r\nAmplify.yml \r\n```\r\nversion: 1\r\nbackend:\r\n  phases:\r\n    build:\r\n      commands:\r\n        - '# Execute Amplify CLI with the helper script'\r\n        - amplifyPush --simple\r\nfrontend:\r\n  phases:\r\n    preBuild:\r\n      commands:\r\n        - yarn install\r\n    build:\r\n      commands:\r\n        - yarn run build\r\n  \r\n  artifacts:\r\n    baseDirectory: .next\r\n    files:\r\n      - '**/*'\r\n  cache:\r\n    paths:\r\n      - node_modules/**/*\r\n\r\n```","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AQ_Uy","author":{"login":"mlag"},"title":"Use normal Lamdba instead of Lambda@Edge","body":"I'm using NextJS. My understanding is that all requests to /api/* go to Lambda@Edge functions. Is it possible to disable Lambda@Edge and host all lambda functions in a single region?\r\nOur database is hosted in us-east-1. When a Lambda@Edge function is invoked in Japan there are a lot of lengthy roundtrips to the database.","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AQ8rn","author":{"login":"RoyalBis"},"title":"amplify cli always detects changes on amplify push","body":"I have an amplify project with a graphql API. When using the cli command, `amplify push`, changes are always detected for the API and force a build and redeploy to the console.\r\n\r\nThis occurs when issuing two `amplify push` commands back to back. \r\nChanges are **not** detected with the following commands:\r\n\r\n`amplify status`\r\n`amplify api push`\r\n\r\nIn these events, no change is detected as expected. It seems during the amplify push command something specific is causing it to appear that the API has been updated.\r\n ","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AQDcB","author":{"login":"ZRunner"},"title":"Jest warning: No navigator object available to get browser client info","body":"Hello there!\r\n\r\nI'm trying to implement Jest tests on my React Native app, and I successfully did, but I noticed Amplify keeps warning me about this missing navigator object.\r\n\r\nI guess this is kind of an expected behavior, as the tests run fine, and considering a Jest test environment has probably no browser available. But I would like to know if there is any way to silent this warning, or fix it if possible.\r\n\r\nThe full stack:\r\n```console\r\n  ● Console\r\n\r\n    console.warn\r\n      [WARN] 08:18.371 ClientDevice_Browser - No navigator object available to get browser client info\r\n\r\n      at ConsoleLogger.apply [as _log] (node_modules/@aws-amplify/core/src/Logger/ConsoleLogger.ts:115:4)\r\n      at ConsoleLogger.warn (node_modules/@aws-amplify/core/src/Logger/ConsoleLogger.ts:164:12)\r\n      at browserClientInfo (node_modules/@aws-amplify/core/src/ClientDevice/browser.ts:33:10)\r\n      at Object.browser_1 [as clientInfo] (node_modules/@aws-amplify/core/src/ClientDevice/browser.ts:22:9)\r\n      at Function.clientInfo (node_modules/@aws-amplify/core/src/ClientDevice/index.ts:18:10)\r\n      at new AWSPinpointProvider (node_modules/@aws-amplify/analytics/src/Providers/AWSPinpointProvider.ts:96:35)\r\n      at AnalyticsClass.configure (node_modules/@aws-amplify/analytics/src/Analytics.ts:129:22)\r\n      at AmplifyClass.register (node_modules/@aws-amplify/core/src/Amplify.ts:50:8)\r\n```\r\n\r\nI'm using React Native 0.68.2, jest 27.5.1, and aws-amplify 4.3.26, if that matters.","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"jacobi85"},"body":"hey, yes I encountered the same I solved it by mocking the Navigator and the ClientDevice_browser inside my jest.setup.js file likeso:\r\n\r\n```\r\nglobal.navigator = {\r\n  ClientDevice_Browser: jest.fn().mockImplementation(() => Promise.resolve()),\r\n};\r\n```"}}]}}},{"node":{"id":"D_kwDOBkswNc4AO30Y","author":{"login":"aalok05"},"title":"What's the correct way to respond to challenge with the name 'PASSWORD_VERIFIER' ?","body":"Upon doing _Auth.signIn_ , I am getting a challenge in response with challengeName 'PASSWORD_VERIFIER'. I was wondering what's the correct way to respond to this challenge. \r\nI've looked at the amplify-js docs but couldn't find the answer.\r\n\r\nPlease note that I also need to check if MFA is enabled and handle that in the code.\r\n\r\nThanks in advance!","upvoteCount":6,"comments":{"edges":[{"node":{"author":{"login":"cristianCeamatuAssist"},"body":"I am facing the same issue, poorly written documentation."}}]}}},{"node":{"id":"D_kwDOBkswNc4AQ6GD","author":{"login":"jdanielsyeah"},"title":"Subscription UnauthorizedException warning on \"update\" of model. How to turn subscription off?","body":"I've recently updated my AWS Amplify front end (NextJS) to remove any subscriptions to a \"Card\" object that I've created in my schema.graphql file. For some reason I'm still getting warnings in my dev tools console telling me that there's a subscription problem concerning authorisation when performing \"update\" on the \"Card\" model. My best guess is that Datastore is still performing some kind of subscription function in the background, but I can't find any information to explain what's going on or how to act on the warning. Could anyone please help explain this one?\r\n\r\nMy schema.graphql showing the subscriptions should be turned off on Card:\r\n```graphql\r\ntype Card\r\n  @model(subscriptions: null) # Removed subscriptions\r\n{...}\r\n```\r\nI used to have subscriptions set up in my javascript, but I have removed them too, eg:\r\n```js\r\n// I have deleted all code relating to subscriptions, such as the following:\r\n  const subscription = DataStore.observe(Card).subscribe(() => fetchCards());\r\n  return () => subscription.unsubscribe();\r\n```\r\n\r\nI get this warning message in my dev tools console:\r\n```\r\nDataStore - subscriptionError Connection failed: {\r\n  \"errors\":[{\r\n    \"errorType\":\"UnauthorizedException\",\r\n    \"message\":\"Permission denied\"\r\n   }\r\n]}\r\n```\r\n\r\nFollowed by this warning:\r\n```\r\nreact_devtools_backend.js:4026 [WARN] \r\n39:46.202 DataStore \r\n{\r\n  recoverySuggestion: 'Ensure app code is up to date, auth directives\r\n  exist and are correct on each model, \r\n  and that server-side data has not been invalidated by a schema\r\n  change. If the problem persists, search for or create an issue:\r\n  https://github.com/aws-amplify/amplify-js/issues', \r\n  localModel: null, \r\n  message: 'Connection failed: \r\n    {\r\n       \"errors\": [\r\n         {\r\n           \"errorType\":\"UnauthorizedException\", \r\n           \"message\":\"Permission denied\"\r\n          }\r\n        ]\r\n}', \r\n  model: 'Card', operation: 'Update', \r\n…}\r\n```","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"duranmla"},"body":"A floating comment from my side _(any guarantee this will solve the issue)_. \r\nI know that people is coming out from `@model(subscriptions: null)` to actually `@model(subscriptions: { level: off })`. Nonetheless, I face the same issue than you and I couldn't make it work.\r\n\r\nAlso be aware of things like this https://github.com/aws-amplify/amplify-cli/issues/7033#issuecomment-840874802 maybe not your case tho but you are not sharing the schema."}}]}}},{"node":{"id":"D_kwDOBkswNc4AQ8Kb","author":{"login":"enrico-calzavara"},"title":"Navigating back to the \"Sign in as a different user\" hosted page causes authentication issues","body":"Hi, \r\n\r\nI have an application that is using amplify and Cognito Hosted UI. Users land on the application and are redirected to the hosted ui page calling `Auth.federatedSignIn()`. After a successful sign in, they are redirected on the application and everything works correctly, with amplify calling the endpoint `oauth2/token` and successfully retrieving the token. \r\n\r\nAt this point, if a user hits the browser back button, the browser navigates back on the hosted ui page, which now prompts the \"_sign in as a different user_\" action, detecting that a user is already signed in. \r\nNow, if the user choose to sign in as a different user, the user is redirected to the hosted sign in form, as before. But this time, when the user signs in and is redirected on the application, the call to the `oauth2/token` endpoint fails with an `invalid_request` error because the request is missing the `code_verifier` parameter. \r\n\r\nAfter a bit of debugging, I noticed that in the normal flow of events (my landing page -> hosted ui -> application) when the `Auth.federatedSignIn()` method is called to navigate on the hosted ui, it generates the data that is later used to value the `code_verifier` parameter. But when navigating back to the hosted ui page, that method is not called and the `code_verifier` data is not generated.\r\n\r\nWhile debugging, I also realised that the \"_sign in as a different user_\" action implies a call to the `logout` endpoint (which then causes a redirection to the sign in page). The call to the the `logout` endpoint contains a `redirect_uri` containing the url of my landing page, but in this phase it's kind of not taken into account.\r\n\r\nSo, the question is: is there some right way to manage this kind of case, with a back navigation to the \"_sign is as a different user_\" page? I noticed, in the [logout endpoint documentation](https://docs.aws.amazon.com/cognito/latest/developerguide/logout-endpoint.html), that there's a `logout_uri` parameter that can be used to specify a location to redirect users after a sign out. But when the hosted page is loaded, the \"_sign in as a different user_\" action is pre-built with just a `redirect_uri` parameter. Is there a way to specify somewhere this parameter? In this way I could, for example, restart the normal flow from my application.\r\n\r\nThanks to everyone!\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AQ8Dn","author":{"login":"Nut41tank"},"title":"how to stop getSession to update token when idToken is expire ( refreshSession ???)","body":"docs -> https://www.npmjs.com/package/amazon-cognito-identity-js\r\ni'm try to implement cognito with react typescript but getSession will update my idToken when it expire but I think is should not because **in docs it said you should update local storage token with refreshSession** ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AQ7VB","author":{"login":"anthony-dupont"},"title":"amplify update function for Environment variable","body":"When I add a new environment variable, we have fill in a value. \r\nHowever, it is not saved as a default value in cloudFormation which make fail the build on a different environment.\r\nIs there a way to also put a default value from the CLI. At the moment the only way to make the build pass is to add default value manually in cloudformation file. ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AQ7RR","author":{"login":"progenaut"},"title":"Join tables","body":"How to join tables in amplify?\r\nI mean if i have\r\n\r\ntype Car @model {\r\n  id: ID!\r\n  name: String!\r\n  wheels: [Wheel] @hasMany\r\n}\r\n\r\ntype Tractor @model {\r\n  id: ID!\r\n  name: String!\r\n  wheels: [Wheel] @hasMany\r\n}\r\n\r\ntype Wheel @model {\r\n    id: ID!\r\n    refId: ID! (ref to car or tractor)\r\n    pressure: String!\r\n}\r\n\r\nIs this somehow possible?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AQ69p","author":{"login":"ErykAttoua"},"title":"Amplify Push Single Function","body":"Is it possible to push a single function?\r\n\r\nIf so, how?\r\nIf not, is this a planned feature? \r\n\r\nThis would be really useful! ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AOsYW","author":{"login":"vincent911001"},"title":"TypeError: stream.pipe is not a function on Electron","body":"Hi,\r\n\r\nI have encountered error of `TypeError: stream.pipe is not a function` in Electron based application with the following codes:\r\n```\r\n  useEffect(() => {\r\n    Storage.list(\"\")\r\n      .then((result) => console.log(result))\r\n      .catch((error) => {\r\n        console.log(error);\r\n      });\r\n  }, []);\r\n```\r\nFYI, I did try to do the same in a normal react web application and it did work without any error.\r\nThus, I would like to ask is there is any way around Electron to fix the error.\r\n\r\nI believe it is related to [https://github.com/aws-amplify/amplify-js/issues/5504](https://github.com/aws-amplify/amplify-js/issues/5504) but since Electron is not just NodeJS, there might be solution for this error?\r\n\r\nFYI, I am using React + Electron.\r\nBesides, `Storage.put()` does work but still bumped into the very same error but it does not affect the file from being uploaded. Thus, S3 configuration is working.\r\n\r\nThanks,\r\nVincent\r\n","upvoteCount":6,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AQ5Pn","author":{"login":"aliwaqar981"},"title":"Passing CustomState in withAuthenticator","body":"Is it possible to pass customState to withAuthenticator? \r\nI wants to get some information after authentication and getting redirected back to my application. I'm using withAuthenticator HOC to do google social login which is working fine but I'm not sure how can I pass any information which I can retrieve later after redirection.\r\n\r\nWhat I'm doing:\r\n`export default withAuthenticator(App, {\r\n  socialProviders: SocialProviders,\r\n  variation: 'default'\r\n});`\r\n\r\nWhat I want to achieve:\r\n`export default withAuthenticator(App, {\r\n  socialProviders: SocialProviders,\r\n  variation: 'default',\r\n  state: {\r\n  domainName: 'donna'\r\n  }\r\n});`","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb244Mzg4NA==","author":null,"title":"-","body":"-","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AQ4qH","author":{"login":"duranmla"},"title":"It is possible to filter by multiple ids on AppSync?","body":"I have a model like:\r\n\r\n```graphql\r\ntype Post\r\n  @model\r\n  @auth(\r\n    rules: [\r\n      { allow: public, operations: [read], provider: apiKey }\r\n      { allow: private, operations: [read] }\r\n      { allow: owner }\r\n      {\r\n        allow: groups\r\n        groups: [\"Admins\"]\r\n        operations: [read, create, update, delete]\r\n      }\r\n    ]\r\n  ) {\r\n  id: ID!\r\n  owner: String\r\n    @auth(\r\n      rules: [\r\n        { allow: owner, operations: [read, delete] }\r\n        { allow: public, operations: [read], provider: apiKey }\r\n      ]\r\n    )\r\n  url: String\r\n  openGraphData: AWSJSON\r\n  image: String\r\n  content: String!\r\n  authorID: ID! @index(name: \"byParticipant\")\r\n  author: Participant @belongsTo(fields: [\"authorID\"])\r\n  projectID: ID! @index(name: \"byProject\")\r\n  project: Project! @belongsTo(fields: [\"projectID\"])\r\n  totalLove: Int @default(value: \"0\")\r\n  totalCred: Int @default(value: \"0\")\r\n}\r\n```\r\n\r\nI want to be able to query this by `projectID` using DataStore I am not able to do it cause `projectID` is not on the model, and using AppSync I can do it but with a single ID like:\r\n\r\n```graphql\r\nquery listPostsByProject {\r\n  listPosts(filter: {projectID: {eq: \"<id>\"}}) {\r\n    items {\r\n      id\r\n      content\r\n      projectID\r\n    }\r\n  }\r\n}\r\n```\r\n\r\nIt is no way for me to do this?","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AQ4c9","author":{"login":"duranmla"},"title":"Amplify DataStore multi-auth not working as expected","body":"I am trying to get public access to my records and update/create/delete only for authenticated users using DataStore and Multi auth configured, nonetheless, DataStore always seems to use **only the default auth mode**.\r\n\r\n> _I created an issue with more information https://github.com/aws-amplify/amplify-cli/issues/11068 just because I wasn't familiarised with Github discussions (sorry about it)_\r\n\r\nThis is a fundamental feature of dataStore so I bet I am doing something wrong but not sure what.\r\n\r\n```graphql\r\ntype Project\r\n  @model\r\n  @auth(\r\n    rules: [\r\n      { allow: private }\r\n      { allow: public, operations: [read], provider: apiKey }\r\n    ]\r\n  ) {\r\n  id: ID!\r\n  name: String!\r\n  description: String!\r\n  location: String!\r\n  problem: String!\r\n  solution: String!\r\n  launchPlan: String!\r\n  status: ProjectStatus! @default(value: \"DRAFT\")\r\n  tags: [Tag] @manyToMany(relationName: \"ProjectTagConnection\")\r\n  organisers: [Organiser] @manyToMany(relationName: \"ProjectOrganiserConnection\")\r\n  participants: [Participant]\r\n    @manyToMany(relationName: \"ProjectParticipantConnection\")\r\n  posts: [Post] @hasMany(indexName: \"byProject\", fields: [\"id\"])\r\n}\r\n```\r\n\r\nI can read the projects as guest and authenticated user but I cannot create them as it fails with _Unauthorized_","upvoteCount":4,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AP-J4","author":{"login":"dreamfalcon"},"title":"oAuthSignOut triggered on tokenRefresh_failure","body":"Hi,\r\nIn  part of my application I just want to know if some user is logged or not. Without asking to login if not.\r\nBut if the refresh token has expire, Amplify automatically redirects the user to logout when trying to use currentAuthenticatedUser, currentSession, currentUserInfo or currentUserPoolUser.\r\nHow could I avoid that?\r\n\r\n\r\n```\r\nasync loadUser() {\r\n    try {\r\n      const userCognito = await Auth.currentAuthenticatedUser({\r\n        bypassCache: false, // Optional, By default is false. If set to true, this call will send a request to Cognito to get the latest user data\r\n      });\r\n      return currentUserPoolUser;\r\n    } catch (err) {\r\n      return undefined;\r\n    }\r\n```\r\n\r\n\r\nThx","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"jzybert"},"body":"I am also seeing this same issue in my application. @dreamfalcon were you able to figure out how to fix this?"}}]}}},{"node":{"id":"D_kwDOBkswNc4AQ3B2","author":{"login":"amirmishani"},"title":"Is there a need for local DB or global State Management when using Datastore in React Native?","body":"I have a general usage question about Datastore in React Native. Is Datastore supposed to replace Local DB or State Management or both or neither? The reason I ask this is because in the \"React Native\" fullstack todo tutorial within the Amplify docs, Datastore is used without a local DB or any global state management. \r\n\r\nIt makes me wonder if there's legit use for say LiteSQL or Redux in combination with Datastore? ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AQuBK","author":{"login":"HerrNerdstromDRK"},"title":"Delete items from DynamoDB with REST API and Lamba","body":"Hi,\r\n\r\nI'm building a simple inventory management system for a project with Amplify DynamoDB, REST, and React. I followed various tutorials online, and so far get() (GET), create() (POST), and update() (POST) work fine. However, I can't seem to figure out how to delete an item from the database from my NodeJS/Javascript application. I've tried numerous permutations of the paths, and also tried using PartiQL, but to no avail.\r\n\r\nCould someone please assist? Thanks!\r\n\r\nHere's hopefully all of the relevant code:\r\n\r\nEach inventory item contains the following:\r\n\r\n```\r\nid: string: Unique identifier built using uuidv4 and serves as the partition key (no sort key included)\r\nname: string: Name of the item\r\ndescription: string: Description of the item\r\ncreatedAt: string: Date when item was created\r\ncreatedBy: string: Human readable username of creator\r\nuserId: string: Cognito username of the creator (managed by Amplify Auth)\r\n```\r\n\r\n```\r\nconst apiName = \"imsapi\";\r\nconst apiDirectory = \"/items\";\r\n\r\n  async function fetchInventoryItems() {\r\n    //    console.log(\"fetchInventoryItems\");\r\n\r\n    const inventoryItemsFromAPI = await API.get(apiName, apiDirectory + \"/id\");\r\n\r\n    setInventoryItems(\r\n      inventoryItemsFromAPI.filter(\r\n        (item) => item.name !== \"\" && item.description !== \"\"\r\n      )\r\n    );\r\n    console.log(\r\n      \"fetchInventoryItems> JSON.stringify( apiData ):  \" +\r\n        JSON.stringify(inventoryItemsFromAPI)\r\n    );\r\n  }\r\n\r\nasync function createInventoryItem() {\r\n    console.log(\r\n      \"createInventoryItem> name: \" +\r\n        inventoryItemFormData.name +\r\n        \", description: \" +\r\n        inventoryItemFormData.description\r\n    );\r\n\r\n    // Ignore request if the inventoryFormData tracking variables are empty.\r\n    if (!inventoryItemFormData.name || !inventoryItemFormData.description) {\r\n      console.log(\"createInventoryItem> Blank name or description\");\r\n      return;\r\n    }\r\n\r\n    const restData = {\r\n      id: uuidv4(),\r\n      name: inventoryItemFormData.name,\r\n      description: inventoryItemFormData.description,\r\n      quantity: inventoryItemFormData.quantity,\r\n      createdBy: user.getUsername(),\r\n      createdAt: new Date().toISOString(),\r\n    };\r\n\r\n    await API.post(apiName, apiDirectory, {\r\n      body: restData,\r\n    })\r\n      .then((result) => {\r\n        console.log(\"createInventoryItem> result: \" + JSON.stringify(result));\r\n      })\r\n      .catch((err) => {\r\n        console.log(\"createInventoryItem> error: \" + err);\r\n      });\r\n\r\n// Need help here\r\n async function deleteInventoryItem(inventoryItemToDelete) {\r\n    if (\r\n      !isAuthenticated() ||\r\n      user.getUsername() !== inventoryItemToDelete.createdBy\r\n    ) {\r\n      console.log(\r\n        \"deleteInventoryItem> User \" +\r\n          user.getUsername() +\r\n          \" attempted to delete inventory item it doesn't own: \" +\r\n          JSON.stringify(inventoryItemToDelete)\r\n      );\r\n      return;\r\n    }\r\n\r\n    const params = {\r\n      id: inventoryItemToDelete.id,\r\n    };\r\n\r\n    // Remove the inventory item from the database back\r\n    await API.post(\r\n      apiName,\r\n      apiDirectory, \r\n      { body: params }\r\n    )\r\n      .then((result) => {\r\n        // console.log(\"deleteInventoryItem> result: \" + JSON.stringify(result));\r\n      })\r\n      .catch((err) => {\r\n        //  console.log(\"deleteInventoryItem> error: \" + JSON.stringify(err));\r\n      });\r\n}\r\n```\r\n\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"tannerabread"},"body":"Have you tried using API.del instead of API.post?\n\nhttps://aws-amplify.github.io/amplify-js/api/classes/apiclass.html#del"}}]}}},{"node":{"id":"D_kwDOBkswNc4AQy_w","author":{"login":"funes79"},"title":"AWS Lambda end of support for Node.js 12","body":"AWS Amplify deployed Auth Lambda with Nodejs12, I ugpraded the amplify to version 10 but the Lambda is using still a deprecated runtime env. How should I proceeed to upgrade the Lambda runtime?\r\nThanks","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"abdallahshaban557"},"body":"Hi @funes79 - Here is a workaround for you until we can get this baked into our CLI https://github.com/aws-amplify/amplify-cli/issues/10894#issuecomment-1251564540"}}]}}},{"node":{"id":"D_kwDOBkswNc4AQvkC","author":{"login":"phstc"},"title":"Conditional withAuthenticator?","body":"Most of my pages require authentication, but one page can be accessed by authenticated and non-authenticated users.\r\n\r\nFor example, `/record/{id}`  for authenticated users, I would show the user logo at the top (from the shared layout) and an editing menu. For non-authenticated users, I would show the record as read-only.\r\n\r\nI want to use the same URL `/record/{id}` so users can simply copy and share. \r\n\r\nWhat would be the best step for implementing that? I'm currently using `withAuthenticator(App)`, and I couldn't find a way to make it customizable. \r\n\r\nI also considered creating a separated \"app\" and serve `/public/record/{id}` but that would introduce some complexity and potential duplication.\r\n\r\nI want to keep the Amplify experience where Amplify automatically shows the login modal for non-authenticated users for the pages requiring authentication.\r\n\r\nSummary of the wants (if possible): \r\n\r\n* Single page that can be accessed by authenticated and non-authenticated users\r\n* All other pages require authenticated users\r\n* Use Amplify goodness to handle showing a modal for sign-in and sign up\r\n* Base layout page expects logged-in users, so there will be a need for `if logged in user then show this top menu with the user photo otherwise show a sign in/up link`\r\n* Preferable to use the same URL for both experiences\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"funes79"},"body":"If you really want to have it public then I would suggest to remove the withAuthenticator and I think you should just test if the user is authenticated and if yes, show the edit button, if not show it disabled.\r\n```\r\n      const authUser = await Auth.currentAuthenticatedUser();\r\n      console.log('identityId', authUser);\r\n      if (authUser !== null && authUser !== undefined) {\r\n      }\r\n```\r\nThe access to the data is any way protected I assume by your GraphQL schema where you define if the rule that only authenticated users can create/update/read records.\r\n"}}]}}},{"node":{"id":"D_kwDOBkswNc4AQyU8","author":{"login":"funes79"},"title":"End of life Node12 AWS Lambda","body":"Amplify created an authTrigger Lambda function with NodeJs 12.x runtime, but AWS deprecated this:\r\n\r\nWe are ending support for Node.js 12 in AWS Lambda. This follows Node.js 12 End-Of-Life (EOL) reached on April 30, 2022 [1].\r\n\r\nI have upgraded amplify to version 10, and pushed the project, but the Lambda is still using the old runtime.\r\n\r\nHow to upgrade?","upvoteCount":4,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APSWX","author":{"login":"Joshig99"},"title":"How to bypass Cognito Hosted UI with OAuth consent screen social login In-App browser","body":"Hi,\r\nHow to take user to **OAuth consent screen** directly instead of **Cognito Hosted UI** when call the **Auth.federatedSignIn()**\r\n\r\nMy Code\r\n\r\n `\r\n                                                                                                                                                                                                                                 \r\n    async function urlOpener(url, redirectUrl) \r\n\r\n    {\r\n         await InAppBrowser.isAvailable();\r\n         await InAppBrowser.closeAuth();\r\n         const { type, url: newUrl } = await InAppBrowser.openAuth(url, redirectUrl, {\r\n         showTitle: false,\r\n         enableUrlBarHiding: true,\r\n         enableDefaultShare: false,\r\n         ephemeralWebSession: true,\r\n          });\r\n\r\n      if (type === 'success') {\r\n      Linking.openURL(newUrl);\r\n      }\r\n    }\r\n    Amplify.configure({\r\n      ...config,\r\n       oauth: {\r\n         ...config.oauth,\r\n         urlOpener\r\n     }\r\n    })\r\n`\r\n\r\n`\r\nconst onGoogleLogin = () => {\r\n    Auth.federatedSignIn();\r\n  };\r\n`\r\n\r\nWhen i call the **onGoogleLogin** function it taking user to Cognito Hosted UI but i have custom ui buttons for social login in my app, i want to take user to OAuth Consent Screen when user click on that button \r\n\r\n![Screen Shot 2022-04-13 at 7 15 28 PM](https://user-images.githubusercontent.com/46310246/163194502-01641fec-e4dc-490d-b2c0-3617fa73ec7a.png)\r\n\r\n![Screen Shot 2022-04-13 at 7 21 50 PM](https://user-images.githubusercontent.com/46310246/163195780-3242e3e2-58b5-48a5-b940-877544809d34.png)\r\n\r\n\r\nAfter clicking Continue with Google then it takes me to Oauth Consent screen\r\n\r\n![Screen Shot 2022-04-13 at 7 23 53 PM](https://user-images.githubusercontent.com/46310246/163196188-6bb0cbd7-97de-43ed-8a99-b828f3727e99.png)\r\n\r\n\r\nPlease help me on this\r\n","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"roryf"},"body":"I think you should pass options to the `federatedSignIn` call:\r\n```ts\r\nAuth.federatedSignIn({ provider: 'Google' })\r\n```\r\nTypeScript couldn't match the `Google` string for some reason in my editor, so I changed it to\r\n```ts\r\nimport { Auth, CognitoHostedUIIdentityProvider } from '@aws-amplify/auth'\r\n\r\nAuth.federatedSignIn({ provider: CognitoHostedUIIdentityProvider.Google })\r\n```"}},{"node":{"author":{"login":"dariodor"},"body":"As specified [here](https://docs.aws.amazon.com/cognito/latest/developerguide/authorization-endpoint.html#get-authorize-request-parameters) you can bypass Cognito Hosted UI for SAML 2.0 and OIDC providers by using the name that you assigned to the identity provider in your user pool.\r\n`Auth.federatedSignIn({ provider: 'MyIdentityProviderName' })`\r\n\r\n![Screenshot from 2022-09-16 16-57-53](https://user-images.githubusercontent.com/8624307/190669468-fa29aaa8-5cd3-4e96-ba68-197a01d0a0a0.png)\r\n"}}]}}},{"node":{"id":"D_kwDOBkswNc4AQwz3","author":{"login":"mahejbinm"},"title":"Angular routing issue","body":"I made angular application. all is happened good but if I try open new window at that time it is not displaying but I get \"404 not found\".\r\nhow to solve it","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNTM0Ng==","author":{"login":"anastasialanz"},"title":"How to Cypress test Amplify login that requires a TOTP code","body":"I've been working on a Cypress test to login to my app that requires a TOTP code. I have a test user and password in Cognito and I'm following similar steps to what is in this guide: [Running end-to-end Cypress tests for your fullstack CI/CD deployment with Amplify Console](https://aws.amazon.com/blogs/mobile/running-end-to-end-cypress-tests-for-your-fullstack-ci-cd-deployment-with-amplify-console/). This guide doesn't include a user that has Multi-Factor Authentication turned on. \r\n\r\nHas anyone had experience with creating a valid TOTP code in their end to end tests? I was hoping that I could make use of https://www.npmjs.com/package/totp-generator and `cy.wait` for the xhr response, but I'm not sure what part of the response is used to be able to generate the TOTP token.","upvoteCount":3,"comments":{"edges":[{"node":{"author":{"login":"jordanranz"},"body":"Hey @anastasialanz,\r\n\r\nI have a little bit of experience looking into testing this particular use case with Cypress. Could you explain specifically how you are using Amplify (Auth API or UI Component)? Also which response are you referring to:\r\n> I'm not sure what part of the response is used to be able to generate the TOTP token.\r\n\r\nI personally haven't tried this module but I am interested to check it out: https://www.npmjs.com/package/cypress-otp\r\n\r\nalso here is an interesting thread related to QR codes/TOTP: https://github.com/cypress-io/cypress/issues/4929"}},{"node":{"author":{"login":"pimmee"},"body":"I'm myself looking for a solid solution, but here's what I'm doing atm.\r\n\r\n1. I created an `e2e@mydomain.com` user and logged the TOTP secret so I could use it in tests.\r\n\r\n```ts\r\nAuth.setupTOTP(user).then(secret => {console.log(secret)})\r\n```\r\n\r\n2. Added the following cypress command with retry mechanism.  (offset is used to avoid \"already used\" cognito errors when running multiple tests):\r\n\r\n```ts\r\nimport { authenticator } from 'otplib';\r\nimport { Amplify, Auth } from 'aws-amplify';\r\n\r\nAmplify.configure(Cypress.env('amplifyConfig'));\r\n\r\nexport function generateOTP(secret: string, offset = 0) {\r\n  if (offset === 0) {\r\n    return authenticator.generate(secret);\r\n  }\r\n  const allOptions = authenticator.allOptions();\r\n  const delta = allOptions.step * 1000;\r\n  authenticator.options = { epoch: Date.now() + offset * delta };\r\n  const offsetToken = authenticator.generate(secret);\r\n  authenticator.resetOptions();\r\n  return offsetToken;\r\n}\r\n\r\nCypress.Commands.add('loginByCognitoApi', (email: string, password: string) => {\r\n  const log = Cypress.log({\r\n    displayName: 'COGNITO LOGIN',\r\n    message: [`🔐 Authenticating | ${email} `],\r\n    autoEnd: false,\r\n  });\r\n\r\n  log.snapshot('before');\r\n\r\n  const signIn = Auth.signIn({ username: email, password });\r\n\r\n  cy.wrap(signIn, { log: false } )\r\n    .then(async user => {\r\n      // This retry logic seems to be kind of flaky\r\n      let offset = 0;\r\n      while (offset < 10) {\r\n        try {\r\n          const challengeSecret = 'OKBS5BUYW2FD32JASDQWLIVC5TNW7V3UZQZTG5OFVSFALQMK4LA';\r\n          const code = generateOTP(challengeSecret, offset++);\r\n          const result = await Auth.confirmSignIn(user, code, 'SOFTWARE_TOKEN_MFA');\r\n          return result;\r\n        } catch {}\r\n      }\r\n    })\r\n    .then((cognitoResponse: any) => {\r\n      const prefix = `${cognitoResponse.keyPrefix}.${cognitoResponse.username}`;\r\n      const { idToken, accessToken, refreshToken, clockDrift } = cognitoResponse.signInUserSession;\r\n\r\n      localStorage.setItem(`${prefix}.idToken`, idToken.jwtToken);\r\n      localStorage.setItem(`${prefix}.accessToken`, accessToken.jwtToken);\r\n      localStorage.setItem(`${prefix}.refreshToken`, refreshToken.token);\r\n      localStorage.setItem(`${prefix}.clockDrift`, clockDrift);\r\n      localStorage.setItem(`${cognitoResponse.keyPrefix}.LastAuthUser`, cognitoResponse.username);\r\n      localStorage.setItem('amplify-signin-with-hostedUI', 'false');\r\n      log.snapshot('after');\r\n      log.end();\r\n    });\r\n});\r\n```\r\n\r\n3. You can then use it like so: \r\n\r\n```ts\r\n  before(() => {\r\n    cy.loginByCognitoApi(E2E_USER.email, E2E_USER.password);\r\n    cy.visit('/');\r\n  });\r\n```\r\n\r\nIf anyone has a less flaky solution for signing in with amplify using TOTP in Cypress I'd like to see it also.\r\n"}},{"node":{"author":{"login":"senkevich33n"},"body":"retry logic improvements\r\n```\r\n         .then(async (user) => {\r\n            let keepTrying = true;\r\n            let offset = 0;\r\n            while (offset < 10 && keepTrying) {\r\n                 try {\r\n                    keepTrying = false;\r\n                    return await Auth.confirmSignIn(user, generateOTP(secret, offset++), 'SOFTWARE_TOKEN_MFA');\r\n                } catch (error) {\r\n                    keepTrying = true;\r\n                }\r\n            }\r\n        })"}}]}}},{"node":{"id":"D_kwDOBkswNc4AQC-W","author":{"login":"nick-0101"},"title":"Pass custom attribute to Federated Signin","body":"I'm opening a disscusion as this issue as a continuation of issue #6913 that, like many other issues in this repo, were closed for no reason. There still doesn't seem to be a way to pass custom attributes to federated sign in.\r\n\r\nFor example, the current way to authenticate with google is: \r\n`Auth.federatedSignIn({ provider: \"Google\" })`\r\n\r\nHowever, what if I wanted to pass the users preferred locale: \r\n```\r\nAuth.federatedSignIn({\r\n  provider: \"Google\",\r\n  attributes: {\r\n    locale: currentLocale\r\n  }\r\n});\r\n```\r\n\r\nIs there a way to do this?","upvoteCount":7,"comments":{"edges":[{"node":{"author":{"login":"mikejackowski"},"body":"Would be great to get this"}}]}}},{"node":{"id":"D_kwDOBkswNc4AQuqC","author":{"login":"balramxyadav"},"title":"API working locally but nothing in server","body":"Hi, I am new amplify and i am sending a post request to the endpoint and it is giving a status of 200 but nothing happens. I have tried to run this locally ( by cd into src folder then running \"node app.js\" ) and it works and don't know why this isn't working in server  please help","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"abdallahshaban557"},"body":"Hi @balramxyadav - Can you please submit a Github issue using this [link](https://github.com/aws-amplify/amplify-js/issues/new?assignees=&labels=&template=1.bug_report.yaml). We need more information from you to be able to debug this. Another thing you can do is use our discord server to speak to see if someone from our community can help you out! https://discord.gg/5Uw8M9CW"}}]}}},{"node":{"id":"D_kwDOBkswNc4AOtfh","author":{"login":"giulioambrogi"},"title":"How to pre populate email field in Authenticator?","body":"# What\r\n\r\nI can't figure out how to pre populate the email field in Authenticator using the latest Amplify version, I could do that in older versions but I can't find this info in the docs.\r\nDocs: https://ui.docs.amplify.aws/components/authenticator?platform=react \r\n\r\n# Desired behaviour\r\n\r\nWhen the page loads I want to pre populate the Email field with a value I pass in. \r\n\r\n\r\n<img width=\"576\" alt=\"Screenshot 2022-02-05 at 08 52 50\" src=\"https://user-images.githubusercontent.com/11599158/152635203-d034c1b0-b265-46d6-925c-1b27a3c2689f.png\">\r\n\r\n# My code\r\n\r\n```\r\n<Authenticator\r\n        initialState={initialAuthState}\r\n        components={{\r\n          SignUp: {\r\n            FormFields() {\r\n              const { validationErrors } = useAuthenticator();\r\n  \r\n              return (\r\n                <>\r\n                <Authenticator.SignUp.FormFields />\r\n                </> \r\n              );\r\n            },\r\n          },\r\n        }}\r\n      />\r\n  ```\r\n\r\nMy amplify versions:\r\n```\r\n    \"@aws-amplify/api\": \"^4.0.32\",\r\n    \"@aws-amplify/auth\": \"^4.4.1\",\r\n    \"@aws-amplify/core\": \"^4.3.14\",\r\n    \"@aws-amplify/storage\": \"^4.4.15\",\r\n    \"@aws-amplify/ui-components\": \"^1.9.6\",\r\n    \"@aws-amplify/ui-react\": \"^2.2.2\",\r\n ```\r\n\r\nThanks in advance.","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"bryanmorganoverbey"},"body":"This worked for me:\r\nReact.useEffect(() => {\r\nsetTimeout(() => {\r\nconst input = document.querySelector('input[name=\"username\"]');\r\nif (input) {\r\ninput.setAttribute(\"value\", \"billybobthornton\");\r\n}\r\n});\r\n}, []);"}}]}}},{"node":{"id":"D_kwDOBkswNc4AQpj9","author":{"login":"calderwoodra"},"title":"Is auth 4.6.* fine to use with core 4.7.*?","body":"Since we started using amplify (9 months ago) auth and core have maintained the same semver versions, but a few weeks ago core 4.7.0 was released while auth is still on 4.6.5.\r\n\r\nIs it fine to upgrade to core 4.7.* or should I wait for auth 4.7 to be released as well? ","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"abdallahshaban557"},"body":"Hi @calderwoodra  - is there a reason you do not just use the @aws-amplify package rather than using core and Auth separately?"}}]}}},{"node":{"id":"D_kwDOBkswNc4AQrbv","author":{"login":"sdandois"},"title":"Singleton Collection","body":"I have a collection that must have at most only one element. \r\n\r\n* What's the best way to make sure that the element is unique when editing?\r\n* How do you query that element? \r\n* When creating the element, if there is one already presente I want to override it.\r\n\r\nCurrently I'm wiping out the collection with Predicates.ALL and then creating the element.\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AQqm4","author":{"login":"blairtaylor"},"title":"DataStore is not syncing with DynamoDB","body":"My DataStore is not syncing with DynamoDB for some reason.\r\n\r\nI've ready every issue on stackoverflow to see if I can find a resolution but no dice.\r\nThere are no errors.\r\nHub is showing the events firing.\r\n\r\nHere is an example of the issue:\r\n\r\n```\r\n  try {\r\n    const result = await DataStore.save(\r\n      new Employer({\r\n        name: 'Test Employer',\r\n        rate: 123.45,\r\n      }),\r\n    )\r\n\r\n    console.log('Employer saved successfully!')\r\n    console.log(result)\r\n\r\n    // const employer = await DataStore.query(Employer)\r\n    // console.log('EMPLOYER = ')\r\n    // console.log(employer)\r\n  } catch (err) {\r\n    console.log('ERROR: An error occurred during getEmployer')\r\n    console.log('Error message was ' + JSON.stringify(err))\r\n  }\r\n```\r\n\r\nDataStore nevers seems to sync with DynamoDB.\r\nOther than that everything is fine. No issues. DataStore contains the correct data.\r\n\r\nThe only difference between my project and the code examples is that I have used Amplify Studio to build the data model and performed Amplify pull to update the project.\r\n\r\nWhen I do an \"amplify status\" the API looks correct.\r\n\r\nThe aws-exports.js file seems to be correct.\r\nIt contains entries for Auth, API, Storage etc.\r\nAuth is working correctly.\r\n\r\nWhat am I missing? ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AQoiN","author":{"login":"raulgonzalezdev"},"title":"Transcribe audio to text always returns {\"err\": \"region not configured for transcription\"}","body":"Hello, Good Amplify community, it's a pleasure to be on this channel, I am new in the management of Amplify services I am testing the service with Predictions speechGenerator, but when I test the App generated in React-Native in the console I get an Error {\"err\": \"region not configured for transcription\"}, I have checked the microphone buffer and certainly generates data, I am testing only with the phrase \"Hello Word\", I have used the Basic configuration automatically generated by AWS Amplify. \r\n\r\nI will leave the fragments of my code, to see if it is a problem with the region where I created the Backend or something in my code that in theory is very simple.\r\n`/* eslint-disable */\r\n// WARNING: DO NOT EDIT. This file is automatically generated by AWS Amplify. It will be overwritten.\r\n\r\nconst awsmobile = {\r\n    \"aws_project_region\": \"us-east-1\",\r\n    \"aws_cognito_identity_pool_id\": \"us-east-1:75f67dbf-*********//kkk/************\",\r\n    \"aws_cognito_region\": \"us-east-1\",\r\n    \"aws_user_pools_id\": \"us-east-1_*****/jjj/*******\",\r\n    \"aws_user_pools_web_client_id\": \"*******/jjjjj**************\",\r\n    \"oauth\": {},\r\n    \"aws_cognito_username_attributes\": [],\r\n    \"aws_cognito_social_providers\": [],\r\n    \"aws_cognito_signup_attributes\": [\r\n        \"EMAIL\"\r\n    ],\r\n    \"aws_cognito_mfa_configuration\": \"OFF\",\r\n    \"aws_cognito_mfa_types\": [\r\n        \"SMS\"\r\n    ],\r\n    \"aws_cognito_password_protection_settings\": {\r\n        \"passwordPolicyMinLength\": 8,\r\n        \"passwordPolicyCharacters\": []\r\n    },\r\n    \"aws_cognito_verification_mechanisms\": [\r\n        \"EMAIL\"\r\n    ],\r\n    \"predictions\": {\r\n        \"convert\": {\r\n            \"speechGenerator\": {\r\n                \"region\": \"us-east-1\",\r\n                \"proxy\": false,\r\n                \"defaults\": {\r\n                    \"VoiceId\": \"Ricardo\",\r\n                    \"LanguageCode\": \"en-US\"\r\n                }\r\n            }\r\n        }\r\n    }\r\n};\r\n\r\n\r\nexport default awsmobile;`\r\n\r\n\r\nMy Code in React-Native\r\n\r\n\r\n`import React, {useState} from 'react';\r\nimport {\r\n  View,\r\n  Text,\r\n  StyleSheet,\r\n  TextInput,\r\n  TouchableOpacity,\r\n} from 'react-native';\r\nimport {Amplify} from 'aws-amplify';\r\nimport  {\r\n    Predictions,  AmazonAIPredictionsProvider,\r\n} from '@aws-amplify/predictions';\r\nimport awsconfig from '../../src/aws-exports';\r\n\r\nimport MicStream from 'react-native-microphone-stream';\r\n\r\n// from https://github.com/aws-samples/amazon-transcribe-websocket-static/tree/master/lib\r\n\r\n\r\nAmplify.configure(awsconfig);\r\nAmplify.addPluggable(new AmazonAIPredictionsProvider());\r\nconst initialState = {name: '', description: ''};\r\n\r\nglobal.Buffer = global.Buffer \r\n\r\nfunction VoiceCapture() {\r\n  const [text, setText] = useState('');\r\n\r\n  // from https://github.com/aws-samples/amazon-transcribe-websocket-static/tree/master/lib\r\n  function pcmEncode(input) {\r\n    let offset = 0;\r\n    const buffer = new ArrayBuffer(input.length * 2);\r\n    const view = new DataView(buffer);\r\n    for (let i = 0; i < input.length; i++, offset += 2) {\r\n      const s = Math.max(-1, Math.min(1, input[i]));\r\n      view.setInt16(offset, s < 0 ? s * 0x8000 : s * 0x7fff, true);\r\n    }\r\n    return buffer;\r\n  }\r\n\r\n  async function transcribe(bytes) {\r\n    await Predictions.convert({\r\n      transcription: {\r\n        source: {\r\n          bytes,\r\n        },\r\n        language: 'en-US',\r\n      },\r\n    })\r\n      .then(({transcription: {fullText}}) => console.log({fullText}))\r\n      .catch((err) => console.log({err}));\r\n  }\r\n\r\n  const listener = MicStream.addListener((data) => {\r\n     console.log('Data:',data);\r\n\r\n    // encode the mic input\r\n    const pcmEncodedBuffer = pcmEncode(data);\r\n\r\n    // // add the right JSON headers and structure to the message\r\n    // let audioEventMessage = getAudioEventMessage(\r\n    //   global.Buffer.from(pcmEncodedBuffer),\r\n    // );\r\n\r\n    // //convert the JSON object + headers into a binary event stream message\r\n    // let binary = eventStreamMarshaller.marshall(audioEventMessage);\r\n\r\n    // the docs say this takes a PCM Audio byte buffer, so i assume the wrappers above aren't necessary. Tried them anyways with no luck.\r\n    // (https://docs.amplify.aws/lib/predictions/transcribe/q/platform/js#set-up-the-backend)\r\n    transcribe(pcmEncodedBuffer);\r\n  });\r\n\r\n  function startTranscribing() {\r\n    MicStream.init({\r\n      bufferSize: 4096 * 32, // tried multiplying this buffer size to send longer  - still no luck\r\n      // sampleRate: 44100,\r\n      sampleRate: 16000,\r\n      bitsPerChannel: 16,\r\n      channelsPerFrame: 1,\r\n    });\r\n\r\n    MicStream.start();\r\n    console.log('Started mic stream');\r\n  }\r\n\r\n  function stopTranscribing() {\r\n    console.log('Stopped mic stream');\r\n    MicStream.stop();\r\n    listener.remove();\r\n  }\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      <View style={styles.horizontalView}>\r\n        <TouchableOpacity\r\n          style={styles.mediumButton}\r\n          onPress={() => {\r\n           // Voice.start('en_US');\r\n            // transcribeAudio();\r\n            startTranscribing();\r\n          }}>\r\n          <Text style={styles.mediumButtonText}>START</Text>\r\n        </TouchableOpacity>\r\n\r\n        <TouchableOpacity\r\n          style={styles.mediumButton}\r\n          onPress={() => {\r\n            stopTranscribing();\r\n          }}>\r\n          <Text style={styles.mediumButtonText}>STOP</Text>\r\n        </TouchableOpacity>\r\n      </View>\r\n      <TextInput\r\n        style={styles.editableText}  multiline\r\n        onChangeText={(editedText) => setText(editedText)}>\r\n        {text}\r\n      </TextInput>\r\n    </View>\r\n  );\r\n}\r\n\r\nconst NewVoice = () => {\r\n  return (\r\n    <View style={styles.container}>\r\n      <VoiceCapture />\r\n    </View>\r\n  );\r\n};\r\n\r\nexport const colors = {\r\n  primary: '#0049bd',\r\n  white: '#ffffff',\r\n};\r\n\r\nexport const padding = {\r\n  sm: 8,\r\n  md: 16,\r\n  lg: 24,\r\n  xl: 32,\r\n};\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: 'white',\r\n    padding: padding.lg,\r\n  },\r\n  bodyText: {\r\n    fontSize: 16,\r\n    height: 20,\r\n    fontWeight: 'normal',\r\n    fontStyle: 'normal',\r\n  },\r\n  mediumButtonText: {\r\n    fontSize: 16,\r\n    height: 20,\r\n    fontWeight: 'normal',\r\n    fontStyle: 'normal',\r\n    color: colors.white,\r\n  },\r\n  smallBodyText: {\r\n    fontSize: 14,\r\n    height: 18,\r\n    fontWeight: 'normal',\r\n    fontStyle: 'normal',\r\n  },\r\n  mediumButton: {\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    width: 132,\r\n    height: 48,\r\n    padding: padding.md,\r\n    margin: 14,\r\n    backgroundColor: colors.primary,\r\n    fontSize: 20,\r\n    fontStyle: 'normal',\r\n    elevation: 1,\r\n    shadowOffset: {width: 1, height: 1},\r\n    shadowOpacity: 0.2,\r\n    shadowRadius: 2,\r\n    borderRadius: 2,\r\n  },\r\n  editableText: {\r\n    textAlign: 'left',\r\n    textAlignVertical: 'top',\r\n    borderColor: 'black',\r\n    borderWidth: 2,\r\n    padding: padding.md,\r\n    margin: 14,\r\n    flex: 5,\r\n    fontSize: 16,\r\n    height: 20,\r\n  },\r\n  horizontalView: {\r\n    flex: 1,\r\n    flexDirection: 'row',\r\n    alignItems: 'stretch',\r\n    justifyContent: 'center',\r\n  },\r\n});\r\n\r\nexport default NewVoice;\r\n\r\n`","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AQkmF","author":{"login":"jeffinhk"},"title":"Push Notification using AWS Lambda + SNS + Firebase FCM","body":"I am currently building an Instagram-like mobile app, where users upload a feed, press likes, comment, and reply. I am facing such questions regarding Push Notification:\r\n\r\nWhen a user logs into my app, how will their device token be registered into AWS SNS endpoint through AWS LAMBDA? (I have succesfully manually updated to Dynamo DB, but I want them to automatically be updated to endpoint when notification authorization is granted).\r\n\r\nWhen my Feed/Post receives 'likes' or 'comments', how should that be notified to the original poster (OP) ?\r\n\r\nNo need to answer both questions, and any opinions are highly appreciated in advance.\r\n\r\nP.S. I'm using React Native and AWS Amplify, in fucntional component","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"abdallahshaban557"},"body":"Hi @jeffinhk - I am curious to hear why you are using SNS rather than using the push notifications category with AWS Amplify? We have support for it with React Native. https://docs.amplify.aws/lib/push-notifications/overview/q/platform/js/"}}]}}},{"node":{"id":"D_kwDOBkswNc4AQmuV","author":{"login":"aliraza944"},"title":"How to stop user from redirecting to callback URLs while login in with Facebook  in AWS Cognito","body":"I am using AWS Cognito to log in with Facebook in react. The problem is that after successful login my web app redirects to the callback URL defined in the ***App Client Setting***.  <br/>\r\nFor example, if I am at the `http://localhost:3000/tools/` and the redirect callback URL is `http://localhost:3000/` the user will be redirected to the callback URL. I want the user to stay at my `https://localhost:3000/tools/` page.<br/>\r\nI have a login modal that can be accessed from any page so after login the user should stay on the same page. ","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AQhLK","author":{"login":"petar-prog91"},"title":"amplify import auth - Cognito user pool - aws-exports.js missing values?","body":"Hi everyone, \r\n\r\nI hope that you'll be able to help me out with this one as I'm banging my head whole day about this and no luck ... I've gone through so many docs and API pages and can't figure it out. Anyway here it goes:\r\n\r\nWe have an Amplify project that we started, all goes rather well, and we have to integrate federated auth with existing Cognito pool. Logically, we connected the Cognito pool to our Amplify app, and did `amplify import auth` and that part went okay, we see that Cognito pool is connected etc. Now here's the thing that's not really going well, and I can't figure out how to do it:\r\n\r\n- In our Cognito pool we have App Client for which we want to use the Hosted UI for logging in (as Cognito is Auth with custom provider). Here's the screenshot (some values random) of Cognito App Client Hosted UI:\r\n<img width=\"1354\" alt=\"image\" src=\"https://user-images.githubusercontent.com/4411896/186426100-eb97226d-c403-4e91-a6b1-c4f614138c34.png\">\r\n\r\nAnd here is the aws-exports.js file (again redacted, but some stuff left for reference):\r\n<img width=\"1028\" alt=\"image\" src=\"https://user-images.githubusercontent.com/4411896/186426575-47188d3a-715a-40d7-91f4-f5201eaf48b4.png\">\r\n\r\nAs you can see where I highlighted with arrow, oauth properties are missing completely, all of them except the domain ... If I add them manually like this, then FederatedSignIn works no problem:\r\n<img width=\"723\" alt=\"image\" src=\"https://user-images.githubusercontent.com/4411896/186426906-b6467453-4422-49a5-910b-3a2543b2512b.png\">\r\n\r\nAs this matches exactly the values from Cognito App Hosted UI properties, FederatedSignIn works ... \r\n\r\nNow here's the thing, what I've did is hardcoding / changing values into file that is not supposed to be manually changed. I'm wondering, what can be done to get these values properly populated based on the values that are in Cognito App Hosted UI, basically that I get in aws-exports.js exactly what I manually added, but being generated by Amplify CLI itself. \r\n\r\nAny ideas?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"abdallahshaban557"},"body":"Hi @petar-prog91 - this appears to be an issue. Can you please submit an issue using this [link](https://github.com/aws-amplify/amplify-cli/issues/new?assignees=&labels=&template=1.bug_report.yaml) to the Amplify CLI repo?"}}]}}},{"node":{"id":"D_kwDOBkswNc4AQg_p","author":{"login":"pcanas"},"title":"Is the Amplify React tutorial up-to-date?","body":"I have followed the [Connect API and database to the app](https://docs.amplify.aws/start/getting-started/data-model/q/integration/react/) section.\r\nWhile the autogenerated files that appear in the tutorial are `graphql/queries` and `graphql/mutations` I have others (the ones appearing in the [Datastore JS page](https://docs.amplify.aws/lib/datastore/getting-started/q/platform/js/):\r\n```\r\n|_ models/\r\n   |_ index.d.ts\r\n   |_ index.js\r\n   |_ schema.d.ts\r\n   |_ schema.js\r\n```\r\nI was wondering if I am doing anything wrong or if this page is not up-to-date.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AQg6i","author":{"login":"jay3dec"},"title":"How to pass clientMetaData to Lambda trigger when using federatedSignIn","body":"I have a use case during Google Sign. I want to check if the user is signing from same ip address, hence during `federatedSignIn` I need to pass ip address as `clientMetaData`. Is it possible ?\r\n\r\n`Auth.federatedSignIn({provider: CognitoHostedUIIdentityProvider.Google })`\r\n\r\nI found a similar question [here](https://github.com/aws-amplify/amplify-js/issues/4662) but no solution has been concluded and the workaround doesn't apply to my case. ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AQfvu","author":{"login":"AbdulmueezEmiola"},"title":"Checksums","body":"In the AWS S3 documentation, It says It's possible to compute and store the checksum using `'x-amz-sdk-checksum-algorithm': 'SHA-256' ` . I have searched the amplify documentation on how this can be implemented, but I couldn't figure this out. Can someone point me in the right direction?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AQcvT","author":{"login":"thiagonsiq"},"title":"Amplify forgot password API not flexible/bad user experience","body":"Hi, \r\n\r\nWe're using Cognito for the user pool used in our react native mobile application, along with the Amplify SDK for interaction with cognito. \r\n\r\nImplementing the Forgot Password workflow, we noticed that the Auth.forgotPasswordSubmit(username, code, new_password) forces customers to collect the verification code AND the new password in one step, and they must be submitted together.\r\n\r\nThis prevents the app designers from separating the verification of the code and the new password collection screens/actions. We cannot do this for instance:\r\n\r\n- Send verification code to user's email\r\n- Provide screen for user to input verification code\r\n- Application makes call to a cognito \"verifyCode\" endpoint, which checks the code and returns true/false or whatever\r\n- Then application can provide users with an input to provide new password\r\n- Application submits new password to cognito\r\n\r\nThe way the API is written now, if the code ends up being incorrect, the user will need to type in a new code AND the password over again. Just a clunky user experience.\r\n\r\nIs there a workaround to validate the code separately from saving the new password?\r\n\r\nThanks,\r\nThiago S.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"proevilz"},"body":"You could just store the password they entered if the code came back as incorrect, and just autofill the password field. That way, the only job required of the user is to fill in the new code?"}}]}}},{"node":{"id":"D_kwDOBkswNc4AQe-d","author":{"login":"cbirkenstock"},"title":"Datastore functioning with a suspended app","body":"I couldn't find a clear answer to this in the documentation, but I don't understand the exact way that AWS's datastore.query and real-time subscription service work in terms of a suspended app. Specifically, how do I trigger datastore to update the content when opening a suspended app (one that wasn't killed)?\r\n\r\nI assume that if I open the app and it download three objects, and then kill it. If two more objects are added in the meantime and I open it up freshly again then it will do a delta query of the two new objects and add them right? But what happens if I close an app, but do not kill it, and then open it up again. How do I see those two new items that are added in the downtime? Do I have to depend on a subscription for this? Would that subscription not be killed when the app is suspended? Should I just call a Datastore.query every time the app is opened?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AQcdN","author":{"login":"proevilz"},"title":"How can I handle errors?","body":"If you consider the following code\r\n\r\n```typescript \r\n  React.useEffect(() => {\r\n    Auth.currentUserInfo()\r\n      .then((data) => {\r\n        if (data.username) {\r\n          //do something with data\r\n        }\r\n      })\r\n      .catch((error) => console.log('No logged in user'))\r\n  }, [])\r\n```\r\n\r\nWhen I look in my console, I see all this with my console log mixed in.  \r\n```\r\n[ERROR] 14:14.682 AuthClass - No current user\r\nat node_modules/@aws-amplify/core/lib-esm/Logger/ConsoleLogger.js:115:9 in prototype._log\r\nat node_modules/@aws-amplify/core/lib-esm/Logger/ConsoleLogger.js:192:18 in <anonymous>\r\nat node_modules/@aws-amplify/auth/lib-esm/Auth.js:2097:38 in user.confirmPassword$argument_2.onFailure\r\n\r\nNo logged in user\r\nError: ENOENT: no such file or directory, open '/Users/XXXXX/react-native-discord/http:/192.168.50.85:19000/node_modules/expo/AppEntry.bundle?platform=ios&dev=true&hot=false&strict=false&minify=false'\r\n    at Object.openSync (node:fs:585:3)\r\n    at Object.readFileSync (node:fs:453:35)\r\n    at getCodeFrame (/Users/XXXXX/react-native-discord/node_modules/metro/src/Server.js:949:18)\r\n    at Server._symbolicate (/Users/XXXXX/react-native-discord/node_modules/metro/src/Server.js:1022:22)\r\n    at processTicksAndRejections (node:internal/process/task_queues:96:5)\r\n    at Server._processRequest (/Users/XXXXX/react-native-discord/node_modules/metro/src/Server.js:429:7) {\r\n  errno: -2,\r\n  syscall: 'open',\r\n  code: 'ENOENT',\r\n  path: '/Users/XXXXX/react-native-discord/http:/192.168.50.85:19000/node_modules/expo/AppEntry.bundle?platform=ios&dev=true&hot=false&strict=false&minify=false'\r\n}\r\nError: ENOENT: no such file or directory, open '/Users/XXXXX/react-native-discord/http:/192.168.50.85:19000/node_modules/expo/AppEntry.bundle?platform=ios&dev=true&hot=false&strict=false&minify=false'\r\n    at Object.openSync (node:fs:585:3)\r\n    at Object.readFileSync (node:fs:453:35)\r\n    at getCodeFrame (/Users/XXXXX/react-native-discord/node_modules/metro/src/Server.js:949:18)\r\n    at Server._symbolicate (/Users/XXXXX/react-native-discord/node_modules/metro/src/Server.js:1022:22)\r\n    at processTicksAndRejections (node:internal/process/task_queues:96:5)\r\n    at Server._processRequest (/Users/XXXXX/react-native-discord/node_modules/metro/src/Server.js:429:7) {\r\n  errno: -2,\r\n  syscall: 'open',\r\n  code: 'ENOENT',\r\n  path: '/Users/XXXXX/react-native-discord/http:/192.168.50.85:19000/node_modules/expo/AppEntry.bundle?platform=ios&dev=true&hot=false&strict=false&minify=false'\r\n}\r\n```\r\n\r\nHow do I catch the error properly without this huge stack trace being included? I tried a `try/catch` instead of `catch()` but that yielded the same result. \r\n\r\n<img width=\"583\" alt=\"image\" src=\"https://user-images.githubusercontent.com/16267903/185059684-adb07140-b781-4c1a-924e-f53f1e74b441.png\">\r\n\r\nAdded the question here too... https://stackoverflow.com/questions/73409446/how-do-i-catch-aws-amplify-errors","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AQevy","author":{"login":"AlexChaseJones"},"title":"When following the docs for enabling sorting on a graphQL model, what is the point of the `type` field?","body":"I'm looking at this guide: https://docs.amplify.aws/guides/api-graphql/query-with-sorting/q/platform/js/#implementation. it's pretty straight forward, but I don't follow understand the implementation. Here's a snippet of the example:\r\n```js\r\ntype Todo @model {\r\n  id: ID!\r\n  title: String!\r\n  type: String! @index(name: \"todosByDate\", queryField: \"todosByDate\", sortKeyFields: [\"createdAt\"])\r\n  createdAt: String!\r\n}\r\n```\r\n\r\nThe `type` field and index settings enable you to do\r\n```js\r\nquery todosByDate {\r\n  todosByDate(\r\n    type: \"Todo\"\r\n    sortDirection: ASC\r\n  ) {\r\n    items {\r\n      id\r\n      title\r\n      createdAt\r\n    }\r\n  }\r\n}\r\n```\r\nwhich would sort the items by createdAt, ASC. Which is really cool. But the extra required field is just a little odd. I'm assuming the name of the field isn't important, and its more about having an index and setting the params in it. but the `type` field just feels redundant, especially since it will for the most part always have the same value (\"todo\" in the example).\r\nIt just seems like you'd be able to define the sort fields as part of the model without having to create a new field. Is this is side effect of dynamoDB, or is this just a quirk of graphQL?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"AlexChaseJones"},"body":"When i added the new index to the model, it created a new global secondary with the partition key set to `type` and the sort_key set to `createdAt`. So I guess it makes sense why it needs the new `type` field. still a little weird"}}]}}},{"node":{"id":"D_kwDOBkswNc4AQecm","author":{"login":"sefatanam"},"title":"Error : import .graphql file in angular showing module not found","body":"Actually I don't want to use any library like apollo-client or apollo-angular. So I generated a angular project with aws amplify. Then I got 3 files under src/graphql file those are mutations.graphql, queries.graphql & subscriptions.graphql. When I want to use those graphql file in my components it showing me this error constantly,\r\n\r\nI tried to import like this,\r\n\r\n \r\n\r\n    import { GetProduct } from '../../graphql/queries.graphql';\r\n\r\n    Cannot find module '../../graphql/queries.graphql' or its corresponding type declarations.ts(2307)\r\n\r\n\r\nI saw several solutions but nothing is workout,\r\n\r\nhere is my tsconfig.ts file:\r\n\r\n    {\r\n      \"compileOnSave\": false,\r\n      \"compilerOptions\": {\r\n        \"baseUrl\": \"./\",\r\n        \"outDir\": \"./dist/out-tsc\",\r\n        \"forceConsistentCasingInFileNames\": true,\r\n        \"strict\": true,\r\n        \"noImplicitOverride\": true,\r\n        \"noPropertyAccessFromIndexSignature\": true,\r\n        \"noImplicitReturns\": true,\r\n        \"noFallthroughCasesInSwitch\": true,\r\n        \"sourceMap\": true,\r\n        \"declaration\": false,\r\n        \"downlevelIteration\": true,\r\n        \"experimentalDecorators\": true,\r\n        \"moduleResolution\": \"node\",\r\n        \"importHelpers\": true,\r\n        \"target\": \"es2017\",\r\n        \"module\": \"es2020\",\r\n        \"allowSyntheticDefaultImports\": true,\r\n        \"typeRoots\": [\r\n          \"node_modules/@types\",\r\n          \"src/graphql\"\r\n        ],\r\n        \"lib\": [\r\n          \"es2020\",\r\n          \"dom\",\r\n          \"esnext.asynciterable\"\r\n        ]\r\n      },\r\n      \"angularCompilerOptions\": {\r\n        \"enableI18nLegacyMessageIdFormat\": false,\r\n        \"strictInjectionParameters\": true,\r\n        \"strictInputAccessModifiers\": true,\r\n        \"strictTemplates\": true\r\n      }\r\n    }\r\n\r\n\r\nI also tried with `skipLibCheck` but still now not working.\r\n\r\n\r\nI want to achieve this [Check at AMPLIFY Documentation][1],\r\n\r\n\r\n    import { Storage, API } from 'aws-amplify';\r\n    import { getProduct } from './graphql/mutations';\r\n    \r\n    async function getProductById () {\r\n      const product = await API.graphql({ query: getProduct, variables: { id: \"12345\" }});\r\n      const s3Image = await Storage.get(product.data.getProduct.image);\r\n      product.data.getProduct.s3Image = s3Image;\r\n      console.log('product:', product);\r\n    }\r\n\r\n\r\n  [1]: https://docs.amplify.aws/guides/api-graphql/image-and-file-uploads/q/platform/js/#interacting-with-the-api-from-a-client-application\r\n\r\nMy only problem is I can't import `graphql` files , is there any thing that I missed to configure ? - TIA","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"AlexChaseJones"},"body":"in the documentation their mutation/query/subscript `./graphql/` files are most likely `.js` files and not `.graphql` files. When i generated my amplify project (i used the react native setup), it also created 3 files under src/graphql, but they were js files. I wonder if when you set up amplify in the project there was some setting you had to set.."}}]}}},{"node":{"id":"D_kwDOBkswNc4AQeot","author":{"login":"wrsulliv"},"title":"Sign in with Apple Error -  \"Error handling auth response - invalid_grant\"","body":"Hi all, when I use \"Sign in with Apple\" it works about 10% of the time, and the other times I get:\r\n\r\n`Error handling auth response - invalid_grant`\r\n\r\nI've found some other users online with the same problem, but the tickets were closed with no solution.\r\n\r\nAny help is much appreciated.  Thank you!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AQdud","author":{"login":"lucassilvagc"},"title":"[amazon-cognito-identity-js] Appropriate usage of associateSoftwareToken","body":"I'm trying to setup TOTP on my Angular application. I do have authentication and password reset flows working. My user pool has mandatory TOTP.\r\n\r\nUse case 28 depicts the following code [resumed to what's interesting]:\r\n\r\n```\r\ncognitoUser.authenticateUser(authenticationDetails, {\r\n     mfaSetup: function(challengeName, challengeParameters) {\r\n          cognitoUser.associateSoftwareToken(this);\r\n     },\r\n}\r\n```\r\n\r\nReproducing the code above (although in a similar way) on my code doesn't allow me to call the associateSoftwareToken function in any way. It returns the following:\r\n\r\n`Argument of type 'IAuthenticationCallback' is not assignable to parameter of type '{ associateSecretCode: (secretCode: string) => void; onFailure: (err: any) => void; }'.`\r\n\r\nMy code:\r\n\r\n\r\n```\r\nuser.authenticateUser(authDetails, {\r\n     onSuccess: success => {\r\n          s.next(success);\r\n          s.complete();\r\n     },\r\n     mfaSetup: function(_challengeName, challengeParameters) {\r\n          user.associateSoftwareToken(this);\r\n     },\r\n}\r\n```\r\n\r\nAny ideas how to make this work?\r\n\r\nThanks.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AQclR","author":{"login":"exbracer"},"title":"Auth.updateUserAttributes() clear localStorage / sessionStorage","body":"I am writing a web-based app that uses AWS Cognito as the authentication service. I use 'aws-amplify' to implement the client-app.\r\n\r\nI am using Auth.updateUserAttributes() to update a custom attribute of users on Cognito. However, I found that the call of this function would clear all the Cognito-related items, including idToken, refreshToken, and accessToken stored in localStorage. As a result, the web app behaves like sign-out.\r\n\r\n\r\n\r\nHere is the code about Auth's configuration\r\n```\r\nAmplify.configure({\r\n  Auth: {\r\n    userPoolId: process.env.REACT_APP_AWS_COGNITO_USER_POOL_ID, \r\n    region: process.env.REACT_APP_AWS_COGNITO_REGION,\r\n    userPoolWebClientId: process.env.REACT_APP_AWS_COGNITO_APP_CLIENT_ID,\r\n    storage: window.localStorage, \r\n    authenticationFlowType: 'CUSTOM_AUTH', \r\n  },\r\n});\r\n```\r\nand the code I wrote to update the user's attribute. (I followed the example code from the amplify docs https://docs.amplify.aws/lib/auth/manageusers/q/platform/js/#managing-user-attributes)\r\n```\r\nlet user = await Auth.currentAuthenticatedUser(); \r\nconsole.log(JSON.stringify(localStorage)); // it outputs the localstorage with \r\n                                       // idToken, refreshToken, accessToken \r\n                                       // and other items start with \r\n                                       // 'CognitoIdentityServiceProvider'\r\nconst result = await Auth.updateUserAttributes(user, {\r\n    'custom:attributes_1': '123456789',\r\n}); \r\nconsole.log(result); // OUTPUT: SUCCESS\r\nconsole.log(JSON.stringify(localStorage)); // Only 'amplify-signin-with-hostedUI'. \r\n                                           // idToken, refreshToken, accessToken \r\n                                       // and other items were gone. No key, \r\n                                       // no value.\r\n```\r\nAfter the last line, I could not interact with the web page anymore. If I refreshed the web page, I found I had signed out and had to sign in again.\r\n\r\nIt was still the same if I changed the storage for Auth from localStorage to sessionStorage.\r\n\r\nHere are my questions:\r\n\r\n1. Is this kind of behavior normal? Does Auth.updateUserAttributes() leads to a force sign-out?\r\n2. If it's true, is there any way to avoid a mandatory sign-out?\r\n3. If it's not, what's wrong with my code or configuration? Or should I do some specific configuration for the Cognito service?\r\n\r\nThanks a lot!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb242NDI2","author":{"login":"hirasaki1985"},"title":"I can't update password with aws-amplify/auth and Auth.changePassword()","body":"I tried to update user password with Auth.changePassword() method.\r\nbut I had catch error.\r\nHow can I solve it?\r\n\r\n## error info\r\n```\r\ncode: \"InvalidParameterException\"\r\nmessage: \"2 validation errors detected: Value at 'previousPassword' failed to satisfy constraint: Member must not be null; Value at 'proposedPassword' failed to satisfy constraint: Member must not be null\"\r\nname: \"InvalidParameterException\"\r\n```\r\n\r\n## package.json \r\n```\r\n \"@aws-amplify/auth\": \"^3.2.13\",\r\n```\r\n\r\n## source code\r\n\r\n```\r\n/**\r\n * config\r\n */\r\nAuth.configure({\r\n  region: AppEnv.Auth.Cognito.Region,\r\n  userPoolId: AppEnv.Auth.Cognito.UserPoolId,\r\n  userPoolWebClientId: AppEnv.Auth.Cognito.ClientId\r\n})\r\n\r\nstatic async changePassword (nowPassword, newPassword) {\r\n    try {\r\n      const user = await Auth.currentAuthenticatedUser()\r\n      return await Auth.changePassword(user, nowPassword, newPassword)\r\n    } catch (e) {\r\n      console.log(e)\r\n      return false\r\n    }\r\n  }\r\n```\r\n\r\nplease check it.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"hirasaki1985"},"body":"I'm very sorry.\r\nIt was a mistake.\r\nI was able to solve it."}},{"node":{"author":{"login":"zanio"},"body":"> ## source code\r\n> ```\r\n> /**\r\n>  * config\r\n>  */\r\n> Auth.configure({\r\n>   region: AppEnv.Auth.Cognito.Region,\r\n>   userPoolId: AppEnv.Auth.Cognito.UserPoolId,\r\n>   userPoolWebClientId: AppEnv.Auth.Cognito.ClientId\r\n> })\r\n> \r\n> static async changePassword (nowPassword, newPassword) {\r\n>     try {\r\n>       const user = await Auth.currentAuthenticatedUser()\r\n>       return await Auth.changePassword(user, nowPassword, newPassword)\r\n>     } catch (e) {\r\n>       console.log(e)\r\n>       return false\r\n>     }\r\n>   }\r\n> ```\r\n> \r\n> please check it.\r\n\r\nThe above code should work. For future readers, if you try to change the password and you follow the above code and it doesn't work then make sure your `nowPasword` and `newPassword` are correct. If the authenticate cognito user exist then the change password operation should be successful \r\n\r\n"}}]}}},{"node":{"id":"D_kwDOBkswNc4AQcZV","author":{"login":"kimfucious"},"title":"Dependencies not found when deploying a Next.js app with Amplify","body":"Hi there,\r\n\r\nFollowing these docs [here](https://docs.amplify.aws/start/getting-started/hosting/q/integration/next/), I was battling to get my app deployed via Amplify.\r\n\r\nThe app deploys just fine on Netlify and Vercel, so I'm a bit confused.\r\n\r\nIn the build log, it looks like dependencies are not being found, specifically dependencies of top-level dependencies, for example:\r\n\r\n```console\r\n...\r\n2022-08-17T00:41:57.963Z [INFO]: info  - Compiled successfully\r\n2022-08-17T00:41:57.964Z [INFO]: info  - Collecting page data...\r\n2022-08-17T00:41:59.315Z [WARNING]: > Build error occurred\r\n2022-08-17T00:41:59.321Z [WARNING]: Error: Cannot find module 'sharp'\r\n...\r\n```\r\nWhere sharp is a dependency of plaiceholer.\r\n\r\nAfter manually adding these \"not found\" dependencies, things work, but that doesn't quite seem right.  And I have an inkling that I'm missing a step or a configuration somewhere.\r\n\r\nI've read about Output File Tracing, [here](https://nextjs.org/docs/advanced-features/output-file-tracing), but I'm not sure if this is the right thing to pursue.\r\n\r\nAny helpful advice toward understanding the best way to handle this would be most appreciated.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AQbRg","author":{"login":"wrsulliv"},"title":"How can I add a custom authorization provider?","body":"I need to support Oauth with Reddit, but that doesn't appear to be provided by Amplify / Cognito.  \r\n\r\nIs there a framework / API documented for extending the Authentication code?  \r\n\r\nThank you!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AQa6n","author":{"login":"rafaelfaria"},"title":"Getting \"Unauthorised\" where It was suppose to be working","body":"I have 2 models for saving data, one linkined to the other one through indexes.\r\n\r\nI use Cognito, so I rely on the \"owner\" default field to make sure it does all the operation with just the data of each owner.\r\n\r\nI have the following schema:\r\n\r\n\r\n```\r\ntype PersonalGoal @model\r\n  @auth(\r\n    rules: [\r\n      { allow: owner }\r\n    ]\r\n  )\r\n{\r\n  monthYear: String! @primaryKey #this will be a combination of [month][year]\r\n  month: Int\r\n  year: Int\r\n  monthlyTarget: Float\r\n  totalToTrade: Float\r\n  amountPerDay: Float\r\n  lossPerDay: Float\r\n  daysToTrade: [Int]\r\n  entries: [PersonalGoalEntry] @hasMany(indexName: \"byPersonalGoal\", fields: [\"monthYear\"])\r\n}\r\n\r\ntype PersonalGoalEntry @model\r\n  @auth(\r\n    rules: [\r\n      { allow: owner }\r\n    ]\r\n  )\r\n{\r\n  id: ID!\r\n  monthYear: String @index(name: \"byPersonalGoal\", queryField: \"listPersonalGoalEntriesByMonthYear\")\r\n  date: String\r\n  month: Int\r\n  year: Int\r\n  tokenName: String\r\n  totalGain: Float\r\n}\r\n\r\n```\r\n\r\n\r\nHowever, when I perform a simple operation as below\r\n\r\n```\r\nconst { data } = await API.graphql(\r\n      graphqlOperation(getPersonalGoal, { monthYear })\r\n    )\r\n```\r\n\r\nI then get the following error\r\n\r\n```\r\ndata: null\r\nerrorInfo: null\r\nerrorType: \"Unauthorized\"\r\nlocations: [{…}]\r\nmessage: \"Not Authorized to access getPersonalGoal on type Query\"\r\npath: ['getPersonalGoal']\r\n```\r\n\r\nEVERYTHING else in my app works, so I am wondering why this is not working.\r\nAny ideas are welcome.\r\n\r\nThank you.\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"rafaelfaria"},"body":"Ok. I think i just figure it out. I am using the primaryKey as monthYear and the id needs to be unique for ALL users, not just for themselves. So I need to use a combination of a id: ID! and using monthYear as a sort key."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzczMzY2","author":{"login":"wordisthebird"},"title":"AWS Cognito user able to sign in, but API “Does not exist” when using I can access using access token on console?","body":"Hey guys,\r\n\r\nIm a bit lost here and would love some help. I am trying to connect my React Native app to a basic Lambda function.\r\n\r\nI have no bother Registering a user, Confirming a user or Signing in. I can see all of these things in the Cognito Console.\r\n\r\nI also am able to test the access to the API with the Authorizers part of the API Gateway and get a Response Code: 200 with the correct email and other details from cognito.\r\n\r\n**Expected behavior**\r\nI want to get a response from the API but instead I get ' API_NAME does not exist'\r\n\r\n**Code Snippet**\r\n\r\nImports:\r\n\r\n`import { API, Auth } from 'aws-amplify';`\r\n ```\r\nasync signIn(email: string, password: string) {\r\n        try {\r\n          //sign in the user\r\n          const user = await Auth.signIn(email, password);\r\n    \r\n          AlertHelper.show('info', 'Signed in!', user)\r\n    \r\n          const token = user.signInUserSession.idToken.jwtToken\r\n    \r\n          console.log('token:', token )\r\n    \r\n          const requestInfo = {\r\n           headers: {\r\n            Authorization: token\r\n           }\r\n    \r\n//get the Data Here\r\n        const data = await API.get('API_NAME','/hello',requestInfo)\r\n        console.log('Data: ',data )\r\n      }\r\n     \r\n        }\r\n        catch(error){\r\n          console.log('Error: ', error)      \r\n        }\r\n    \r\n      }\r\n```\r\n\r\n**What is Configured?**\r\n```\r\nconst awsmobile = {\r\n    \"aws_project_region\": \"eu-west-1\",\r\n    \"aws_cognito_identity_pool_id\": \"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\",\r\n    \"aws_cognito_region\": \"eu-west-1\",\r\n    \"aws_user_pools_id\": \"eu-west-1_xxxxxxxxx\",\r\n    \"aws_user_pools_web_client_id\": \"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\",\r\n    \"oauth\": {},\r\n    \"aws_cloud_logic_custom\": [\r\n        {\r\n            \"name\": \"API_NAME\",\r\n            \"endpoint\": \"https://endpoint\",\r\n            \"region\": \"eu-west-1\"\r\n        }\r\n    ]\r\n};\r\n\r\n\r\nHere is the index.js from the function\r\n\r\nexports.handler = async (event) => {\r\n    // TODO implement\r\n\r\n\r\n    if(event.requestContext.authorizer){\r\n        console.log('Claims: ',event.requestContext.authorizer.claims)\r\n    }\r\n\r\n    const response = {\r\n        statusCode: 200,\r\n    //  Uncomment below to enable CORS requests\r\n     headers: {\r\n         \"Access-Control-Allow-Origin\": \"*\",\r\n         \"Access-Control-Allow-Headers\": \"*\"\r\n     }, \r\n        body: JSON.stringify('Hello from Lambda!'),\r\n    };\r\n    return response;\r\n};\r\n\r\n\r\n\r\n\r\n```\r\n**Smartphone (please complete the following information):**\r\n\r\nIphone 11\r\n\r\nand \r\n\r\nAndroid Samsung A20E\r\n\r\n**Additional context**\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"amhinson"},"body":"Can you describe what steps you took to create the Lambda function? Was it with `amplify add api`?"}},{"node":{"author":{"login":"wordisthebird"},"body":"Hi there,\r\nI used `amplify add api`\r\n\r\nThen added the name of the API\r\n\r\nThen I added `/hello` for the path\r\n\r\nThen I used a lambda function previously created\r\n\r\nThen I restricted the access to Authenticated/guest-users\r\n\r\nThen I didn't add more paths\r\n\r\n"}},{"node":{"author":{"login":"amhinson"},"body":"Would you be able to double check the values you're providing for `API_NAME`? I've tried to replicate the issue you are seeing, but everything appears to be working when I create a new rest API with Lambda via the CLI."}},{"node":{"author":{"login":"mikhael28"},"body":"I just had the same problem - I have a mature react app running, I run amplify add api, add a rest dynamodb crud api with Node, everything gets pushed, but afterwards - my 'api does not exist' message is the same as theirs.\r\n\r\nI ran the first operation using amplify-cli version 4.41, then deleted everything, ran it with version 4.40 - same issue. Unfortunately, it looks like something is broken with `amplify add api`.\r\n\r\n@amhinson @wordisthebird in the future, would be very helpful if you would give the version number of the packages you are using."}},{"node":{"author":{"login":"mikhael28"},"body":"Specifically, the problem is with the REST api creation. I created a graphql api 3-4 weeks ago, no problems. Same dep versions."}},{"node":{"author":{"login":"wordisthebird"},"body":"Hi @amhinson, thank you for your reply. I get the `API_NAME` from the AWS-exports.js file under the `name:` category which is an auto generated file. The name of the API is the same on the Aws console.\r\n\r\nI really cant think of what else I could be doing wrong, any ideas.  How are you re creating the issue as maybe I am doing something wrong here.\r\n"}},{"node":{"author":{"login":"wordisthebird"},"body":"> Specifically, the problem is with the REST api creation. I created a graphql api 3-4 weeks ago, no problems. Same dep versions.\r\n\r\nHi @mikhael28 thank you very much for your response! would you have a link to any good tutorials / documentation on how to link up a graphql to a react native app"}},{"node":{"author":{"login":"wordisthebird"},"body":"Update:\r\n\r\nI can test the api on the console and also get a 200 response with the basic 'Hello from Lambda' message. What am I missing?? @amhinson \r\n![Screenshot 2021-02-03 at 10 28 18](https://user-images.githubusercontent.com/23181835/106734266-b9551880-660a-11eb-92a7-2c4002a20a00.png)\r\n"}},{"node":{"author":{"login":"mikhael28"},"body":"The problem appears to be, from my vantage point, not a problem with the\n\ncreation of the API itself. It appears to be an error with the\ninitialization logic of the aws-amplify/core library. When it's running\n\nAmplify.configure of the aws-exports object, there appears to be some\nproblem with how it is making those API's available to the 'global\nstate', as it were, accessible for the `aws-amplify/api` library.\n\n\nOn February 2, 2021, Steve Denton <notifications@github.com> wrote:\n> Update:\n>\n> I can test the api on the console and also get a 200 response with the\n\n> basic 'Hello from Lambda' message. What am I missing??\n>  \n>\n\n>  \n> —\n> You are receiving this because you were mentioned.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/aws-amplify/amplify-js/issues/7670#issuecomment-\n\n> 772403894>, or unsubscribe\n> <https://github.com/notifications/unsubscribe-\n> auth/ADUAHC6NHH3M27LTUYFDVXTS5EQSPANCNFSM4W7EJEHQ>.\n>\n"}},{"node":{"author":{"login":"amhinson"},"body":"@mikhael28 @wordisthebird Could you share your `package.json`? This might possibly be due to duplicate dependencies. We now only recommend using the `aws-amplify` package and not any of the modular packages directly.\r\n\r\n> would you have a link to any good tutorials / documentation on how to link up a graphql to a react native app\r\n\r\nThe docs have a [getting started guide](https://docs.amplify.aws/lib/graphqlapi/getting-started/q/platform/js#create-the-graphql-api) that will work for React Native as well.\r\n\r\n"}},{"node":{"author":{"login":"mikhael28"},"body":"Here is my package.json, though I am a little confused - when did you\nstart not recommending the module packages? When I was doing a audit on\n\nmy bundle size, aws-amplify was adding a huge weight to the bundled js -\n\nwhen I added the modular libraries and updated my imports, it went down\n\nby 800kb. Does the base amplify package support tree shaking now?\n\n\"dependencies\": {\n    \"@aws-amplify/api\": \"^3.2.17\",\n    \"@aws-amplify/auth\": \"^3.4.17\",\n    \"@aws-amplify/core\": \"^3.8.9\",\n    \"@aws-amplify/pubsub\": \"^3.2.15\",\n    \"@aws-amplify/storage\": \"^3.3.17\",\n    \"@material-ui/core\": \"^4.11.2\",\n    \"@sanity/block-content-to-react\": \"^2.0.6\",\n    \"@sanity/client\": \"^0.141.6\",\n    \"@sanity/image-url\": \"^0.140.19\",\n    \"classnames\": \"^2.2.6\",\n    \"generate-password\": \"^1.4.2\",\n    \"lodash.clonedeep\": \"^4.5.0\",\n    \"lodash.sortby\": \"^4.7.0\",\n    \"prop-types\": \"^15.7.2\",\n    \"pure-react-carousel\": \"^1.27.4\",\n    \"react\": \"^17.0.1\",\n    \"react-accessible-accordion\": \"^3.3.3\",\n    \"react-beautiful-dnd\": \"^13.0.0\",\n    \"react-bootstrap\": \"^0.32.4\",\n    \"react-calendar\": \"^3.2.1\",\n    \"react-dom\": \"^17.0.1\",\n    \"react-icons\": \"^4.1.0\",\n    \"react-loading-skeleton\": \"^2.1.1\",\n    \"react-quill\": \"^1.3.5\",\n    \"react-redux\": \"^7.1.0\",\n    \"react-router-dom\": \"^5.2.0\",\n    \"react-scripts\": \"^4.0.1\",\n    \"react-spring\": \"^8.0.27\",\n    \"react-stripe-elements\": \"^1.6.0\",\n    \"reactour\": \"^1.18.0\",\n    \"redux\": \"^4.0.4\",\n    \"source-map-explorer\": \"^2.5.2\",\n    \"styled-components\": \"^4.4.1\",\n    \"toasted-notes\": \"^3.2.0\",\n    \"uuid\": \"^3.3.3\",\n    \"victory\": \"^35.1.1\",\n    \"web-vitals\": \"^0.2.4\",\n    \"workbox-background-sync\": \"^5.1.3\",\n    \"workbox-broadcast-update\": \"^5.1.3\",\n    \"workbox-cacheable-response\": \"^5.1.3\",\n    \"workbox-core\": \"^5.1.3\",\n    \"workbox-expiration\": \"^5.1.3\",\n    \"workbox-google-analytics\": \"^5.1.3\",\n    \"workbox-navigation-preload\": \"^5.1.3\",\n    \"workbox-precaching\": \"^5.1.3\",\n    \"workbox-range-requests\": \"^5.1.3\",\n    \"workbox-routing\": \"^5.1.3\",\n    \"workbox-strategies\": \"^5.1.3\",\n    \"workbox-streams\": \"^5.1.3\"\n  },\n  \"scripts\": {\n    \"analyze\": \"source-map-explorer 'build/static/js/*.js'\",\n\n    \"start\": \"react-scripts start\",\n    \"build\": \"react-scripts build\",\n    \"test\": \"react-scripts test --env=jsdom\",\n    \"eject\": \"react-scripts eject\",\n    \"serve\": \"serve -s build\"\n  },\n  \"browserslist\": [\n    \">0.2%\",\n    \"not dead\",\n    \"not ie <= 11\",\n    \"not op_mini all\"\n  ],\n  \"devDependencies\": {\n    \"cypress\": \"^3.4.1\",\n    \"redux-devtools\": \"^3.5.0\"\n  }\n\nOn February 8, 2021, Steve Denton <notifications@github.com> wrote:\n> @mikhael28 <https://github.com/mikhael28>\n> @wordisthebird <https://github.com/wordisthebird> Could you share your\n\n> package.json? This might possibly be due to duplicate dependencies. We\n\n> now only recommend using the aws-amplify package and not any of the\n> modular packages directly.\n>\n> > would you have a link to any good tutorials / documentation on how\n\n> > to link up a graphql to a react native app\n> >\n>\n> The docs have a getting started guide\n> <https://docs.amplify.aws/lib/graphqlapi/getting-\n> started/q/platform/js#create-the-graphql-api> that will work for React\n\n> Native as well.\n>\n\n—\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub <https://github.com/aws-\n\namplify/amplify-js/issues/7670#issuecomment-775402697>, or unsubscribe\n\n<https://github.com/notifications/unsubscribe-\nauth/ADUAHC6N7JLHK5BJDZN3WN3S6A6SZANCNFSM4W7EJEHQ>.\n"}},{"node":{"author":{"login":"amhinson"},"body":"> Does the base amplify package support tree shaking now? \r\n\r\nYep, tree shaking was introduced with the last major version bump (3.0.0)."}},{"node":{"author":{"login":"mikhael28"},"body":"My bundle size did not reflect that, though perhaps I was on 2.x for\nsome reason. I will give that another try when I have time, thanks for\n\nthe heads up! \n\nOn February 8, 2021, Steve Denton <notifications@github.com> wrote:\n> > Does the base amplify package support tree shaking now?\n> >\n>\n> Yep, tree shaking was introduced with the last major version bump\n> (3.0.0).\n>\n\n—\nYou are receiving this because you were mentioned.\nReply to this email directly, view it on GitHub <https://github.com/aws-\n\namplify/amplify-js/issues/7670#issuecomment-775463089>, or unsubscribe\n\n<https://github.com/notifications/unsubscribe-\nauth/ADUAHC2X54B4KQ3UNDJP323S6BHGZANCNFSM4W7EJEHQ>.\n"}},{"node":{"author":{"login":"radheyshyamideastoimpacts"},"body":"Getting this error when sign up and sign in\r\n UserNotFoundException{message=User not found in the system., cause=com.amazonaws.services.cognitoidentityprovider.model.UserNotFoundException: User does not exist. (Service: AmazonCognitoIdentityProvider; Status Code: 400; Error Code: UserNotFoundException; Request ID: ********-****-****-****-************), recoverySuggestion=Please enter correct username.}"}}]}}},{"node":{"id":"D_kwDOBkswNc4AQZGR","author":{"login":"natrajevertz"},"title":"Setting cache-control and pragma in request headers of Auth.signIn","body":"Hi everyone, \r\n\r\nI'm want to set the headers for the HTTP request that gets sent on calling Auth.signIn (https://docs.amplify.aws/lib/auth/emailpassword/q/platform/js/#sign-in)\r\n\r\nThis are the headers I want to set\r\nCache-Control: no-store\r\nPragma: no-cache\r\n\r\nI'm also using Amplify.configure (https://docs.amplify.aws/lib/client-configuration/configuring-amplify-categories/q/platform/js/#authentication-amazon-cognito) to configure Amplify before making the Auth.signIn call.\r\n\r\nSo how do I set these headers? Is there an option to set them in Auth.signIn or Amplify.configure?\r\n\r\nBTW I'm using Angular.","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AQShe","author":{"login":"chess-octane"},"title":"User session expired right after the authentication","body":"Hello everyone! I am trying to debug a tricky bug in our application that is happening only in production (yes, excellent).\r\n\r\nAbout ~2.5% of our users (200 out of 8000) had issues after registering on our platform. We are creating the user in our backend invoking the `AdminCreateUserCommand`.\r\n\r\nThe flow is as follows:\r\n- User registers using a custom form - we call `AdminCreateUserCommand`. The user is required to set the permanent password.\r\n- The user is redirected to the first login page where the user inputs the temporary password sent by Cognito - Here we call `userInstance = await Auth.signIn(username, password)`. The user returned by the `signIn` function contains the `challengeName === 'NEW_PASSWORD_REQUIRED'`. We save the `userInstance` in memory inside our store (zustand).\r\n- The user is redirected to a form to set the permanent password - we call here `Auth.completeNewPassword(userInstance, permanentPassword)`\r\n\r\nThe `Auth.completeNewPassword` sometimes raises an exception: `Invalid session for the user, the session is expired.` and the code is `NotAuthorizedException`.\r\n\r\nI want to understand why would this happen immediately after the user logs in and why it only happens for a few set of users. Does anyone can help us? :) \r\n\r\nThis is how we configure Amplify:\r\n\r\n```\r\nconst configuration: AuthOptions = {\r\n  region: process.env.AWS_COGNITO_USER_POOL_REGION,\r\n  userPoolId: process.env.AWS_COGNITO_USER_POOL_ID,\r\n  userPoolWebClientId: process.env.AWS_COGNITO_USER_POOL_CLIENT_ID,\r\n  mandatorySignIn: true,\r\n  authenticationFlowType: 'USER_SRP_AUTH',\r\n};\r\n\r\nAuth.configure({ Auth: configuration });\r\n```","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"chess-octane"},"body":"I found [this workshop](https://catalog.us-east-1.prod.workshops.aws/workshops/f3a3e2bd-e1d5-49de-b8e6-dac361842e76/ko-KR/basic-modules/20-vpc/api-gateway/5-apigateway) in AWS page and it has the following warning:\r\n\r\n![image](https://user-images.githubusercontent.com/95883601/182377587-5e3ffaf8-6ed3-42f5-b242-6c4a20a9f7b8.png)\r\n\r\nI wonder why the session expired so soon? We have configured the access token to expire in 30 minutes and ID token in 60 minutes. Users are facing this issue 1-2 minutes after the login. Some users are not that fast to get their temporary password from their email and fill it. There's something very wrong going on here."}},{"node":{"author":{"login":"abdallahshaban557"},"body":"Hi @chess-octane  - can you please submit a Github issue so that our team can triage this issue?"}}]}}},{"node":{"id":"D_kwDOBkswNc4AQXi2","author":{"login":"shoaib30"},"title":"Authourization_code flow with amazon-cognito-identity-js or amplify","body":"Hi,\r\n\r\nI am trying to use `amazon-cognito-identity-js` which is part of `amplify-js` essentially the `Auth` module of amplify in my VS Code extension. I can open the hosted UI from VSCode in the system browser and capture the `code` in the callback url by registering the `vscode://` uri. Once I have the code I see no option in the amplify/amazon-cognito-identity-js to authenticate, or get tokens with the code.\r\n\r\nI may be missing something since amplify is able to open the hosted UI when used in a web application and perform the authentication, but I am not able to find the functions for getting tokens/session given the `code`","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AQXYV","author":{"login":"Josephenoch"},"title":"Relationship for autogenerated manytomany relationship","body":"Hello, I'm in need of urgent help\r\n\r\nI am working on a project and the relationship between two models I have, let's call them student and classroom, is many to many. I understand that a model is autogenerated, let's call that ClassroomStudent. Now, I'm trying to say a ClassroomStudent has many of another model, let's say, Classmates. Is there a way to do this in amplify? ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNDgz","author":{"login":"killrazor"},"title":"Multiple domains in cookiestorage","body":"Looking for a way to specify multiple domains in cookiestorage. Right now we can accomplish this by using a static list and checking that against the window location for the client side code. This should be handled in package. ","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"rockymeza"},"body":"This is a feature that we've spent a ton of time trying to make happen at work. The way that we have been handling cross domain token storage in two ways:\r\n\r\n1. subdomains: custom cookie storage\r\n2. different top-level domains: token sharing through implicit oauth flow\r\n\r\n## subdomains\r\nThe custom CookieStorage will store all of the tokens at the eLTD+1 (so `*.example.com`) and that way any subdomain has access to all of the tokens. Cognito doesn't let you have multiple redirectUris for the oauth flows, so what we've been doing is always use one subdomain for the oauth flow and sort of treating it like a proxy:\r\n\r\n1. User goes to `https://foo.example.com`\r\n2. They click on login with SSO button\r\n3. We redirect to `https://special.example.com/special/path`\r\n4. This calls `Auth.federatedSignIn`\r\n5. User is sent to Cognito -> SSO Provider -> Back to Cognito\r\n6. User lands on `https://special.example.com?code=...`\r\n7. After the code flow finishes, we store the tokens in a cookie\r\n8. The we redirect the user back to `https://foo.example.com`\r\n\r\nThis is pretty annoying and not very fast. A benefit is that now the user can navigate to any subdomain and they will be logged in already.\r\n\r\nI don't have any other solutions for it, so that's what we've been doing. We can't use the Hosted UI because it's too limited style-wise and we also have to brand the login screen differently for different tenants.\r\n\r\n## cross domain\r\nSo in this case, we have some properties on different eTLD+1 (`*.example.com` and some on `*.example.net`). In order to share the token over there we are taking advantage of the implicit OAuth flow and doing something like this:\r\n\r\n1. User is on `https://foo.example.com`\r\n2. They click link to go to `https://bar.example.net`\r\n3. We grab the access_token & id_token and put them on the URL like this: `https://bar.example.net/#access_token=...&id_token=...`.\r\n\r\nThis has a major disadvantage of losing the `refreshToken` the user will be logged out after a while. As of yet we don't have a good solution for this. All I can hope is that we can merge all of our properties into one root domain before too long.\r\n\r\nI would love to hear from the Amplify team on how/if they intend to support cross domain logins.\r\n"}},{"node":{"author":{"login":"astroanu"},"body":"Any update on this ? we're also struggling with this at the moment"}},{"node":{"author":{"login":"idwise-team"},"body":"Any update on this?"}},{"node":{"author":{"login":"davidboom95"},"body":"Any update on this?"}},{"node":{"author":{"login":"namdevdivya"},"body":"any update on this?\r\n"}},{"node":{"author":{"login":"nh83012001"},"body":"Any update on this?"}},{"node":{"author":{"login":"ashika01"},"body":"I have not personally tried this out. I will work on creating a sample or if anyone here has a sample I could use @ me. I will create an issue out of this one so we can track this."}}]}}},{"node":{"id":"D_kwDOBkswNc4AQUJ-","author":{"login":"clintfoster"},"title":"Unauthorized field throws instead of returns","body":"I'm aware that the `GraphQLResult` returned when performing a query via `API.graphql()` can contain both `data` and `errors`. But is it normal for it to literally be thrown in the case of a partial failure rather than returned as the function call result?\r\n\r\nI'm not sure if the specific scenario matters, but here are some additional details. In this case an `Unauthorized` error occurs because the user that attempted to access the record isn't authorized for the `notes` field, which has a field-level auth rule that overrides the one for the model. The request actually works since the User record in `data` is populated as expected, with `notes` being empty. But since this would seem to be a go-right path for many similar use cases (fields user isn't supposed to see simply shouldn't be returned) it seems odd that an exception is thrown.\r\n\r\nI realize this wouldn't happen with custom queries that only ask for the fields a particular user is authorized to access, but I'm using the queries generated by the Amplify CLI. Creating queries for all the permutations of field-level permissions and selecting them from the code logic seems tedious. For now I'm simply catching the thrown result and proceeding the same as if it were the return value, even though it might be inefficient (or at least counterintuitive).\r\n\r\n## Thrown GraphQLResult\r\n```\r\n  data: { userByEmail: { items: [blahblah], nextToken: null } },  <== items is populated\r\n  errors: [\r\n    {\r\n      path: [ 'userByEmail', 'items', 0, 'notes' ],  <== lets us know notes not returned\r\n      data: null,\r\n      errorType: 'Unauthorized',\r\n      errorInfo: null,\r\n      locations: [ [Object] ],\r\n      message: 'Not Authorized to access notes on type String'\r\n    }\r\n  ]\r\n```\r\n\r\n## Schema excerpt\r\n\r\n```graphql\r\ntype User \r\n  @model\r\n  @auth(\r\n    rules: [\r\n      { allow: owner }\r\n      { allow: groups, groups: [\"Admin\"] }\r\n      { allow: private, operations: [read] }\r\n    ]\r\n  ) {\r\n\r\n  id: ID! @primaryKey\r\n\r\n  email: AWSEmail\r\n    @index(\r\n      name: \"byEmail\"\r\n      queryField: \"usrByEmail\")\r\n\r\n  notes: [String]\r\n    @auth(rules: [ # don't allow users to see internal notes about them\r\n      { \r\n        allow: groups, groups: [\"Admin\"] \r\n      }\r\n    ])\r\n}\r\n\r\n```","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"clintfoster"},"body":"This may be TMI, but in case anyone will find it interesting (or laughable) here is the boilerplate code I find myself writing everywhere to invoke `API.graphql()` using the generated types. When I first started working with Amplify almost a year ago I was coming to TypeScript from Java. What I had to do to make my code pass reasonably strict eslint checks seemed crazy. It really didn't seem like a proper TypeScript API. I figured I must not know what I was doing...\r\n\r\n```typescript\r\n\r\nimport * as t from 'src/API'  // generated GQL types for use w/ below\r\nimport * as qry from 'src/queries'  // generated GQL queries & mutations\r\n\r\nexport async function userByEmail(\r\n  vars: t.UserByEmail_QueryVariables\r\n): Promise<t.UserByEmailQuery> {\r\n  try {\r\n    const res = await API.graphql({\r\n      query: qry.userByEmail,\r\n      variables: vars,\r\n    }) as GraphQLResult<t.UserByEmailQuery>  // narrow: Observable is for sub & undefined is catch\r\n    if (res.data && res.data.userByEmail) {\r\n      return res.data.userByEmail\r\n    } else {\r\n      throw new NoDataErr(context)  // can't happen, per catch below?\r\n    }\r\n  // Amplify literally throws GraphQLResult if errors is populated\r\n  } catch (exOrGraphQLResult) {  // could presumably also be an Err instance\r\n      throw new ApiErr(context, exOrGraphQLResult)  // wrapped ex w/ context info\r\n  }\r\n  // never get here since testing indicates GraphQLResult is thrown if errors populated\r\n  throw new UnexpectedApiErr(context)\r\n}\r\n```\r\n\r\nI bet someone can improve on that. But, setting aside crazy code to improve TypeScript  usability, there is a problem with my \"catch\" clause assuming `data` is never populated when `GraphQLResult` is thrown. That's really the subject of this thread. My code (and probably most code) should treat it as \"normal\" if what was thrown is an instance of `GraphQLResult` _and_ `data` is populated. That's what happens when a partial result is returned due to the user not being authorized to access certain fields. The data is still returned, but with the unauthorized fields removed. That much makes sense. What doesn't make sense is throwing the result as an exception since the caller can still check the `errors` field if it wants to know data was omitted.\r\n\r\nMore broadly, from an API architecture standpoint it doesn't make sense to use `GraphQLResult` both as a return value and a thrown object, especially since it is an interface, making it messy to differentiate from other exceptions in a catch clause since `instanceof` cannot be used on an interface. Also, the fact that the same `API.graphql()` function is also used for subscriptions (which return `Observable`) makes handling the return value for queries and mutations unwieldy since narrowing is required in TS.\r\n"}}]}}},{"node":{"id":"D_kwDOBkswNc4AQO08","author":{"login":"hardikmehta88999"},"title":"Push Notification json body missing","body":"When I tried to send the push notification along with the JSON body (pinpoint.jsonBody) through pinpoint but when I console the notification data the JSON body is missing for the frontend (react-native). Need Help\r\nVersion : 4.3.17 (push notification)","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"abdallahshaban557"},"body":"Hi @hardikmehta88999  - can you please elaborate on what JSON Body means here?"}}]}}},{"node":{"id":"D_kwDOBkswNc4AQJ-p","author":{"login":"zzBrunoBrito"},"title":"Is there a way to validate the code sent using forgotPassword and change the password only after the validatation?","body":"I'm using cognito user pools for user management and using the flow of forgotPassword a confirmation code is sent to the user. For UI purposes I need to validate the code that is sent when I call the API ForgotPassword without sending the new password yet. I need like a middle step between ForgotPassword and ConfirmForgotPassword.\r\n\r\nThe function below is the one sending the code:\r\n\r\nAuth.forgotPassword(username)\r\n\r\nThis function is resetting the password with the code sent (here I'm notified if the code is invalid)\r\n\r\nIs it possible to only validate the code sent with the existing API's available?\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"abdallahshaban557"},"body":"Unfortunately, this is not currently possible. You can only confirm the code with setting the password. Why would you need to check the code without setting the password as well?"}}]}}},{"node":{"id":"D_kwDOBkswNc4AQQxT","author":{"login":"aaronmg241"},"title":"Passing Authorization Token to Graphql Request","body":"I am trying to allow users in a cognito group to delete a User from my DynamoDB database. I am using graphql for queries, mutations, etc. I try the following graphql request:\r\n\r\n        await API.graphql(\r\n            { \r\n                query: deleteUser,\r\n                variables: { id },\r\n                authMode: 'AMAZON_COGNITO_USER_POOLS',\r\n                authToken: token\r\n            }\r\n        )\r\n\r\nwhere \"token\" is a jwtToken from the current logged in user. However, when I try this I get a \"no current user\" error. Is there any way to pass in the user or authorization parameter for a request like this?? The docs (from what I have read) only go over how to add this authentication to your schema, but I am lost when it comes to finding an answer to give the user to the request. \r\n\r\nI have been trying to find an answer for hours with no luck. Any help is GREATLY appreciated!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AQQdF","author":{"login":"achinthaprem"},"title":"Allowing the session to be restored for CognitoUser in amazon-cognito-identity-js","body":"I just came across a scenario where I had to restore the session for CognitoUser in the `amazon-cognito-identity-js` package. I know that the intended use for the package is using it on the client side. I'm currently working on a bit old project that uses the package in a NodeJS server.\r\n\r\nSo the scenario is that I'm tasked to develop TOTP MFA support for the project. There would be two requests to the NodeJS server from the web client. The first request is to provide the server with the username and password and then retrieve the URI to generate the QR code. The second request is to provide the TOTP code user entered after scanning the QR code. The issue arises when I try to call the verifySoftwareToken method. It just throws NotAuthorizedException because the server couldn't keep the session. So I patched the package to assign the session (which was obtained during the first request) from the constructor of CognitoUser. and then call the verifySoftwareToken method. This was successful.\r\n\r\nWhat I want to know is, is there any better approach to restore the session from the `amazon-cognito-identity-js` package and the shortcomings of this patch? Please note that I can't use the `adminInitiateAuth` and `adminRespondToAuthChallenge` from `@aws-sdk/client-cognito-identity-provider` package or any methods that requires developer credentials. Thank you.","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AQK44","author":{"login":"cdellinger"},"title":"How to troubleshoot subscription authentication issue","body":"I have a React application that currently uses Amplify GraphQL APIs. I have set those APIs up so that they require using Cognito user pools for authorization. For example the following code is successfully retrieving a list of values from my Projects collection in DynamoDB\r\n\r\n`const apiData = await API.graphql({ query: listProjects, authMode: \"AMAZON_COGNITO_USER_POOLS\"  });\r\n`\r\nRecently I have been trying to setup a subscription so that I can receive real time updates from AppSync when new entries are added to my Projects collection. This is the code that I am trying to get to work:\r\n\r\n```\r\nconst subscription = API.graphql({query: subscriptions.onUpdateProject, authMode: \"AMAZON_COGNITO_USER_POOLS\"}\r\n    ).subscribe({\r\n    next: ({ provider, value }) => console.log({ provider, value }),\r\n    error: error => console.warn(error)\r\n});\r\n```\r\n\r\nUnfortunately, this code is failing when executed, it is causing this error to be raised:\r\n\r\n`\"Connection failed: {\\\"errors\\\":[{\\\"errorType\\\":\\\"Unauthorized\\\",\\\"message\\\":\\\"Not Authorized to access onUpdateProject on type Project\\\"}]}\"\r\n`\r\nI am not quite sure how to troubleshoot this or resolve it, do subscriptions require a special configuration with respect to authorization? Are Cognito user pools supported with subscriptions? Any help or guidance would be greatly appreciated.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"cdellinger"},"body":"I was able to resolve this by adding the a variable to specify the owner to my subscription as shown below.   I found this in another issue (https://github.com/aws-amplify/amplify-category-api/issues/456).\r\n\r\n```\r\n        const updateProjectSubscription = API.graphql({query: subscriptions.onUpdateProject, authMode: 'AMAZON_COGNITO_USER_POOLS', variables: {\r\n            owner: Auth.user.attributes.sub \r\n        }}\r\n\r\n```"}}]}}},{"node":{"id":"D_kwDOBkswNc4AQPNu","author":{"login":"sdandois"},"title":"At least local transactions?","body":"Hi, what kind of transaction support does this library have? \r\n\r\nI'm comparing with Firebase Cloudfirestore and Realm which both have good support for transactions. I would expect at least that the SQlite adapter leverages SQLite transactions, is that the case? \r\n\r\nHow do you deal with absence of transactions? \r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AODcS","author":{"login":"guaaak"},"title":"Amplify pushnotification on Android","body":"Hi I setup everything followed the steps for android https://docs.amplify.aws/lib/push-notifications/getting-started/q/platform/js/\r\nWhen I test the push notification through ping point I can trigger the onNotification function and get notification message. However, the notification doesn't popup on the Android device. Any ideas of this issue? Thanks!","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"Samaritan1011001"},"body":"Hi, is your app in the foreground at the time you send it from Pinpoint? If so, only the `onNotification` callback will get fired and no message will be displayed. "}}]}}},{"node":{"id":"D_kwDOBkswNc4ANunB","author":{"login":"abdullahmujahidali"},"title":"The Lambda function associated with the CloudFront distribution is invalid","body":"I am working on an SSR app and I have deployed it on my amplify, whenever I try to redirect to a page it gives me a 503 ERROR. \r\n\r\n> 503 ERROR\r\nThe request could not be satisfied.\r\nThe Lambda function associated with the CloudFront distribution is invalid or doesn't have the required permissions. We can't connect to the server for this app or website at this time. There might be too much traffic or a configuration error. Try again later, or contact the app or website owner.\r\nIf you provide content to customers through CloudFront, you can find steps to troubleshoot and help prevent this error by reviewing the CloudFront documentation.\r\nGenerated by cloudfront (CloudFront)\r\nRequest ID: PUV5fkcF-HXXhA5qvSfyGKjmw5QI7iD1x7x1y0xWA9rdcumb8zEzOg==\r\n\r\nThis is the error I get, I am communicating with my APIs directly there's no server in my next js app. My app is working fine if I connect it with Vercel or Netlify but fails with Amplify.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"abdullahmujahidali"},"body":"There are several issues still with getting Next and Amplify to work nicely. The best two pages I found are here\r\n\r\nhttps://github.com/aws-amplify/amplify-hosting/blob/main/FAQ.md#error-accessdenied-access-denied\r\n\r\nAnd here\r\n\r\nhttps://aws.amazon.com/blogs/mobile/host-a-next-js-ssr-app-with-real-time-data-on-aws-amplify/ (specifically the comments below the blog post)\r\n\r\nIn my case I made several key changes:\r\n\r\n1-Install or downgrade to Next 10.0.0.8 (npm install next@10.0.8)\r\n\r\n2-Be sure all of your Environment variables are added to Amplify’s console\r\n\r\n3-Add this Env variable too: AMPLIFY_NEXTJS_EXPERIMENTAL_TRACE=true\r\n\r\n4-Modify your next.config.js for the Environment Variables Workaround mentioned in the 1st article above.\r\n\r\nAlso, it doesn’t hurt to test an api/ file with bare min code to ensure there aren’t errors in your code. LambdaEdge doesn’t seem to have great logging. (At least not that I found)"}}]}}},{"node":{"id":"D_kwDOBkswNc4AQLh8","author":{"login":"rayshi67"},"title":"AWS Amplify GraphQL Query with Computed Field","body":"I am looking to implement a query named **driversByActiveStatus** that returns only the active, inactive, or all drivers respectively for the following Driver type,\r\n\r\n```\r\ntype Driver\r\n  @model\r\n  @auth(rules: [\r\n    {allow: private}\r\n  ])\r\n  @key(name: \"byLastName\", fields: [\"lastName\", \"id\"], queryField: \"driversByLastName\")\r\n  @key(name: \"byActiveStatus\", fields: [\"active\", \"id\"], queryField: \"driversByActiveStatus\") {\r\n  \r\n  id: ID!\r\n  firstName: String!\r\n  lastName: String!\r\n  \r\n  # computed field that is calculated based on startDate and endDate\r\n  # true if startDate < currentDate < endDate\r\n  # false if currentDate < startDate || current > endDate\r\n  active: Boolean\r\n  \r\n  startDate: AWSDateTime!\r\n  endDate: AWSDateTime!\r\n}\r\n```\r\n\r\nThe query **driversByActiveStatus** should work as follows,\r\n - it returns all the drivers if the **active** parameter is null\r\n - it returns only the active drivers if the **active** parameter is true (an active driver is a DynamoDB record where the current date is between its **startDate** and **endDate**, i.e., startDate < currentDate < endDate)\r\n - it returns only the inactive drivers if the **active** parameter is false\r\n\r\nWhat would be the best way to achieve this in AWS Amplify?\r\n\r\nFrom what I read on <https://docs.amplify.aws/cli/> it looks like it may be possible to implement the query by overwriting the auto-generated VTL resolvers **Query.driversByActiveStatus.req.vtl** and **Query.driversByActiveStatus.res.vtl**, and replacing the **active** field value with a calculated value based on **startDate** and **endDate** in the returned result set in the result mapping resolver.\r\n\r\nHas anyone implemented something similar? If so can you please shed some lights or share the code snippet as there is only limited documentation on AppSync VTL resolvers.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APwQL","author":{"login":"pratikdhody"},"title":"Installing In App Messaging","body":"Hi,\r\n\r\nI've followed https://docs.amplify.aws/lib/in-app-messaging/overview/q/platform/js/ and within my React Native app, I've copied the `aws-exports.js` file which looks like below but I'm getting an error within my app `Notifications.InAppMessaging - Failed to sync messages, [Error: not implemented]`\r\n\r\nIAM policies have also been created and assigned to appropriate roles.\r\nAny thoughts on what I may have not done?\r\n\r\nCheers\r\n\r\n\r\n```\r\nconst awsmobile = {\r\n  aws_project_region: \"ap-southeast-2\",\r\n  aws_appsync_graphqlEndpoint:\r\n    \"XXXX\",\r\n  aws_appsync_region: \"ap-southeast-2\",\r\n  aws_appsync_authenticationType: \"API_KEY\",\r\n  aws_appsync_apiKey: \"XXXX\",\r\n  aws_cognito_identity_pool_id: \"XXXX\",\r\n  aws_cognito_region: \"ap-southeast-2\",\r\n  aws_user_pools_id: \"XXXXX\",\r\n  aws_user_pools_web_client_id: \"XXXXX\",\r\n  oauth: {},\r\n  aws_cognito_username_attributes: [],\r\n  aws_cognito_social_providers: [],\r\n  aws_cognito_signup_attributes: [\"EMAIL\"],\r\n  aws_cognito_mfa_configuration: \"OFF\",\r\n  aws_cognito_mfa_types: [\"SMS\"],\r\n  aws_cognito_password_protection_settings: {\r\n    passwordPolicyMinLength: 8,\r\n    passwordPolicyCharacters: [],\r\n  },\r\n  aws_cognito_verification_mechanisms: [\"EMAIL\"],\r\n  aws_user_files_s3_bucket: \"fgdata211956-dev\",\r\n  aws_user_files_s3_bucket_region: \"ap-southeast-2\",\r\n  aws_mobile_analytics_app_id: \"XXXXX\",\r\n  aws_mobile_analytics_app_region: \"ap-southeast-2\",\r\n  Notifications: {\r\n    InAppMessaging: {\r\n      AWSPinpoint: {\r\n        appId: \"XXXXX\",\r\n        region: \"ap-southeast-2\",\r\n      },\r\n    },\r\n  },\r\n```","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"Samaritan1011001"},"body":"Please provide the output of the bellow command,\r\n`npx envinfo --system --binaries --browsers --npmPackages --duplicates --npmGlobalPackages`\r\n\r\nAnd can you make sure you added the right actions and ARN when following [this](https://docs.amplify.aws/lib/in-app-messaging/prerequisites/q/platform/js/#create-and-attach-iam-policy) section of the doc? "}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb241NDYx","author":{"login":"crolly"},"title":"Datastore API set id from client","body":"According to the amplify-cli docs, it is possible to set the primary key field `id` from the client through the graphql mutation.\r\n\r\nWith Datastore, the id however is always created server side and reassigned.\r\n\r\nIs it possible to accomplish this with DataStore or are any changes regarding this planned?\r\nDoes somebody have a workaround maybe?","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"lenarmazitov"},"body":"Hi @crolly DataStore generates id on client with uuid, firstly data created on client and then sync process send it to remote storage. If you see generated resolver you will see:\r\n```\r\n  \"id\":   $util.dynamodb.toDynamoDBJson($util.defaultIfNullOrBlank($ctx.args.input.id, $util.autoId()))\r\n```\r\n\r\nSo if you can set it manually id will be set instead of uuid, but uuid comes from client.\r\n\r\nAs workaround you can set id from other attribute like myId and redefine resolver\r\n\r\n```\r\n  \"id\":   $util.dynamodb.toDynamoDBJson($util.defaultIfNullOrBlank($ctx.args.input.myId, $util.autoId()))\r\n```\r\n\r\nBUT THIS IS NO GOOD IDEA, because you will get two records in DataStore cache, one with your id and one with autogenerated. And I do not know exactly but second record may wants to try sync everytime when sync process triggered."}},{"node":{"author":{"login":"kolodi"},"body":"It should be possible to define ID for newly created items. Otherwise, too many workarounds needed. A common use case would be: create user in Cognito and then create an item in DB with the same ID (sub). If you create item with other custom APIs or directly in DB, the DataStore client won't \"know\" about it for a long time as there is no mechanism to manually resync items with certain ID, which would be an awesome idea too, because, given numerous limitations of the DataStore client, there is a multitude of cases where you want you data be manipulated differently, but on the other hand you want you clients to have those updates as soon as possible and not after 5 minutes or so when DataStore decides to resync on its own. "}}]}}},{"node":{"id":"D_kwDOBkswNc4AQJfr","author":{"login":"swiftzor"},"title":"Testing Site in Cypress requiring Cognito MFA","body":"Hi All,\r\n\r\nI'm trying to write E2E tests in Cypress, but its locked behind a Cognito pool with MFA on it.  This is obviously a problem as cypress cannot do anything with the request and token which means I'm blocked from the site.  Has anyone run into this?\r\n\r\n\r\nHere is how I'm logging in:\r\n\r\n`Cypress.Commands.add('login', (user, pass, url) => {\r\n  cy.session([user, pass], () => {\r\n    cy.visit(`${Cypress.env('baseUrl')}/login`)\r\n\r\n    // Configure amplify\r\n    Amplify.configure({\r\n      region: Cypress.env('region'),\r\n      userPoolId: Cypress.env('userPoolId'),\r\n      userPoolWebClientId: Cypress.env('userPoolWebClientId'),\r\n    });\r\n\r\n    // perform sign in programmatically\r\n    let authReq = new Cypress.Promise((resolve, reject) => {\r\n      Auth.signIn(user, pass)\r\n        .then(function(_user) {\r\n          resolve()\r\n        })\r\n    });\r\n\r\n    cy.wrap(null).then(async () => {\r\n      await authReq;\r\n      store.commit(\"logIn\", {\r\n        isLoggedIn: true,\r\n        username: user,\r\n        token: \"...\",\r\n        isAdmin: true,\r\n        userType: \"Admin\"\r\n      });\r\n    })\r\n\r\n\r\nI've tried looking and looking but so far to no avail on it.  Maybe I need to do component testing instead, but I'm not 100% on that","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AQHyQ","author":{"login":"sdandois"},"title":"Is this library actively maintained?","body":"Is this library actively maintained? \r\n\r\nThe latest release is 4 years old, I doubt that works with latest react-native version.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"sdandois"},"body":"I guess the answer is yes, but they no longer publish release in github."}},{"node":{"author":{"login":"abdallahshaban557"},"body":"Yes, this library is maintained. We will be resuming the use of releases in Github soon to make sure there is no confusion about us maintaining support! "}}]}}},{"node":{"id":"D_kwDOBkswNc4AQIbH","author":{"login":"mariela-plaza"},"title":"How can I check if an accessToken is invalid from my react app?","body":"To give some context as to why I need this, **here is our problem:**\r\nWe are using Cognito to manage the users of our web app, built with react. When a user signs in, we retrieve the idToken, store it in AuthContext and we set a state called isAuthenticated to true (also part of the AuthContext).\r\n\r\nWhen the user signs out, the isAuthenticated state is set to false.\r\n\r\n**Here is the troublesome part:**\r\nIn the current state of the app, a single user can be signed in simultaneously from multiple places. This is something we want to avoid.\r\n\r\nI’ve done some research and it seems the best approach is to implement a Cognito Pre-Auth trigger which logs the user out of every device whenever they authenticate.\r\nI don’t think this approach would helps us because of the previously mentioned isAuthenticated state, which, as long as it is true, keeps the user logged in.\r\n\r\nThe other idea I saw was doing a global signout every time: (1) the user signs out and (2) before each signin as this (https://github.com/aws-amplify/amplify-flutter/issues/1206)\r\nThe issue with the isAuthenticated state persists with this approach, but by doing a global signout, the accessToken gets revoked.\r\n\r\nThat’s why I was wondering if there is a function or something I can call to verify if the accessToken is valid. In case it is not, I can logout the user by setting isAuthenticated state to false.\r\n\r\nThis is just an idea I’ve had. I haven’t come up with anything else, but if someone has a better approach to solve this issue, please comment down your solution.\r\n\r\n\r\nAll inputs and ideas will be greatly appreciated, thank you in advance!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNjY3NTAx","author":{"login":"jnomeisky"},"title":"ERROR: Validate that amazon-cognito-identity-js has been linked","body":"I receive the following error when trying to authenticate with email and password.\r\n\r\nIm using the following versions:\r\n\"aws-amplify\": \"^3.3.7\",\r\n\"aws-amplify-react-native\": \"^4.2.8\",\r\n\r\nIt's worth noting that I was using EXPO and the code worked just fine but when I \"ejected\" the code, this started to happen.\r\nCan anybody help me?","upvoteCount":3,"comments":{"edges":[{"node":{"author":{"login":"kiljee"},"body":"Hi @jnomeisky \r\nneed to run npm install aws-amplify aws-amplify-react-native amazon-cognito-identity-js @react-native-community/netinfo\r\nand after that cd ios and pod install,\r\nit's solved for me same issue"}},{"node":{"author":{"login":"pthornhi"},"body":"Mine was a mismatch between the react-native package and the @react-native-community/cli package. \r\n\r\nI looked at this reference table: https://github.com/react-native-community/cli and made sure my install pair matched a row on that table. Now pod install works from the ios directory."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjQwODE1","author":{"login":"IggyBlob"},"title":"Authenticator: Custom CSS property --container-height ignored","body":"I'm trying to set the height of Amplify Authenticator's `auth-container`. According to [the docs](https://github.com/aws-amplify/amplify-js/tree/main/packages/amplify-ui-components/src/components/amplify-authenticator#css-custom-properties), this should be trivial as `amplify-authenticator` exposes a custom CSS property `--container-height` that lets you do exactly that.\r\n\r\nIn the global `styles.scss` file of my Angular project I added the following selector:\r\n\r\n```\r\n:root {\r\n  --amplify-primary-color: #ff003d;\r\n  --amplify-secondary-color: #fff;\r\n  --amplify-primary-tint: #fff;\r\n  --amplify-primary-shade: #ff003d;\r\n  --amplify-font-family: 'Open Sans', sans-serif;\r\n  --amplify-background-color: rgba(0, 0, 0, 0.5) !important;\r\n  --amplify-secondary-contrast: rgba(0, 0, 0, 0);\r\n  --container-height: 300px;\r\n}\r\n```\r\n\r\nThe properties prefixed with `--amplify-` are picked up correctly. However, the custom property value `--container-height: 300px;` is ignored and Amplify falls back to the default value, namely `100vh`.\r\n\r\n![screenshot](https://user-images.githubusercontent.com/20150256/109129401-e64fa380-7750-11eb-9f12-928b8f60762e.png)\r\n\r\nWhat am I missing?","upvoteCount":5,"comments":{"edges":[{"node":{"author":{"login":"24601"},"body":"Did you happen to find a resolution here? W are experiencing the same thing upon updating library, just bumping a rev. \r\n\r\ndisabling min-height on the element fixes it in the browser, but with shadow DOM, the obvious way to override it in CSS isn't working, and this var isn't working either. \r\n![Screen Shot 2021-03-31 at 12 24 29](https://user-images.githubusercontent.com/1157207/113203321-c401e780-9220-11eb-9340-e7abde936ffa.png)\r\n"}},{"node":{"author":{"login":"loco-lby"},"body":"I came across this exact problem today, I setup a div around the Authenticator with a set height and it did the job.\r\nThis is inside a custom form component I made, I\r\n```\r\n<div style={{ height: 500 }}>\r\n      <AmplifyAuthenticator>\r\n        <AmplifySignUp\r\n          slot=\"sign-up\"\r\n          formFields={[{ type: \"email\" }, { type: \"password\" }]}\r\n        />\r\n      </AmplifyAuthenticator>\r\n    </div> \r\n``` \r\nAnd then I wrapped the component with a class (jss)\r\n```\r\n   <div className={classes.card2}>\r\n            <LoginForm />\r\n     </div>\r\n```\r\n\r\n```\r\ncard2: {\r\n    position: 'relative',\r\n    margin: '5% 0',\r\n    '& div': {\r\n      display: 'flex',\r\n      justifyContent: 'center',\r\n      alignItems: 'center',\r\n      flexDirection: 'column',\r\n    },\r\n  },\r\n```"}},{"node":{"author":{"login":"KarinMatsuyama"},"body":"Putting `--container-height` inside of `amplify-authenticator` worked for me.\r\nI added this to my global css.\r\n\r\n```\r\namplify-authenticator {\r\n  --container-height: 100%;\r\n}\r\n```"}}]}}},{"node":{"id":"D_kwDOBkswNc4AQDbT","author":{"login":"drummerwolli"},"title":"datastore websockets not working due to \"unauthorized\" error","body":"Hi everyone. I'm using `aws-amplify = 4.3.27`. I have an auth (cognito with social login) + api (graphql + dynamoDB) + storage setup currently. All entities are marked in the `schema.graphql` file with `allow: groups` and one string field in the entity indicating the group. The app works actually fine, I can add entities, update them and everything. Also, each user can only get the entities they are assigned to.\r\n\r\nbut i'm having a lot of datastore warnings in the console saying:\r\n\r\n![image](https://user-images.githubusercontent.com/3867569/178292528-5a296224-391b-498d-ac9b-32197d7f1a68.png)\r\n\r\nWhen checking the network tab, i can see that all graphQL calls are working fine, but the websocket connection call is full with errors, most likely causing the warnings in the console as well.\r\n\r\nHow can I get rid of these warnings and make the websockets work again properly? \r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMjY1MQ==","author":{"login":"hyprstack"},"title":"React.js AuthError - Error: Amplify has not been configured correctly.","body":"**Describe the bug**\r\nHave tried to manually integrate amplify in an existing react-app. I have succeeded in similar projects before, but have now migrated to the @aws-amplify/auth module and keep getting an annoying, and very un-helpful, error in the console:\r\n\r\n`[ERROR] 00:42.548 AuthError - \r\n            Error: Amplify has not been configured correctly. \r\n            The configuration object is missing required auth properties. \r\n            Did you run `amplify push` after adding auth via `amplify add auth`?\r\n            See https://aws-amplify.github.io/docs/js/authentication#amplify-project-setup for more information`\r\n\r\nNot only that but the form is now pushed to the left although the container div has `justify-content: center`, whereas before with the exact same styling, it was centred. Not sure if this is linked to previous error, but is annoying.\r\n\r\n<img width=\"1269\" alt=\"Screenshot 2020-05-19 at 16 01 48\" src=\"https://user-images.githubusercontent.com/5845311/82342903-16ac2980-99ea-11ea-9d8f-37722131b65b.png\">\r\n\r\nI have tried both formats of config files as shown here:\r\n\r\n```javascript\r\n{\r\n  \"Auth\": {\r\n      \"identityPoolId\": \"xxxxx:xxxxxxxx\",\r\n      \"region\": \"xxxxxx\",\r\n      \"identityPoolRegion\": \"xxxxxx\",\r\n      \"userPoolId\": \"eu-west-xxxxxxxx\",\r\n      \"userPoolWebClientId\": \"xxxxxxxxxxx\",\r\n      \"mandatorySignIn\": \"true\",\r\n      \"authenticationFlowType\": 'USER_PASSWORD_AUTH',\r\n      \"oauth\": {\r\n        \"domain\": 'https://xxxxxxxx.xxxxxx.amazoncognito.com',\r\n        \"scope\": ['phone', 'email', 'profile', 'openid', 'aws.cognito.signin.user.admin'],\r\n        \"redirectSignIn\": 'http://localhost:3000/',\r\n        \"redirectSignOut\": 'http://localhost:3000/',\r\n        \"responseType\": 'code' // or 'token', note that REFRESH token will only be generated when the responseType is code\r\n      }\r\n    }\r\n}\r\n```\r\n\r\nand \r\n\r\n```javascript\r\n{\r\n     \"aws_appsync_authenticationType\": \"AMAZON_COGNITO_USER_POOLS\",\r\n    \"aws_user_pools_id\": \"xxxxxxx\",\r\n    \"aws_user_files_s3_bucket\": \"xxxx\",\r\n    \"aws_project_region\": \"xxxxx\",\r\n    \"aws_cognito_region\": \"xxxxx\",\r\n    \"aws_appsync_region\": \"xxxxx\",\r\n    \"aws_content_delivery_bucket_region\": \"xxxxx\",\r\n    \"aws_user_files_s3_bucket_region\": \"xxxxxx\",\r\n    \"aws_cognito_identity_pool_id\": \"xxxxxx\",\r\n    \"aws_user_pools_web_client_id\": \"xxxxxxxx\"\r\n    \"oauth\": {}\r\n}\r\n```\r\n\r\nMy package.json is as follows:\r\n\r\n```javascript\r\n{\r\n  \"name\": \"demo-app\",\r\n  \"version\": \"0.1.0\",\r\n  \"private\": true,\r\n  \"dependencies\": {\r\n    \"@aws-amplify/auth\": \"^3.2.7\",\r\n    \"@aws-amplify/ui-react\": \"^0.2.6\",\r\n    \"@date-io/moment\": \"^2.0.1\",\r\n    \"@fortawesome/fontawesome-svg-core\": \"^1.2.26\",\r\n    \"@fortawesome/free-brands-svg-icons\": \"^5.12.0\",\r\n    \"@fortawesome/free-solid-svg-icons\": \"^5.12.0\",\r\n    \"@fortawesome/react-fontawesome\": \"^0.1.8\",\r\n    \"@material-ui/core\": \"^4.8.3\",\r\n    \"@material-ui/icons\": \"^4.5.1\",\r\n    \"@material-ui/lab\": \"^4.0.0-alpha.40\",\r\n    \"@material-ui/pickers\": \"^3.2.9\",\r\n    \"@testing-library/jest-dom\": \"^4.2.4\",\r\n    \"@testing-library/react\": \"^9.4.0\",\r\n    \"@testing-library/user-event\": \"^7.2.1\",\r\n    \"aws-amplify\": \"^2.3.0\",\r\n    \"aws-sdk\": \"^2.608.0\",\r\n    \"axios\": \"^0.19.2\",\r\n    \"local-storage\": \"^2.0.0\",\r\n    \"lodash\": \"^4.17.15\",\r\n    \"moment\": \"^2.24.0\",\r\n    \"nconf\": \"^0.10.0\",\r\n    \"react\": \"^16.12.0\",\r\n    \"react-dom\": \"^16.12.0\",\r\n    \"react-redux\": \"^7.1.3\",\r\n    \"react-router-dom\": \"^5.1.2\",\r\n    \"react-scripts\": \"^3.4.0\",\r\n    \"redux\": \"^4.0.5\",\r\n    \"typeface-roboto\": \"0.0.75\",\r\n    \"uuid\": \"^3.4.0\"\r\n  },\r\n  \"scripts\": {\r\n    \"start\": \"react-scripts start\",\r\n    \"build\": \"react-scripts build\",\r\n    \"test\": \"react-scripts test\",\r\n    \"eject\": \"react-scripts eject\"\r\n  },\r\n  \"eslintConfig\": {\r\n    \"extends\": \"react-app\"\r\n  },\r\n  \"browserslist\": {\r\n    \"production\": [\r\n      \">0.2%\",\r\n      \"not dead\",\r\n      \"not op_mini all\"\r\n    ],\r\n    \"development\": [\r\n      \"last 1 chrome version\",\r\n      \"last 1 firefox version\",\r\n      \"last 1 safari version\"\r\n    ]\r\n  }\r\n}\r\n```\r\n\r\nI have tried deleting node_modules and packga-lock.json and re-installing without any change.\r\n\r\nThis is my app.js file:\r\n\r\n```javascript \r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport Amplify, { Auth } from 'aws-amplify';\r\nimport { AmplifyAuthenticator } from '@aws-amplify/ui-react';\r\nimport App from './App';\r\nimport './index.css';\r\nimport * as serviceWorker from './serviceWorker';\r\n\r\nimport { Provider } from 'react-redux';\r\nimport { createStore } from 'redux'\r\nimport rootReducer from './reducers'\r\n\r\n/*global CONFIG */ --> This is {AWS: {Auth: {...}}}\r\nimport awsconfig from './aws-exports';\r\nAmplify.configure(awsconfig);\r\nAmplify.configure(CONFIG.AWS) // This also fails\r\n\r\nconst store = createStore(rootReducer, []);\r\n\r\nReactDOM.render(\r\n  <Provider store={store}>\r\n    <AmplifyAuthenticator>\r\n      <App />\r\n    </AmplifyAuthenticator>\r\n  </Provider>,\r\n  document.getElementById('root')\r\n);\r\n\r\nserviceWorker.unregister();\r\n```\r\n\r\nRunning `npm list | grep \"amplify\"` yields the following:\r\n\r\n```javascript\r\n├─┬ @aws-amplify/auth@3.2.7\r\n│ ├─┬ @aws-amplify/cache@3.1.10\r\n│ │ └── @aws-amplify/core@3.2.7 deduped\r\n│ ├─┬ @aws-amplify/core@3.2.7\r\n├─┬ @aws-amplify/ui-react@0.2.6\r\n│ ├── UNMET PEER DEPENDENCY @aws-amplify/auth@^2.1.5\r\n│ ├── UNMET PEER DEPENDENCY @aws-amplify/core@^2.2.4\r\n│ └─┬ @aws-amplify/ui-components@0.4.1\r\n├─┬ aws-amplify@2.3.0\r\n│ ├─┬ @aws-amplify/analytics@2.2.8\r\n│ │ ├─┬ @aws-amplify/cache@2.1.8\r\n│ │ │ ├── @aws-amplify/core@2.3.0 deduped\r\n│ │ ├─┬ @aws-amplify/core@2.3.0\r\n│ ├─┬ @aws-amplify/api@2.2.1\r\n│ │ ├─┬ @aws-amplify/auth@2.1.8\r\n│ │ │ ├── @aws-amplify/cache@2.1.8 deduped\r\n│ │ │ ├── @aws-amplify/core@2.3.0 deduped\r\n│ │ ├─┬ @aws-amplify/cache@2.1.8\r\n│ │ │ ├── @aws-amplify/core@2.3.0 deduped\r\n│ │ ├─┬ @aws-amplify/core@2.3.0\r\n│ ├─┬ @aws-amplify/auth@2.1.8\r\n│ │ ├── @aws-amplify/cache@2.1.8 deduped\r\n│ │ ├── @aws-amplify/core@2.3.0 deduped\r\n│ ├─┬ @aws-amplify/cache@2.1.8\r\n│ │ ├── @aws-amplify/core@2.3.0 deduped\r\n│ ├─┬ @aws-amplify/core@2.3.0\r\n│ ├─┬ @aws-amplify/datastore@1.2.0\r\n│ │ ├── @aws-amplify/api@2.2.1 deduped\r\n│ │ ├─┬ @aws-amplify/core@2.3.0\r\n│ │ ├── UNMET PEER DEPENDENCY @aws-amplify/pubsub@2.1.9 deduped\r\n│ ├─┬ @aws-amplify/interactions@2.1.8\r\n│ │ ├─┬ @aws-amplify/core@2.3.0\r\n│ ├─┬ @aws-amplify/predictions@2.1.8\r\n│ │ ├─┬ @aws-amplify/core@2.3.0\r\n│ │ ├── @aws-amplify/storage@2.2.3 deduped\r\n│ ├─┬ UNMET PEER DEPENDENCY @aws-amplify/pubsub@2.1.9\r\n│ │ ├─┬ @aws-amplify/auth@2.1.8\r\n│ │ │ ├── @aws-amplify/cache@2.1.8 deduped\r\n│ │ │ ├── @aws-amplify/core@2.3.0 deduped\r\n│ │ ├─┬ @aws-amplify/cache@2.1.8\r\n│ │ │ ├── @aws-amplify/core@2.3.0 deduped\r\n│ │ ├─┬ @aws-amplify/core@2.3.0\r\n│ ├─┬ @aws-amplify/storage@2.2.3\r\n│ │ ├─┬ @aws-amplify/core@2.3.0\r\n│ ├── @aws-amplify/ui@1.2.3\r\n│ ├─┬ @aws-amplify/xr@1.1.8\r\n│ │ ├─┬ @aws-amplify/core@2.3.0\r\nnpm ERR! peer dep missing: @date-io/core@^1.3.6, required by @material-ui/pickers@3.2.10\r\nnpm ERR! peer dep missing: @aws-amplify/auth@^2.1.5, required by @aws-amplify/ui-components@0.4.1\r\nnpm ERR! peer dep missing: @aws-amplify/core@^2.2.4, required by @aws-amplify/ui-components@0.4.1\r\nnpm ERR! peer dep missing: @aws-amplify/pubsub@^1.2.4, required by @aws-amplify/api@2.2.1\r\nnpm ERR! peer dep missing: @aws-amplify/pubsub@^1.2.4, required by @aws-amplify/api@2.2.1\r\nnpm ERR! peer dep missing: @react-native-community/netinfo@^5.5.0, required by @aws-amplify/core@2.3.0\r\nnpm ERR! peer dep missing: @react-native-community/netinfo@^5.5.0, required by @aws-amplify/core@2.3.0\r\nnpm ERR! peer dep missing: @react-native-community/netinfo@^5.5.0, required by @aws-amplify/core@2.3.0\r\nnpm ERR! peer dep missing: @react-native-community/netinfo@^5.5.0, required by @aws-amplify/core@2.3.0\r\nnpm ERR! peer dep missing: @react-native-community/netinfo@^5.5.0, required by @aws-amplify/core@2.3.0\r\nnpm ERR! peer dep missing: @react-native-community/netinfo@^5.5.0, required by @aws-amplify/core@2.3.0\r\nnpm ERR! peer dep missing: @aws-amplify/pubsub@^1.2.4, required by @aws-amplify/api@2.2.1\r\nnpm ERR! peer dep missing: @aws-amplify/pubsub@^1.2.4, required by @aws-amplify/api@2.2.1\r\nnpm ERR! peer dep missing: @react-native-community/netinfo@^5.5.0, required by @aws-amplify/core@2.3.0\r\nnpm ERR! peer dep missing: @react-native-community/netinfo@^5.5.0, required by @aws-amplify/core@2.3.0\r\nnpm ERR! peer dep missing: @react-native-community/netinfo@^5.5.0, required by @aws-amplify/core@2.3.0\r\nnpm ERR! peer dep missing: @react-native-community/netinfo@^5.5.0, required by @aws-amplify/core@2.3.0\r\nnpm ERR! peer dep missing: @react-native-community/netinfo@^5.5.0, required by @aws-amplify/core@2.3.0\r\nnpm ERR! peer dep missing: @react-native-community/netinfo@^5.5.0, required by @aws-amplify/core@2.3.0\r\nnpm ERR! peer dep missing: @react-native-community/netinfo@^5.5.0, required by @aws-amplify/core@2.3.0\r\nnpm ERR! peer dep missing: typescript@>=2.8.0 || >= 3.2.0-dev || >= 3.3.0-dev || >= 3.4.0-dev || >= 3.5.0-dev || >= 3.6.0-dev || >= 3.6.0-beta || >= 3.7.0-dev || >= 3.7.0-beta, required by tsutils@3.17.1\r\nnpm ERR! peer dep missing: typescript@>=2.8.0 || >= 3.2.0-dev || >= 3.3.0-dev || >= 3.4.0-dev || >= 3.5.0-dev || >= 3.6.0-dev || >= 3.6.0-beta || >= 3.7.0-dev || >= 3.7.0-beta, required by tsutils@3.17.1\r\n```","upvoteCount":3,"comments":{"edges":[{"node":{"author":{"login":"Fanner487"},"body":"I'm getting the exact same issue/error too. I just rolled back my package version to use the last version from `^3.2.7` to `3.2.6` and it's now working again. Hopefully, this issue can be resolved.\r\n\r\nHope this helps you too!"}},{"node":{"author":{"login":"hyprstack"},"body":"> I'm getting the exact same issue/error too. I just rolled back my package version to use the last version from `^3.2.7` to `3.2.6` and it's now working again. Hopefully, this issue can be resolved.\r\n> \r\n> Hope this helps you too!\r\n\r\n@Fanner487 This didn't resolve my issue unfortunately, but I rolled back so that my package.json looked like\r\n\r\n```javascript\r\n \"dependencies\": {\r\n    \"@date-io/moment\": \"^2.0.1\",\r\n    \"@fortawesome/fontawesome-svg-core\": \"^1.2.26\",\r\n    \"@fortawesome/free-brands-svg-icons\": \"^5.12.0\",\r\n    \"@fortawesome/free-solid-svg-icons\": \"^5.12.0\",\r\n    \"@fortawesome/react-fontawesome\": \"^0.1.8\",\r\n    \"@material-ui/core\": \"^4.8.3\",\r\n    \"@material-ui/icons\": \"^4.5.1\",\r\n    \"@material-ui/lab\": \"^4.0.0-alpha.40\",\r\n    \"@material-ui/pickers\": \"^3.2.9\",\r\n    \"@testing-library/jest-dom\": \"^4.2.4\",\r\n    \"@testing-library/react\": \"^9.4.0\",\r\n    \"@testing-library/user-event\": \"^7.2.1\",\r\n    \"aws-amplify\": \"^2.2.1\",\r\n    \"aws-amplify-react\": \"^3.1.9\",\r\n    \"aws-amplify-react-native\": \"^2.2.3\",\r\n    \"aws-sdk\": \"^2.608.0\",\r\n    \"axios\": \"^0.19.2\",\r\n    \"local-storage\": \"^2.0.0\",\r\n    \"lodash\": \"^4.17.15\",\r\n    \"moment\": \"^2.24.0\",\r\n    \"nconf\": \"^0.10.0\",\r\n    \"react\": \"^16.12.0\",\r\n    \"react-dom\": \"^16.12.0\",\r\n    \"react-redux\": \"^7.1.3\",\r\n    \"react-router-dom\": \"^5.1.2\",\r\n    \"react-scripts\": \"^3.4.0\",\r\n    \"redux\": \"^4.0.5\",\r\n    \"typeface-roboto\": \"0.0.75\",\r\n    \"uuid\": \"^3.4.0\"\r\n  }\r\n```\r\n\r\nThis has worked to resolve my immediate issue. \r\n\r\nHowever I am hoping that the Amplify team can get back to me with an answer to this issue."}},{"node":{"author":{"login":"ryanhinojosa"},"body":"I'm getting this exact same error while moving from Amplify 2.x to 3. Any guidance here would be enormously helpful!"}},{"node":{"author":{"login":"ryanhinojosa"},"body":"I was able to get past this error by:\r\n- Removing all Amplify dependencies in package.json\r\n- Deleting package-lock.json\r\n- Deleting node_modules\r\n- npm install aws-amplify @aws-amplify/ui-react\r\n- Going to this page ([https://docs.amplify.aws/lib/auth/start/q/platform/js#configure-your-application](https://docs.amplify.aws/lib/auth/start/q/platform/js#configure-your-application)) and starting with the section \"Re-use existing authentication resource\" since I already had a Cognito back-end set up.\r\n\r\nHopefully this works for you.\r\n"}},{"node":{"author":{"login":"manueliglesias"},"body":"Hi @hyprstack \r\n\r\nI noticed you have this in your `package.json`:\r\n\r\n```\r\n    \"aws-amplify\": \"^2.2.1\",\r\n    \"aws-amplify-react\": \"^3.1.9\",\r\n    \"aws-amplify-react-native\": \"^2.2.3\",\r\n```\r\nI think you don't need both `aws-amplify-react` and `aws-amplify-react-native` in your project, typically you use one or the other depending on your platform. Also, can you try using the latest versions and make sure you remove your `node_modules` and lock files (`yarn.lock` and `package-lock.json`)?\r\n\r\nBasically, @ryanhinojosa 's suggestions \r\n\r\nLet us know how it goes"}},{"node":{"author":{"login":"qtagtech"},"body":"I found out that by mistake I had both @aws-amplify/core@3.2.7(latest) and aws-amplify@3.0.10 (one before the latest). I updated to just have aws-amplify 3.0.11 and it worked again. I say again because before in a different branch the project was with @aws-amplify/core@^3.2.7 and aws-amplify@^3.0.10. Probably it was installing both the latest versions and not having the conflict? It might just give some light into the problem."}},{"node":{"author":{"login":"hyprstack"},"body":"@manueliglesias I had deleted my node modules and lock file as describe above. Also please notice in my initial post, where the error is occurring, my package.json only contains \"@aws-amplify/auth\": \"^3.2.7\",  \"@aws-amplify/ui-react\": \"^0.2.6\" and \"aws-amplify\": \"^2.3.0\".\r\n@qtagtech thanks I will give this a try and let you know.\r\n\r\nthanks"}},{"node":{"author":{"login":"alexandprivate"},"body":"> I was able to get past this error by:\r\n> \r\n> * Removing all Amplify dependencies in package.json\r\n> * Deleting package-lock.json\r\n> * Deleting node_modules\r\n> * npm install aws-amplify @aws-amplify/ui-react\r\n> * Going to this page ([docs.amplify.aws/lib/auth/start/q/platform/js#configure-your-application](https://docs.amplify.aws/lib/auth/start/q/platform/js#configure-your-application)) and starting with the section \"Re-use existing authentication resource\" since I already had a Cognito back-end set up.\r\n> \r\n> Hopefully this works for you.\r\n\r\nI can confirm this works for me! Thanks @ryanhinojosa "}},{"node":{"author":{"login":"hyprstack"},"body":"I am still unable to replicate the fix provided by @ryanhinojosa . I have in the meantime used an entirely new laptop and tried following the solution provided above. I then tried following the docs and used the `AmplifyAuthenticator` component. With the docs from using an already existing user pool, there was no login page and the app simply seemed to proceed as if the user was logged in, although I had cleared the local storage and cache.\r\n\r\nFor now it seems I am going to keep using the previous version and logical flow."}},{"node":{"author":{"login":"iaarnio"},"body":"I had these amplify dependencies:\r\n```\r\n\"@aws-amplify/api\": \"latest\",\r\n\"@aws-amplify/auth\": \"^3.2.13\",\r\n\"@aws-amplify/pubsub\": \"latest\",\r\n\"aws-amplify\": \"^3.0.7\",\r\n\"aws-amplify-react\": \"^4.1.6\",\r\n```\r\nHard locking the versions to few days older versions (and removing node_modules and the lock file) fixed the issue for me:\r\n```\r\n\"@aws-amplify/api\": \"3.1.15\",\r\n\"@aws-amplify/auth\": \"3.2.12\",\r\n\"@aws-amplify/pubsub\": \"3.0.16\",\r\n\"aws-amplify\": \"3.0.16\",\r\n\"aws-amplify-react\": \"4.1.15\",\r\n```\r\n"}},{"node":{"author":{"login":"JohanAltamar"},"body":"> I was able to get past this error by:\r\n> \r\n> * Removing all Amplify dependencies in package.json\r\n> * Deleting package-lock.json\r\n> * Deleting node_modules\r\n> * npm install aws-amplify @aws-amplify/ui-react\r\n> * Going to this page (https://docs.amplify.aws/lib/auth/start/q/platform/js#configure-your-application) and starting with the section \"Re-use existing authentication resource\" since I already had a Cognito back-end set up.\r\n> \r\n> Hopefully this works for you.\r\n\r\nStill working :)"}},{"node":{"author":{"login":"ashika01"},"body":"@hyprstack Usually this happens in case one dependencies not being linked to each other properly. Either use all latest version or using all pinned version should help you fix this issue. \r\n\r\nIn cases of migrating from 2.x to 3.x, @ryanhinojosa suggestion is spot on. In most cases, a need to delete anything cached and reinstalling should solve it for you. \r\n\r\nLet me know if this solves the problem."}},{"node":{"author":{"login":"imhashir"},"body":"Tried everything above but none worked. Updated versions as below and it started working fine:\r\n\r\n```\r\n\"aws-amplify\": \"3.3.3\",\r\n\"aws-amplify-react-native\": \"4.2.7\",\r\n```"}},{"node":{"author":{"login":"wei"},"body":"As @ashika01 said. It is mostly likely caused by mismatching versions between the amplify ui-component package and `aws-amplify` package. I get this when I upgrade `aws-amplify` but forgot to update amplify ui-component or vise-versa.\r\n\r\nPlease install the latest using\r\n```\r\nyarn add aws-amplify@latest\r\nyarn add @aws-amplify/ui-react@latest  # or any other amplify ui component package\r\n```\r\nand it should work fine. If not, remove `node_modules` first before attempting it again."}},{"node":{"author":{"login":"nubpro"},"body":"Can't believe I hit this error too. I was simply following along the basic tutorial to setup a React project. https://docs.amplify.aws/start/getting-started/installation/q/integration/react\r\n\r\nCome on, make this easier for beginners please. I'd really wonder how many of them spend more than a couple of hours trying to figure out why their app is not working, they'd probably stuck and gave up. They are punished for not looking through the console logs.\r\n"}},{"node":{"author":{"login":"ktmdan"},"body":"For anyone that is still getting the error the solution was to add this Auth.configure(awsconfig); after your Amplify.configure(awsconfig);.  "}},{"node":{"author":{"login":"IanPhilips"},"body":"When I reimported `Auth` in different files the configuration I made in `App.js` wasn't propagating, so I stored the `Auth` post configuration in my React context a la:   \r\n```import Amplify, { Auth } from 'aws-amplify';\r\nimport awsmobile from '../src/aws-exports';\r\nAmplify.configure(awsmobile);\r\nAuth.configure(awsmobile);\r\n\r\nconst initialState = {\r\n    amplifyAuth:Auth,\r\n};\r\nconst store = createContext(initialState);\r\n```  \r\n\r\nthen accessed it later via `useContext(store)`, check out [React Context](https://reactjs.org/docs/context.html)  \r\n\r\nThere are other ways to access the Auth object after configuring it though, so do whatever makes sense for you. I'm new to React contexts so I may be hammering a screw here."}},{"node":{"author":{"login":"cloud-github"},"body":"Make sure package version is right!\r\n\r\nThis package combination don't work.\r\n\r\n`\"aws-amplify\": \"^4.0.3\",\r\n    \"aws-amplify-react\": \"^5.0.1\",`\r\n\r\nThis package combination works fine.\r\n`\"aws-amplify\": \"^3.3.27\",\r\n    \"aws-amplify-react\": \"^4.2.31\",`\r\n\r\n\r\n\r\n\r\n\r\n\r\n"}},{"node":{"author":{"login":"jrc"},"body":"I ran into this using React Native. The trick is to call `Amplify.configure()`, documented in https://docs.amplify.aws/lib/auth/start/q/platform/js/#configure-your-application. This step is missing in the \"Add authentication\" section of the Amplify \"Getting Started\" tutorials at e.g. https://docs.amplify.aws/start/getting-started/auth/q/integration/react-native/.\r\n\r\nUpdate: It's actually there, at the bottom of a previous page, at https://docs.amplify.aws/start/getting-started/setup/q/integration/react-native/#install-amplify-libraries\r\n\r\n```\r\nimport Amplify from 'aws-amplify'\r\nimport config from './src/aws-exports'\r\nAmplify.configure(config)\r\n```"}},{"node":{"author":{"login":"hyprstack"},"body":"I since then upgraded to `\"aws-amplify\": \"^4.3.12\"` and `\"@aws-amplify/ui-react\": \"^2.1.8\"` as shown in my `package.json` file:\r\n\r\n```javascript\r\n{\r\n  \"name\": \"demo-app\",\r\n  \"version\": \"0.1.0\",\r\n  \"private\": true,\r\n  \"dependencies\": {\r\n    \"@aws-amplify/ui-react\": \"^2.1.8\",\r\n    \"@emotion/react\": \"^11.7.1\",\r\n    \"@emotion/styled\": \"^11.6.0\",\r\n    \"@material-ui/core\": \"^4.12.3\",\r\n    \"@mui/icons-material\": \"^5.3.0\",\r\n    \"@mui/material\": \"^5.2.8\",\r\n    \"@testing-library/jest-dom\": \"^5.16.1\",\r\n    \"@testing-library/react\": \"^12.1.2\",\r\n    \"@testing-library/user-event\": \"^13.5.0\",\r\n    \"aws-amplify\": \"^4.3.12\",\r\n    \"exifr\": \"^7.1.3\",\r\n    \"i18next\": \"^21.6.6\",\r\n    \"i18next-browser-languagedetector\": \"^6.1.2\",\r\n    \"i18next-http-backend\": \"^1.3.1\",\r\n    \"ol\": \"^6.12.0\",\r\n    \"pure-md5\": \"^0.1.13\",\r\n    \"react\": \"^17.0.2\",\r\n    \"react-dom\": \"^17.0.2\",\r\n    \"react-i18next\": \"^11.15.3\",\r\n    \"react-redux\": \"^7.2.6\",\r\n    \"react-router-dom\": \"^6.2.1\",\r\n    \"react-scripts\": \"5.0.0\",\r\n    \"web-vitals\": \"^2.1.2\"\r\n  },\r\n  \"scripts\": {\r\n    \"start\": \"react-scripts start\",\r\n    \"build\": \"react-scripts build\",\r\n    \"test\": \"react-scripts test\",\r\n    \"eject\": \"react-scripts eject\",\r\n    \"prepare\": \"husky install\",\r\n    \"pretty\": \"prettier --write \\\"./**/*.{js,jsx,json}\\\"\"\r\n  },\r\n  \"eslintConfig\": {\r\n    \"extends\": [\r\n      \"react-app\",\r\n      \"react-app/jest\"\r\n    ]\r\n  },\r\n  \"browserslist\": {\r\n    \"production\": [\r\n      \">0.2%\",\r\n      \"not dead\",\r\n      \"not op_mini all\"\r\n    ],\r\n    \"development\": [\r\n      \"last 1 chrome version\",\r\n      \"last 1 firefox version\",\r\n      \"last 1 safari version\"\r\n    ]\r\n  },\r\n  \"devDependencies\": {\r\n    \"husky\": \"^7.0.4\",\r\n    \"lint-staged\": \"^12.1.7\",\r\n    \"prettier\": \"^2.5.1\"\r\n  },\r\n  \"lint-staged\": {\r\n    \"*.{js,css,md}\": \"prettier --write\"\r\n  }\r\n}\r\n```\r\n\r\nI *have also* updated my config file located in the public folder:\r\n\r\n```javascript\r\nconst CONFIG = {\r\n  AWS: {\r\n    aws_appsync_graphqlEndpoint:\r\n      \"https://xxxxxxxxxxxxxxxxxx.appsync-api.sa-xxxx.amazonaws.com/graphql\",\r\n    aws_appsync_region: \"sa-xxxxx\",\r\n    aws_appsync_authenticationType: \"AMAZON_COGNITO_USER_POOLS\",\r\n    identityPoolId: \"sa-east-1:xxxxxxxxxxxxxxxxx\",\r\n    region: \"sa-xxxxx\",\r\n    aws_user_files_s3_bucket_region: \"sa-xxxxx\",\r\n    aws_content_delivery_bucket_region: \"sa-xxxxx\",\r\n    aws_user_files_s3_bucket: \"dev-content-xxxxxxxxx\",\r\n    identityPoolRegion: \"sa-xxxxx\",\r\n    userPoolId: \"sa-xxxxxx_xxxxxxxxx\",\r\n    userPoolWebClientId: \"xxxxxxxxx\",\r\n    authenticationFlowType: \"USER_PASSWORD_AUTH\",\r\n  },\r\n};\r\n```\r\n\r\nWith my `App.js` now looking like this:\r\n\r\n```javascript\r\nimport React from \"react\";\r\nimport Router from \"./router\";\r\nimport { MuiThemeProvider } from \"@material-ui/core/styles\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport \"./App.css\";\r\nimport theme from \"./themes\";\r\nimport CssBaseline from \"@mui/material/CssBaseline\";\r\n\r\nclass App extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      loggedIn: props.loggedIn,\r\n      ready: false,\r\n    };\r\n  }\r\n\r\n  async componentDidMount() {\r\n    const {\r\n      props: {\r\n        user: {\r\n          signInUserSession: {\r\n            accessToken: { payload },\r\n          },\r\n        },\r\n      },\r\n    } = this;\r\n\r\n    this.setState({ ready: true });\r\n  }\r\n\r\n  render() {\r\n    const { loggedIn, ready } = this.state;\r\n\r\n    if (!loggedIn || !ready) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <MuiThemeProvider theme={theme}>\r\n        <CssBaseline />\r\n        <div className=\"App\">\r\n          <Router signOut={this.props.signOut} />\r\n        </div>\r\n      </MuiThemeProvider>\r\n    );\r\n  }\r\n}\r\n\r\nexport default connect(null)(App);\r\n```\r\n\r\n`index.js`\r\n\r\n```javascript\r\nimport React, { Suspense } from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport { Provider } from \"react-redux\";\r\n\r\nimport store from \"./redux/store\";\r\nimport AuthWrapper from \"./AuthWrapper\";\r\nimport \"./index.css\";\r\nimport reportWebVitals from \"./reportWebVitals\";\r\nimport \"./i18n\";\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <Provider store={store}>\r\n      <Suspense fallback={null}>\r\n        <AuthWrapper />\r\n      </Suspense>\r\n    </Provider>\r\n  </React.StrictMode>,\r\n  document.getElementById(\"root\")\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n```\r\n\r\nAnd `AuthWrapper.js`:\r\n\r\n```javascript\r\nimport React, { useEffect, useState } from \"react\";\r\nimport Amplify, { I18n } from \"aws-amplify\";\r\nimport { Authenticator, View } from \"@aws-amplify/ui-react\";\r\nimport \"@aws-amplify/ui-react/styles.css\";\r\nimport { translations } from \"@aws-amplify/ui\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport LanguageSelect from \"./components/languageSelect\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport App from \"./App\";\r\nimport \"./App.css\";\r\n\r\n/*global CONFIG */\r\nAmplify.configure(CONFIG.AWS);\r\n\r\nconst components = {\r\n  Header() {\r\n    return (\r\n      <View as=\"section\">\r\n        <LanguageSelect />\r\n      </View>\r\n    );\r\n  },\r\n};\r\n\r\nconst AuthWrapper = (props) => {\r\n  const { language } = props;\r\n  const { t } = useTranslation();\r\n  const [lng, setLng] = useState(language);\r\n\r\n  useEffect(() => {\r\n    const placeholderSpanishVocab = t(\"awsAmplifySignIn\");\r\n    I18n.putVocabularies(translations);\r\n    I18n.putVocabulariesForLanguage(\"es\", placeholderSpanishVocab);\r\n    I18n.setLanguage(language);\r\n  });\r\n\r\n  useEffect(() => {\r\n    setLng(language);\r\n  }, [language, setLng]);\r\n\r\n  useEffect(() => {\r\n    if (language !== lng) {\r\n      I18n.setLanguage(language);\r\n    }\r\n  }, [language, lng]);\r\n\r\n  return (\r\n    <Authenticator components={components}>\r\n      {(props) => {\r\n        return <App {...props} loggedIn={true} />;\r\n      }}\r\n    </Authenticator>\r\n  );\r\n};\r\n\r\nconst mapStateToProps = (state) => {\r\n  const { lng: language } = state;\r\n  return { language };\r\n};\r\n\r\nexport default connect(mapStateToProps, null)(AuthWrapper);\r\n```\r\n\r\nHope this helps people coming here looking for answers ✌️ "}},{"node":{"author":{"login":"styled-man"},"body":"I'm getting this error now and I'm not even using auth"}}]}}},{"node":{"id":"D_kwDOBkswNc4AQDHd","author":{"login":"ggalantucc"},"title":"How to send username and temporary password in separate messages","body":"Hi,\r\nI'm testing Cognito as IdP and checking all available options.\r\nI'm now working on admin users creation and on lambda functions to customize welcome email.\r\nI was wondering if it's somehow possible to use lambda functions to send username and temporary password on separate emails or even email + sms.\r\nI know that through AWS Cognito default Message customization as per the service design user name and temporary password are getting sent in to the same email. The custom message must contain the {username} and {####} placeholders. \r\nIs it possible to split for a better security uername and temporary password in 2 distinct messages ?\r\n\r\nThanks\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb244OTA1","author":{"login":"Zanndorin"},"title":"Getting user attributes related to item ownership.","body":"Hi, Copying from https://stackoverflow.com/questions/62739796/amplify-get-owner-user-attributes-from-cognito\r\n\r\nIs it possible / Is there an easy way to access user attributes from an item owner (i.e. Cognito user id)? \r\n\r\n```\r\ntype Item\r\n@model\r\n@auth(rules: [\r\n    { allow: owner},\r\n    { allow: groups, groups: [\"Admin\"] },\r\n    { allow: private, operations: [read] },\r\n    { allow: public, operations: [read] }\r\n])\r\n{\r\n    id: ID!\r\n    title: String!\r\n    description: String\r\n}\r\n```\r\n\r\n```\r\n{\r\n  \"__typename\": \"Item\",\r\n  \"_lastChangedAt\": 1593707126605,\r\n  \"_version\": 1,\r\n  \"createdAt\": \"2020-07-02T16:25:26.582Z\",\r\n  \"description\": \"Description\",\r\n  \"id\": \"0592fcd8-408e-406e-84bf-9f63eb43e147\",\r\n  \"owner\": \"2b10fb7e-4472-43c9-9bb9-54219b5027a3\",\r\n  \"title\": \"Item\",\r\n  \"updatedAt\": \"2020-07-02T16:25:26.582Z\"\r\n}\r\n```","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"RossWilliams"},"body":"you can use a  function resolver on a 'cognitoAttributes' field. The lambda function can call admin-get-user in Cognito and return the attributes. The lambda function will receive the dynamo Item in the event.source property so you will have access to the owner id to make the call to Cognito.\r\n\r\n```gql\r\ntype Item\r\n@model\r\n@auth(rules: [\r\n    { allow: owner},\r\n    { allow: groups, groups: [\"Admin\"] },\r\n    { allow: private, operations: [read] },\r\n    { allow: public, operations: [read] }\r\n])\r\n{\r\n    id: ID!\r\n    title: String!\r\n    cognitoAttributes: [String]! @function('cognitoGetUserAttributes-${env})\r\n    description: String\r\n}\r\n```"}}]}}},{"node":{"id":"D_kwDOBkswNc4AQBMr","author":{"login":"beevor"},"title":"In AWS Amplify, is it possible to have two separate teams (repos) working on the frontend and backend separately?","body":"I would like to develop a React app using Amplify and two dev teams. Can one team work on the frontend exclusively, without giving them access to the backend code (the amplify folder)? The backend team can have access to both the backend and frontend code. If possible, how would I set it up?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AP_no","author":{"login":"dsws"},"title":"Not catching iOS notification when app is closed","body":"I'm using Amplify for push notifications\r\nhttps://docs.amplify.aws/lib/push-notifications/getting-started/q/platform/js/\r\n\r\nI'm using the plugin https://github.com/react-native-push-notification/ios\r\nFollowed the instructions provided.\r\n\r\nWhen the app is open in the background, the handlers PushNotification.onNotificationOpened and PushNotificationIOS.addEventListener are catching the notification\r\n\r\nWhen the app is closed and I click on the IOS notification, the event is not getting caught.\r\n\r\nYour feedback would be appreciated on how to move forward. Been stuck on this for too long :(\r\n\r\nyarn list v1.22.19\r\n├─ @aws-amplify/analytics@5.2.11\r\n├─ @aws-amplify/api-graphql@2.3.8\r\n├─ @aws-amplify/api-rest@2.0.44\r\n├─ @aws-amplify/api@4.0.44\r\n├─ @aws-amplify/auth@4.5.8\r\n├─ @aws-amplify/cache@4.0.46\r\n├─ @aws-amplify/core@4.5.8\r\n├─ @aws-amplify/datastore@3.12.1\r\n├─ @aws-amplify/geo@1.3.7\r\n├─ @aws-amplify/interactions@4.0.44\r\n├─ @aws-amplify/predictions@4.0.44\r\n├─ @aws-amplify/pubsub@4.4.5\r\n├─ @aws-amplify/pushnotification@4.3.23\r\n├─ @aws-amplify/storage@4.4.27\r\n├─ @aws-amplify/ui@2.0.5\r\n├─ @aws-amplify/xr@3.0.44\r\n├─ aws-amplify-react-native@6.0.5\r\n└─ aws-amplify@4.3.26\r\n\r\nSetting in IOS Signing and Capabilities\r\n![Screen Shot 2022-07-04 at 11 59 33 AM](https://user-images.githubusercontent.com/60757593/177189114-539bc07d-9420-4f50-8592-bc9f207a2593.png)\r\n\r\n\r\n\r\n\r\n#import \"AppDelegate.h\"\r\n#import <React/RCTBridge.h>\r\n#import <React/RCTBundleURLProvider.h>\r\n#import <React/RCTRootView.h>\r\n#import <React/RCTLinkingManager.h>\r\n#import \"RNBootSplash.h\"\r\n#import <UserNotifications/UserNotifications.h>\r\n#import <RNCPushNotificationIOS.h>\r\n\r\n// #ifdef FB_SONARKIT_ENABLED\r\n// #import <FlipperKit/FlipperClient.h>\r\n// #import <FlipperKitLayoutPlugin/FlipperKitLayoutPlugin.h>\r\n// #import <FlipperKitUserDefaultsPlugin/FKUserDefaultsPlugin.h>\r\n// #import <FlipperKitNetworkPlugin/FlipperKitNetworkPlugin.h>\r\n// #import <SKIOSNetworkPlugin/SKIOSNetworkAdapter.h>\r\n// #import <FlipperKitReactPlugin/FlipperKitReactPlugin.h>\r\n#import <React/RCTLinkingManager.h>\r\n\r\n\r\n// static void InitializeFlipper(UIApplication *application) {\r\n//   FlipperClient *client = [FlipperClient sharedClient];\r\n//   SKDescriptorMapper *layoutDescriptorMapper = [[SKDescriptorMapper alloc] initWithDefaults];\r\n//   [client addPlugin:[[FlipperKitLayoutPlugin alloc] initWithRootNode:application withDescriptorMapper:layoutDescriptorMapper]];\r\n//   [client addPlugin:[[FKUserDefaultsPlugin alloc] initWithSuiteName:nil]];\r\n//   [client addPlugin:[FlipperKitReactPlugin new]];\r\n//   [client addPlugin:[[FlipperKitNetworkPlugin alloc] initWithNetworkAdapter:[SKIOSNetworkAdapter new]]];\r\n//   [client start];\r\n// }\r\n// #endif\r\n\r\n\r\n@implementation AppDelegate\r\n\r\n- (BOOL)application:(UIApplication *)application openURL:(NSURL *)url\r\n  sourceApplication:(NSString *)sourceApplication annotation:(id)annotation\r\n{\r\n  return [RCTLinkingManager application:application openURL:url\r\n                      sourceApplication:sourceApplication annotation:annotation];\r\n}\r\n\r\n// Only if your app is using [Universal Links](https://developer.apple.com/library/prerelease/ios/documentation/General/Conceptual/AppSearch/UniversalLinks.html).\r\n- (BOOL)application:(UIApplication *)application continueUserActivity:(NSUserActivity *)userActivity\r\n restorationHandler:(void (^)(NSArray * _Nullable))restorationHandler\r\n{\r\n return [RCTLinkingManager application:application\r\n                  continueUserActivity:userActivity\r\n                    restorationHandler:restorationHandler];\r\n}\r\n\r\n- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions\r\n{\r\n// #ifdef FB_SONARKIT_ENABLED\r\n//   InitializeFlipper(application);\r\n// #endif\r\n\r\n  RCTBridge *bridge = [[RCTBridge alloc] initWithDelegate:self launchOptions:launchOptions];\r\n  RCTRootView *rootView = [[RCTRootView alloc] initWithBridge:bridge\r\n                                                   moduleName:@\"BoatLink\"\r\n                                            initialProperties:nil];\r\n\r\n  UNUserNotificationCenter *center = [UNUserNotificationCenter currentNotificationCenter];\r\n  center.delegate = self;\r\n\r\n  if (@available(iOS 13.0, *)) {\r\n      rootView.backgroundColor = [UIColor systemBackgroundColor];\r\n  } else {\r\n      rootView.backgroundColor = [UIColor whiteColor];\r\n  }\r\n\r\n  self.window = [[UIWindow alloc] initWithFrame:[UIScreen mainScreen].bounds];\r\n  UIViewController *rootViewController = [UIViewController new];\r\n  rootViewController.view = rootView;\r\n  self.window.rootViewController = rootViewController;\r\n  [self.window makeKeyAndVisible];\r\n  [RNBootSplash initWithStoryboard:@\"LaunchScreen\" rootView:rootView];\r\n  return YES;\r\n}\r\n\r\n- (NSURL *)sourceURLForBridge:(RCTBridge *)bridge\r\n{\r\n#if DEBUG\r\n  return [[RCTBundleURLProvider sharedSettings] jsBundleURLForBundleRoot:@\"index\" fallbackResource:nil];\r\n#else\r\n  return [[NSBundle mainBundle] URLForResource:@\"main\" withExtension:@\"jsbundle\"];\r\n#endif\r\n}\r\n\r\n- (BOOL)application:(UIApplication *)application\r\n   openURL:(NSURL *)url\r\n   options:(NSDictionary<UIApplicationOpenURLOptionsKey,id> *)options\r\n{\r\n  return [RCTLinkingManager application:application openURL:url options:options];\r\n}\r\n\r\n// Required for the register event.\r\n- (void)application:(UIApplication *)application didRegisterForRemoteNotificationsWithDeviceToken:(NSData *)deviceToken\r\n{\r\n [RNCPushNotificationIOS didRegisterForRemoteNotificationsWithDeviceToken:deviceToken];\r\n}\r\n// Required for the notification event. You must call the completion handler after handling the remote notification.\r\n- (void)application:(UIApplication *)application didReceiveRemoteNotification:(NSDictionary *)userInfo\r\nfetchCompletionHandler:(void (^)(UIBackgroundFetchResult))completionHandler\r\n{\r\n  [RNCPushNotificationIOS didReceiveRemoteNotification:userInfo fetchCompletionHandler:completionHandler];\r\n}\r\n// Required for the registrationError event.\r\n- (void)application:(UIApplication *)application didFailToRegisterForRemoteNotificationsWithError:(NSError *)error\r\n{\r\n [RNCPushNotificationIOS didFailToRegisterForRemoteNotificationsWithError:error];\r\n}\r\n// Required for localNotification event\r\n- (void)userNotificationCenter:(UNUserNotificationCenter *)center\r\ndidReceiveNotificationResponse:(UNNotificationResponse *)response\r\n         withCompletionHandler:(void (^)(void))completionHandler\r\n{\r\n  [RNCPushNotificationIOS didReceiveNotificationResponse:response];\r\n}\r\n\r\n-(void)userNotificationCenter:(UNUserNotificationCenter *)center willPresentNotification:(UNNotification *)notification withCompletionHandler:(void (^)(UNNotificationPresentationOptions options))completionHandler\r\n{\r\n  completionHandler(UNNotificationPresentationOptionSound | UNNotificationPresentationOptionAlert | UNNotificationPresentationOptionBadge);\r\n}\r\n\r\n@end\r\n\r\n\r\n\r\n\r\n\r\n#import <React/RCTBridgeDelegate.h>\r\n#import <UIKit/UIKit.h>\r\n#import <UserNotifications/UNUserNotificationCenter.h>\r\n\r\n@interface AppDelegate : UIResponder <UIApplicationDelegate, RCTBridgeDelegate, UNUserNotificationCenterDelegate>\r\n\r\n@property (nonatomic, strong) UIWindow *window;\r\n\r\n@end\r\n\r\n\r\n\r\n","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"dsws"},"body":"So after long annoying debugging sessions, @twointo2 found the correct answer :)\r\n\r\nWhen you add this function call at the top, then onNotificationOpened starts getting the notification when app was killed.\r\n\r\nPushNotificationIOS.getInitialNoticiation()"}}]}}},{"node":{"id":"D_kwDOBkswNc4AP_0a","author":{"login":"simonboland"},"title":"Amplify UI login with a custom OIDC provider","body":"I am building a proof of concept to allow users to sign in through a federated login with OIDC to Azure. I'm having trouble getting the React frontend with Amplify to show my OIDC login option.\r\n\r\n**Cognito setup**\r\nI have set up a cognito user pool outside of Amplify with the following steps:\r\n\r\n1. Set up a Cognito user pool\r\n2. Set up an OIDC provider with Azure and confirmed that the discovery works.  This is called AzureOIDC.  I also added Google as a Federated identity. \r\n3. Set up a web App Client (no secret key)\r\n4. Under Cognito -> App integration, I set up the domain name and under App Client webclients, I added the following identity providers\r\n- AzureOIDC \r\n- Google\r\n- Cognito User Pool\r\n\r\n![image](https://user-images.githubusercontent.com/31790674/177230235-866e258f-7650-4df3-a2c7-86f8c19e0e2e.png)\r\n\r\nCallback and Signout URLs are simply http://localhost:3000/ for testing\r\nOAuth 2.0 flows are Authorization Code and Implicit grants and Allowed OAuth Scopes are email, openid, aws.cognito.signin.user.admin and profile. \r\n\r\nWhen I run the hosted UI, I see:  \r\n![image](https://user-images.githubusercontent.com/31790674/177230273-836e265c-7767-4b37-a417-1c0abd5a7c5a.png)\r\n\r\n**Amplify setup**\r\nThen in Amplify I set up a project and imported the Cognito user pool using the command\r\n\r\n`amplify import auth`\r\n\r\nWhen I run `yarn start`, it shows me the Google and Cognito user pool option but no Azure OIDC.    See the screenshot.\r\n\r\n![image](https://user-images.githubusercontent.com/31790674/177230303-393eefcb-e834-4b7d-811c-a6add06152d4.png)\r\n\r\nMy aws-export.js has no reference to the AzureOIDC.   I would prefer that it redirects to the hosted UI URL. ","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"simonboland"},"body":"I found that the [example](https://github.com/aws-samples/aws-amplify-oidc-federation) in the `amplify-frontend` provides a good example to follow here on how to set up the UI to use a Federated login.   "}}]}}},{"node":{"id":"D_kwDOBkswNc4AOayF","author":{"login":"yuriyseriy"},"title":"Amplify Build failed to complete successfully.","body":"Hello\r\n\r\ni do all the points in [this manual](https://aws.amazon.com/ru/getting-started/hands-on/build-react-app-amplify-graphql/module-three/?e=gs2020&p=build-a-react-app-two), but after step \"Set up CI/CD of the front end and backend\" i get error \"Build failed to complete successfully.\"\r\n\r\nOS: Mac OS 12.1\r\nAmplify CLI 7.6.5\r\n\r\n\r\n**Build log:**\r\n\r\n```# Starting phase: build\r\n2022-01-04T18:19:41.251Z [INFO]: Invalid feature flag configuration\r\n2022-01-04T18:19:41.253Z [INFO]: These feature flags are defined in the \"amplify/cli.json\" configuration file and are unknown to the currently running Amplify CLI:\r\n                                   - project\r\n                                   - graphqltransformer.transformerversion\r\n                                   - graphqltransformer.suppressschemamigrationprompt\r\n                                   - auth.useenabledmfas\r\n                                 This issue likely happens when the project has been pushed with a newer version of Amplify CLI, try updating to a newer version.\r\n                                 Ensure that the CI/CD pipeline is not using an older or pinned down version of Amplify CLI.\r\n                                 Learn more about feature flags: https://docs.amplify.aws/cli/reference/feature-flags\r\n2022-01-04T18:19:41.261Z [ERROR]: !!! Build failed\r\n2022-01-04T18:19:41.262Z [ERROR]: !!! Non-Zero Exit Code detected\r\n2022-01-04T18:19:41.262Z [INFO]: # Starting environment caching...\r\n2022-01-04T18:19:41.262Z [INFO]: # Uploading environment cache artifact...\r\n2022-01-04T18:19:41.326Z [INFO]: # Environment caching completed\r\n```\r\n\r\nOn page [Feature Flags](https://docs.amplify.aws/cli/reference/feature-flags/) i don't see flags:\r\n\r\n- project\r\n- graphqltransformer.transformerversion\r\n- graphqltransformer.suppressschemamigrationprompt\r\n- auth.useenabledmfas\r\n","upvoteCount":10,"comments":{"edges":[{"node":{"author":{"login":"parthipank"},"body":"Im currently having this issue. I have tried modifying the AMPLIFY CLI version to latest in the console but still getting the same error.\r\nIts failing even when both my local and console Amplify CLI version are same. "}},{"node":{"author":{"login":"martinventx"},"body":"I ran in the preBuild step inside the amplify.yaml a npm update, which caused this Problem.\r\n**npm i -g npm@8.3.0**\r\nTry to remove it from the backend preBuild/Build in amplify.yml.\r\nNot sure how it is on your local machine, but guess it also has something todo with the npm version."}},{"node":{"author":{"login":"dodige"},"body":"I had this  same error message while going throught the tutorial\r\nAfter looking around i found that this was coming from the build process in AWS being run to build  my backend.\r\nAfter noting the CLI version on my local machine ( 7.6.5 ) i updated the  the build config side by addiing a pre build section to install a similar CLI version as my local install and it fixed the issue. Tutorial should include this to save grief...\r\n\r\nAnyway here the portion of my application build file that i modify  ( just before the frontend section if you are using one ) :\r\n          \r\n          > \r\n          > \r\n          > version: 1\r\n          > env:\r\n          >   variables:\r\n          >     VERSION_AMPLIFY: 7.6.5\r\n          > backend:\r\n          >   phases:\r\n          >     preBuild:\r\n          >       commands:\r\n          >         - npm i -g @aws-amplify/cli@${VERSION_AMPLIFY}\r\n          >     build:\r\n          >       commands:\r\n          >         - '# Execute Amplify CLI with the helper script'\r\n          >         - amplifyPush --simple\r\n          > \r\n\r\n\r\nTHe application build file can be found in the amplify console of your app, select the \"build settings\" under the \"app setting\" on the left hand side menu.\r\n\r\n\r\nRegards\r\n"}},{"node":{"author":{"login":"sidchopp"},"body":"Thanks @dodige. It worked man. Thanks a lot."}},{"node":{"author":{"login":"mandeepsingh-private"},"body":"I was able to fix it by rolling back the cli locally to my original version locally\r\n\r\n`sudo npm install -g @aws-amplify/cli@7.4.0`\r\n\r\n and then deleting these 2 lines from file amplify/cli.json\r\n\r\nThese feature flags are defined in the \"amplify/cli.json\" configuration file and are unknown to the currently running Amplify CLI:\r\n  - graphqltransformer.securityenhancementnotification\r\n  - graphqltransformer.showfieldauthnotification\r\n"}},{"node":{"author":{"login":"prestonhom"},"body":"@mandeepsingh-private How did you push amplify/cli.json?\r\nHaving trouble deleting those lines and then running `amplify push`. It appears that my changes don't get updated in the cloud when I do."}},{"node":{"author":{"login":"fertrevino"},"body":"I can confirm the problem, the solution provided by @dodige worked for me. In my case _amplify.yml_ in the build settings console had to be replaced with this:\r\n\r\n\r\n```yaml\r\nversion: 1\r\nenv:\r\n  variables:\r\n    VERSION_AMPLIFY: 7.6.26\r\nbackend:\r\n  phases:\r\n    preBuild:\r\n      commands:\r\n        - npm i -g @aws-amplify/cli@${VERSION_AMPLIFY} \r\n    build:\r\n      commands:\r\n        - '# Execute Amplify CLI with the helper script'\r\n        - amplifyPush --simple\r\nfrontend:\r\n  phases:\r\n    preBuild:\r\n      commands:\r\n        - npm install\r\n    build:\r\n      commands:\r\n        - npm run build\r\n  artifacts:\r\n    baseDirectory: build\r\n    files:\r\n      - '**/*'\r\n  cache:\r\n    paths:\r\n      - node_modules/**/*\r\n\r\n```"}},{"node":{"author":{"login":"ayllondark"},"body":"A mi me funciono quitando del gitignore el archivo aws-export.js para que se subiera a mi repo de github ya que eso pide en la consola de aws amplify y por eso salía error. Aparte también tienen que tener su archivo amplify.yml que se creo o descargaste cuando creaste tu proyecto desde amplify."}}]}}},{"node":{"id":"D_kwDOBkswNc4AP-Ne","author":{"login":"lucaswong98"},"title":"Hosting Nextjs with SSG + ISG","body":"Hi there,\r\n\r\nMy team is trying to host a next.js ecommerce app using AWS services because we have the aws credits in our account so we are thinking to utilise it. We are shifting from a fullstack C# nopcommerce app to RESTful api and a js frontend framework. The apis are ady built in and ready to go, so we are trying to use nextjs as our frontend app that provides features like seo and image optimization.\r\n\r\nSo far we come across AWS amplify service as the most commonly used service to host nextjs outside of vercel. However, we are not planning to use server side rendering and we are not building any api files in the nextjs app, as we ady a fully working api mentioned above, so the idea is to use SSG + ISG + Client side rendering only to handle the data fetched from api. \r\n\r\nSo far we come across AWS amplify service as the most commonly used service to host nextjs outside of vercel. \r\n\r\nQuestion:\r\n1. Does a SSG site on aws amplify still has the feature of incremental static generation (ISG) ? Because its not practical to rebuild the whole site if we have a product detail changed.\r\n2. Does ISG requires aws lambda to work?\r\n3. Is there any alternative to AWS amplify? We have a working EC2 VM so if possible we are trying to host our nextjs in the VM instead of using amplify","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AP9Kr","author":{"login":"TuTomasz"},"title":"setupTOTP state component render conditions?","body":"I'm using amplify UI in a project and various component states work correctly, except for the setupTOTP state which documentation defines in the formFields prop. How does one trigger that state? Or what are the conditions for that state to render on login or signup?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AP7fY","author":{"login":"mattiLeBlanc"},"title":"Use refreshtoken from subdomain A to authenticate for subdomain B in Cognito","body":"We are using Cognito via Amplify/Auth to handle our signup. After the signup is done (on signup.foo.com) we redirect the user to the dashboard (on app.foo.com).\r\nUsing localstorage, the session is locked to the domainname of signup.foo.com and not accessible at signup.foo.com.\r\n\r\nWe used cookieStorage with a *.foo.com domain, which worked, but we are having issues with the cookies disappearing on our mobile Webview solution, so I am looking at going back to the localstorage solution.\r\n\r\nHowever, it seems to be impossible to carry over a session from one subdomain to the second, even if we use the same app client in Cognito.\r\n\r\nI was able to get a new access token using the refresh token of the signup session using `aws cognito-idp admin-initiate-auth` via the command line, but I can't manually inject the refreshToken or accessToken in the localstorage with the correct key name.\r\nThe Auth module doesn't accept it, and it probably is because the domain is hashed into the refreshtoken.\r\n\r\nIs there an official way to, either via Node and a valid refresh or JWT token, to get a new token that can be injected into subdomain B?\r\n\r\nCheers,\r\n\r\nMattijs","upvoteCount":3,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AP7YY","author":{"login":"tammha"},"title":"AWS Appsync GraphQL: Resolver Request Payload does not contain \"identity\" in the context","body":"Hi,\r\nI have 2 AppSync GraphQL APIs, where one is Auth using IAM, and the other using Cognito Pools.\r\nBoth these APIs have been setup with correct roles, etc for security, because I can query and mutate data into DynamoDB.\r\n\r\nFor clients have have used:\r\n\r\nPostman = AWS Signature (IAM using Temp STS AccessKey/SecretKey and Session Tokens)\r\nAmplify API.graphQL API to make query calls.\r\nBoth the clients successfully interacted with the AppSync API server to query and mutate. I am accessing the Gql Endpoint as shown in the App Sync Console ==> Settings. That is:\r\n\r\nhttps://.appsync-api.ap-southeast-2.amazonaws.com/graphql\r\n\r\nHowever, in the cloudwatch logs, I can see that the payload in to the RequestMapping, there is no \"identity\" key. According to the documentation, I should get the identity property with their respective values depending on whether the Auth was AWS_IAM or AMAZON_COGNITO_USER_POOLS (https://docs.aws.amazon.com/appsync/latest/devguide/resolver-context-reference.html).\r\n\r\nAm I missing some setting such that the identity info is not passed into the RequestMapping resolver?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xODU5","author":{"login":"rahulje9"},"title":"Social auth duplicate user.","body":"Hi,\r\nI have set up Social auth in my React Native application. I have added Facebook, Google Signup with Identity pool. What my issue is if a person with same email id in Facebook and Google tries to login, it is taken as two different accounts than one. is it some error on my end or is it is done like that by the package?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"techdragon"},"body":"I opened an issue for this on the Amplify CLI repo a few days ago. https://github.com/aws-amplify/amplify-cli/issues/4427"}},{"node":{"author":{"login":"YajanaRao"},"body":"Hi @rahulje9 . Can you please provide the code for google sign in ? I am getting the error with useragent:\r\nhttps://github.com/aws-amplify/amplify-js/discussions/10023"}}]}}},{"node":{"id":"D_kwDOBkswNc4AP6sQ","author":{"login":"YajanaRao"},"title":"Authorisation Error in React Native Google Sign In","body":"I am using Amplify Authorization for Google Login in React Native. I am getting the following error:\r\n![image](https://user-images.githubusercontent.com/38914337/175779208-b0281240-b653-4bf2-8296-310b4d8ec730.png)\r\n\r\nHere is the code:\r\n```jsx\r\nfunction App() {\r\n  const [user, setUser] = useState(null);\r\n\r\n  useEffect(() => {\r\n    Hub.listen('auth', ({ payload: { event, data } }) => {\r\n      switch (event) {\r\n        case 'signIn':\r\n        case 'cognitoHostedUI':\r\n          getUser().then(userData => setUser(userData));\r\n          break;\r\n        case 'signOut':\r\n          setUser(null);\r\n          break;\r\n        case 'signIn_failure':\r\n        case 'cognitoHostedUI_failure':\r\n          console.log('Sign in failure', data);\r\n          break;\r\n      }\r\n    });\r\n\r\n    getUser().then(userData => setUser(userData));\r\n  }, []);\r\n\r\n  function getUser() {\r\n    return Auth.currentAuthenticatedUser()\r\n      .then(userData => userData)\r\n      .catch(() => console.log('Not signed in'));\r\n  }\r\n\r\n  return (\r\n    <View>\r\n      <Text>User: {user ? JSON.stringify(user.attributes) : 'None'}</Text>\r\n      {user ? (\r\n        <Button title=\"Sign Out\" onPress={() => Auth.signOut()} />\r\n      ) : (\r\n        <Button title=\"Google Sign In\" onPress={() => Auth.federatedSignIn({ provider: CognitoHostedUIIdentityProvider.Google })} />\r\n      )}\r\n    </View>\r\n  );\r\n}\r\n```\r\n\r\nPlease do help. ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AP5fc","author":{"login":"IhorHudkov"},"title":"Replace XMLHttpRequest with fetch in amazon-cognito-identity.js file.","body":"Hello, I'm including the amazon-cognito-identity.js file in the server worker background file in the browser extension. The problem is that according to the version 3 manifest, I can't use XMLHttpRequest in the code. I have to use fetch. But the amazon-cognito-identity.js file uses XMLHttpRequest. How to fix it? Thank you.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNzU4OA==","author":{"login":"LaurentEscalier"},"title":"Using DataStore and AppSync without using the Amplify CLI ?","body":"Hey there 👋 \r\n\r\nI've joined a project where we use DataStore to sync app data with an AppSync backend.\r\n\r\nIn the past it has been decided to not use the Amplify CLI to generate the AppSync backend and its GraphQL schema. Somehow the team has got things to work and we until now has a working sync between DataStore and AppSync.\r\n\r\nNow, we've recently updated our `aws-amplify` dependency to a newer version in order to test a new DataStore feature (selective sync), and this new feature requires a change to the Backend (GraphQL schema and resolvers).\r\n\r\nWithout using the CLI and without proper documentation of the required changes in the Backends, we now find ourselves simply unable to apply the required changes to the AppSync backend.\r\n\r\nNow my question is: **Is there any sense in using DataStore / AppSync without using the Amplify CLI ?**\r\n\r\n_Note: I'm gonna investigate within my team regarding the reason behind our past decision not to use the CLI._","upvoteCount":4,"comments":{"edges":[{"node":{"author":{"login":"ronnyroeller"},"body":"We're in the same boat. We can't use amplify-cli because our resources are provisioned by serverless (which is less opaque). Yet, we would love to use the features from the frontend amplify-lib like DataStore sync'ing.\r\nIt would be great if the amplify-lib would be more separated from amplify-cli. Better documentation would certainly help - but also to support features that shouldn't require a amplify-controlled API (e.g. `amplify codegen models`)."}},{"node":{"author":{"login":"master-harvey"},"body":"The Amplify Auth Library Documentation shows [an example](https://docs.amplify.aws/lib/auth/start/q/platform/js/#re-use-existing-authentication-resource) of reusing existing AWS resources with the Amplify API, in this case an existing cognito user pool. The method's full documentation can be found in [the API Reference](https://aws-amplify.github.io/amplify-js/api/index.html#configuration) where they also show an example of using an existing graphql endpoint.\r\n\r\nGraphQL models and mutations should stay consistent with the schema so generating them during development with the CLI is still useful before ultimately deploying with the CDK or otherwise."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMDg3OA==","author":{"login":"mtcha8l"},"title":"How to make Datastore offline only mode and sync on demand?","body":"I'm trying to make a Datastore App that only privileged users can access to cloud, and yet provide local datastore for other users. Is there a way to make Datastore offline/online programmatically?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"sw-yx"},"body":"probably no - but you might be able to manage a hacky workaround by listening to datastore messages: https://docs.amplify.aws/lib/utilities/hub/q/platform/js#listening-for-regular-expressions"}},{"node":{"author":{"login":"julie777"},"body":"I would think that you could call Amplify.configure with different parameters to determine whether it works in offline only mode. Offline only is the preferred development mode."}},{"node":{"author":{"login":"emilyahsu"},"body":"Hi all,\r\n\r\nI'm Emily, a UX Designer on the AWS Amplify team, and we're conducting user interviews to learn more about the use cases of offline-first vs online-only development modes. The interview will be take at most 30 minutes, and as a “thank you”, we’d love to provide you with $25 in AWS credits for your time.\r\n\r\nIf you are interested in participating, please email me at [emilyhsu@amazon.com](mailto:emilyhsu@amazon.com) and we can schedule a time. Thanks!"}}]}}},{"node":{"id":"D_kwDOBkswNc4AP2dI","author":{"login":"wrsulliv"},"title":"Auth.federatedSignIn opens an 'undefined' domain","body":"When I call `Auth.federatedSignIn()` I'm forwarded to `https://undefined/oauth2/authorize?...`\r\n\r\nWhy is the domain `undefined`?  \r\n\r\nI have followed instructions here for Apple integration:  https://aws.amazon.com/blogs/mobile/enable-sign-in-with-apple-on-your-app-with-aws-amplify/\r\n\r\nIf I manually replace `https://undefined` with my local server `http://localhost:19006` then I can see the generated login page.  However, the \"Sign In with Apple\" button forwards me to another undefined page.\r\n\r\nThe only reason I'm using Amplify is for Auth, and it would be nice if I could configure all of this manually with Cognito and bypass Amplify.  I have my own deployment system, and I don't need any of the other serverless resources.\r\n\r\nAll help is greatly appreciated =)","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"temrb"},"body":"Do you have the cognito URI correctly configured @ apple? I haven't used apple as a federated login though I know for google I had to add google endpoint from amplify onto google console both uri and URI redirect\r\n"}}]}}},{"node":{"id":"D_kwDOBkswNc4AP3Qm","author":{"login":"mariela-plaza"},"title":"How to handle multiple simultaneous signins from the same account","body":"We are using aws-amplify to utilize Cognito to handle our user's sessions.\r\n\r\nRight now, our app allows multiple simultaneous signins from the same user in different devices, but this is something we want to avoid.\r\nWe want to use Cognito to either:\r\n* Logout open sessions in other devices whenever the user logs in.\r\n* Notify the user who's loging in on a new device that they already have an open session in other devices and ask them if they want to continue with the login process or if they want to continue with their open session in another device.\r\n\r\nI saw this thread in the aws-amplify (flutter) package, but since our app is a web app I'm not sure the same process applies to us:\r\nhttps://github.com/aws-amplify/amplify-flutter/issues/1206\r\n\r\n\r\nAny feedback you can provide on this will be very helpful.\r\nThank you in advance for your responses!\r\n\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"temrb"},"body":"I think for that u can use lambda? \r\n\r\nhttps://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-lambda-pre-authentication.html"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzU1MTQx","author":{"login":"lowecg"},"title":"Default support for Brotli in Amplify Hosting","body":"Please can Brotli compression be enabled by default for the CloudFront hosting capability of Amplify?\r\n\r\nBrotli can potentially achieve significantly higher compression ratios when serving text assets over the wire.\r\n\r\nFor example, in my use case, I have a single page app (SPA) that uses Amplify. The SPA bakes in a number of Amplify dependencies which adds about 4MiB to the application size, which is a fair bit of extra weight. I know there are ways to reduce this impact using Amplify's modules, but humour me for now.\r\n\r\ngzip compression is currently supported by default in Amplify's hosting capability, and in my case, this reduces the \"bytes on the wire\" when the main code for my client is served to about 655k (according to my browsers network logging).\r\n\r\nTo examine the impact of using Brotli in my case, I conducted a quick experiment:\r\n\r\nI download my SPA's main code file, `app.js`, and ran the following compression scenarios with gzip and brotli using their default compression levels. I got the following results:\r\n\r\n```\r\n$ gzip -k app.js \r\n$ brotli -k app.js\r\n$ ls -lh app*\r\n-rw-r--r--@ 1 lowecg  staff   4.1M  7 May 08:55 app.js\r\n-rw-r--r--  1 lowecg  staff   468K  7 May 08:55 app.js.br                <-- much smaller\r\n-rw-r--r--@ 1 lowecg  staff   654K  7 May 08:55 app.js.gz\r\n```\r\n\r\nThat's a reduction of **28.4%**! Not too shabby.\r\n\r\nFor reference, I came across this discussion regarding the compression in the AWS forums and it was suggested that someone makes a feature request:\r\n\r\nhttps://forums.aws.amazon.com/thread.jspa?messageID=968270","upvoteCount":13,"comments":{"edges":[{"node":{"author":{"login":"lowecg"},"body":"Here's the quote from the forum:\r\n> Although we enable compression on the CloudFront distribution which hosts your app, we don't currently set the flag \"EnableAcceptEncodingBrotli\" necessary to enable Brotli according to this doc: https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/ServingCompressedFiles.html\r\n>\r\n>We can take this as a feature request."}},{"node":{"author":{"login":"salv0"},"body":"Any news about this? :)"}},{"node":{"author":{"login":"drclementshimizu"},"body":"I have this problem too.  If I try to set the content-type to br in the custom headers, it rejects that as a read only header"}}]}}},{"node":{"id":"D_kwDOBkswNc4AP3Ec","author":{"login":"cdwheatley"},"title":"[DataStore] Failed to PutOrAdd in database because not enough space for domain","body":"QuotaExceededError - \"Failed to PutOrAdd in database because not enough space for domain\"\r\n\r\niOS platform\r\n\r\nIs there any way around this error, like to increase the quota?\r\n\r\nWhat is the root cause of this error, and what is the quota?  I was not able to find any documentation on this quota, and it should likely exist somewhere since it can cause this error and it definitely impacts use cases.\r\n\r\nI have not been able to run in to this issue on Android, so are the limits different between the OS versions?\r\n\r\nThanks for any help.","upvoteCount":3,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AP2Ao","author":{"login":"artidataio"},"title":"Is it possible for One S3 storage to be accessed within authentication from Two client apps?","body":"Hi, I have one s3 storage to be used by 2 application. I want it to be accessible under authentication. There is one solution that make the bucket public instead: https://github.com/aws-amplify/amplify-js/issues/960#issuecomment-605456268. However, in my case is not ideal, as anyone with the link will be able to access and download every items in the bucket. \r\n\r\nPreviously, I was able to do so. However, for some reason it is breaking now on the app where the s3 storage is manually imported with StatusCode: `403 Forbidden` and response:\r\n\r\n```xml\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<Error><Code>AccessDenied</Code><Message>Access Denied</Message><RequestId>0TSX9EX3GX5HFZ6C</RequestId><HostId>N/lPVZtuFGgD8wxV/SUYJQ+jQ/+IySS/Je8rZRaukEHObFyAm3N3J0XMPceV8qDzSvNNF81U0aA=</HostId></Error>\r\n```\r\n\r\nLet me know if such scenario is possible. Thanks.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"artidataio"},"body":"Yeah, it is possible.\r\n> Previously, I was able to do so. However, for some reason it is breaking now on the app where the s3 storage is manually imported with StatusCode: 403 Forbidden and response:\r\nI added admin queries api, and it breaks. I revert it back and remove the admin queries. It works again now. 😕 \r\n"}}]}}},{"node":{"id":"D_kwDOBkswNc4AP1PF","author":{"login":"RocketRonz"},"title":"Auth.federatedSignIn redirect URLs for Expo Go","body":"Hi there. Is anyone using Auth.federatedSignIn (Google) with Expo?\r\n\r\nI have it working locally by setting the redirect URIs to exp://192.168.1.73:19000/--/ but this obviously doesn't work for a published Expo app. Have tried using exp://exp.host/@user/APP_NAME/--/ but this just displays the Cognito error page in the browser, which provides no information whatsoever :(\r\n\r\nAny help would be appreciated, thanks.","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APyWY","author":{"login":"sefatanam"},"title":"Update data without manually property setter in DataStore using AWS Amplify with angular","body":"I used aws-amplify for a very short time for my project. Recently, I'm facing a serious issue about data updating in DataStore in aws-amplify. After reading the docs from their official site I findout that, If I want to update data in DataStore it worked in Immutable way like this,\r\n\r\nFor creating data,\r\n\r\n```\r\nawait DataStore.save(\r\n  new Post({\r\n    title: \"My First Post\",\r\n    rating: 10,\r\n    status: PostStatus.DRAFT\r\n  })\r\n);\r\n```\r\n\r\nand for updating data ,\r\n\r\n```\r\nconst original = await DataStore.query(Post, \"123\");\r\n\r\nawait DataStore.save(\r\n  Post.copyOf(original, updated => {\r\n    updated.title = `Any Title`;\r\n  })\r\n);\r\n```\r\n\r\nthere is no issue with creation but when I goes with update this line is a pain if you have more than 20 property in your object model. Because you have to write all those property and update with it .\r\n\r\n```\r\nupdated.title = `Any Title`;\r\n``` \r\n\r\nSo, I want to update like this without writing all the property in manually,\r\n\r\n```\r\nconst updatedTestResult = { ...this.testResult, ...this.testResultForm.value };\r\nvar result = await DataStore.save(TestResult.copyOf(this.testResult, updatedTestResult))\r\n```\r\n\r\nnow it showing me this error,\r\n\r\n```\r\nTypeError: fn is not a function\r\n    at datastore.js:376:17\r\n    at produce (immer.esm.js:1:16034)\r\n    at Model.copyOf (datastore.js:375:32)\r\n    at test-result-form.component.ts:130:41\r\n    at Generator.next (<anonymous>)\r\n    at asyncGeneratorStep (asyncToGenerator.js:3:1)\r\n    at _next (asyncToGenerator.js:25:1)\r\n    at asyncToGenerator.js:32:1\r\n    at new ZoneAwarePromise (zone.js:1427:29)\r\n    at asyncToGenerator.js:21:1\r\n```\r\n\r\nor maybe there have another solution. Can you please me on that ? \r\n\r\n- TIA","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"david-mcafee"},"body":"@sefatanam - thanks for starting this discussion! I've included some examples that would provide the correct input to `copyOf`:\r\n\r\nFor updating a single property at a time, you could do the following:\r\n```\r\nasync function updateTestResult(key, value) {\r\n  try {\r\n    const testResult = await DataStore.save(\r\n      TestResult.copyOf(originalTestResult, (updated) => {\r\n        updated[key] = value;\r\n      })\r\n    );\r\n\r\n    console.log(\"TestResult updated:\", testResult);\r\n  } catch (error) {\r\n    console.error(\"Save failed:\", error);\r\n  }\r\n}\r\n```\r\n\r\nTo update multiple properties at once, you could do the following:\r\n```\r\nasync function updateTestResult(testResultForm) {\r\n  try {\r\n    const testResult = await DataStore.save(\r\n      TestResult.copyOf(originalTestResult, (updated) => {\r\n        for (const property in testResultForm) {\r\n          updated[property] = testResultForm[property];\r\n        }\r\n      })\r\n    );\r\n\r\n    console.log(\"TestResult updated:\", testResult);\r\n  } catch (error) {\r\n    console.error(\"Save failed:\", error);\r\n  }\r\n}\r\n```\r\n\r\nHope this helps, and let me know if you have further questions!"}}]}}},{"node":{"id":"D_kwDOBkswNc4AP0qS","author":{"login":"emilyahsu"},"title":"AWS Amplify User Testing Opportunity","body":"Hi everyone! I’m Emily, a UX Designer at AWS Amplify, and I’m conducting user interviews to improve the data modeling experience on Amplify. The interview will take at most 1 hour, and as a “thank you”, we’d love to provide you with $100 in AWS credits for your time. If you are interested in participating, please email me at [emilyhsu@amazon.com](mailto:emilyhsu@amazon.com) or DM me on Discord (emilyhsu#6135) and we can schedule a time. Thanks!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AP0gw","author":{"login":"rkushkuley"},"title":"Dynamodb trigger Appsync Subscription from Python","body":"I am updating an item in dynamodb through python. Is there a way for datastore to observe this change? \r\n\r\nIt looks like the _version and _lastUpdatedAt does not change when i update item so datastore does not see it as a mutation.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APitl","author":{"login":"sefatanam"},"title":"How do I redirect to another URL after sign-in in angular ?","body":"Hi,\r\n\r\nI'm using the latest AWS-Amplify's authentication component. It can logged in successfully but after login I need to sent the route to another url which I can't able to achieve, it keeping the same url after logged in. BUT I need to set a custom url where it automatically redirect if a user login successfully.\r\n\r\nNote : I'm not using `aws-amplify-angular` package I'm using these packages,\r\n```\r\n \"@aws-amplify/ui-angular\": \"^2.4.4\", \r\n \"aws-amplify\": \"^4.3.21\",\r\n```\r\nAlso I checked this `import {AuthenticatorService} from '@aws-amplify/ui-angular';` service but here I didn't find any response with observable type, I think that's why I don't get any event or something instantly after user login successfully. I need to route imminently after a successful login. So I need an event so that I can do that .\r\n\r\nMy `main.ts` : \r\n\r\n```\r\nimport { Amplify } from 'aws-amplify'\r\nimport awsmobile from './aws-exports'\r\nAmplify.configure(awsmobile)\r\n```\r\n\r\n`auth.component.html` : [ there is no code in `ts` ]\r\n\r\n```\r\n<amplify-authenticator [signUpAttributes]=\"['email']\"></amplify-authenticator>\r\n```\r\n\r\n& the routes setup like this,\r\n\r\n```\r\nconst routes: Routes = [\r\n  {\r\n    path: 'home',\r\n    component: HomeComponent,\r\n    canActivate: [AuthGuard]\r\n  },\r\n  {\r\n    path: 'auth',\r\n    component: AuthComponent\r\n  },\r\n  {\r\n    path: '',\r\n    redirectTo: 'home',\r\n    pathMatch: 'full'\r\n  }\r\n];\r\n```\r\n\r\nI didn't get any good solution with using this packages. Please help with this issue or am I missed something in my configuration .\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"wlee221"},"body":"Oh yeah, `@aws-amplify/ui-angular` needs a much better `observable` way to track state changes. Note that `AuthenticatorService.user`, `AuthenticatorService.route` are getters -- so basic SPA usages like\r\n\r\n```html\r\n<div *ngIf=\"authenticatorService.route === 'authenticated>\r\n  Hello!\r\n</div>\r\n```\r\n\r\nwill work, but routed usage like your use case wouldn't work very well. \r\n\r\nFor immediate workaround, `AuthenticatorService` has an internal `subscribe` method that you can use:\r\n\r\n```ts\r\nconsturctor(private router: Router, private authenticatorService: AuthenticatorService) {}\r\n\r\nngOnInit(): void {\r\n  this.authenticatorService.subscribe(() => {\r\n    const { route } = this.authenticatorService;\r\n    \r\n    if (route === 'authenticated') {\r\n      this.router.navigate(['/home'])\r\n    }\r\n  });\r\n}\r\n```"}},{"node":{"author":{"login":"wezside"},"body":"For anyone else looking for a state change event it's possible to use `Hub.listen` for this:\r\n\r\n`\r\nHub.listen('auth', (data) => {\r\n        const { payload } = data;\r\n        console.log(data);\r\n    });\r\n`"}}]}}},{"node":{"id":"D_kwDOBkswNc4APzzV","author":{"login":"whunter"},"title":"Amplify push updated the wrong App","body":"Hi, we have several Amplify apps based on the same codebase. Yesterday I wanted to add a new backend env to one of them for testing. I pulled our repo from Github and then from the root of the project I ran `amplify pull <desired app ID>` where the \"desired app ID\" was found at the end of the ARN on the Amplify App Settings > General tab. The CLI then asks several questions and among them was \"Which app are you working on?\" So I chose the app that I wanted to update. I made my changes to the backend and ran `amplify push`. When the push completed I looked for my new backend on the app web page in the AWS console. It wasn't there but I did find it in a different app. \r\n\r\nCould someone let me know where I went wrong? I tried it twice with the same results. I guess I must be missing a step somewhere.\r\n\r\nThanks!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APzBA","author":{"login":"T-DiegoF"},"title":"How to delete unconfirmed users from Cognito ?","body":"I need to delete the users that remain unconfirmed in the user pools. What dou you recommend?","upvoteCount":3,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APygV","author":{"login":"prli"},"title":"How can I use Amplify with service worker in Chrome extension","body":"I have a chrome extension which uses AWS Amplify for authentication. I currently have it within background.html for authentication using chrome manifest v2. Chrome will remove support for manifest v2 by 2023 and I am trying to upgrade my extension from v2 to v3. \r\n\r\nIn manifest v3, background pages are replaced by service workers. \r\nhttps://developer.chrome.com/docs/extensions/mv3/intro/mv3-overview/#service-workers\r\n\r\nOnce I changed my background page to service worker, Amplify started throwing `Not Supported` error.\r\n\r\nI have created a sample repository that demonstrate the issue.\r\namplify sample that is working - https://github.com/prli/AwsAmplifySample/tree/master\r\namplify sample using service worker which fails - https://github.com/prli/AwsAmplifySample/tree/amplify-service-worker-example\r\n\r\nHow can I make Amplify work with service worker for chrome extension?","upvoteCount":5,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APxm1","author":{"login":"rkushkuley"},"title":"DataStore Sync from Dynamo: React","body":"Hi,\r\n\r\nMy use case is i have some data and after some time a backend server updates dynamodb directly on a certail field (data). I am trying to repull that data once its updated to display on the UI.\r\n\r\n**Is there anyway to sync from DynamoDB without :**\r\n```\r\nawait DataStore.stop();\r\nawait DataStore.clear();\r\nawait DataStore.start();\r\nconst model= await DataStore.query(TableName, id)\r\nsetModel(model)\r\n```\r\n\r\n(^ I am currently doing this in a 10 second interval in my useeffect on this particular page, it works but causing some delays and db transaction issues)\r\n\r\n**I have tried using Observe and Subscribe but that does not seem to work:**\r\n\r\n```\r\nasync function fetchModel() {\r\n    const model= await DataStore.query(TableName, id);\r\n    setModel(model);\r\n  }\r\n\r\nuseEffect(() => {\r\n    fetchModel();\r\n    DataStore.observe(TableName).subscribe(fetchModel);\r\n  }, []);\r\n```\r\n\r\n\r\n**Versions:\r\ndatastore: 3.11\r\namplify: 4.3**\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDI4MjAx","author":{"login":"MedNabilEssefaihi"},"title":"APIKEY in amplify add notification","body":"Dear Network,\r\n\r\nI am trying to add **push notifications** but in the one of the steps it asked me about the apikey. where can I found it ? and why isn't in documentation https://docs.amplify.aws/lib/push-notifications/getting-started/q/platform/js#setup-for-android\r\n![2](https://user-images.githubusercontent.com/74948380/123248444-d8801400-d4df-11eb-9c99-1c4faba61f25.png)\r\n\r\n\r\n\r\nI put **Server key** from **Firebase**> **project overview**> **Cloud Messaging**> **project credentials**> **serverkey** (I copied the token)\r\n\r\nis it right ? ","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"Samaritan1011001"},"body":"Yes, it is the `Server Key` from the Firebase console."}}]}}},{"node":{"id":"D_kwDOBkswNc4AO_bR","author":{"login":"Joshig99"},"title":"Error React Native: Safari cannot open the page because the server cannot be found","body":"Hi, I did social logins for Apple and Google.\r\nI Followed Aws Authentication document and configured correctly for providers side and cognito side. also i configured front end correctly, added url scheme in info.plist. \r\nThe social logins works fine with Cognito Hosted UI, but it not working in React Native app. please help me\r\n\r\nredirect uri:\r\nhttps://prodfoliolens8f2c39d0-8f2c39d0-prod.auth.us-east-1.amazoncognito.com/oauth2/authorize?redirect_uri=foliolens%3A%2F%2F&response_type=code&client_id=4mh63true7d06i7o3l70590idg&identity_provider=Google&scope=phone%20email%20openid%20profile%20aws.cognito.signin.user.admin&state=aomMPwrBP23PHD7OepoZl7GV4c2NDQiF&code_challenge=pnmnl9uXsA34iPhudWjLTkQ1SlwqjpWMW6hDA8SpGzM&code_challenge_method=S256\r\n\r\nReact Native: 0.64.2\r\nAws-amplify: 4.2.10\r\n\r\n![Screenshot 2022-03-11 at 11 00 15 AM](https://user-images.githubusercontent.com/46310246/157808122-1ab128ea-758d-4ae9-b884-cd4a7e9f06ae.png)\r\n\r\n![Screenshot 2022-03-11 at 10 53 45 AM](https://user-images.githubusercontent.com/46310246/157807754-51769571-3bb4-44dc-b5ee-e68bd5668dc0.png)\r\n\r\n![Screenshot 2022-03-11 at 10 54 27 AM](https://user-images.githubusercontent.com/46310246/157807784-abbc8278-8f8e-4ea7-b16d-12df00d57387.png)\r\n\r\n![Screenshot 2022-03-11 at 10 54 57 AM](https://user-images.githubusercontent.com/46310246/157807798-3dc39d37-8fba-4bb2-bec4-1f22235611bc.png)\r\n\r\n![Screenshot 2022-03-11 at 10 56 05 AM](https://user-images.githubusercontent.com/46310246/157807811-857fad88-0498-4547-85d3-12867bc24032.png)\r\n\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"codeOlam"},"body":"I am Currently experiencing same issues. "}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjI2Mg==","author":{"login":"oarthursilva"},"title":"react-native: Login fail with error NotAuthorizedException: Invalid login token. Not a valid OpenId Connect identity token","body":"I'm trying to use the federated sign in with Facebook. I've set up everything correctly, but I can't get it to work when passing the facebook token to `Auth.federatedSignIn`, The idea is to re-use the authenticated token from facebook to Cognito.\r\n\r\nhere's my code below:\r\n\r\n```\r\n  async function signIn() {\r\n    LoginManager.logInWithPermissions([\r\n      'public_profile', 'email',\r\n    ]).then(async (result) => {\r\n      // when login successfull\r\n      if (result.isCancelled) {\r\n        return;\r\n      }\r\n\r\n      let accessTokenData = await AccessToken.getCurrentAccessToken();\r\n\r\n      let accessToken = accessTokenData?.accessToken;\r\n      let expiresAt = accessTokenData?.expirationTime;\r\n\r\n      try {\r\n        await Auth.federatedSignIn('Facebook', { token: accessToken, expires_at: expiresAt })\r\n          .then(credentials => {\r\n            console.log(credentials);\r\n          });\r\n      } catch (error) {\r\n        console.log('Login fail with error', error);\r\n      }\r\n    },\r\n      // when login fails\r\n      (error) => {\r\n        console.log('Login fail with error ', error);\r\n      },\r\n    );\r\n  }\r\n```\r\n\r\nWhen trying to login, the message ` Login fail with error [NotAuthorizedException: Invalid login token. Not a valid OpenId Connect identity token.]` is always raised.\r\n\r\nAny idea ?\r\n\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"oarthursilva"},"body":"any?"}},{"node":{"author":{"login":"92Harsha"},"body":"Hi afuscella\r\n\r\nI did get through this step. Do find my steps below.\r\n\r\n1) Change the responseType of oauth to the token in aws-exports.js \r\n2) Cognito:  Within AppClient Settings allow Implicit grant with OAuth 2.0\r\n3) Add the Facebook id in Authentication providers within the Identity pool\r\n4) Full Example of Facebook Login.\r\n\r\n   ```\r\n    import React, {Component} from 'react';\r\n    import {View, Button, Alert} from 'react-native';\r\n    import Amplify, {Auth} from 'aws-amplify';\r\n    import {Hub} from 'aws-amplify';\r\n    import awsExports from './aws-exports';\r\n    Amplify.configure(awsExports);\r\n    \r\n    class App extends Component {\r\n      constructor() {\r\n        super();\r\n        this.state = {user: null};\r\n        Hub.listen('auth', async (data) => {\r\n          if (data) {\r\n            const {payload} = data;\r\n            console.log('new event: ' + JSON.stringify(data.payload.data));\r\n            const currentUser = await Auth.currentUserInfo();\r\n            if (currentUser) {\r\n              console.log(\r\n                'A new auth event has happened: ',\r\n                data.payload.data.username + ' has ' + data.payload.event,\r\n              );\r\n              this.setState({user: currentUser});\r\n            }\r\n          }\r\n        });\r\n      }\r\n    \r\n      async debugMessage() {\r\n        console.log(JSON.stringify(this.state.user));\r\n        Alert.alert(JSON.stringify(this.state.user));\r\n      }\r\n    \r\n      render() {\r\n        return (\r\n          <View style={{marginTop: 100}}>\r\n            <Button\r\n              title=\"Facebook Login\"\r\n              onPress={() => {\r\n                Auth.federatedSignIn({provider: 'Facebook'});\r\n              }}\r\n            />\r\n            {this.state.user && (\r\n              <Button\r\n                title=\"Current User Info\"\r\n                onPress={() => this.debugMessage()}\r\n              />\r\n            )}\r\n          </View>\r\n        );\r\n      }\r\n    }\r\n    export default App;\r\n```\r\nGood Luck.!\r\n"}}]}}},{"node":{"id":"D_kwDOBkswNc4APuVo","author":{"login":"rpmansion"},"title":"Continue the authorization code grant flow process after logging in from Amplify SignIn function","body":"Upon initiating an authorization code grant from a client app, it goes to the authorize endpoint, then redirect you to login with a queryparams from an example below.\r\n\r\n`https://devapp.com/login?client_id=898fdsajkjfafagdfa3fdafsf&redirect_uri=http:%2F%2Flocalhost:4200&authorization_code=ded01....\r\n`\r\n\r\nWhen you log in, the below function will initiate.\r\n\r\n```\r\ntry {\r\n  const result = await this.amplifyAuth.signIn(username, password);\r\n  this.user = result;\r\n\r\n  this.router.navigate(['/dashboard']);\r\n\r\n  return true;\r\n} catch (err: any) {\r\n}\r\n```\r\n\r\nOf course, once you sign in it will redirect you to the dashboard. The question is how to continue the authorization code grant process by using the `signIn()` function when there are `client_id`, `redirect_uri`, `authorization_code`, etc... to continue the flow and redirect to the client application that initiates the authentication or is there other solution to do this?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjUyNDg0","author":{"login":"apoorvmote"},"title":"List operation with @auth is scan operation or query operation?","body":"I have simple schema\r\n```graphql\r\ntype Blog @model @auth(rules: [{ allow: owner }]){\r\n  id: ID!\r\n  title: String!\r\n}\r\n```\r\nI have been running `@key` like the following\r\n```graphql\r\ntype Blog @model \r\n  @key(name: \"byOwnerID\", fields: \"owner\", queryField: \"blogsByOwnerID\") \r\n  @auth(rules: [{ allow: owner }]) {\r\n  id: ID!\r\n  owner: String!\r\n  title: String!\r\n}\r\n```\r\n\r\nDo I need this `blogsByOwnerID`? The default generated `listBlogs` automatically returns all the blogs written by the same owner.\r\n\r\nBut in AppSync Console there is no resolver for `listBlogs` and there is no `owner GSI` for first graphql schema.\r\n\r\nHow its possible to query Dynamodb table for `owner` key without GSI? \r\n\r\nAre they running scan operation and filtering for `owner` from the request?","upvoteCount":3,"comments":{"edges":[{"node":{"author":{"login":"alexkates"},"body":"Coming here looking for guidance as well. I've made assumptions that I'll describe below, but I'm also looking for some definitive guidance here from the Amplify team.\r\n\r\nIn my experience, if you were to run the auto-generated `listBlogs` Query as an authenticated user, under the hood DynamoDB would be executing a scan operation on the Blog table and would filter entries where the owner is equal to the authenticated user. Also, you would receive a nextToken which would allow you to perform a subsequent scan for the next page.\r\n\r\nIn the past, I've introduced a top-level, or aggregate root type called `Customer`. A customer would be created when a user registers, and it would allow me to build a relationship to the Blog type that would provide the index. I would also set the Id of this Customer to be the `sub` or `username` of the Cognito user."}}]}}},{"node":{"id":"D_kwDOBkswNc4APst5","author":{"login":"sagar14791"},"title":"Amplify sync model specific data","body":"**I am using 2 Configurations for amplify**\r\n\r\n              //  To save data in offline without starting sync\r\n                     void configureOffline() async {\r\n                        Amplify.addPlugin(AmplifyDataStore(\r\n                          modelProvider: ModelProvider.instance,\r\n                        ));\r\n                        await Amplify.configure(amplifyconfig);\r\n                      }\r\n\r\n                // to sync offline data or new data in server\r\n                 void configureAmplifyOnline() async {\r\n                        await Future.wait([\r\n                          Amplify.addPlugin(AmplifyDataStore(\r\n                              modelProvider: ModelProvider.instance,\r\n                              syncExpressions: [\r\n                               // DataStoreSyncExpression(AllRetailerList.classType,\r\n                               //     () => AllRetailerList.SALES_LIST.contains(\"3\")), \r\n                                DataStoreSyncExpression(\r\n                                    ProductData.classType, () => ProductData.STATUS.eq(1)),\r\n                              ])),\r\n                          Amplify.addPlugin(AmplifyAPI()),\r\n                        ]);\r\n                        await Amplify.configure(amplifyconfig);\r\n                    }\r\n\r\n\r\ni want to sync data from **ProductData** only and not to from **SALES_LIST** but configureAmplifyOnline() sync all data how to stop auto sync for specific MODELS?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AOY1Q","author":{"login":"jamessouth"},"title":"FYI - Chrome warning on future User-Agent String changes","body":"Hello, I got this warning in Chrome (Iridium) re my use of `amazon-cognito-identity-js@5.2.3` and did not find it mentioned in another issue or discussion:\r\n\r\n```\r\nAudit usage of navigator.userAgent, navigator.appVersion, and navigator.platform\r\n\r\nA page or script is accessing at least one of navigator.userAgent, navigator.appVersion, and navigator.platform.\r\nIn a future version of Chrome, the amount of information available in the User Agent string will be reduced.\r\n\r\nTo fix this issue, replace the usage of navigator.userAgent, navigator.appVersion, and navigator.platform with\r\nfeature detection, progressive enhancement, or migrate to navigator.userAgentData.\r\n```\r\n[Chrome blog post](https://blog.chromium.org/2021/05/update-on-user-agent-string-reduction.html)\r\n\r\nThank you!","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"jrobbins-LiveData"},"body":"`amazon-cognito-identity.js` appears to use `navigator.product`, `navigator.appName`, and `navigator.userAgent`. \r\n\r\nThe code that uses `navigator.product` seems like it would work even without a `navigator` object or `navigator.product` (although I have not tested this.)  \r\n\r\nThe chromium [link](https://www.chromium.org/updates/ua-reduction/#reduced-navigatorplatform-values-for-all-versions) doesn't mention `navigator.product` so it is unclear to me what the \"reduction\" means for this property. It also doesn't mention `navigator.appName`, but, again (based on a superficial read of the code), it looks like the code that uses `navigator.appName` would survive the non-existence of the `navigator` object or simply the nonexistence of `navigator.appName`.\r\n\r\nThat leaves `navigator.userAgent`.  This is one of the properties mentioned at the [link](https://www.chromium.org/updates/ua-reduction/#reduced-navigatoruseragent-values), and called out in the Audit issue (`Audit usage of navigator.userAgent, navigator.appVersion, and navigator.platform`).\r\n\r\nThe code in question is\r\n\r\n```javascript\r\n A = w ? navigator.userAgent : \"nodejs\"\r\n```\r\n\r\nThis appears to be safe wrt the reduction.  The Audit issue recommends not using `navigator.userAgent` in favor of \"...feature detection, progressive enhancement, or migrate to navigator.userAgentData.\"  I don't think, though, that the reduction in values for `navigator.userAgent` will break this code, so it is more an annoyance at this point than a signal of a real problem, apparently. \r\n\r\nThat said, it would be much nicer not to have this Audit notice, as it inevitably will raise concerns.  Since the single use of `navigator.userAgent` is in [CognitoUser.js](https://github.com/aws-amplify/amplify-js/blob/1b188626afcc7f0f755ba449534236a38260e692/packages/amazon-cognito-identity-js/src/CognitoUser.js), perhaps AWS would consider switching [that line of code](https://github.com/aws-amplify/amplify-js/blob/1b188626afcc7f0f755ba449534236a38260e692/packages/amazon-cognito-identity-js/src/CognitoUser.js#L62)\r\n\r\n```javascript\r\nconst userAgent = isBrowser ? navigator.userAgent : 'nodejs';\r\n```\r\n\r\nto one of the suggested alternatives, in order to remove the Audit notice?  [edited] I opened an [issue ](https://github.com/aws-amplify/amplify-js/issues/9957)on this topic.\r\n\r\n\r\n\r\n\r\n"}}]}}},{"node":{"id":"D_kwDOBkswNc4APsSK","author":{"login":"dalekatwork"},"title":"How to handle a 413 status call on a POST call payload?","body":"Hi, I am getting 413 status code on a POST call when I take an image from my camera as part of my payload. I want to save it as part of the request.\r\n\r\nWhere in amplify dashboard can I set `client_max_body_size` or any other way I can fix my issue.","upvoteCount":0,"comments":{"edges":[{"node":{"author":{"login":"dalekatwork"},"body":"I was able to fix the issue by increasing my server client body size. Closing this issue"}}]}}},{"node":{"id":"D_kwDOBkswNc4APscr","author":{"login":"aak001"},"title":"How to upload multiple images to S3 bucket (React Native Expo)","body":"Hi, I successfully uploaded an image to my amplify s3 bucket using the prescribed method in the amplify storage docs. Is there a way to upload multiple images to the same bucket maybe using \"promise.all()\"? if so can I have an example?","upvoteCount":0,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNjg5ODUz","author":{"login":"DevTGhosh"},"title":"What are the limits of Datastore? And how does the sync limit work?","body":"I have a One to Many relationship model. For e.g 1 Post can have many Comments.  So for my usecase a Post can have 1000's of Comments. This is running into the default Datastore limit of 10k records. If I create new post with another 1000 comment they show up in the datastore. However if I clear, stop and restart the datastore the selective sync causes only partial comments to load for each Post.\r\n\r\nThis is leading me to have the following assumptions please correct me If I am wrong:\r\n\r\n1. If I am creating a new post with 1000's of comments I am gonna guess they replace some other data from the datastore to remain under the sync limit?\r\n\r\n2. Since we are doing a scan of the Comments table to get comments only partial data for each Post is being fetched and stored since the Sync limit is shared across all Posts and Comments. And the rest of the comments over limit are not being saved.\r\n\r\nNow my questions:\r\n\r\n1. Is it possible to force fetch and save data in datastore when you are fetching Comments of a Post, while also not removing all of the already synced items of another model. So say you can remove comments from other Posts but keep the data to the Post model intact.  I know you can use a combination of  `Datastore.stop`, `Datastore.configure` & `Datastore.start` but that removes all of the already synced data. This creates an issue when offline it will clear & stop datastore and have no way of syncing new data or getting old data. \r\n\r\n2. What are the limits of `maxRecordsToSync` for Datastore. How many records can I realistically keep. I can have a table with tens of millions of items is that possible to sync with datastore and not face issue with sync. What are the limits to the amount of data being saved(few gb?)    How much time will it take to realistically sync the data? ","upvoteCount":7,"comments":{"edges":[{"node":{"author":{"login":"nvnk3"},"body":"@DevTGhosh did you figure out how to do force fetch  ?"}}]}}},{"node":{"id":"D_kwDOBkswNc4APn-Z","author":{"login":"andre347"},"title":"How to implement login with a dynamic redirect?","body":"I have the following use case. I am building an internal portal and we often share links to protected pages. If a user clicks on a link and they are not authenticated they are send to the '/login' page and then send to the '/dashboard' page. However, we want the user to go the link they initially clicked on. Say someone clicks on a link to go to '/dashboard/product/product1', we want to first go to '/login' and after auth to '/dashboard/product/product1' and not to '/dashboard'. \r\n\r\nWhat is the best way to implement this with AWS Amplify and Cognito? This is for a Next.js application and I am using Amplify v^4.3.3. In getServerSideProps I check if someone is authenticated to a page, if not go to '/login' else continue.\r\n\r\nIn Auth0 there is a prop on the login method to set a dynamic redirect, which you can populate with the browser history but I can't seem to find something similar for AWS Amplify.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APnXY","author":{"login":"chris-maclean"},"title":"How do I best use CognitoUser.completeNewPasswordChallenge?","body":"I am trying to support the `FORCE_CHANGE_PASSWORD` workflow in my web app, following Use Case 23 in the `amazon-cognito-identity-js` [README](https://github.com/aws-amplify/amplify-js/tree/main/packages/amazon-cognito-identity-js). I have a `newPasswordRequired` callback for the `CognitoUser.authenticateUser` method, and I have verified that the callback is called. However, like the OP in issue [#3043](https://github.com/aws-amplify/amplify-js/issues/3043), I want to redirect my user to a new page to fill in their new password. Use Case 23 says to save the user attributes (the first parameter to the `newPasswordRequired` callback) to a global variable, then provide it as an argument to `CognitoUser.completeNewPasswordChallenge`, like this:\r\n\r\n```javascript\r\ncognitoUser.authenticateUser(authenticationDetails, {\r\n        newPasswordRequired: function(userAttributes, requiredAttributes) {\r\n            // User was signed up by an admin and must provide new\r\n            // password and required attributes, if any, to complete\r\n            // authentication.\r\n\r\n            // the api doesn't accept this field back\r\n            delete userAttributes.email_verified;\r\n\r\n            // store userAttributes on global variable\r\n            sessionUserAttributes = userAttributes;\r\n        }\r\n    });\r\n\r\n    // ... handle new password flow on your app\r\n    handleNewPassword(newPassword) {\r\n      cognitoUser.completeNewPasswordChallenge(newPassword, sessionUserAttributes);\r\n    }\r\n```\r\n\r\nIn my app, I accomplish this by saving the user attributes object to a Redux store and extracting it later when I'm ready to complete the new password challenge. This seems to me like it should accomplish the same thing as a saving the attributes to a global variable, like in the README. However, when my component calls `CognitoUser.completeNewPasswordChallenge`, the call fails with this fairly opaque error:\r\n\r\n```\r\nindex.js:1 TypeError: Cannot read properties of undefined (reading 'NewDeviceMetadata')\r\n    at CognitoUser.authenticateUserInternal (CognitoUser.js:478:1)\r\n    at CognitoUser.js:575:1\r\n    at Client.js:119:1\r\n```\r\n\r\nAlso, when I inspect the user attributes object, it is quite simple and doesn't seem to include any session information. In fact, all it includes are the custom Cognito attributes assigned to the user. I don't understand how the package uses these attributes to successfully change the user's password with Cognito.\r\n\r\nI should point out that I've also tried to same store-and-extract approach to save the CognitoUser object that makes the original `authenticateUser` call, thinking that maybe I needed the same instance of CognitoUser to complete the challenge. This approach leads to the same error.\r\n\r\nAs a test, I made the first `newPasswordRequired` callback immediately fire a `completeNewPasswordChallenge` like this:\r\n\r\n```javascript\r\ncognitoUser.authenticateUser(authenticationDetails, {\r\n  newPasswordRequired(userAttributes) {\r\n    console.log('New password required');\r\n    cognitoUser.completeNewPasswordChallenge(\r\n      'foobar',\r\n      userAttributes,\r\n      {\r\n        onSuccess() {\r\n          console.log('Completed the new password challenge!');\r\n        },\r\n        onFailure() {\r\n          console.error('Failed to complete the new password challenge');\r\n        },\r\n      }\r\n    );\r\n  },\r\n})\r\n```\r\n\r\nThis successfully changes the password to `foobar`. The success of this approach tells me that it's somehow important for `completeNewPasswordChallenge` to be called from within the `newPasswordRequired` callback, but I don't understand why.\r\n\r\nCan anyone help me understand why `completeNewPasswordChallenge` succeeds when called from within the `newPasswordRequired` callback, but fails when called elsewhere, even when I use the same CognitoUser instance and user attributes as those in the callback?","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"chris-maclean"},"body":"My idea for a workaround (which the OP of issue [#3043](https://github.com/aws-amplify/amplify-js/issues/3043) also arrived at) is to make the change password page re-start the authentication flow. That is, create a CognitoUser instance, call its `authenticateUser` method, and provide a `newPasswordRequired` callback which calls the `completeNewPasswordChallenge` itself. The original login component will detect the new password requirement and redirect to the change password page. Like this:\r\n\r\n```javascript\r\n// First login page\r\ncognitoUser = new CognitoUser(params);\r\ncognitoUser.authenticateUser(authenticationDetails, {\r\n  newPasswordRequired(userAttributes) {\r\n    console.log('New password required');\r\n    goToChangePasswordPage();\r\n  },\r\n});\r\n\r\n// Change password page\r\ncognitoUser = new CognitoUser(params);\r\ncognitoUser.authenticateUser(authenticationDetails, {\r\n  newPasswordRequired(userAttributes) {\r\n    console.log('Changing password...');\r\n    cognitoUser.completeNewPasswordChallenge(\r\n      newPasswordFromInputComponent,\r\n      userAttributes,\r\n      {\r\n        onSuccess() {\r\n          console.log('Completed the new password challenge!');\r\n        },\r\n        onFailure() {\r\n          console.error('Failed to complete the new password challenge');\r\n        },\r\n      }\r\n    );\r\n  },\r\n});\r\n```\r\n\r\nI think this will work, but it seems strange that it should be necessary. I don't understand why I can't carry the CognitoUserObject and user attributes through from the first login page to the change password page."}}]}}},{"node":{"id":"D_kwDOBkswNc4APnUp","author":{"login":"madlerpar"},"title":"Confirm an action with current users password","body":"Does anyone know of a way to verify a users password when they are already logged in? My application has some sensitive actions that we have the user confirm by entering their password. Originally we were using Auth.SignIn(). This worked fine when the only MFA option was TOTP, but after adding in SMS SignIn will trigger a text message being sent to the user which we do not want. \r\n\r\nCurrent:\r\nUser enters password which is checked with Auth.SignIn(). If SMS is enabled for MFA, it also sends them a MFA code.\r\n\r\nDesired:\r\nUser enters password which is checked somehow by amplify. It simply returns if password is correct or not, with no MFA code being sent.\r\n\r\nIf anyone has any insight in how to confirm the users password without triggering an MFA message that would be appreciated. Thanks!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APm-h","author":{"login":"brown2021"},"title":"Custom storage plugin","body":"Hello, I would like to use my own storage. My storage APIs are in Python. How do I use the Amplify Framework to call them. For example, \r\n\r\nThis is my get() API\r\n\r\n`def get_image_by_id(st, id):\r\n\r\n    query = [{\r\n        \"FindImage\": {\r\n            \"constraints\": {\r\n                \"_uniqueid\": [\"==\", id]\r\n            },\r\n            \"results\": {\r\n                \"all_properties\": True\r\n            }\r\n        }\r\n    }]\r\n\r\n    return query_api(query, st)`\r\n\r\nWhere the query_api is defined by \r\n\r\n\r\n`def query_api(query, st):\r\n\r\n    query = dict_query_to_str(query)\r\n    # print(repr(query))\r\n\r\n    response = requests.post(URL, headers = {'Authorization': \"Bearer \" + st},\r\n                             data    = {'json_query': query})\r\n\r\n    # print(response.status_code)\r\n    # print(response.text)\r\n\r\n    # Parse response:\r\n    json_response = json.loads(response.text)\r\n    response      = json.loads(json_response[\"json\"])\r\n    blobs         = json_response[\"blobs\"]\r\n\r\n    return response, blobs`\r\n\r\n\r\nHow do I map that to the get function documented in Amplify?\r\nhttps://docs.amplify.aws/lib/storage/getting-started/q/platform/js/#using-a-custom-plugin\r\n\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APle8","author":{"login":"flexelem"},"title":"Getting \"no current user\" error after redirect from Cognito Hosted UI","body":"Hi there, I am trying to learn authentication code grant flow with Cognito Hosted UI. Everything seems working until I get redirected back to my protected page. All the /authorize, /login and /token calls are getting completed successfully. I can also confirm that I see the URL with /code parameter generated which is then redirected again. As the final step when I use `await Auth.currentAuthenticatedUser();` I get an error with \"no current user\". So, if I am not mistaken Amplify handles all the required OAUTH calls internally which I would then expect to get an authorized user at the end. Here are the two main files from my react app;\r\n\r\n**App.js**\r\n\r\n```\r\nimport './App.css';\r\nimport React from 'react'\r\nimport Amplify from 'aws-amplify';\r\n\r\nAmplify.configure({\r\n    Auth: {\r\n\r\n        // REQUIRED - Amazon Cognito Region\r\n        region: 'us-east-1',\r\n\r\n        // OPTIONAL - Amazon Cognito User Pool ID\r\n        userPoolId: process.env.REACT_APP_USERPOOL_ID,\r\n\r\n        // OPTIONAL - Amazon Cognito Web Client ID (26-char alphanumeric string)\r\n        userPoolWebClientId: process.env.REACT_APP_USERPOOL_WEB_CLIENT_ID,\r\n\r\n        // OPTIONAL - Enforce user authentication prior to accessing AWS resources or not\r\n        mandatorySignIn: false,\r\n\r\n        // OPTIONAL - Manually set the authentication flow type. Default is 'USER_SRP_AUTH'\r\n        authenticationFlowType: 'USER_PASSWORD_AUTH',\r\n\r\n        // OPTIONAL - Hosted UI configuration\r\n        oauth: {\r\n            domain: 'belttgvsdu.auth.us-east-1.amazoncognito.com',\r\n            scope: ['myresourceserver/awesomeapi.read', 'myresourceserver/awesomeapi.write'],\r\n            redirectSignIn: 'http://localhost:3000/dashboard',\r\n            redirectSignOut: 'http://localhost:3000',\r\n            responseType: 'code'\r\n        }\r\n    }\r\n});\r\n\r\nfunction App(props) {\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <h1>This is Landing page</h1>\r\n      <a href=\"https://belttgvsdu.auth.us-east-1.amazoncognito.com/oauth2/authorize?client_id=3chm4jkbcn767oqu2m9icconcs&response_type=code&scope=myresourceserver%2Fawesomeapi.read+myresourceserver%2Fawesomeapi.write&redirect_uri=http%3A%2F%2Flocalhost%3A3000%2Fdashboard\">Login</a>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n\r\n```\r\n\r\nAnd here is the dashboard.js to render localhost:3000/dashboard\r\n\r\n**dashboard.js**\r\n\r\n```\r\nimport React, {useEffect, useState} from 'react';\r\nimport '../App.css';\r\nimport {Auth} from 'aws-amplify';\r\nimport {Navigate} from \"react-router-dom\";\r\n\r\nfunction Dashboard(props) {\r\n    const [user, setUser] = useState();\r\n    const [isLoading, setIsLoading] = useState(true);\r\n\r\n    async function getCurrentUser() {\r\n        try {\r\n            const authUser = await Auth.currentAuthenticatedUser();\r\n            console.log(JSON.stringify(authUser));\r\n            setUser(authUser);\r\n        } catch (e) {\r\n            console.log('error happened', e);\r\n            setUser(null);\r\n            setIsLoading(false);\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        getCurrentUser();\r\n    }, []);\r\n\r\n    async function handleSignOut(event) {\r\n        event.preventDefault();\r\n        try {\r\n            await Auth.signOut();\r\n        } catch (error) {\r\n            console.log('error signing out: ', error);\r\n        }\r\n        setUser(null);\r\n        setIsLoading(false);\r\n    }\r\n\r\n    if (!user && !isLoading) {\r\n        return <Navigate to=\"/\" replace={true} />\r\n    }\r\n\r\n    return (\r\n        <div className=\"container\">\r\n            <h1>Dashboard</h1>\r\n            <button onClick={handleSignOut} className=\"fluid ui button blue\">Sign Out</button>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Dashboard;\r\n\r\n```\r\n\r\nHere I also attached a screenshot to show all the related oauth calls are ending with success.\r\n\r\n![Screen Shot 2022-05-19 at 19 28 36](https://user-images.githubusercontent.com/6500753/169351029-f023398e-e045-4580-a955-d7c20a5026ab.png)\r\n\r\nAnd this is the error I am getting;\r\n\r\n\r\n![Screen Shot 2022-05-19 at 19 29 57](https://user-images.githubusercontent.com/6500753/169351297-ebbc4a55-0cb5-4ab1-963d-d496598c3926.png)\r\n\r\n\r\nThanks for the help!","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AOjMf","author":{"login":"duranmla"},"title":"Issue to query model with @hasMany relationship using DataStore","body":"👋 Hi!\r\n\r\nI am having issues with **`@hasMany`** relation. I am trying to access the related model from the source model returns empty. What is odd is that at some point I was able to query without issues since the generated types when `amplify codegen models` run used to contain `pathwayID`, currently, when I generate models the property `pathwayID` is removed.\r\n\r\nThe case of study looks like below, I have this schema:\r\n\r\n```graphql\r\ntype Pathway @model @auth(rules: [{ allow: private }]) {\r\n  id: ID!\r\n  title: String!\r\n  description: String\r\n  thumbnail: String\r\n  pathwayPitstops: [PathwayPitstop] @hasMany(indexName: \"byPathway\", fields: [\"id\"])\r\n}\r\n\r\ntype PathwayPitstop @model @auth(rules: [{ allow: private }]) {\r\n  id: ID!\r\n  pathwayID: ID! @index(name: \"byPathway\")\r\n  pathway: Pathway @belongsTo(fields: [\"pathwayID\"])\r\n  pitstopID: ID!\r\n  pitstop: Pitstop @hasOne(fields: [\"pitstopID\"])\r\n  positionX: Int!\r\n  positionY: Int!\r\n  pathwayPitstopParentID: ID\r\n}\r\n```\r\n\r\nAnd then this are the approaches I have donde to query:\r\n\r\n1. **Trying to get the pathwayPitstops using the source model and then accessing to the related model using the property**\r\n```ts\r\nconst pathwayPitstops = (await DataStore.query(Pathway, pathwayId))\r\n      ?.pathwayPitstops\r\n```\r\n*Always return undefined*\r\n\r\n2. **Trying to query all the pathwayPitstops and filter by `pathwayID`** (this used to work but since I don't have pathwayID anymore it does not.)\r\n\r\n```ts\r\nconst pathwayPitstops = await DataStore.query(PathwayPitstop, (pp) => pp.pathwayID('eq', pathwayId))\r\n```\r\n*It complains that pathwayID is not a property* (at some point it was valid but now when I run `amplify codegen models` it deletes the pathwayID from the types)\r\n\r\n**And yes, I do have a record that suppose to be returned**\r\n[Screenshot to DynamoDB](https://user-images.githubusercontent.com/1425162/150333471-52d77710-e694-4538-9843-bd20ef35f70c.png)","upvoteCount":4,"comments":{"edges":[{"node":{"author":{"login":"duranmla"},"body":"As for now my way to move forward has been to use the GraphQL query instead. Nonetheless, it feels like bug that I am not able to query the same data using DataStore. For the sake of helping others in this endeavour this is what I have done:\r\n\r\n```ts\r\nconst pathwayGraphQLResponse = await API.graphql(graphqlOperation(queries.getPathway, { id: pathwayId }))\r\n\r\n// get the `pathwayPitstops` from my `pathwayGraphQLResponse` object\r\n```"}},{"node":{"author":{"login":"svidgen"},"body":"Thanks for submitting this! This _does_ just look like a bug to me. And in face, there's an open CLI issue to fix codegen on `belongsTo` relationships. See [amplify-codgen/349](https://github.com/aws-amplify/amplify-codegen/issues/349). Still tracking js-side as well in #9514.\r\n\r\nThat said, it's best to save models in this manner:\r\n\r\n```\r\nawait DataStore.save(PathwayPitstop, {\r\n  // ... fields ... \r\n  pitstop: your_pitstop\r\n});\r\n```\r\n\r\nDataStore will manage the ID under the hood for you.\r\n\r\nWorking around the missing ID field, you can do this:\r\n\r\n```\r\n(await DataStore.query(PathwayPitstop)).filter(p => p.pitstop.id == SOME_ID);\r\n```\r\n\r\nLoading the `hasMany` side of the relationship (`pitstop. pathwayPitstops`) is not yet supported by DataStore."}},{"node":{"author":{"login":"hpwtaee"},"body":"@svidgen is this a bug and if so are there any timelines for a fix?\n\nIn my case I'm using DataStore and trying to selectively sync a subset of data against the id field that has 'vanished' (this bug restricts me from doing that). Would really appreciate an insight into what's going on!"}}]}}},{"node":{"id":"D_kwDOBkswNc4AOOHH","author":{"login":"monscamus"},"title":"Amplify Datastore Sync Passes Session Token in URL","body":"We recently reviewed a prototype React application for security and noticed that a session token is passed by the Amplify offline datastore code into the graphql endpoint _in the url_. I know that jwt tokens are passed in the headers normally but I'm thinking that target urls of users are much easier to capture than encrypted headers. it looks like the following:\r\n\r\n`GET \r\n/graphql?header=eyJBdXRob3JpemF0aW9uIjoiZXlKcmFXUWlPaUp4WTBGdWJGbzNVbVpFY1hkWVhDOUJjMVJ0VUVkdVpYaEd\r\nURE0xWkdkT1dIcGNMMWhNVjFvM1kxWmphMnM5SWl3aVlXeG5Jam9pVWxNeU5UWWlmUS5leUp6ZFdJaU9pSTRNamt4WkRKall5\r\n...c2ZHMDVtakFrZyIsImhvc3QiOiIzbGx6Z2NjcnV6YjZ4YXhkYmR6NjdmeTZ0cS5hcHBzeW5jLWFwaS5ldS13ZXN0LTIuYW1he\r\nm9uYXdzLmNvbSJ9&payload=e30= HTTP/1.1    \r\nHost: 3llzgccruzb6yabdbdz67fy6tq.appsync-realtime-api.eu-west-2.amazonaws.com    \r\nConnection: Upgrade    \r\nPragma: no-cache    \r\nCache-Control: no-cache  `\r\n\r\nCan someone explain why this is OK? Or if there are additional Amplify settings to stop this that I'm unaware of?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"david-mcafee"},"body":"Created [an issue](https://github.com/aws-amplify/amplify-js/issues/9811) for this."}},{"node":{"author":{"login":"david-mcafee"},"body":"Hi @monscamus,\r\n\r\nThanks for your inquiry.\r\n\r\n[AppSync’s subscription protocol](https://docs.aws.amazon.com/appsync/latest/devguide/real-time-websocket-client.html) uses query string parameters to establish new sessions. This is by design and secure as the entire request is encrypted end-to-end via TLS and is protected while in transit.\r\n\r\nIf you have any follow up questions, please do not hesitate to contact us at [aws-security@amazon.com](mailto:aws-security@amazon.com)."}}]}}},{"node":{"id":"D_kwDOBkswNc4APk98","author":{"login":"bikashgupta-zinrelo"},"title":"aws.cognito.signin.user.admin scope reach","body":"Does aws.cognito.signin.user.admin scope allows the logged-in user to change other users' data or delete other users in the pool?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APeBb","author":{"login":"Ramnirmal0"},"title":"what should be the minimum Node version for this library ?","body":"I am trying to enable TOTP based MFA . but most of the time i am getting following as API Response\r\n\r\n````\r\nmessage: \"Code mismatch\"\r\n__type: \"EnableSoftwareTokenMFAException\"\r\n````\r\n\r\nSome times this works but most of the times i am getting the above error. why ?\r\n\r\n  Binaries:\r\n    Node: 8.17.0 - ~/.nvm/versions/node/v8.17.0/bin/node\r\n    Yarn: 1.22.18 - /usr/bin/yarn\r\n    npm: 6.13.4 - ~/.nvm/versions/node/v8.17.0/bin/npm\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"david-mcafee"},"body":"@Ramnirmal0 - the recommended minimum Node and NPM versions are listed [here in our docs](https://docs.amplify.aws/start/getting-started/installation/q/integration/react/). The current minimum versions are Node 12.x or later, and NPM 5.x or later. However, Node v14.x or later / NPM v6.14.4 or later are required when using [Create React App](https://create-react-app.dev/docs/getting-started)"}}]}}},{"node":{"id":"D_kwDOBkswNc4APi2v","author":{"login":"LudoLab92"},"title":"Any Cognito trigger is fired after email or phone verification, how to sync?","body":"Hi,\r\n\r\nI am using PostConfirmation et PreTokenGeneration triggers but any of it get fired when a user verify its phone number or his email.\r\nIt looks like we don't have any way to stay sync with our database when this event occurs.\r\nCan someone confirm this or share a way to do?\r\n\r\nThanks,","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APhCN","author":{"login":"samuelcastro"},"title":"How to return more device information | Auth.fetchDevices","body":"The `Auth.fetchDevices` fn only returns `id` and `name`, however I know that Cognito supports several other informations like `IP`, `Last Seen` etc. How can we return more information?","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APgOr","author":{"login":"ranopriyo-neogy"},"title":"How is aws_cloud_logic_custom block added inside aws-exports.js?","body":"I am setting up an existing react project in a new AWS account and trying to figure out how to get `aws_cloud_logic_custom` in `aws-exports.js`? As I didn't find a way to put that in, I manually edited the `aws-export.js` file (as shown in the code below), however with Amplify push the configuration was auto deleted.\r\n\r\nI have the API available for aws_cloud_logic_custom, just didn't find a way to sync it with the existing amplify configuration by getting it inside `aws-exports.js`. What should I do considering  there is an existing API that I want to link to the Amplify project inside `aws_cloud_logic_custom` block. TIA\r\n\r\n**Code**\r\n\r\n```\r\nconst awsmobile = {\r\n  aws_project_region: \"us-east-2\",\r\n  aws_appsync_graphqlEndpoint:\r\n    \"https://abcd/graphql\",\r\n  aws_appsync_region: \"us-east-2\",\r\n  aws_appsync_authenticationType: \"AMAZON_COGNITO_USER_POOLS\",\r\n  aws_cognito_identity_pool_id:\r\n    \"Us-east-2:22,\r\n  aws_cognito_region: \"us-east-2\",\r\n  aws_user_pools_id: “xxxx”,\r\n  aws_user_pools_web_client_id: “xxxxx”,\r\n  oauth: {},\r\n  aws_cloud_logic_custom: [\r\n    {\r\n      name: “apiname,\r\n      endpoint: \"https:xxx/prod\",\r\n      region: \"us-east-2\",\r\n    },\r\n  ],\r\n};\r\n\r\nexport default awsmobile;\r\n```","upvoteCount":0,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APfE6","author":{"login":"LudoLab92"},"title":"How to retrieve the Cognito IdentityId from Post Confirmation Trigger ?","body":"Why do we need this? Here is a common use case:\r\n\r\n1. User uploads avatar to his subfolder, enforced with a policy using identity id (since we can't do it using the user pool sub): arn:aws:s3:::mybucket/${cognito-identity.amazonaws.com:sub}/avatar.jpg\r\n2. Users should access avatars (their own with read/write and the other ones with read), so we need to know the cognito identityId of every user in the database to be able to build the path the the avatars.\r\n\r\nI have found an issue created more than 5 years ago here: https://github.com/amazon-archives/amazon-cognito-identity-js/issues/302 and topics on StackOverflow, there is no solution given to this issue.\r\n\r\nIs there a way to do it in 2022 or do we still have to compose with unsecure workarounds?\r\n\r\nHere are some solutions that in my opinion would be great:\r\n\r\n1. Being able to declare IAM policies using the sub UserPool (so we would never have to deal with the Cognito IdentityId)\r\n2. Being able to get the Cognito IdentityId as a parameter from the Post Confirmation lambda event (it would solve the issue and it doesn't sound too complicated to achieve)\r\n3. Being able to fetch a Cognito IdentityId from a sub UserPool thanks to a server-to-server API call (start being weird but would be secured and could be transactionnal with the Post Confirmation trigger)\r\n\r\nAs far is i know, nothing of this is still possible, and i don't see any other reliable way.\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APc8g","author":{"login":"ZYinMD"},"title":"[doc] one doc seems to have wrong code","body":"https://docs.amplify.aws/cli/graphql/overview/ this entire page seems to show wrong signatures of `API.graphql(...)`, and I don't think the code would work. The correct signature should be either `API.graphql(graphqlOperation(query, { input }))` or `API.graphql({ query, variables })`, I think.\r\n\r\n![image](https://user-images.githubusercontent.com/32368482/166608464-9867149b-37fa-4e5d-a2bd-531fd2f3803b.png)\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APaxl","author":{"login":"ZYinMD"},"title":"Can I create a user from a uid, similar to the \"custom token\" approach in Firebase, without involving password?","body":"I'm migrating a web app from firebase to Amplify. In firebase, you can silently sign-up / sign-in a user without any user interaction or password, as long as you somehow already have a unique identifier of the user. I wonder if Amplify has a equivalent flow. The process is something like this:\r\n\r\n```ts\r\n// backend:\r\nfunction exchangeUidForToken(uid: string) {\r\n  const jwt = await firebaseAdmin.auth.createCustomToken(uid);\r\n  return jwt;\r\n}\r\n\r\n// frontend:\r\nfunction authByUid(uid: string) {\r\n  const jwt = await backendFunctions.exchangeUidForToken(uid);\r\n  await firebase.auth.signInWithToken(jwt);\r\n  // user is now signed in\r\n}\r\n```\r\n\r\nSo if you have a unique identifier from your other logic, you can auth the user. The same code can be used for both sign-up and sign-in, because all you're doing is translate a fixed uid into the corresponding user.\r\n\r\nIs something similar available in Amplify?\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APa-E","author":{"login":"LokeshBhatt79"},"title":"Amplify backend build is failing most of the time but some time it works","body":"We have setup an amplify CI/CD pipeline with Auto-Build Enabled, but most of the times build fails while building the backend, but sometime it works. So, not sure why does it fail most if the times. There is no error provided in the failures. We tried removing --simple but it behaves same way. We are having around than 64 python lambda functions which we deploy using amplify.\r\n\r\nAmplify CLI: Latest\r\n\r\nHere is the last log where it stops - \r\n`2022-04-29T11:19:20.308Z [WARNING]: ⠙ Creating virtual environment...\r\n2022-04-29T11:19:20.313Z [WARNING]: \b\r\n2022-04-29T11:19:20.313Z [WARNING]: ⠇ Locking...\r\n2022-04-29T11:19:20.343Z [WARNING]: \b\r\n2022-04-29T11:19:20.343Z [WARNING]: ⠧ Creating virtual environment...\r\n2022-04-29T11:19:20.347Z [WARNING]: \b\r\n⠇ Creating virtual environment...\r\n2022-04-29T11:19:20.366Z [WARNING]: \b\r\n⠙ Creating virtual environment...\r\n2022-04-29T11:19:20.381Z [WARNING]: \b\r\n⠼ Creating virtual environment...\r\n2022-04-29T11:19:20.388Z [WARNING]: \b\r\n⠹ Creating virtual environment...\r\n2022-04-29T11:19:20.394Z [WARNING]: \b\r\n2022-04-29T11:19:20.394Z [WARNING]: ⠏ Locking...\r\n2022-04-29T11:19:20.401Z [WARNING]: \b\r\n2022-04-29T11:19:20.401Z [WARNING]: ⠸ Locking...\r\n2022-04-29T11:19:20.423Z [WARNING]: \b\r\n⠇ Creating virtual environment...\r\n2022-04-29T11:19:20.427Z [WARNING]: \b\r\n2022-04-29T11:19:20.427Z [WARNING]: ⠏ Creating virtual environment...\r\n2022-04-29T11:19:20.446Z [WARNING]: \b\r\n2022-04-29T11:19:20.446Z [WARNING]: ⠹ Creating virtual environment...\r\n2022-04-29T11:19:20.462Z [WARNING]: \b\r\n⠴ Creating virtual environment...\r\n2022-04-29T11:19:20.468Z [WARNING]: \b\r\n⠸ Creating virtual environment...\r\n2022-04-29T11:19:20.474Z [WARNING]: \b\r\n2022-04-29T11:19:20.474Z [WARNING]: ⠋ Locking...\r\n2022-04-29T11:19:20.504Z [WARNING]: \b\r\n⠏ Creating virtual environment...`\r\n\r\nHere is the amplify.yml - \r\n`version: 1\r\nbackend:\r\n  phases:\r\n    build:\r\n      commands:\r\n        - update-alternatives --install /usr/bin/python3 python3 /usr/local/bin/python3.9 11\r\n        - /usr/local/bin/pip3.9 install --upgrade pip\r\n        - /usr/local/bin/pip3.9 install --user pipenv\r\n        - amplifyPush\r\nfrontend:\r\n  phases:\r\n    preBuild:\r\n      commands:\r\n        - yarn install\r\n        - yarn next --version\r\n    build:\r\n      commands:\r\n        - yarn run build\r\n  artifacts:\r\n    baseDirectory: out\r\n    files:\r\n      - \"**/*\"\r\n  cache:\r\n    paths:\r\n      - node_modules/**/*\r\n` \r\nAny solution to this issue?","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjMwNzk2","author":{"login":"steve-ng"},"title":"Enable pop out for federated","body":"Currently I am using `import { Auth } from '@aws-amplify/auth'`\r\n\r\nand in order to do social login, i've a button, on click will call this method `Auth.federatedSignIn({provider: \"Google\"})` \r\n\r\nIs there a way to configure it to show as pop up over over a redirection of the current window?","upvoteCount":7,"comments":{"edges":[{"node":{"author":{"login":"Zach45"},"body":"I would really love to see a solution to this, it's crazy how little customization there is with userpool social log in."}},{"node":{"author":{"login":"hkjpotato"},"body":"@steve-ng Are you referring to web or react-native platform? For RN it could be challenging. For web, by popup I assume you means a headless browser like this? https://dev.to/dinkydani21/how-we-use-a-popup-for-google-and-outlook-oauth-oci"}},{"node":{"author":{"login":"evanlarkin10"},"body":"I am hoping to accomplish this in react native, has anyone made that happen? In fact Apple decided to reject our version because we link out of the app for oauth flows."}}]}}},{"node":{"id":"D_kwDOBkswNc4APZ7L","author":{"login":"sayu-agiliad"},"title":"Invoke AdminQueries API from NextJS API Route","body":"Hi,\r\nI am developing a NextJS app where I need to invoke the Cognito listUsers AdminQuery inside my nextJS API route . However, when I run the application in dev mode, I get a 403 for the API.get. \r\nI have verified that\r\n1. The Auth token (JWT) is correct.\r\n2. I get the API and Auth instances from withSSRContext.\r\n\r\nThe same code when run on the client side works like a charm, but when put in an API route, it does not work.\r\nCan anyone please help. I am a bit new to AWS / Amplify.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APZnS","author":{"login":"BobToninho"},"title":"Can DataStore manage schemas with no `id: ID!`?","body":"Hi, I am trying to implement DataStore in an existing AppSync GraphQL backend, but I have the same problem as https://github.com/aws-amplify/amplify-js/issues/6912\r\n\r\nThis a type of my schema, but basically all of the types are like this (without `id: ID!`):\r\n\r\n```graphql\r\ntype MyType\r\n@model\r\n@auth(rules: [\r\n\t{ allow: public, operations: [create, update] }\r\n\t{ allow: private }\r\n])\r\n@key(fields: [\"pk\", \"sk\"])\r\n{\r\n\tpk: String!\r\n\tsk: String!\r\n\t# other fields...\r\n}\r\n```\r\n\r\nQuestions\r\n1. As long as I understand, currently DataStore does **not** support schemas of this kind. It requires an `id: ID!` key. Is this correct?\r\n2. If this is correct, what would be the faster solution to implement this with less issues as possible?\r\n\r\nThank you!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APZYb","author":{"login":"CodalReef"},"title":"Integrating Cognito in an Expo App without Amplify","body":"I'm attempting to integrate Cognito with federated sign-on in my expo app, but I'm finding Amplify to be very heavy.\r\n\r\nI already have Cognito sign-in working, but I'd like to add federated access through Apple.\r\n\r\nAll the tutorials I see require me to run `amplify init`.  For example:  https://dev.to/aws/the-complete-react-native-guide-to-user-authentication-with-the-amplify-framework-ib2\r\n\r\nI ran `amplify init` and it created a bunch of files which I have a cursory understanding of from the docs here:  https://docs.amplify.aws/cli/reference/files/\r\n\r\nI have my own backend API deployed and working.  The *only* service I currently need is Cognito.  Is there a way to make this happen without adapting all of Amplify?\r\n","upvoteCount":3,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APZQm","author":{"login":"Anthony-Gaudino"},"title":"How do I verify a user email when he updates his temporary password?","body":"When a user creates an account he receives an email with a temporary password.\r\n\r\nOn first login the user has to input a new password. How can I confirm the user address (set `email_verified` to true) when the user inputs a new password?\r\nIs there a parameter in `Auth.completeNewPassword` that I can pass to accomplish this?\r\n\r\nThe logic is that since the user received the temporary password by email and used it to login his email is verified.","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APYms","author":{"login":"funes79"},"title":"Notification unauthorized in schema where groups are granted to allow","body":"Given the below schema when a userA (admin) logs in - he receives subscriptions data. But when another userB logs in (non admin) - he can create a Notification, but cannot subscribe to it.\r\n\r\n```\r\ntype Notification\r\n  @model(timestamps: { createdAt: \"createdOn\", updatedAt: \"updatedOn\" })\r\n  @auth(\r\n    rules: [\r\n      { allow: groups, groups: [\"admins\"] }\r\n      { allow: owner, ownerField: \"author\" }\r\n    ]\r\n  ) {\r\n...\r\n```\r\n\r\nError message:\r\n`\"Connection failed: {\"errors\":[{\"errorType\":\"Unauthorized\",\"message\":\"Not Authorized to access onCreateNotification on type Notification\"}]}\"`\r\n\r\nIs this a bug or intended feature? If it is not a bug, how can I achieve a setup where userB will receive notifications only on records created by userB (`owner=userB`), but userA will receive (will subscribe to) to all notifications.\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APXNN","author":{"login":"sansavision"},"title":"How can I implement a chat schema with @manyToMany using Amplify GraphQL with non private/public auth rules?","body":"I was trying to implement a chat feature that has three models; message, user and conversation.\r\nA user can have many conversations, a conversation can have many users and a conversation can have many messages.\r\n\r\nI tried using @manytomany between the user and conversation models with authenticated rules set to owner, this however fails because of \" Not Authorized to access on type error\". Im using graphql API (Not Datastore) with cognito user pool.\r\n\r\nIf I set the allow rule to private then it works but then that would mean that the users in a conversation would have access to each others user model and through that access to other conversations that the users might have.\r\n\r\nOne could maybe use a query filter and only show the relevant conversations but it would still mean that the user data is accessible to all signed in users. Maybe one could use a lambda function.\r\n\r\nThe simple explanation however is that my model is incorrect. My question is as follows, how can we create a simple chat with the above three models where the users in a conversation would only have access to the relevant data (messages in a conversation) and not have have access to each others, other conversations and messages.\r\n\r\nThe chat schema\r\n\r\ntype User @model @auth(rules: [{ allow: owner }]) {\r\nid:ID!\r\nusername: String!\r\nconversations: [Conversation] @manytomany(relationName: \"ConversationUser\")\r\n}\r\n\r\ntype Conversation @model @auth(rules: [{ allow: owner }]) {\r\nid: ID!\r\nusers: [User] @manytomany(relationName: \"ConversationUser\")\r\nMessages: [Message] @hasmany(indexName: \"byConversation\", fields: [\"id\"])\r\n}\r\n\r\ntype Message @model @auth(rules: [{ allow: owner }]) {\r\nid: ID!\r\nauthor: ID!\r\ncontent: String!\r\nconversationID: ID! https://github.com/Index(name: \"byConversation\", sortKeyFields: [\"createdAt\"])\r\n}\r\n\r\nAmplify CLI Version : 8.0.2","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNTkyMg==","author":{"login":"jbprat"},"title":"Auth.currentSession() is null when relaunching the page","body":"Hi,\r\n\r\nI'm trying to check is a user currently signed in when reloading the a web page, before doing any request that requires a JWT.\r\n\r\nHere is my code: \r\n```\r\n  axios.interceptors.request.use(\r\n    (config) => {\r\n      return new Promise((resolve, reject) => {\r\n        Auth.currentSession()\r\n          .then((session) => {\r\n            const idTokenExpire = session.getIdToken().getExpiration();\r\n            const refreshToken = session.getRefreshToken();\r\n            const currentTimeSeconds = Math.round(Date.now() / 1000);\r\n\r\n            if (idTokenExpire < currentTimeSeconds) {\r\n              Auth.currentAuthenticatedUser().then((res) => {\r\n                res.refreshSession(refreshToken, (err: any, data: any) => {\r\n                  if (err) {\r\n                    signOut();\r\n                  } else {\r\n                    config.headers.Authorization =\r\n                      'Bearer ' + data.getIdToken().getJwtToken();\r\n                    resolve(config);\r\n                  }\r\n                });\r\n              });\r\n            } else {\r\n              config.headers.Authorization =\r\n                'Bearer ' + session.getIdToken().getJwtToken();\r\n              resolve(config);\r\n            }\r\n          })\r\n          .catch(() => {\r\n            if (token && !isTokenExpired)\r\n              config.headers.Authorization = `Bearer ${token}`;\r\n\r\n            resolve(config);\r\n          });\r\n      });\r\n    }\r\n```\r\n\r\nThe `Auth.currentSession().then((session) => )` returns something right after the user connects. \r\nIf I reload the page,` Auth.currentSession()` is falling into the catch.\r\n\r\nIsn't Auth supposed to get its information from the localStorage, where the tokens are with `amplify-authenticator-authState` key set to `signedIn`?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"elorzafe"},"body":"@jbprat \r\n\r\nHow are you configuring the library?\r\n"}},{"node":{"author":{"login":"eliecer2000"},"body":"Hi, try adding `bypassCache: true` to the parameters of `currentAuthenticatedUser`. \r\n\r\nthis makes if the user is really logged out or was disabled it will give you the exception \r\n  \r\n      \r\n```\r\n        Auth.currentAuthenticatedUser({\r\n          bypassCache: true\r\n        })\r\n```"}}]}}},{"node":{"id":"D_kwDOBkswNc4APUV7","author":{"login":"sampleaccount2"},"title":"[v3] @searchable directive for @manyToMany","body":"```\r\ntype Post @model {\r\n  id: ID!\r\n  title: String!\r\n  content: String\r\n  tags: [Tag] @manyToMany(relationName: \"PostTags\")\r\n}\r\n\r\ntype Tag @model {\r\n  id: ID!\r\n  label: String!\r\n  posts: [Post] @manyToMany(relationName: \"PostTags\")\r\n}\r\n```\r\n\r\nI take the [docs ](https://docs.amplify.aws/cli/graphql/data-modeling/#many-to-many-relationship) as example. As I understand, in v2, when we want to create a N:N relationship table, `PostTags` model will be created automatically which is really convenient. However, I want to search for a list of `Post`s with some `Tag` sorted by `createdAt` and paginated. Is it possible to use `@searchable` directive with `@manyToMany`?\r\n\r\nA follow up question is how do we also define other directives for a `manyToMany` model? Say I want to include `@model(timestamps: { createdAt: \"createdOn\", updatedAt: \"updatedOn\" })` for `PostTags`. I have some questions:\r\n1. Must I create the model manually? \r\n2. If so, it seems like `@key` and `@connection` has been deprecated in v2, so how would I go about doing it? ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APSUi","author":{"login":"entest-hai"},"title":"PubSub unsubscribe completes before sign out?","body":"I am using [Amplify PubSub to subscribe to an IoT topic](https://docs.amplify.aws/lib/pubsub/subunsub/q/platform/js/#subscribe-to-a-topic). I want to unsubscribe before sign out. However, sign out happens before unsubscribe. Please help. ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APSPV","author":{"login":"entest-hai"},"title":"withAuthenticator with pre-filled username and password?","body":"Hello, \r\n\r\nI am doing a demonstration and need pre-filled username and password for the login form provided by withAuthenticator? Can anyone tell me how to do it? \r\n\r\nThank you ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AN0VV","author":{"login":"mohitsuccessive"},"title":"Regarding Amplify Datastore Connectivity","body":"I am able to connect Amplify Datastore with Dynomodb and synchronization is also working fine but I don't want to use Dynomodb tables in my process. I want my Datastore to directly call my HTTP API.\r\n\r\nI want to create an application that works offline and when users come online it will call my custom HTTP API and sync that data to the local datastore.\r\n\r\nCan anybody suggest to me how can I achieve this by using amplify","upvoteCount":0,"comments":{"edges":[{"node":{"author":{"login":"david-mcafee"},"body":"@mohitsuccessive - currently, the DataStore sync engine only works with AWS AppSync."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjMwNjUy","author":{"login":"kheriox-technologies"},"title":"Handle unsynched Datastore during graphql schema changes","body":"Hello Team,\r\n\r\nWe are using Amplify Datastore and App Sync for our Offline requirements in react application.\r\nOur end users use this app in offline mode in the field. The data from their app will be synched with AppSync (Dynamo DB) when they come online.\r\nDuring our recent release, we added a new entity to the AppSync graphql schema. There was some unsynched data in the local data store. This unsynched data is deleted from the local data store after the release.\r\n\r\nWe would like to know if there any way to sync the data before refreshing / re-initializing the local data store with the new schema so that we won't lose unsynched data when we do app sync schema changes.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"david-mcafee"},"body":"@kheriox-technologies - currently, schema changes are performed prior to processing the mutation queue when DataStore starts, meaning that if there are local changes that have not yet been persisted to AppSync, they will be cleared."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzIxNDY4","author":{"login":"mir1198yusuf"},"title":"Does Datastore sync with backend if changes on backend and app is closed","body":"There is a config called `fullSyncInterval` . When this time finishes and app is closed for a long time (not inactive , not in background, but closed completely), does syncing with backend happens?  or it  starts to happen when app is opened again? ","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"david-mcafee"},"body":"Hi @mir1198yusuf - thanks for starting this discussion! A sync will not occur until the app has been opened, and is online. The first time DataStore is started on a new client, a full sync is performed. Subsequent reloads of the app (including browser refresh, or a new browser session) are delta syncs. If it has been greater than the `fullSyncInterval` (a configurable value) since the client has performed a full sync, this operation occurs as a full sync. However, syncs only occur when the app has been opened, and is online."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjQxOTgx","author":{"login":"mdegrees"},"title":"Is there a way to ignore DataStore subscription events if the listener is the event emitter?","body":"When using \r\n```javascript\r\n   const subscription = DataStore.observe(SomeModel, someModel.id).subscribe(\r\n      (msg) => {}\r\n    );\r\n```\r\nHow do you avoid reacting to an incoming event when we are the event emitter?\r\n\r\nthank you.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"david-mcafee"},"body":"@mdegrees - `observe` will always return subscription events to all users, including the author of the event. Can you explain your use case further so we can better understand the issue? Thanks!"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTA0MzQw","author":{"login":"leonardocfor"},"title":"How to get Amplify project and be able to execute amplify push","body":"Hi everybody, \r\n\r\nI have an amplify project already deployed in the Cloud and in production. Whenever I want to make a change, for example in schema.graphql for the database, I do it from the same computer where I initialized the project. How can I do it from another computer ? Not only the database but in general, update authentication, etc., i.e. admin privileges from another computer. \r\n\r\nThank you, ","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"david-mcafee"},"body":"@leonardocfor thanks for starting this discussion! This workflow is documented in [this section of our docs](https://docs.amplify.aws/cli/start/workflows/#amplify-pull). Let me know if you have any other questions!"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xOTEzMDMy","author":{"login":"tshad"},"title":"Datastore local data disappears","body":"Is there a time limit when the datastore data which resides in IndexedDB will be deleted?\r\n\r\nI am not synching with the cloud yet and it was working fine. I hadn't run the project for about 2 weeks.  When I started the project again, all the data was gone. When I looked in dev tools, there are no records there.\r\n\r\n![image](https://user-images.githubusercontent.com/12076957/105226291-a9224100-5b14-11eb-8aa7-2818f1c47dc6.png)\r\n\r\nThanks,\r\nTom","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"egyangel"},"body":"Hi did you manage to solve this problem? \r\nhaving same thing here..."}},{"node":{"author":{"login":"david-mcafee"},"body":"@tshad and @egyangel - are you using DataStore strictly in local-only mode, or is there an AppSync backend that has been provisioned? Also, can you confirm if you have performed `DataStore.clear`, or if you have perhaps cleared local storage manually at any point? When you mention that you started the project again, was it on a local server? Thank you!"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDA4MzU4","author":{"login":"ramakrishnan"},"title":"DataStore update sending only updated attributes from v3.4.0","body":"Starting from amplify-js 3.4.0 DataStore save (update) on a existing model sends only the updated attributes. Is there any option to send all the attributes.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"david-mcafee"},"body":"@ramakrishnan - when DataStore sends a mutation to AppSync, we only send updated attributes. However, the most recent version of DataStore now sends _all_ fields to the customer (even those that are not updated) in each of the `observe` and `observeQuery` snapshots. Does this solve your issue? If not, could you let us know a little more about your use case? Thank you!"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzkwNTQ5","author":{"login":"mdegrees"},"title":"How to query a DataStore Model that has nested properties?","body":"Hi everyone, anyone has an idea how I can query a model with a predicate on a nested object. I'm working with the following schema:\r\n\r\n```graphql\r\ntype Post @model {\r\n  id: ID\r\n  title: String\r\n  tags: [Tag]\r\n}\r\n\r\n# e.g title=\"foo\" , color=\"yellow\"\r\ntype Tag {\r\nid: ID\r\ntitle: String\r\ncolor: String\r\n}\r\n```\r\nHow can I get posts where tag title = 'foo' ?\r\n\r\nIt's not possible with predicates as they seem to work only on first level fields. I thought about using the `contains' predicate, but it does not work on an array of objects. Any ideas how I can get around this?\r\n\r\nthank you\r\n\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"david-mcafee"},"body":"@mdegrees thanks for starting this discussion! I believe the most straightforward approach here would be to set up a \"many to many\" relationship between `Post` and `Tag`, [as described in our docs](https://docs.amplify.aws/lib/datastore/relational/q/platform/js/#many-to-many). Let me know if that works for you!"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzg2MjA3","author":{"login":"trungphotobank"},"title":"Login by with \"LINE\" by OpenID, do we have document for that (React native - Cognito - OpenId - Line)","body":"I have implement \"Login with facebook\" successfully,\r\nBut I got some problem to implement with \"Login with Line\"\r\n\r\nPlease help me!. Thanks u !!!!\r\n<img width=\"344\" alt=\"Screen Shot 2021-05-28 at 14 51 04\" src=\"https://user-images.githubusercontent.com/54518789/119949496-2169a900-bfc4-11eb-9ac2-293d8c9b1294.png\">\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"trungphotobank"},"body":"closed!"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xOTI3","author":{"login":"ARChatco"},"title":"is amplify codegen removing always the custom queries you have made?","body":"So I have done my own listUsers. returning less fields and when I do amplify push and I choose update, it is not adding the new stuff from schema, is also removing my custom queries,\r\n\r\nAm I missing something?\r\n\r\nThanks!","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"RossWilliams"},"body":"Where are you saving your 'listUsers'? At the top of the queries.ts and queries.js files is a comment.\r\n```\r\n// this is an auto generated file. This will be overwritten\r\n```"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMDQ2","author":{"login":"karrettgelley"},"title":"AppSync SDK vs @aws-amplify/api","body":"I have been working on a react web app for a while and I have been using the api module (`@aws-amplify/api`). Love that package. It has done everything I need it to do. However, I am trying to pivot into a mobile. I now would like to create a react native mobile app that is offline enabled. I still want to keep my react app. There are two recommendations in the docs regarding [amplify and offline support](https://docs.amplify.aws/lib/graphqlapi/offline/q/platform/js): 1. Use DataStore  and 2. Use the AppSync SDK. \r\nI'm averse to using DataStore given that it's so new and does not have first class support for multi-tenant apps. But like I said, I have been using the api module for the longest and I have never heard of the AppSync sdk. It's documentation is fairly sparse and I'm wondering how it differs from `@aws-amplify/api`. Does anybody use it? Would you say that you either use `@aws-amplify/api` _or_ the AppSync SDK, or are they not mutually exclusive? Is the AppSync SDK part of the amplify framework or is it a one-off package for general use? And if `@aws-amplify/api` doesn't support offline cases, will it in the future? And what is the long term support of the AppSync SDK?\r\n\r\nI know that's a lot of questions :). I'm just trying to figure out how this lowly mentioned package fits into the amplify ecosystem and what its purpose is. ","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"d2kx"},"body":"The AppSync SDK is what they initially started with, basically it's an extension of the popular Apollo GraphQL Client (https://www.apollographql.com/docs/react/). However, it is stuck on version 2.4 of the Apollo Client, and they since have released standalone Apollo Links to use with new versions of the Apollo Client (https://github.com/awslabs/aws-mobile-appsync-sdk-js#using-authorization-and-subscription-links-with-apollo-client-no-offline-support). These do not support the Offline use-case out of the box either, however.\r\n\r\nI doubt they'll integrate any offline support into @aws-amplify/api, because there are many ways to do it and not everyone needs it and they don't want to bloat the library. The DataStore is probably what they'll push for your use-case going forward.\r\n\r\nYou can either use the Apollo Client with the AppSync SDK-Apollo Links and apollo-cache-persist (https://github.com/apollographql/apollo-cache-persist), which is more or less what the AppSync SDK was doing before they kind of dropped it because it was stuck on version 2.4 and focus shifted to @aws-amplify/api and the DataStore, or you can continue to use @aws-amplify/api and think about how to manage this yourself. E.g. if you are using a state management like redux, there are libraries that help you to persist it into IndexedDB for Web and AsyncStorage for React Native use-cases, or you build something yourself.\r\n\r\nI absolutely sympathize with your issue, however this is a subject that will always be in flux, and hard to find a balance between what some users want vs. what other users want. I encourage you to make yourself familiar with IndexedDB for Web, AsyncStorage for ReactNative and simple ways to build your own small data stores and/or cache layers. It's fun and will help you going forward."}},{"node":{"author":{"login":"david-mcafee"},"body":"> I'm averse to using DataStore given that it's so new and does not have first class support for multi-tenant apps.\r\n\r\nHi @d2kx! I know this discussion is 2 years old now, but wanted to follow up with some feedback for future users. DataStore would give you the offline support you need across multiple platforms, and has been around for some time now. \r\n\r\n\r\n> Does anybody use [the AppSync SDK]? \r\n\r\nThe AppSync SDK exists for users that have a preference for using Apollo.\r\n\r\n\r\n> Would you say that you either use `@aws-amplify/api` _or_ the AppSync SDK, or are they not mutually exclusive? \r\n\r\nUsing the two together would mean you would have 2 clients, which would be unnecessary.\r\n\r\n\r\n> Is the AppSync SDK part of the amplify framework or is it a one-off package for general use? \r\n\r\nAmplify and the AppSync SDK can be used together, but they are separate packages.\r\n\r\n\r\n> And if `@aws-amplify/api` doesn't support offline cases, will it in the future? And what is the long term support of the AppSync SDK?\r\n\r\nIf you're using Apollo V2, offline support is available. There is no current plan for offline support with Apollo V3.\r\n\r\nHope this answers any questions you may have!"}}]}}},{"node":{"id":"D_kwDOBkswNc4AOVYx","author":{"login":"laclance"},"title":"DataStore: What is the best way to approach privacy and clearing the local database on signin/out while preventing data loss?","body":"### Before opening, please confirm:\n\n\n- [X] I have [searched for duplicate or closed issues](https://github.com/aws-amplify/amplify-js/issues?q=is%3Aissue+) and [discussions](https://github.com/aws-amplify/amplify-js/discussions).\n- [X] I have read the guide for [submitting bug reports](https://github.com/aws-amplify/amplify-js/blob/main/CONTRIBUTING.md#bug-reports).\n- [X] I have done my best to include a minimal, self-contained set of instructions for consistently reproducing the issue.\n\n### JavaScript Framework\n\nReact\n\n### Amplify APIs\n\nDataStore\n\n### Amplify Categories\n\nNot applicable\n\n### Environment information\n\n<details>\r\n\r\n```\r\n# Put output below this line\r\n System:\r\n    OS: Windows 10 10.0.19042\r\n    CPU: (8) x64 Intel(R) Core(TM) i5-10210U CPU @ 1.60GHz\r\n    Memory: 7.05 GB / 15.84 GB\r\n  Binaries:\r\n    Node: 14.18.1 - C:\\Program Files\\nodejs\\node.EXE\r\n    Yarn: 1.22.17 - C:\\Program Files\\nodejs\\yarn.CMD\r\n    npm: 6.14.15 - C:\\Program Files\\nodejs\\npm.CMD\r\n  Browsers:\r\n    Edge: Spartan (44.19041.1266.0), Chromium (96.0.1054.34)\r\n  npmPackages:\r\n    @aws-amplify/core: ^4.3.8 => 4.3.8\r\n    @aws-amplify/datastore: ^3.7.0 => 3.7.0\r\n    @babel/helper-call-delegate: ^7.12.1 => 7.12.13\r\n    @capacitor-community/electron: ^4.0.3 => 4.0.3\r\n    @capacitor/android: ^3.3.1 => 3.3.1\r\n    @capacitor/app: ^1.0.5 => 1.0.6\r\n    @capacitor/core: ^3.3.1 => 3.3.1\r\n    @capacitor/device: ^1.0.5 => 1.0.6\r\n    @material-ui/core: ^4.11.3 => 4.12.3\r\n    @material-ui/icons: ^4.11.2 => 4.11.2\r\n    @testing-library/jest-dom: ^5.11.9 => 5.15.0\r\n    @testing-library/react: 12.1.2 => 12.1.2\r\n    @testing-library/user-event: ^13.5.0 => 13.5.0\r\n    @types/crypto-js: ^4.0.2 => 4.0.2\r\n    @types/intl-tel-input: ^17.0.3 => 17.0.4\r\n    @types/jest: ^27.0.2 => 27.0.2\r\n    @types/node: 16.11.6 => 16.11.6\r\n    @types/qrcode.react: ^1.0.1 => 1.0.2\r\n    @types/react: ^17.0.30 => 17.0.34\r\n    @types/react-dom: ^17.0.0 => 17.0.11\r\n    @types/uuid: ^8.3.0 => 8.3.1\r\n    @typescript-eslint/eslint-plugin: 5.3.0 => 5.3.0 (4.33.0)\r\n    @typescript-eslint/parser: 5.3.0 => 5.3.0 (4.33.0)\r\n    array-move: ^4.0.0 => 4.0.0\r\n    clsx: ^1.1.1 => 1.1.1\r\n    crypto-js: ^4.1.1 => 4.1.1\r\n    eslint-plugin-prettier: ^4.0.0 => 4.0.0\r\n    eslint-plugin-react: ^7.26.1 => 7.26.1\r\n    eslint-plugin-react-hooks: ^4.2.0 => 4.2.0\r\n    graphql: ^16.0.1 => 16.0.1 (14.5.0, 14.0.0)\r\n    graphql-tag: ^2.12.6 => 2.12.6\r\n    i18next: ^21.3.2 => 21.4.0\r\n    intl-tel-input: ^17.0.13 => 17.0.13\r\n    jwt-decode: ^3.1.2 => 3.1.2\r\n    ksuid: ^3.0.0 => 3.0.0\r\n    prettier: ^2.4.1 => 2.4.1\r\n    qrcode.react: ^1.0.1 => 1.0.1\r\n    react: ^17.0.1 => 17.0.2\r\n    react-dnd: ^14.0.4 => 14.0.4\r\n    react-dnd-html5-backend: ^14.0.2 => 14.0.2\r\n    react-dom: ^17.0.1 => 17.0.2\r\n    react-i18next: ^11.12.0 => 11.13.0\r\n    react-indiana-drag-scroll: ^2.1.0 => 2.1.0\r\n    react-loader-spinner: ^4.0.0 => 4.0.0\r\n    react-scripts: 4.0.3 => 4.0.3\r\n    react-simple-keyboard: ^3.3.7 => 3.3.26\r\n    shelljs: ^0.8.4 => 0.8.4\r\n    typescript: 4.4.4 => 4.4.4\r\n    universal-cookie: ^4.0.4 => 4.0.4\r\n  npmGlobalPackages:\r\n    @aws-amplify/cli: 7.5.2\r\n    cross-env: 7.0.3\r\n    npm: 6.14.15\r\n    yarn: 1.22.17\r\n\r\n```\r\n\r\n</details>\r\n\n\n### Describe the bug\n\nTrying to clear datastore after a mutation causes this error:\r\nDOMException: Failed to execute 'transaction' on 'IDBDatabase': The database connection is closing.\n\n### Expected behavior\n\nShould be able to wait for mutations to complete before disconnecting.\n\n### Reproduction steps\n\n1. Make a mutation.\r\n2. Clear datastore\n\n### Code Snippet\n\n```javascript\r\n// Put your code below this line.\r\n\r\n        //logout\r\n        try {\r\n          await DataStore.save(new DataTable(unsavedData));\r\n          await DataStore.clear();\r\n        } catch (e) {\r\n          console.error('logout err', e);\r\n        }\r\n```\r\n\n\n### Log output\n\n<details>\r\n\r\n```\r\n// Put your logs below this line\r\n\r\n[DEBUG] 46:14.36 Hub - Dispatching to datastore with  {event: 'outboxMutationEnqueued', data: {…}}\r\nConsoleLogger.ts:125 [DEBUG] 46:14.36 Hub - Dispatching to datastore with  {event: 'outboxMutationEnqueued', data: {…}}\r\nConsoleLogger.ts:125 [DEBUG] 46:14.36 Hub - Dispatching to datastore with  {event: 'outboxMutationEnqueued', data: {…}}\r\nConsoleLogger.ts:125 [DEBUG] 46:14.37 Hub - Dispatching to datastore with  {event: 'outboxMutationEnqueued', data: {…}}\r\nConsoleLogger.ts:125 [DEBUG] 46:14.37 Hub - Dispatching to datastore with  {event: 'outboxMutationEnqueued', data: {…}}\r\nConsoleLogger.ts:125 [DEBUG] 46:14.37 Hub - Dispatching to datastore with  {event: 'outboxStatus', data: {…}}\r\nConsoleLogger.ts:125 [DEBUG] 46:14.37 Hub - Dispatching to datastore with  {event: 'outboxStatus', data: {…}}\r\nConsoleLogger.ts:125 [DEBUG] 46:14.37 Hub - Dispatching to datastore with  {event: 'outboxStatus', data: {…}}\r\nConsoleLogger.ts:125 [DEBUG] 46:14.38 Hub - Dispatching to datastore with  {event: 'outboxStatus', data: {…}}\r\nConsoleLogger.ts:125 [DEBUG] 46:14.38 Hub - Dispatching to datastore with  {event: 'outboxStatus', data: {…}}\r\nConsoleLogger.ts:115 [DEBUG] 46:14.56 DataStore - Attempting mutation with authMode: API_KEY\r\nConsoleLogger.ts:115 [DEBUG] 46:14.56 Util -  attempt #1 with this vars: [\"DataTable\",\"Create\",\"{\\\"test\\\":\\\"test\\\",\\\"id\\\":\\\"8ed1246f-6dfa-4b54-92d2-a3ae353d0d4a\\\"}\",\"modelId\":\"8ed1246f-6dfa-4b54-92d2-a3ae353d0d4a\",\"model\":\"DataTable\",\"operation\":\"Create\",\"condition\":\"{}\",\"id\":\"01FNDT3TP0P2KJSKFTG7T43NWF\"}]\r\nConsoleLogger.ts:125 [DEBUG] 46:14.58 RestClient - POST https://****.appsync-api.eu-west-1.amazonaws.com/graphql\r\nConsoleLogger.ts:125 [DEBUG] 46:14.96 Hub - Dispatching to datastore with  {event: 'outboxMutationEnqueued', data: {…}}\r\nConsoleLogger.ts:125 [DEBUG] 46:14.96 Hub - Dispatching to datastore with  {event: 'outboxMutationEnqueued', data: {…}}\r\nConsoleLogger.ts:125 [DEBUG] 46:14.96 Hub - Dispatching to datastore with  {event: 'outboxMutationEnqueued', data: {…}}\r\nConsoleLogger.ts:125 [DEBUG] 46:14.96 Hub - Dispatching to datastore with  {event: 'outboxMutationEnqueued', data: {…}}\r\nConsoleLogger.ts:125 [DEBUG] 46:14.97 Hub - Dispatching to datastore with  {event: 'outboxMutationEnqueued', data: {…}}\r\nConsoleLogger.ts:125 [DEBUG] 46:14.97 Hub - Dispatching to datastore with  {event: 'outboxStatus', data: {…}}\r\nConsoleLogger.ts:125 [DEBUG] 46:14.97 Hub - Dispatching to datastore with  {event: 'outboxStatus', data: {…}}\r\nConsoleLogger.ts:125 [DEBUG] 46:14.97 Hub - Dispatching to datastore with  {event: 'outboxStatus', data: {…}}\r\nConsoleLogger.ts:125 [DEBUG] 46:14.97 Hub - Dispatching to datastore with  {event: 'outboxStatus', data: {…}}\r\nConsoleLogger.ts:125 [DEBUG] 46:14.97 Hub - Dispatching to datastore with  {event: 'outboxStatus', data: {…}}\r\nConsoleLogger.ts:115 [DEBUG] 46:14.154 DataStore - Starting Storage\r\n\r\nwrap-idb-value.js:150 Uncaught (in promise) DOMException: Failed to execute 'transaction' on 'IDBDatabase': The database connection is closing.\r\n    at Proxy.<anonymous> (http://localhost:3000/static/js/vendors~main.chunk.js:342317:22)\r\n    at IndexedDBAdapter.<anonymous> (http://localhost:3000/static/js/vendors~main.chunk.js:38191:26)\r\n    at step (http://localhost:3000/static/js/vendors~main.chunk.js:37730:17)\r\n    at Object.next (http://localhost:3000/static/js/vendors~main.chunk.js:37661:14)\r\n    at fulfilled (http://localhost:3000/static/js/vendors~main.chunk.js:37615:24)\r\n```\r\n\r\n</details>\r\n\n\n### aws-exports.js\n\n```javascript\r\nconst awsmobile = {\r\n    \"aws_project_region\": \"eu-west-1\",\r\n    \"aws_appsync_graphqlEndpoint\": \"https://.appsync-api.eu-west-1.amazonaws.com/graphql\",\r\n    \"aws_appsync_region\": \"eu-west-1\",\r\n    \"aws_appsync_authenticationType\": \"API_KEY\",\r\n    \"aws_appsync_apiKey\": \"da2-\"\r\n};\r\n```\n\n### Manual configuration\n\n_No response_\n\n### Additional configuration\n\n_No response_\n\n### Mobile Device\n\n_No response_\n\n### Mobile Operating System\n\n_No response_\n\n### Mobile Browser\n\n_No response_\n\n### Mobile Browser Version\n\n_No response_\n\n### Additional information and screenshots\n\n_No response_","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"chrisbonifacio"},"body":"Hi @laclance 👋 thanks for raising this issue. In our [documentation](https://docs.amplify.aws/lib/datastore/sync/q/platform/js/#clear-local-data), we recommend listening to the signout event from the Auth category to trigger a `DataStore.clear` call.\r\n\r\nI think there might be a race condition happening between the graphql call datastore makes and the clear/signout operations but this should work.\r\n\r\nex.\r\n```js\r\nHub.listen('auth', async (data) => {\r\n  if (data.payload.event === 'signOut') {\r\n    await DataStore.clear();\r\n  }\r\n});\r\n```"}},{"node":{"author":{"login":"laclance"},"body":"ok thank you but how do I trigger the signOut event? It's a custom login, do I have to use amplify authentication in order to clear datastore on signout?"}},{"node":{"author":{"login":"chrisbonifacio"},"body":"Ohh okay. Well, in that case, maybe you could use the `API.graphql` method to create that record before DataStore gets cleared? I think the issue is mainly that you're trying to save a record to the local database, which DataStore will always do, but the graphql queries happen separately apart from the DataStore operations. So, it might make more sense to make a call directly to the API so you don't have to worry about the DataStore websocket connection closing before the local record can be synced to the server.\r\n\r\nsomething like this:\r\n\r\n```js\r\n//logout\r\ntry {\r\n  await API.graphql({\r\n    query: createRecord,\r\n    variables: {\r\n      ...unsavedData\r\n    }\r\n  });\r\n  await DataStore.clear();\r\n} catch (e) {\r\n  console.error('logout err', e);\r\n}\r\n```"}},{"node":{"author":{"login":"laclance"},"body":"Ok yeah thank you that's probably the best idea. "}},{"node":{"author":{"login":"chrisbonifacio"},"body":"No problem 😄  Let me know if that works for you!"}},{"node":{"author":{"login":"laclance"},"body":"@chrisbonifacio is there a way to check a record has been synced to the cloud? Comparing the SubscriptionMessage when offline and online they seem to be identical?"}},{"node":{"author":{"login":"laclance"},"body":"The problem I'm having is similar to this one https://github.com/aws-amplify/amplify-js/issues/6488. If the internet goes down and I do a Datastore.save to the local db while still offline and then when the internet comes on again datastore does not sync right away and if a user wants to log out before the sync occurs I can't tell which items in the local db have been synced to the cloud or not."}},{"node":{"author":{"login":"laclance"},"body":"> `graphql`\r\n\r\nAlso tried this and get same error."}},{"node":{"author":{"login":"laclance"},"body":"Can also get the same error without trying to save right before clearing. If you do a datastore.save while offline then at any point in time clear the db and then at any point in time go online again you will get the error. So doesn't matter whether or not I try to save data before clearing will still get the error if I clear the db at any point in time while there are unsynced records."}},{"node":{"author":{"login":"chrisbonifacio"},"body":">is there a way to check a record has been synced to the cloud? Comparing the SubscriptionMessage when offline and online they seem to be identical?\r\n\r\nAs far as I know, there are two ways:\r\n\r\n1. Using the Hub utility\r\n\r\n```js\r\nReact.useEffect(() => {\r\n  DataStore.start();\r\n\r\n  const listener = async ({ payload }) => {\r\n    const { event, data } = payload;\r\n\r\n    switch (event) {\r\n        case \"ready\":\r\n          console.log(\"datastore is ready\");\r\n          break;\r\n        case \"modelSynced\":\r\n          console.log(\"modelSynced\", data.model.name);\r\n          break;\r\n        default:\r\n          console.log(\"unknown event\", event, data);\r\n      }\r\n  };\r\n\r\n  Hub.listen(\"datastore\", listener);\r\n\r\n  return () => {\r\n    Hub.remove(\"datastore\", listener);\r\n  };\r\n}, []);\r\n```\r\n\r\nconsole logs\r\n\r\n<img width=\"1438\" alt=\"Screen Shot 2021-12-01 at 2 59 23 PM\" src=\"https://user-images.githubusercontent.com/16952986/144304938-2eef2f78-5bed-49a8-991f-0cfea8becaf7.png\">\r\n\r\n2. Using `DataStore.observeQuery`\r\n\r\n```js\r\nReact.useEffect(() => {\r\n  let sub;\r\n\r\n  sub = DataStore.observeQuery(Profile).subscribe(({ items, isSynced }) => {\r\n    console.log({ items, isSynced });\r\n  });\r\n\r\n  return () => {\r\n    sub.unsubscribe();\r\n  };\r\n}, []);\r\n```\r\n\r\nconsole logs\r\n\r\n<img width=\"1440\" alt=\"Screen Shot 2021-12-01 at 3 40 31 PM\" src=\"https://user-images.githubusercontent.com/16952986/144310601-129336f6-0d02-420b-af3a-1547652d537f.png\">\r\n"}},{"node":{"author":{"login":"chrisbonifacio"},"body":"Maybe I'm misunderstanding the use case here, but why are you clearing the local database if you are anticipating the user to perform operations offline? Do you expect multiple users to be logged into the same device? If the same user is signing in, it might be best to leave the data cached locally and only clear the database if a different user logs in.\r\n\r\nhttps://docs.amplify.aws/lib/datastore/sync/q/platform/js/#clear-local-data"}},{"node":{"author":{"login":"laclance"},"body":"Thanks but those solutions don't tell me if data has synced to the cloud only locally because even when offline datastore says items are synced. Yes there are multiple users and their data needs to be private."}},{"node":{"author":{"login":"laclance"},"body":"So whether online or offline this is what I get:\r\n```\r\nevent: 'outboxMutationEnqueued'\r\nevent: 'outboxStatus', \r\n{items: Array(687), isSynced: true}\r\n```\r\n\r\nIf offline then will get event: 'modelSynced' when I come online again which is great because I can check if 'outboxMutationEnqueued' fires then wait for 'modelSynced' to check if data has been synced but if online then 'modelSynced' events only fires when I refresh the page."}},{"node":{"author":{"login":"laclance"},"body":"That I can manage though but main issue is still if app is online I want to clear datastore but save unsynced data before doing so but I get the 'Failed to execute' error."}},{"node":{"author":{"login":"chrisbonifacio"},"body":"@laclance ah okay, I see what you mean. Hmm, I'm not really sure if there's a reliable way to make sure records are synced to the server before clearing, especially if offline.\r\n\r\nPersonally, I wouldn't clear the local database unless a different user logs into the same device to try to avoid the edge case of a user logging out while offline causing records to be lost before synced. But, I may just be missing some experience on how to properly handle this.\r\n\r\nI'm going to reach out to the DataStore team to see if I can get some feedback for you on what might be the best way to approach this."}},{"node":{"author":{"login":"laclance"},"body":"Ok cool thanks so much, the only problem with not clearing is that other users can see the data in the indexdb via browser dev tools."}},{"node":{"author":{"login":"chrisbonifacio"},"body":"No problem! As a quick note, the team has pointed out that the event for when a local change has been synced to the cloud would be `outboxMutationProcessed`, rather than the enqueued changes.\r\n\r\nStill in talks about this with the team. Thank you for bearing with me in the meantime!"}},{"node":{"author":{"login":"laclance"},"body":"No problem thanks, yes I did see that but it's the same problem as the 'modelSynced' event, the events don't always get fired if you do not have a stable internet connection."}},{"node":{"author":{"login":"laclance"},"body":"All of a sudden getting this error and can't get rid of it. \r\n```index.ts:594 Uncaught (in promise) TypeError: Cannot read properties of undefined (reading 'lastFullSync')```"}},{"node":{"author":{"login":"laclance"},"body":"@chrisbonifacio deleted amplify project and recreated from scratch but still the the same error, not sure if I should maybe open a new issue because I don't know how to reproduce it, all I did was try to run Datastore.clear() after doing multiple updates, which I tried many times before without receiving this error.\r\n```\r\n[DEBUG] 30:28.849 Util -  attempt #1 with this vars: [\"query operation($limit: Int, $nextToken: String, $lastSync: AWSTimestamp, $filter: ModelPOSFilterInput){\\n\\t\\tsyncPOS(limit: $limit, nextToken: $nextToken, lastSync: $lastSync, filter: $filter){\\n\\t\\t\\titems {\\n\\t\\t\\t\\t\\t\\t\\tid\\npk\\nsk\\nentityType\\ncurrentState\\ndata\\ngsi1Pk\\ngsi1Sk\\ncreatedAt\\nupdatedAt\\n_version\\n_lastChangedAt\\n_deleted\\n\\t\\t\\t\\t\\t\\t}\\n\\t\\t\\t\\t\\t\\tnextToken\\n\\t\\t\\t\\t\\t\\tstartedAt\\n\\t\\t}\\n\\t}\",{\"limit\":1000,\"nextToken\":\"***==\",\"lastSync\":0,\"filter\":null}]\r\nConsoleLogger.ts:125 [DEBUG] 30:28.850 RestClient - POST https://***.appsync-api.eu-west-1.amazonaws.com/graphql\r\nConsoleLogger.ts:115 [DEBUG] 30:31.434 DataStore - Sync successful with authMode: API_KEY\r\nindex.ts:594 Uncaught (in promise) TypeError: Cannot read properties of undefined (reading 'lastFullSync')\r\n    at SyncEngine.<anonymous> (index.ts:594)\r\n    at step (index.ts:3)\r\n    at Object.next (index.ts:3)\r\n    at fulfilled (index.ts:3)\r\n    ```"}},{"node":{"author":{"login":"laclance"},"body":"Re-created the project again with a different table name and created a fresh frontend app with only `Amplify.configure(aws_exports);` and `DataStore.start()` and get these 2 errors:\r\n\r\n```\r\nUnhandled Rejection (TypeError): Cannot read properties of undefined (reading 'namespaces')\r\nIndexedDBAdapter.<anonymous>\r\nC:/Users/src/storage/adapter/IndexedDBAdapter.ts:115\r\n  112 | };\r\n  113 | IndexedDBAdapter.prototype.getStorename = function (namespace, modelName) {\r\n  114 |     var storeName = namespace + \"_\" + modelName;\r\n> 115 |     return storeName;\r\n      | ^  116 | };\r\n  117 | IndexedDBAdapter.prototype.setUp = function (theSchema, namespaceResolver, modelInstanceCreator, getModelConstructorByModelName, sessionId) {\r\n  118 |     return __awaiter(this, void 0, void 0, function () {\r\n  ```\r\n  \r\n  ```\r\n  Unhandled Rejection (TypeError): Cannot read properties of undefined (reading 'version')\r\nDataStore.<anonymous>\r\nC:/Users/Lance/src/datastore/datastore.ts:742\r\n  739 | };\r\n  740 | this.delete = function (modelOrConstructor, idOrCriteria) { return __awaiter(_this, void 0, void 0, function () {\r\n  741 |     var condition, msg, modelConstructor, msg, msg, _a, deleted, model, modelConstructor, msg, modelDefinition, idPredicate, msg, _b, _c, deleted;\r\n> 742 |     return __generator(this, function (_d) {\r\n      | ^  743 |         switch (_d.label) {\r\n  744 |             case 0: return [4 /*yield*/, this.start()];\r\n  745 |             case 1:\r\n  ```"}},{"node":{"author":{"login":"chrisbonifacio"},"body":"looking into similar issues in the past, these errors seem to be caused by a few things.\r\n\r\n1. Make sure DataStore is enabled for the project, of course\r\n2. Remove any unnecessary amplify packages (I see you have both `@aws-amplify/core` and `@aws-amplify/datastore`. You can either try only installing `aws-amplify` from which you can still import the scoped packages if it's the only package installed. Or, you can remove `@aws-amplify/core` because its already listed as a dependency of the scoped datastore package.\r\n3. Replace `DataStore.start()` with `DataStore.query()`"}},{"node":{"author":{"login":"laclance"},"body":"Thank you, looks like replacing dataStore.start() with DataStore.query() works, I thought the first query() called start() anyway."}},{"node":{"author":{"login":"laclance"},"body":"Also have to use the aws-amplify package now, but we were using datastore fine for almost a year with @aws-amplify/core and @aws-amplify/datastore."}},{"node":{"author":{"login":"laclance"},"body":"Still get the same error when I start using Datastore more after the first DataStore.query()."}},{"node":{"author":{"login":"laclance"},"body":"Ok now it seems to only throw errors on start and clear.\r\n\r\n`DataStore.start()` gives `Cannot read properties of undefined (reading 'lastFullSync')` but we can use `query` instead.\r\n\r\n`DataStore.clear()` still gives `DOMException: Failed to execute 'transaction' on 'IDBDatabase': The database connection is closing.` and we do want to be able to clear the db to not allow users to view other users' private information via browser dev tools.\r\n\r\nAlso using the aws-amplify package, types are not inferred which is quite annoying also can't do things like jump to the definition."}},{"node":{"author":{"login":"chrisbonifacio"},"body":"Yeah, we're still working to improve TypeScript support in our library.\r\n\r\nI was thinking about the issue you're having with clearing the database and have some thoughts I'd like to run by you because with most of the syncing process being automated and requiring an active network connection, data loss is difficult to avoid if a user were to sign out and, as a result, clear the database while offline before records have a chance to sync.\r\n\r\nI think the documentation's recommendation of real world usage being to clear the local db if a different user logs in makes more sense than simply clearing the db on signOut.\r\n\r\nDefinitely don't want to try to save a record before the database is cleared because, as mentioned before, the time it takes between a `save` and a `clear` won't be enough to ensure the record was synced through the outbox process anyway. This will probably always result in the `Failed to execute 'transaction' on 'IDBDatabase' error.\r\n\r\nSo, I was wondering if maybe there is some room for letting the data exist in the local store at least until the network status comes back online. There is also a `networkStatus` event from the `Hub`'s datastore listener that could maybe be used to check if the user is online and only clear the database if they are logged out with an active connection?"}},{"node":{"author":{"login":"laclance"},"body":"Okay, thank you. Yes but as mentioned we don't want to to allow users to view other users' private information via the dev tools. The `networkStatus` still returns true if there is a network but no internet connection. So I'm using `outboxStatus` and `outboxMutationProcessed` to check if everything has synced then running clear() after a small delay. If data doesn't get synced after a certain amount of time then I encrypt it and store it locally. Using the hub events was causing a bit of a problem with an unstable internet connection but due to the other errors we haven't had a chance to fully test it yet. "}},{"node":{"author":{"login":"chrisbonifacio"},"body":"Okay yeah that makes sense and aligns with what the team has explained to me about what is probably the best way to handle this scenario (using the outbox status and mutationProcessed events).\r\n\r\nBecause the original issue is not a bug and intended behavior I'd close this issue but I believe this is worth a more in-depth discussion so we can move it to discussions instead to keep this open for feedback."}},{"node":{"author":{"login":"laclance"},"body":"Not quite the original issue but I feel like it shouldn't be the intended behavior. As I mentioned, the outboxStatus and mutationProcessed events often don't work without a stable internet connection, same goes for subscriptions. Also if a user logs out and the internet goes off for a second and datastore stops and mutations don't get processed you going to see the same error when a user logs in and `DataStore.clear()` is called. Is one purpose of datastore not suppose to be the aid in offline/online data synchronization?  "}},{"node":{"author":{"login":"laclance"},"body":"Just got the same error now after running `DataStore.clear()` and I've had a stable internet connection and have not done a mutation."}},{"node":{"author":{"login":"ecc7220"},"body":"Is there any progress on this?"}},{"node":{"author":{"login":"perryneal11"},"body":"Also having this issue, would love a solution\r\n"}}]}}},{"node":{"id":"D_kwDOBkswNc4APPi6","author":{"login":"Zilvinaskli"},"title":"After deleting corrupted environment admin queries API and function is not being added","body":"Hello, \r\n\r\nI had a working environment that hasn't been used in a while and it was throwing errors after every amplify push command.\r\nInstead of resolving all the issues and cloudformation stacks I deleted the environment and started adding resources from a fresh start.\r\n\r\nI managed to add all the resources fine and they were working except admin queries API and functions were missing.\r\nI removed auth and dependent resources and tried to do it again, I definitely selected yes to add admin queries but still admin queries were missing. \r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APPVu","author":{"login":"eliecer2000"},"title":"Problems when exporting","body":"Hello community, I tell you about a problem I have with a project created with AWS Amplify, I have with several resolvers in the preLoadData stage, unfortunately I did not find an elegant solution to place them dataSourceName until I used the strategy of overwrite in the API, when I deploy with the CLI works great, the problem becomes when I try to export my project to CDK the overrider does not work, in the build stage when it is exported does not make this call, you can even try running the command `amplify build` and you will see that if the overrider file runs, it does not work when I run `amplify export`, I do not know whether to report this bug.\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APPIc","author":{"login":"DVGY"},"title":"Failed to deploy user pool using option \"Reuse existing Amazon Cognito resources\"","body":"The selected Cognito User Pool does not have at least 1 Web app client configured. Web app clients are app clients without a client secret. at headlessImport.\r\n\r\n![image](https://user-images.githubusercontent.com/46158826/162268161-ad1fea01-da4a-453e-a933-11bda0244f30.png)\r\n","upvoteCount":4,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APOyj","author":{"login":"proraheelaslam"},"title":"How can get the authenticated user from cookies.","body":"Hi,\r\n\r\nI have setup user and pol data in cookies for multiple domain switch. I am using this script It is working fine to set the token\r\nin cookies. When i try to get the authenticated user by this script it gives error.\r\n\r\n`var cognitoUser = new AmazonCognitoIdentity.CognitoUserPool(poolData).getCurrentUser();`\r\n\r\n```\r\namazon-cognito-identity.js:7577 Uncaught TypeError: this.storage.getItem is not a function\r\n    at CognitoUserPool.getCurrentUser (amazon-cognito-identity.js:7577:37) \r\n```\r\n\r\n```\r\nvar poolData = {\r\n     UserPoolId : '...', // Your user pool id here\r\n     ClientId : '...' // Your client id here\r\n     Storage: new AmazonCognitoIdentity.CookieStorage({domain: \"localhost\"})\r\n };\r\n\r\n var userPool = new AmazonCognitoIdentity.CognitoUserPool(poolData);\r\n\r\n var userData = {\r\n     Username: 'username',\r\n     Pool: userPool,\r\n     Storage: new AmazonCognitoIdentity.CookieStorage({domain: \"localhost\"})\r\n };\r\n```\r\n\r\nHow can get the authenticated user from cookies instead from localstorage.\r\n\r\n\r\nThanks \r\n\r\n","upvoteCount":4,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APOm1","author":{"login":"micoPhD"},"title":"Documentation on amazon-cognito-identity-js methods and functions","body":"Hi,\r\n\r\nDo we have an explicit documentation on the classes and methods used in the example use cases from the npm page (here: https://www.npmjs.com/package/amazon-cognito-identity-js)\r\n\r\nFor example:\r\nAmazonCognitoIdentity.CognitoUserAttribute\r\nAmazonCognitoIdentity.CognitoUserPool\r\nAmazonCognitoIdentity.CognitoUser\r\netc.\r\n\r\nThank you","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yODg0NjI4","author":{"login":"agrant-intix"},"title":"Cache - elasticache","body":"General question on caching API results in a next.js application.\r\n\r\nWhenever we try to connect to AWS elasticache, we get a timeout due to security issues.\r\n\r\nI understand this is due to requiring to access elasticache by a VPC which would generally exist if you were running EC2 in the same VPC to connect properly.\r\n\r\nHowever in Amplify it's all setup via Cloudfront. Is it possible to connect to elasticache from an Amplify project?\r\n\r\nAlternatively I have found you can use a react library such as \r\n\r\nconst cache = require('memory-cache');\r\n\r\nMy understanding this gets saved into memory but I'm unsure what memory and whether it is actually going to work in cloudfront with so many different cloudfront edges therefore negating the cache savings.\r\n\r\nIn my API request for example I currently have\r\n\r\nexport default async function venue(req, res){\r\n   const cache = require('memory-cache');\r\n   const cache_title = req.url;\r\n   const get_cache = cache.get(cache_title);\r\n\r\n   if( get_cache != null ){\r\n      res.status(200).json(get_cache);\r\n   } else {\r\n       const sql = require('sql-template-strings');\r\n       const db = require('../../../lib/db');\r\n       db.query(sql`SELECT xxx WHERE xxxx = xxxx`)\r\n      .then( data => {\r\n           res.status(201).json(JSON.parse(JSON.stringify(data[0])));\r\n           cache.put(cache_title, JSON.parse(JSON.stringify(data[0])), 10000); // Time in ms\r\n      });\r\n   }\r\n}\r\n\r\n","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"vbhakta8"},"body":"How can we get amplify to deploy within our VPC?"}}]}}},{"node":{"id":"D_kwDOBkswNc4ANw3R","author":null,"title":"Cognito bug on Safari 15.0 - QuotaExceededError: The quota has been exceeded.","body":"This happened on the latest Safari 15.0 on both Mac system and IOS system.\r\n\r\nSeems like sometimes the localstorage stopped working sometimes, and it could be solved by refreshing the page etc.\r\n\r\nAnyone can help?","upvoteCount":17,"comments":{"edges":[{"node":{"author":{"login":"Progressandro"},"body":"@chengjiaapraamcos Same thing here. Were you able to solve the issue?"}},{"node":{"author":{"login":"blkg"},"body":"This is happening for us too, and is particularly problematic since Safari is the #1 browser using our application, holding a 2-1 margin over its nearest competitor (Chrome).  Hope this gets fixed soon!"}},{"node":{"author":{"login":"ashika01"},"body":"@chengjiaapraamcos @Progressandro is this happening only on safari 15? and do you have any configuration related to cookie storage? Could you maybe provide a snippet of your `Amplify.configure`?"}},{"node":{"author":{"login":"coisme"},"body":"I got the same error too on Safari Version 15.0 (16612.1.29.41.4, 16612) on macOS Big Sur Version 11.6 (20G165).\r\n\r\nAfter I clear cache from `Preferences > Privacy > Manage Website Data > [Target website] > Remove`, the problem disappeared."}},{"node":{"author":{"login":"bassamrached"},"body":"Is there any update on this issue? Is it a safari problem or cognito?\r\nMore and more of our safari users are having this issue.\r\nThank you!"}},{"node":{"author":{"login":"thomasdashney"},"body":"My app was reporting this error for the last few months, I **finally** figured out how to reproduce it semi-consistently:\r\n\r\n* Open an iOS simulator (I'm using iPhone 8, iOS 15.0)\r\n* Open Safari\r\n* Close all Safari tabs\r\n* Force quit Safari\r\n* In the terminal, run this command to open your web page that breaks: `xcrun simctl openurl booted <YOUR_URL_HERE>`\r\n* After a couple of seconds, this should automatically open Safari into a state where any `localStorage.setItem` calls are throwing an instance of `QuotaExceededError`\r\n\r\nFrom my testing, it seems that the error only occurs from a cold open via a link click, and when there were no pre-existing tabs open. I run into the same bug in iOS Chrome as well.\r\n\r\nI was able to at least avoid use of `localStorage` by falling back to in-memory storage if `localStorage` isn't working:\r\n\r\n```tsx\r\nexport function getAuthStorage(): Pick<\r\n  Storage,\r\n  \"setItem\" | \"getItem\" | \"removeItem\" | \"clear\"\r\n> {\r\n  try {\r\n    window.localStorage.setItem(\"rewards.shared.test-ls\", \"1\");\r\n    window.localStorage.removeItem(\"rewards.shared.test-ls\");\r\n    // we know local storage is working\r\n    return window.localStorage;\r\n  } catch (error) {\r\n    console.warn(\"Cannot use localstorage; falling back to memory storage\");\r\n    return MemoryStorage;\r\n  }\r\n}\r\n\r\nlet dataMemory: {\r\n  [key: string]: string;\r\n} = {};\r\n\r\nexport class MemoryStorage {\r\n  static setItem(key: string, value: any) {\r\n    dataMemory[key] = value;\r\n    return dataMemory[key];\r\n  }\r\n\r\n  static getItem(key: string) {\r\n    return Object.prototype.hasOwnProperty.call(dataMemory, key)\r\n      ? dataMemory[key]\r\n      : null;\r\n  }\r\n\r\n  static removeItem(key: string) {\r\n    return delete dataMemory[key];\r\n  }\r\n\r\n  static clear() {\r\n    dataMemory = {};\r\n    return dataMemory;\r\n  }\r\n}\r\n\r\n// and then pass this custom storage when initializing cognito:\r\n\r\nAuth.configure({\r\n  storage: getAuthStorage()\r\n})\r\n```\r\n"}},{"node":{"author":null,"body":"I don't think it's a good idea to workaround this issue. \r\nLocalstorage is an important feature and we need to inform Safari to fix it.\r\nCould anyone tell me how to inform their team? A proper fix should be done on their side but not our side.\r\n\r\nThanks guys\r\n"}},{"node":{"author":{"login":"silenceisgolden"},"body":"Not having access to `localStorage` is not a new issue unfortunately [Angular2 issue link](https://github.com/marcj/angular2-localstorage/issues/73). Could Amplify fall back to in memory or choose another storage option if localStorage is not available for any reason, not just if Safari is started with a Private Browsing session?"}},{"node":{"author":{"login":"djdam"},"body":"Did anyone try indexedDB as an alternative (instead of @thomasdashney 's mem storage) ?"}},{"node":{"author":{"login":"djdam"},"body":"this seems to work, I will try it out in prod and monitor the ios users\r\n\r\nhttps://gist.github.com/djdam/1dd3d0a1023a6533419aa4ec01ff7463\r\n\r\nbtw, I used the localforage package for simplicity:\r\n\r\n`npm install localforage`\r\n\r\nedit: I had key/val mixed up, fixed it"}},{"node":{"author":{"login":"darkmarthur"},"body":"Hello people!\r\n\r\nIn my company, we are facing the same issue in our web application on iOS devices when trying to login to the application (using AWS Cognito auth) after a long period (a couple of days) of inactivity with the device browser.\r\n\r\nDoes anybody find a solution or a workaround to avoid the `QuotaExceededError` response?"}},{"node":{"author":{"login":"pawojciechowski"},"body":"Duplicate of #9140. \r\nSolution: https://github.com/aws-amplify/amplify-js/issues/9140#issuecomment-1083364359\r\nAlternatively you can setup [cookieStorage](https://docs.amplify.aws/lib/client-configuration/configuring-amplify-categories/q/platform/js/#scoped-configuration)\r\n```javascript\r\nAmplify.configure({\r\n  Auth: {\r\n    // (optional) - Configuration for cookie storage\r\n    // Note: if the secure flag is set to true, then the cookie transmission requires a secure protocol\r\n    cookieStorage: {\r\n      // - Cookie domain (only required if cookieStorage is provided)\r\n      domain: '.yourdomain.com',\r\n      // (optional) - Cookie path\r\n      path: '/',\r\n      // (optional) - Cookie expiration in days\r\n      expires: 365,\r\n      // (optional) - See: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie/SameSite\r\n      sameSite: 'strict' | 'lax',\r\n      // (optional) - Cookie secure flag\r\n      // Either true or false, indicating if the cookie transmission requires a secure protocol (https).\r\n      secure: true\r\n    },\r\n  }\r\n})\r\n```"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMDk5OQ==","author":{"login":"simon-zhangmuye"},"title":"How to send and receive message in amplify?","body":"Hi,\r\n\r\n Is there a best practice case for amplify notification just like a blog with many posts, if someone clicks Like this post or make a comment, the author will receive a message like \"username likes your post\" or someone comments your post.\r\n\r\nI am thinking about using a subscription listener, create a message model in schema.graphql and subscribe to the new messages by owner id. \r\n\r\nBut if I use rules allow owner in my modal, the senders can subscribe to the notifications sent by themselves. How can receivers get notifications and subscribe to new messages? Obviously, receivers don't need to subscribe to all messages, they just need the messages sent to them. How can I config rules this time?\r\n\r\nWhat if I have thousands of comments or likes per second, in this case, is it right to put them in one table and subscribe to all the events. What should I do?\r\n\r\nIf anyone knows how to do it, please help. \r\n\r\nThanks,\r\n\r\n","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"sw-yx"},"body":"you can publish/subscribe a single topic per user: https://docs.amplify.aws/lib/pubsub/getting-started/q/platform/js#aws-iot"}},{"node":{"author":{"login":"viprocket1"},"body":"Im also interested in this topic. "}},{"node":{"author":{"login":"iukea1"},"body":"Any luck on ideas about this? I am having the same thoughts and problems. "}}]}}},{"node":{"id":"D_kwDOBkswNc4APLkT","author":{"login":"kim00425"},"title":"how do I give each subdomain a different meta tag?","body":"currently i m deploying a web front with SEO at amplify.\r\n\r\nI want to give different meta tags for each subDomain.\r\n\r\nis there a way?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APJGD","author":{"login":"EdGonzalez-"},"title":"Changelog?","body":"Is there a changelog for each Amplify release?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"david-mcafee"},"body":"Hi @EdGonzalez, thanks for starting this conversation! As of now, we have a separate CHANGELOG for each package (for instance, [the DataStore CHANGELOG](https://github.com/aws-amplify/amplify-js/blob/main/packages/datastore/CHANGELOG.md)), but we do not have a global CHANGELOG for all packages. Does this answer your question?"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb241NDgw","author":{"login":"wataruoguchi"},"title":"`invalid_client` from TOKEN endpoint","body":"Hello! Correct me if I am posting in wrong place.\r\n\r\nI have a question about the error.\r\n\r\n```\r\n{\"error\":\"invalid_client\"}\r\n```\r\n\r\nMy goal is to integrate an OpenID Connect client into AWS Cognito and authenticate users with Authorization Code Flow. The client provides client id and secret, my Cognito user pool client knows those values.\r\n\r\nI've been using https://github.com/amazon-archives/amazon-cognito-auth-js, It's working fine with Implicit Flow.\r\n\r\nI believe when the `response_type` is switched from `token` to `code`, it should take Authorization Code Flow. In fact, it started requesting to `https://<my domain>.auth.<region>.amazoncognito.com/oauth2/token` a POST request. However, I am getting the error above.\r\n\r\n[The developer guide](https://docs.aws.amazon.com/cognito/latest/developerguide/token-endpoint.html) says that I may haven't set correct `client_id` and `client_secret`, however, there's nowhere I can set `client_secret`. I once thought it'd be in the Authentication header, but it seems like both the archived package and this Amplify package don't have the Authentication header set.\r\n\r\n- [Where header is defined in Amplify](https://github.com/aws-amplify/amplify-js/blob/f89e545a93f370f0ce91b437514f833b03c6202b/packages/auth/src/OAuth/OAuth.ts#L169)\r\n- [Where header is defined in amazon-cognito-auth-js](https://github.com/amazon-archives/amazon-cognito-auth-js/blob/master/lib/CognitoAuth.js#L168)\r\n\r\nI am wondering if these JS libraries don't support \"Authorization Code Flow\", or I am missing the implementation adding the Authentication header?\r\n\r\nOn the other hand, I think it's odd to expose the client secret in the Authentication header if I have to. So I have doubt that the POST request should be done in server side?","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"sagarb27"},"body":"If the type of your client is WebApp then you will be issued a Client secret. \r\nAs per the Oauth2 Authorization code flow specifications https://datatracker.ietf.org/doc/html/rfc6749#section-2.3\r\nyou have to follow basic authentication scheme for client application (if the clientApp type is Webapp) by including Authorization header of the following format:\r\nHeader => Authorization: \"Basic<Space><base64 encoded string of <ClientID:<colon>ClientSecret>>\r\nInvalid client error is because it couldnt authenticate your client while invoking the token endpoint as mentioned in the specifications\r\nhttps://datatracker.ietf.org/doc/html/rfc6749#section-5.2"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjE4MA==","author":{"login":"thedraketaylor"},"title":"Adding custom attributes to sign up form question.","body":"I've got the following code where I'm adding a custom attribute to my sign up form:\r\n\r\n```\r\n    <AmplifyAuthenticator>\r\n    <AmplifySignUp\r\n      slot=\"sign-up\"\r\n      headerText=\"My Custom Sign Up Text\"\r\n      formFields={[\r\n        { type: \"username\" },\r\n        { type: \"password\" },\r\n        { type: \"email\" },\r\n        {\r\n          type: \"text\",\r\n          label: \"Stage Name\",\r\n          placeholder: \"Stage Name\",\r\n          name: \"custom:stage-name1\",\r\n          fieldId: \"custom:stage-name1\"\r\n        },\r\n      ]}\r\n    />\r\n  </AmplifyAuthenticator>\r\n```\r\nIt shows up fine, but when I click the submit button, I get the following error: \"A client attempted to write unauthorized attribute\r\n\"  I've checked my cognito attributes and they are writable. Clearly I'm missing something, can someone tell me what I'm doing wrong?\r\n\r\nThanks!\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"thedraketaylor"},"body":"I found the issue. I needed type: \"custom:stage-name1\", instead of type: \"text\","}}]}}},{"node":{"id":"D_kwDOBkswNc4APJEc","author":{"login":"demilp"},"title":"How to allow custom headers for API Gateway programmatically","body":"I need to receive a custom header in a lambda function but the API Gateway was blocking the request.\r\nI followed this steps [here](https://docs.amplify.aws/lib/restapi/authz/q/platform/js/#customizing-http-request-headers) and it is working now, but is not scalable if I want to create multiple environments or do this on multiple endpoints.\r\nIs there a way to do it from the amplify console or at least manually modifying some CloudFormation template?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APIVO","author":{"login":"CSHaze"},"title":"How to recover from AWSAppSyncRealTimeProvider errors?","body":"Is there any easy way to reconnect the  AWSAppSyncRealTimeProvider web socket after an error (\"Connection closed\", \"Timeout disconnect\", etc)? These errors appear when the connection has been idle or disconnected for longer than the keepAliveTimeout (5 minutes).\r\n\r\nI can't figure out a way to get any of my subscriptions to work again without refreshing the page (web) or restarting the app (android and ios).","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APE5F","author":{"login":"ClaudioVR"},"title":"How to delete a DynamoDB item from Lambda with node.js","body":"The \"Calling DynamoDB from Lambda in Node.js\" page of the [online docs](https://docs.amplify.aws/guides/functions/dynamodb-from-js-lambda/q/platform/js/#querying-a-table) has no mention of how to delete a DynamoDB item.\r\n\r\nI've brought this up on the amplify docs issues board [#4114](https://github.com/aws-amplify/docs/issues/4114)\r\n\r\nThere are docClient methods for .get(), .query() and .scan() but nothing on how to delete an item. \r\n\r\nI have found [dynamoDb docs](https://github.com/aws-amplify/docs/issues/4114#:~:text=https%3A//docs.aws.amazon.com/amazondynamodb/latest/developerguide/GettingStarted.NodeJs.03.html%23GettingStarted.NodeJs.03.06) that explain how to delete items but the syntax seems to differ slightly.\r\n\r\nMy code looks something like this....\r\n\r\nI am using a primaryKey: userID and a sortKey: bankAccountID\r\n\r\n```\r\napp.post('/delete-account', async function (req, res) {\r\n  const bankAccountID = req.body.bankAccountID\r\n  \r\n  try {\r\n    const accountDetails = await getSpecificAccountDetails(req, bankAccountID)\r\n    \r\n    var params = {\r\n      TableName: 'myTableName',\r\n      KeyConditionExpression: '#user = :value and #bankID = :OID',\r\n      ExpressionAttributeValues: { ':value': accountDetails.userID, ':OID': bankAccountID  },\r\n      ExpressionAttributeNames: { '#user': 'userID', '#bankID': 'bankAccountID'  }\r\n    }\r\n\r\n    const accountDeleted = docClient.delete(params).promise()\r\n\r\n    res.json({\r\n      ...\r\n    })\r\n  }\r\n    catch (err) {\r\n      ...\r\n    })\r\n  }\r\n})\r\n```\r\n\r\nHas anyone come across this issue or have any suggestions?\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"ClaudioVR"},"body":"After working on this for a few days, I came across the answer only minutes after posting the above post, so I thought I'd share the answer here:\r\n\r\n```\r\n var params = {\r\n    TableName: 'myTableName',\r\n     Key: {\r\n         userID: account.userID, // primary key\r\n         bankAccountID: account.bankAccountID, // sort key\r\n      },\r\n}\r\n\r\nawait docClient.delete(params).promise()\r\n```"}}]}}},{"node":{"id":"D_kwDOBkswNc4APDQj","author":{"login":"fistofzen"},"title":"Can I use Graphql and Datastore in same project ?","body":"Hello,\r\n\r\nI have a project, where I enabled Datastore. When I  execute the same select query with Graphql and Datastore, they return different resultsets.\r\n\r\nIs it normal behaviour :? \r\n\r\nRegards.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"david-mcafee"},"body":"Thanks for starting this discussion, @fistofzen!\r\n\r\nThe difference in query results between DataStore and the GraphQL API is due to the fact that DataStore performs soft deletes on records - a record that has been deleted by DataStore will be marked with the `_deleted` flag set to `true` with a TTL of 30 days. The records you're seeing when you perform a query with the API is likely containing all of the records in the table, including those marked with the `_deleted` flag. \r\n\r\nCan you help us understand your use-case for wanting to use both the GraphQL API, and DataStore, concurrently? Thanks!"}},{"node":{"author":{"login":"fistofzen"},"body":"Hello David,\r\nActually, I tried to use Datastore but there were some performance problems. Initial data selection was so slow. \r\nSecondly, for the deep structures GraphQL is much more useful  than Datastore. \r\nThanks\r\n\r\n"}}]}}},{"node":{"id":"D_kwDOBkswNc4AO8ju","author":{"login":"alxAgu"},"title":"tokenRefresh event triggered multiple times","body":"Hi, I'm using the following code to monitor the auth process:\r\n\r\n```js\r\nconst handleHubEvent = useCallback((capsule) => {\r\n  const event = capsule?.payload?.event;\r\n\r\n  try {\r\n    switch(event){\r\n      case 'signIn_start':\r\n      case 'signIn':\r\n      case 'tokenRefresh':\r\n        const user = await auth.currentAuthenticatedUser();\r\n        setCurrentUser(user);\r\n        break;\r\n      case 'signOut':\r\n      case 'tokenRefresh_failure':\r\n        setCurrentUser(null);\r\n        break;\r\n    }\r\n  } catch (e) {\r\n    console.log(\"Error: \", e);\r\n    setCurrentUser(null);\r\n  }\r\n}, []);\r\n\r\nuseEffect(() => {\r\n  Hub.listen('auth', handleHubEvent);\r\n  Hub.dispatch('auth', { event: 'signIn_start' });\r\n\r\n  return () => Hub.remove('auth', handleHubEvent);\r\n}, []);\r\n\r\n```\r\n\r\nThe problem is that after a few hours (seems random), the event callback `handleHubEvent` gets invoked continuously with the `tokenRefresh` event, I mean, like 7 times a second. I can see in the network tab multiple (successful) requests to `cognito-idp.ap-southeast-2.amazonaws.com`.\r\n\r\nEven after refreshing the page, the behaviour is the same, the only way to get rid of it is by deleting the cookies and sign in again.\r\n\r\nAs a workaround, I even tried detecting the behaviour by calculating the elapsed time between `tokenRefresh` events and then call `Hub.remove` but even this is not working, the callback (`handleHubEvent`) keeps being invoked.\r\n\r\nI spent a lot of time debugging this and I can confirm `Hub.listen` is only being called once.\r\n\r\nI didn't create an issue because I'm not sure how to replicate this yet, but it is still happening. Can anyone from the amplify team (@chrisbonifacio? @david-mcafee? 🙏🙏🙏) look at this? Maybe I'm doing something obviously wrong? \r\n\r\nThanks.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APDW4","author":{"login":"rhinozD"},"title":"Cannot modify an already provided attribute","body":"Hi everyone,\r\n\r\nActually, I use [amazon-cognito-identity-dart-2](https://github.com/furaiev/amazon-cognito-identity-dart-2) in my flutter app.\r\n\r\nI called [sendNewPasswordRequiredAnswer](https://github.com/furaiev/amazon-cognito-identity-dart-2/blob/main/lib/src/cognito_user.dart#L796) with the following parameters:\r\n```\r\n newPassword = 'newPass'\r\n requiredAttributes = {'phone_number': '+123456789'}\r\n```\r\nto change initial password and add `phone_number` attribute. `phone_number` is not a required attribute.\r\nThe `sendNewPasswordRequiredAnswer` is mapping to [completeNewPasswordChallenge](https://github.com/aws-amplify/amplify-js/blob/main/packages/amazon-cognito-identity-js/src/CognitoUser.js#L580) and it should work fine.\r\n\r\nIt worked perfectly before but now I got this error(I did not change my source code):\r\n`CognitoClientException{statusCode: 400, code: NotAuthorizedException, name: NotAuthorizedException, message: Cannot modify an already provided phone number}`\r\n\r\nI am really stuck in this issue, please help me!\r\nThank you very much!\r\n","upvoteCount":4,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APDT6","author":{"login":"kainn9"},"title":"What is the authorization grant used by the Amplify Auth?","body":"My apologies if this is a silly question, but I am struggling to understand this concept. When calling methods such as`Auth.signIn()` what type of Authorization grant is being used?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4APBk_","author":{"login":"katerlouis"},"title":"aws-cognito-identity-js requires login on every refresh hosted on heroku, but not on localhost","body":"I use `aws-cognito-identity-js` in my nuxt 2 application and login like this:\r\n\r\n```js\r\nimport { CognitoUserPool, CognitoUser, CognitoUserAttribute, AuthenticationDetails } from 'amazon-cognito-identity-js';\r\n\r\n// nuxt plugin function\r\nexport default ({ redirect, app, store, $config }, inject) => {\r\n  // create a user pool using env vars\r\n  const userPool = new CognitoUserPool({\r\n    // todo: move data to env variables?\r\n    UserPoolId: $config.cognito.userPoolId,\r\n    ClientId: $config.cognito.clientId,\r\n  });\r\n\r\n  /**\r\n   *   Login\r\n   */\r\n  const login = ({ username, password }) => {\r\n    return new Promise((resolve, reject) => {\r\n      const user = new CognitoUser({\r\n        Username: username,\r\n        Pool: userPool,\r\n      });\r\n\r\n      const authDetails = new AuthenticationDetails({\r\n        Username: username,\r\n        Password: password,\r\n      });\r\n\r\n      user.authenticateUser(authDetails, {\r\n        onSuccess(result) {\r\n          const payload = result.getIdToken().payload;\r\n          console.log('login success:', result, payload);\r\n          updateStore(payload);\r\n          resolve(true);\r\n        },\r\n        onFailure(error) {\r\n          console.log('login failed:', error);\r\n          reject(error);\r\n        },\r\n        // preventing app breaking errors\r\n        newPasswordRequired(error) {\r\n          console.log('login failed: new password required', user);\r\n          reject(error);\r\n        },\r\n      });\r\n    });\r\n  };\r\n\r\n  // ... more functions\r\n});\r\n```\r\n\r\nlocally a page-refresh doesn't require me to login again. Hosting the SSR build on Heroku (https) forces users to login on every refresh, though. Unfortunately OAuth2 is a bit over my head and I don't really know how to incorporate a refreshToken here. I still hope it's not necessary and I can get it to work just like on `localhost:3000` :D\r\n\r\nAppreciate some help! \r\n\r\nThanks!","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"katerlouis"},"body":"I've figured it out.\r\n\r\nUsually I generate static sites with nuxt, but this time I'm going for Server-Side-Rendering and the middleware checking if the user is still logged in is called server-side when the page is refreshed. The server obviously doesn't have the necessary tokens stored anywhere. \r\n\r\nMy workaround for the moment is just telling the nuxt server to skip server-side-rendering:\r\n\r\n```js\r\n// nuxt.config.js\r\n\r\nexport default {\r\n  target: 'server',\r\n  ssr: false, \r\n\r\n  // ...\r\n};\r\n```"}}]}}},{"node":{"id":"D_kwDOBkswNc4APCiy","author":{"login":"marcioalexbarbosa"},"title":"One to many modeling in datastore with shared common data","body":"I have the following model in amplify datastore:\r\n\r\n```\r\ntype Professor @model @auth(rules: [{ allow: owner }]) {\r\n  id: ID! @primaryKey\r\n  firstName: String!\r\n  lastName: String!\r\n  students: [Student] @hasMany\r\n# ...  \r\n}\r\n\r\ntype Student @model @auth(rules: [{ allow: owner }]) {\r\n  id: ID! @primaryKey\r\n  firstName: String!\r\n  lastName: String!\r\n# ...\r\n}\r\n```\r\n\r\nProfessor Charles can have both students Timothy and Johnson and Timothy can have as professors both Charles and Rita\r\n\r\nNow the modeling part is piece of cake, the problem is with the way datastore works.\r\n\r\nA professor will see a dashsboard with a list of his/her students, and the students will see a dashboard with a list with his/her professors.\r\n\r\nAt dynamodb this will be persisted with a professor key in the students table. So for Timothy to have more than one professor, each professor must have a copy of Timothy?\r\n\r\nIf I change to, say, @manyToMany, then how can I avoid the entire database to be downloaded? because selective sync does not allow to use an \"in [list]\" expression filter where I can change the list later with, for example, the keys in the join table.\r\n\r\nAny ideas? ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDg5MDcy","author":{"login":"lack-of-gravitas"},"title":"Remove \"Sign in with AWS Button\"","body":"How can I remove **only** the Sign in with AWS button - using Amplify UI components\r\n\r\n![image](https://user-images.githubusercontent.com/10094964/127498149-b0cc6ea8-c00d-4e6c-8982-b7d6b327cb33.png)\r\n\r\n- i havent enabled this as a federated sign in in my userpool nor do i want to so why is it shown by default?\r\n- hiding with CSS or query selectors seems to be a terrible way to hide a button for something that supposedly provides slots\r\n- i referred to this [CodeSandbox](https://codesandbox.io/s/amplify-ui-federated-buttons-48x56?file=/src/App.js) which shows that there's an AmplifyGoogleButton / AmplifyFacebookButton component -- supposedly there is an AmplifyAmazonButton? where is this documented so that someone can actually implement what they are after?\r\n- where is this documented (if at all) and no Github threads (with bad search) don't count\r\n-  \r\n![image](https://user-images.githubusercontent.com/10094964/127498245-4da135ee-0e2a-4eaf-892c-24040d9614fc.png)\r\n","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"kewur"},"body":"how did you find which slot you can override? is it on the documentation somewhere?"}}]}}},{"node":{"id":"D_kwDOBkswNc4AO132","author":{"login":"MikeLungu77"},"title":"Amplify component styling","body":"Hey all,\r\nhas anybody been able to style the AWS Amplify component?\r\ni can't seem to be able to do simple things, like \r\n1. applying border radius, or \r\n2. disabling the text transform on the buttons.\r\ni can change top level attributes, from amplify-authenticator, which are then inherited down to input and buttons, but not the input fields or the buttons themselves.\r\nany hints, would be greatly appreciated.\r\nthanks,\r\nMike.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"david-mcafee"},"body":"@MikeLungu77 thanks for starting this discussion! Can you let us know which version of Amplify UI you are using, and what component(s) you are wanting to style? I assume the Amplify Authenticator component, but just want to be sure. Thanks!"}},{"node":{"author":{"login":"MikeLungu77"},"body":"hi David,\nthanks heaps for your reply.\nindeed i am using the Amplify Authenticator component.\nand my versions are like below:\n\n    ***@***.***/ui-angular\": \"^1.0.30\",\n    ***@***.***/ui-components\": \"^1.9.1\",\n\n\n    \"aws-amplify\": \"^4.3.4\",\n    \"aws-amplify-angular\": \"^6.0.22\",\n\njust a couple of things i am struggling with:\n\nthe buttons, i am unable to disable or remove the text-transform. i don't\nwant the all uppercase. or apply a different border-radius.\nthese properties seem to be inherited from the \"amplify-button.hydrate\",\nand i am not sure how to change them.\n\nthe form fields, is there a way to set the label text different color than\nthe input?\n\nthanks gain,\n\ncheers,\nMike.\n\nOn Sat, 26 Feb 2022 at 08:25, David McAfee ***@***.***> wrote:\n\n> @MikeLungu77 <https://github.com/MikeLungu77> thanks for starting this\n> discussion! Can you let us know which version of Amplify UI you are using,\n> and what component(s) you are wanting to style? I assume the Amplify\n> Authenticator component, but just want to be sure. Thanks!\n>\n> —\n> Reply to this email directly, view it on GitHub\n> <https://github.com/aws-amplify/amplify-js/discussions/9622#discussioncomment-2254368>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AU2QVXYYNJOFGHR7244BJELU476UXANCNFSM5O5KUDYA>\n> .\n> Triage notifications on the go with GitHub Mobile for iOS\n> <https://apps.apple.com/app/apple-store/id1477376905?ct=notification-email&mt=8&pt=524675>\n> or Android\n> <https://play.google.com/store/apps/details?id=com.github.android&referrer=utm_campaign%3Dnotification-email%26utm_medium%3Demail%26utm_source%3Dgithub>.\n>\n> You are receiving this because you were mentioned.Message ID:\n> ***@***.***>\n>\n"}}]}}},{"node":{"id":"D_kwDOBkswNc4AOZJm","author":{"login":"diontrepate"},"title":"IndexedDB exposure in production","body":"Hi! I recently deployed my application and noticed that the IndexedDB was exposed from the dev tools. This was concerning because all of my tables and the data from within them are present. Is there something I can do to fix this? ","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"david-mcafee"},"body":"Hi @diontrepate - you're correct that IndexedDB data is visible from dev tools. Can you give me more information regarding what your concern is? (i.e. are you concerned that end users can view the tables, or that someone else could potentially view this data?) Perhaps if you can provide more information regarding your concern, I can better help answer your question. Thanks!!"}},{"node":{"author":{"login":"david-mcafee"},"body":"Hey @diontrepate - DataStore does not offer encoding of the data, however, you are correct that [using authorization rules](https://docs.amplify.aws/lib/datastore/setup-auth-rules/q/platform/js/) will allow you to control what users can view what data. Does this answer your question?"}}]}}},{"node":{"id":"D_kwDOBkswNc4AO-Iq","author":{"login":"KevinLam0308"},"title":"Datastore: How can I sync with the data belongs to the Login user, not sync the entire database?","body":"Hello,\r\n\r\nI'm developing an Android App using Android Studio which stores user data by datastore and with their user login, I'm now facing a problem is that:\r\n\r\nEvery time re-install the App, amplify will sync again the entire database to the local, it takes at least 2 to 3 minutes, in the middle of syncing, encounter a Timeout error (maybe it's 1 minute now), so I would like to know how can I overcome this problem, and below are the possible solution that I'm looking on:\r\n\r\n1) Add syncExpression for a dedicated user to minimize the sync time\r\n\r\nFollowed below instruction to change the syncExpression at runtime, but not success:\r\n\r\nhttps://docs.amplify.aws/lib/datastore/sync/q/platform/android/#reevaluate-expressions-at-runtime\r\n\r\nhere is the code:\r\n\r\n```\r\npublic static String userId;\r\n\r\nprotected void onCreate{\r\n        try {\r\n            Amplify.addPlugin(new AWSApiPlugin());\r\n\r\n            Amplify.addPlugin(new AWSCognitoAuthPlugin());\r\n\r\n            initialize();\r\n\r\n            Amplify.configure(getApplicationContext());\r\n\r\n            Log.i(\"Amplify\", \"Initialized Amplify\");\r\n        } catch (AmplifyException e) {\r\n            Log.e(\"Amplify\", \"Could not initialize Amplify\", e);\r\n        }\r\n\r\n       changeSync();\r\n}\r\n\r\n    public void initialize() {\r\n        try {\r\n            Amplify.addPlugin(AWSDataStorePlugin.builder().dataStoreConfiguration(\r\n                    DataStoreConfiguration.builder()\r\n                            .syncExpression(Alert.class, () -> Alert.NAME.eq(userId))\r\n                            .build())\r\n                    .build());\r\n        } catch (AmplifyException e) {\r\n            e.printStackTrace();\r\n        }\r\n    }\r\n\r\n    public void changeSync() {\r\n        userId = Amplify.Auth.getCurrentUser().getUserId();\r\n\r\n        Amplify.DataStore.stop(\r\n                () -> Log.i(\"Amplify\", \"DataStore is stopped.\"),\r\n                failure -> Log.e(\"Amplify\", \"Failed to clear DataStore.\")\r\n        );\r\n\r\n        Amplify.DataStore.start(\r\n                () -> Log.i(\"MyAmplifyApp\", \"DataStore started\"),\r\n                error -> Log.e(\"MyAmplifyApp\", \"Error starting DataStore: \", error)\r\n        );\r\n    }\r\n```\r\n\r\nI would like to set userId as the sync condition, but not success in the above code, any suggestions?\r\n\r\n2) Set the authentication rules on Amplify console\r\n\r\nAre there any rules that can be set for each model on Amplfiy console that can have the same result that I want?\r\n\r\n\r\n**Which Category is your question related to?**\r\n\r\nDataStore and Cognito\r\n\r\n**Amplify CLI Version**\r\n\r\nv7.6.21\r\n\r\n**What AWS Services are you utilizing?**\r\n\r\nAppSync, Datastore, Cognito\r\n\r\nThanks and regards,\r\nKevin","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"KevinLam0308"},"body":"In addition, is there a way to extend the Timeout for syncing? I'm thinking that if the data size for each user becomes bigger and bigger, it may take over a minute to sync all data to local even I set the syncExpression successfully, below is the timeout error during syncing:\r\n\r\n```\r\n2022-03-09 10:56:06.032 14356-14416/com.example.bleapp E/amplify:aws-datastore: Failure encountered while attempting to start API sync.\r\n    DataStoreException{message=Initial sync during DataStore initialization failed., cause=java.util.concurrent.TimeoutException: Timed out while performing initial model sync., recoverySuggestion=There is a possibility that there is a bug if this error persists. Please take a look at \r\n    https://github.com/aws-amplify/amplify-android/issues to see if there are any existing issues that \r\n    match your scenario, and file an issue with the details of the bug if there isn't.}\r\n        at com.amplifyframework.datastore.syncengine.Orchestrator.lambda$startApiSync$3$com-amplifyframework-datastore-syncengine-Orchestrator(Orchestrator.java:327)\r\n        at com.amplifyframework.datastore.syncengine.Orchestrator$$ExternalSyntheticLambda5.subscribe(Unknown Source:2)\r\n        at io.reactivex.rxjava3.internal.operators.completable.CompletableCreate.subscribeActual(CompletableCreate.java:40)\r\n        at io.reactivex.rxjava3.core.Completable.subscribe(Completable.java:2850)\r\n        at io.reactivex.rxjava3.internal.operators.completable.CompletablePeek.subscribeActual(CompletablePeek.java:51)\r\n        at io.reactivex.rxjava3.core.Completable.subscribe(Completable.java:2850)\r\n        at io.reactivex.rxjava3.internal.operators.completable.CompletablePeek.subscribeActual(CompletablePeek.java:51)\r\n        at io.reactivex.rxjava3.core.Completable.subscribe(Completable.java:2850)\r\n        at io.reactivex.rxjava3.internal.operators.completable.CompletablePeek.subscribeActual(CompletablePeek.java:51)\r\n        at io.reactivex.rxjava3.core.Completable.subscribe(Completable.java:2850)\r\n        at io.reactivex.rxjava3.internal.operators.completable.CompletableSubscribeOn$SubscribeOnObserver.run(CompletableSubscribeOn.java:64)\r\n        at io.reactivex.rxjava3.core.Scheduler$DisposeTask.run(Scheduler.java:614)\r\n        at io.reactivex.rxjava3.internal.schedulers.ScheduledRunnable.run(ScheduledRunnable.java:65)\r\n        at io.reactivex.rxjava3.internal.schedulers.ScheduledRunnable.call(ScheduledRunnable.java:56)\r\n        at java.util.concurrent.FutureTask.run(FutureTask.java:266)\r\n        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:301)\r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1167)\r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:641)\r\n        at java.lang.Thread.run(Thread.java:764)\r\n     Caused by: java.util.concurrent.TimeoutException: Timed out while performing initial model sync.\r\n        at com.amplifyframework.datastore.syncengine.Orchestrator.lambda$startApiSync$3$com-amplifyframework-datastore-syncengine-Orchestrator(Orchestrator.java:323)\r\n        at com.amplifyframework.datastore.syncengine.Orchestrator$$ExternalSyntheticLambda5.subscribe(Unknown Source:2) \r\n        at io.reactivex.rxjava3.internal.operators.completable.CompletableCreate.subscribeActual(CompletableCreate.java:40) \r\n        at io.reactivex.rxjava3.core.Completable.subscribe(Completable.java:2850) \r\n        at io.reactivex.rxjava3.internal.operators.completable.CompletablePeek.subscribeActual(CompletablePeek.java:51) \r\n        at io.reactivex.rxjava3.core.Completable.subscribe(Completable.java:2850) \r\n        at io.reactivex.rxjava3.internal.operators.completable.CompletablePeek.subscribeActual(CompletablePeek.java:51) \r\n        at io.reactivex.rxjava3.core.Completable.subscribe(Completable.java:2850) \r\n        at io.reactivex.rxjava3.internal.operators.completable.CompletablePeek.subscribeActual(CompletablePeek.java:51) \r\n        at io.reactivex.rxjava3.core.Completable.subscribe(Completable.java:2850) \r\n        at io.reactivex.rxjava3.internal.operators.completable.CompletableSubscribeOn$SubscribeOnObserver.run(CompletableSubscribeOn.java:64) \r\n        at io.reactivex.rxjava3.core.Scheduler$DisposeTask.run(Scheduler.java:614) \r\n        at io.reactivex.rxjava3.internal.schedulers.ScheduledRunnable.run(ScheduledRunnable.java:65) \r\n        at io.reactivex.rxjava3.internal.schedulers.ScheduledRunnable.call(ScheduledRunnable.java:56) \r\n        at java.util.concurrent.FutureTask.run(FutureTask.java:266) \r\n        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:301) \r\n        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1167) \r\n        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:641) \r\n        at java.lang.Thread.run(Thread.java:764) \r\n2022-03-09 10:56:06.034 14356-14416/com.example.bleapp W/amplify:aws-datastore: API sync failed - transitioning to LOCAL_ONLY.\r\n```\r\n\r\nChanging the timeout may not be the best approach, so what about querying data from remote directly instead of automatic syncing of the entire database to local?\r\n"}},{"node":{"author":{"login":"KevinLam0308"},"body":"anyone can help? thanks!"}}]}}},{"node":{"id":"D_kwDOBkswNc4AO_AT","author":{"login":"theguy1985"},"title":"How do i set proper device name in deviceList, in react native.","body":"I am using `aws-amplify 4.3.15(latest)` in my react native application with enabled MFA. Now when I try to fetch the list of authorized devices, I do not get a proper result for Android devices. `cognitoUser.listDevices()` gives me array of devices, but the DeviceAttribute ` device_name` doesn't say Android or something like that. Instead, I get `\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36\"`. Also Sometime device_name is not at all there. This is most probably an issue with device tracking and detection. Please help if anyone went through a similar situation.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AO5rf","author":{"login":"cietho"},"title":"Is the Release Cycle Wiki page up to date?","body":"Hey guys, I have seen that an important pull request for me has been successfully reviewed and merged. Unfortunately it is not clear to me what happens after the merge into the main branch. I would like to install the latest version that contains the pull request.\r\n\r\nI did some searching and came across this wiki page: https://github.com/aws-amplify/amplify-js/wiki/Release-Cycle - so far so good. Then I searched for the tag 4.0.32-unstable-xx. Unfortunately this tag does not exist.\r\n\r\nSo my question: Is the wiki page still up to date and were the tags just not pushed by mistake? Or has the process changed?\r\n\r\nMany thanks and best regards\r\ncietho","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"david-mcafee"},"body":"Hey @cietho! The wiki you linked to is still up-to-date. Can you tell me which PR you are searching for, specifically?\r\n\r\nThis tag does not exist because version `4.0.32` does not exist.\r\n\r\nWe just released a major version today, so your PR would be included with that release. For future reference, if you take a look at [our version history on npm](https://www.npmjs.com/package/aws-amplify), you'll see all of the unstable versions that are published each week. For instance, our last unstable version was [4.3.15-unstable.10](https://www.npmjs.com/package/aws-amplify/v/4.3.15-unstable.10). Hope this helps, and let me know if you have more questions!"}}]}}},{"node":{"id":"D_kwDOBkswNc4AO7BR","author":{"login":"clintfoster"},"title":"Correct way to handle adding required fields later","body":"Suppose I update my GraphQL schema to add a new field that is required (or change an existing field to be required), e.g.:\r\n\r\n```json\r\nname: String!\r\n```\r\n\r\nIf I then call `Datastore.query(Foo)` to list all Foos, it silently ignores existing items in the db that are missing `name`. This is true even when I explicitly provide an id to retrieve only one item, e.g.:\r\n\r\n```json\r\nDataStore.query(Foo, id)\r\n```\r\n\r\nThis simply returns nothing, as if the item doesn't exist.\r\n\r\nI don't think this situation can be handled by `DataStore.setErrorHandler()` since that's apparently only for sync errors.\r\n\r\nOne solution would be to write a script that backfills all items in the table whenever a required field is added. But if there are millions of records (many of which may never be accessed again) that may not be reasonable. \r\n\r\nI know this is going to sound extreme, but it seems to me it's not practical to make any fields required (except for the key schema) in an application that wants to be strict when storing, but forgiving when reading.\r\n\r\nA way to provide a default value directly in the schema would be nice, and/or a handler called by `DataStore.query()` for each item that is missing any required fields.\r\n\r\nAm I missing anything obvious, or should I make all fields optional, and handle validation for required fields myself? This means I'll no longer get automatic validation on `save()`, but at least i'll be able to query items that are missing required fields and deal with them.\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AOy6L","author":{"login":"BartoszKlonowski"},"title":"How to correctly use the `Analytics.updateEndpoint`?","body":"In general: How to correctly use the `Analytics.updateEndpoint` method\r\nfrom `AnalyticsClass`: `{ Analytics }` imported from `'@aws-amplify/analytics'`?\r\n\r\nDocumentation does not clearly specify how should the updated object look like that we are sending.\r\n\r\nLet's say, that my example is:\r\nI have the standard endpoint with all the required information, but I also have the\r\n```javascript\r\nendpoint: {\r\n  attributes: {\r\n    hobbies: ['piano', 'hiking'],\r\n  },\r\n}\r\n```\r\nand I want to extend the `attributes` with the user's pupils: `pupils: ['dog', 'cat']`.\r\nSo what I do is:\r\n```javascript\r\nimport { Analytics } from '@aws-amplify/analytics';\r\n\r\nAnalytics.updateEndpoint({\r\n  attributes: {\r\n    pupils: ['dog', 'cat']\r\n  },\r\n})\r\n.then(response => {\r\n  console.log(\"Success with response: \", response);\r\n})\r\n.catch(error => {\r\n  console.log(\"Error with response: \", error);\r\n});\r\n```\r\n\r\nMy questions are:\r\n* I keep on getting the `ERROR  [ERROR] 58:48.118 AWSPinpointProvider - updateEndpoint failed [TypeError: undefined is not a function]` error, so I must be doing something in an incorrect way - what is it?\r\n* Should I update the endpoint's additional attributes by giving all of them:\r\n```javascript\r\nAnalytics.updateEndpoint({\r\n  attributes: {\r\n    hobbies: ['piano', 'hiking'],\r\n    pupils: ['dog', 'cat']\r\n  },\r\n})\r\n```\r\nor just give the data that I want to update the endpoint with: `pupils` only?\r\n* Should I specify the `address` field during updating the endpoint?\r\nLike so?\r\n```javascript\r\nAnalytics.updateEndpoint({\r\n  address: '12345678',\r\n  attributes: {\r\n    pupils: ['dog', 'cat']\r\n  },\r\n})\r\n```\r\n* Should I give the **whole** configuration object or just give the object with data I want to update the endpoint with?\r\n\r\nI'm really hoping for as much explanation as you can provide me with - I'm struggling with this a lot so I would use some help.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"david-mcafee"},"body":"Closing this as a duplicate of [this docs ticket](https://github.com/aws-amplify/amplify-js/issues/9608). @BartoszKlonowski has [an open PR](https://github.com/aws-amplify/docs/pull/4054) on improving that documentation to be more clear. Thanks!"}}]}}},{"node":{"id":"D_kwDOBkswNc4AO5Jz","author":{"login":"bojidaryovchev"},"title":"I have some saved configured users, how do I delete them?","body":"Hey guys, this is driving me nuts.. I decided to clear out everything from my account and start clean, so I also deleted my IAM users and so on. Then, I used npx amplify init to initialize amplify in an application and I saw that I still have some users saved. I started googling for 15 or 20 mins without ever being able to find where are these users stored or how could I delete them. This is something that's supposed to be super simple and intuitive yet it seems impossible..\r\n\r\nDoes anyone know how to delete previously used users, where are they stored? I don't remember how I created them in the first place, but it should be easy to delete them..","upvoteCount":0,"comments":{"edges":[{"node":{"author":{"login":"bojidaryovchev"},"body":"ok I found out that I have to delete my AWS profile and in order to do that I had to go in my user folder (on Windows that is C:\\Users\\name) and then find the .aws folder in there and delete the config and credentials files in there and it worked"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xOTgxMDE2","author":{"login":"lvillacin"},"title":"OpenID Connect Federated Sign-In","body":"**I'm trying to use Microsoft as my authorization and authentication provider using OpenID Connect** and found that User Pools has an OIDC option so I could set things up through there. My question is, how do I now call this within my amplify webapp? I don't want to use the Hosted UI and `Auth.federatedSignIn({provider: 'xyz'})` only works for Google, Facebook, Apple and Amazon. ","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"lvillacin"},"body":"Found out this can actually be done but I now don't know how to have access to the OIDC Access and Refresh Tokens. Anyone know how I can achieve that?"}}]}}},{"node":{"id":"D_kwDOBkswNc4AO2VW","author":{"login":"raffibag"},"title":"Pulling existing backend for standalone frontend is creating a new backend environment","body":"When calling `amplify pull` from the Amplify CLI, I'm taken through the process of selecting a profile and a project (something I've been doing on this project for nearly two years), however, recently when answering `No` to `Do you plan on modifying this backend?`, Amplify is creating an `amplify` folder containing `cli.json` and `team-provider-info.json` files. This never used to happen.\r\n\r\nThe issue is that when I try to deploy the frontend in Amplify, it is failing on backend build. Again, it shouldn't even be creating a backend build.\r\n\r\nIs there a way to pull only the `aws-exports.js` file and not an entirely new backend when calling `amplify pull`?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"david-mcafee"},"body":"Hi @raffibag - thanks for starting this discussion! Check out [this page in our docs](https://docs.amplify.aws/cli/start/workflows/#amplify-pull) for instructions on how to pull the backend / env for an existing project. "}}]}}},{"node":{"id":"D_kwDOBkswNc4AO3By","author":{"login":"gasspau"},"title":"Error message: Let's Build a TINDER clone with REACT NATIVE and AWS Amplify (pt. 2) at time 02:00:00","body":"Hi there!\r\nI have an issue concerning the video of notJust.dev pt.2 at time mark 02:00:00 (https://www.youtube.com/watch?v=Wt8jo1znYWA&t=7215s) \r\nWhen I follow his steps I get the error messages in the attachment...\r\n\r\nIt seems like many others have the problem too...\r\n\r\nHas anyone a solution to this problem? Would be very thankful!!\r\n\r\nThanks!\r\nPaul\r\n`import React, {useState} from 'react'\r\nimport { View, Text, StyleSheet, SafeAreaView, Image, Pressable, TextInput} from 'react-native'\r\nimport {Auth, DataStore} from \"aws-amplify\"\r\nimport {Picker} from \"@react-native-picker/picker\"\r\nimport  {User} from \"../models/\"\r\n\r\n\r\nconst ProfileScreen = () => {\r\n    const [name, setName] = useState(\"\")\r\n    const [bio, setBio] = useState(\"\")\r\n    const [gender, setGender] = useState()\r\n    const [lookingFor, setLookingFor] = useState()\r\n\r\n    const isValid = () => {\r\n        return name  && bio && gender && lookingFor;\r\n\r\n    }\r\n\r\n    const save = () => {\r\n        if(!isValid()){\r\n            console.warn(\"Not Valid\")\r\n            return \r\n        }\r\n\r\n   \r\n        const newUser = new User({\r\n             name,\r\n             bio, \r\n             gender,\r\n             lookingFor,\r\n            image: \"https://notjustdev-dummy.s3.us-east-2.amazonaws.com/avatars/elon.png\",\r\n        })\r\n\r\n        DataStore.save(newUser)\r\n        console.warn(\"Valid\")\r\n\r\n    }\r\n    return (\r\n        <SafeAreaView style={styles.root}>\r\n            <View style={styles.container}>\r\n                <TextInput \r\n                    style={styles.input} \r\n                    placeholder=\"Name\" \r\n                    value={name} \r\n                    onChangeText={setName}\r\n                />\r\n                <TextInput \r\n                    style={styles.input} \r\n                    placeholder=\"Bio...\" \r\n                    multiline\r\n                    numberOfLines={3}\r\n                    value={bio} \r\n                    onChangeText={setBio}\r\n                />\r\n\r\n                <Text>Gender</Text>\r\n\r\n                <Picker\r\n                    label=\"Gender\"\r\n                    selectedValue={gender}\r\n                    onValueChange={itemValue => setGender(itemValue)}\r\n                    >\r\n                    <Picker.Item  label=\"Male\" value=\"MALE\"/>\r\n                    <Picker.Item  label=\"Female\" value=\"FEMALE\"/>\r\n                    <Picker.Item label=\"Other\" value=\"OTHER\"/>\r\n\r\n                </Picker>\r\n\r\n                <Text>Looking For</Text>\r\n                <Picker\r\n                    label=\"Looking for\"\r\n                    selectedValue={lookingFor}\r\n                    onValueChange={itemValue => setLookingFor(itemValue)}\r\n                    >\r\n                    <Picker.Item  label=\"Male\" value=\"MALE\"/>\r\n                    <Picker.Item  label=\"Female\" value=\"FEMALE\"/>\r\n                    <Picker.Item label=\"Other\" value=\"OTHER\"/>\r\n\r\n                </Picker>\r\n          \r\n                <Pressable onPress={save} style={styles.button}>\r\n                       <Text>Save</Text> \r\n                </Pressable>\r\n\r\n                <Pressable onPress={() => Auth.signOut()} style={styles.button}>\r\n                    <Text>Sign Out</Text>\r\n                </Pressable>\r\n            </View>\r\n        </SafeAreaView>\r\n    )\r\n}\r\nconst styles = StyleSheet.create({\r\n    root: {\r\n        width: \"100%\",\r\n        padding: 10,\r\n        flex: 1,\r\n\r\n    },\r\n    container: {\r\n        padding: 10,\r\n        // backgroundColor: \"red\"\r\n\r\n    },\r\n    input: {\r\n        margin: 10,\r\n        borderBottomColor: \"lightgray\",\r\n        borderBottomWidth: 1\r\n    },\r\n    button: {\r\n        backgroundColor: \"[#F63A6E](https://www.youtube.com/hashtag/f63a6e)\",\r\n        height: 25,\r\n        justifyContent: \"center\",\r\n        alignItems: \"center\",\r\n        borderRadius: 20,\r\n        margin: 10\r\n    }\r\n\r\n})\r\nexport default ProfileScreen`\r\n\r\n![image](https://user-images.githubusercontent.com/78957068/155233355-fe8a4fab-57d2-4a58-b600-bc6c28d9b25c.png)\r\n\r\n![image](https://user-images.githubusercontent.com/78957068/155233374-d9f1c509-6735-4161-bf0a-00dccd4dee2d.png)\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDU0OTky","author":{"login":"fr-an-k"},"title":"DataStore observe not working","body":"DataStore.observe(MyModel).subscribe(data => ...) is supposed to enable live notifications of remote database mutations through the websocket, correct?\r\n\r\nNeither of the following get notified when I create or update an an item either through the AppSync console or a succesful signed graphql mutation request. DynamoDB console confirms that the mutations take place, with incremented versions.\r\n\r\n```\r\nHub.listen('datastore', data => console.log('hub datastore', data))\r\nDataStore.observe(MyModel).subscribe(\r\n  data => console.log('subscription event', data),\r\n  err => console.error('subscription error', err), // never called\r\n  () => console.log('subscription completed') // never called\r\n)\r\n```\r\n\r\nThe Hub.listen('datastore') happens before my first query, which starts the DataStore\r\nThe observe() call happens after datastore 'ready' event.\r\n\r\nWhen I refresh the page there is still no notification.\r\nI have an AppSync log and Amplify.Logger.LOG_LEVEL = 'DEBUG' but nothing interesting occurs.\r\n\r\nOn DataStore.query(MyModel, Predicates.ALL), I receive the new data, but only after refreshing the page twice.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"fr-an-k"},"body":"It seems to be working again, but haven't checked the live update of a remote change yet. I switched to aws-amplify instead of the modular packages, updated versions, did an amplify pull & checkout env to fix any files that may have been corrupted."}},{"node":{"author":{"login":"fr-an-k"},"body":"Turns out DataStore's inner subscribe system only supports owner strings in a model, not arrays. I turned off the auth rules and hope I can do it with a customized resolver instead."}},{"node":{"author":{"login":"david-mcafee"},"body":"@frank-unovica - you mention updates within the AppSync console, as well as graphql mutations. Do you receive updates when calling `Datastore.save` to perform a mutation? Thanks!"}},{"node":{"author":{"login":"david-mcafee"},"body":"Marking as resolved as there hasn't been a response on this. If you are still running into issues, @frank-unovica, please re-open this discussion. Thank you!"}}]}}},{"node":{"id":"D_kwDOBkswNc4AOdNe","author":{"login":"krikork"},"title":"JavaScript heap out of memory","body":"Today my builds have started failing with \"FATAL ERROR: Ineffective mark-compacts near heap limit Allocation failed - JavaScript heap out of memory\".\r\n\r\nI am aware of https://github.com/aws-amplify/amplify-cli/issues/3708 and https://cloudnamaste.com/amplify-console-build-fail-java-heap-out-of-memory/ and have tried to mess around with those settings but that did not help. \r\n\r\nAny ideas?\r\n\r\n","upvoteCount":3,"comments":{"edges":[{"node":{"author":{"login":"david-mcafee"},"body":"Hi @krikork - can you provide additional details regarding what versions of the Amplify CLI / node you are using? Thanks!"}},{"node":{"author":{"login":"david-mcafee"},"body":"Marking this as closed, as a solution is documented on [this issue](https://github.com/aws-amplify/amplify-cli/issues/3708). @krikork if you run into further issues, please re-open this discussion. Thank you!"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNjQ0MzYz","author":{"login":"patweb99"},"title":"Does Lex/Interactions pass Cognito session information to underlying Lambda Validation scripts?","body":"I have an application that requires knowing WHO's logged in via the front end through Cognito. I'd like to be able to see this information whenever the validation Lambda is called through Lex.\r\n\r\nIs this possible?\r\n\r\nI see NO session or Cognito information. It would great to have this available since my validation Lambda script handles business logic and updates database records depending on whoever is logged in at the moment.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"elorzafe"},"body":"@patweb99 \r\n\r\nDo you mean you want to have information from the signed in user on your lambda once the bot is fullfilled? For example username, email, etc?\r\n\r\n"}}]}}},{"node":{"id":"D_kwDOBkswNc4AOz7o","author":{"login":"muthu32"},"title":"Subscribe not working on ElasticSearch","body":"** Which Category is your question related to? **\r\ngql queries and subscriptions\r\n\r\n** What AWS Services are you utilizing? **\r\nAppSync, DynamoDB, ElasticSearch\r\n\r\n** Provide additional details e.g. code snippets **\r\nGraphql subscription works with Dynamo db, So it can't get updated data from elasticsearch as soon as subscription triggers.\r\nI have to use settimeout function to get updated results, as elasticsearch data does not available immediately. \r\nDue to this problem delete function is not working as expected sometime (if delay for insert in data in elsticsearch takes 2 seconds)\r\n\r\nHow to  change subscription function to work on amazon elastic search??\r\n\r\nRelated github issue: https://github.com/aws-amplify/amplify-js/issues/4916 => but no solution there\r\n\r\n```\r\ntype Customer @model @searchable @auth(rules:[\r\n# allow admins to create, update, delete \r\n{ allow: groups, groups: [\"admin\"] }\r\n# allow all authenticated users to read\r\n{ allow: private, operations: [read] }\r\n]) {\r\nid: ID!\r\nname: String!\r\nemail: String!\r\nMobile: String!\r\ncustomer_notes: String!\r\nadmin_notes: String!\r\ncity: City @hasOne\r\ncities: String\r\nlangs: [String]\r\nowner: String\r\ncreatedAt: AWSDateTime!\r\nupdatedAt: AWSDateTime!\r\n}\r\n```\r\nSubscription\r\n```\r\ntype Subscription {\r\n  onMutateCustomer: Customer\r\n  @aws_subscribe(mutations: [\"createCustomer\", \"updateCustomer\", \"deleteCustomer\"])\r\n  onMutateCity: City\r\n  @aws_subscribe(mutations: [\"createCity\", \"updateCity\", \"deleteCity\"])\r\n  onMutateLanguage: Language\r\n  @aws_subscribe(mutations: [\"createLanguage\", \"updateLanguage\", \"deleteLanguage\"])\r\n}\r\n```\r\nsubscription Query\r\n```\r\nuseEffect(()=> {\r\n  const subscriptionOnCreate = (API.graphql(\r\n    graphqlOperation(onMutateCustomer)\r\n    ) as any).subscribe({\r\n    next: (customerData:any) => {\r\n      console.log(\"subscription data\");\r\n      console.log(customerData);\r\n       setTimeout(fetchCustomer, 1000);\r\n    },\r\n    error: (error:any) => console.warn(error)\r\n});\r\n\r\nreturn () => {\r\n  subscriptionOnCreate.unsubscribe();\r\n}\r\n},[]);\r\n```\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"muthu32"},"body":"is it bug on subscription?? If it is bug, then I will post this on amplify issues page."}}]}}},{"node":{"id":"D_kwDOBkswNc4AO0se","author":{"login":"AngelHadzhiev"},"title":"How to attach only an email to a Pinpoint endpoit and not the browser?","body":"Hello, \r\n\r\nI recently started using AWS Amplify to create a newsletter functionality with AWS Pinpoint. Everything goes good with the exception that I found out that when I create an endpoint, I can only create one endpoint per browser hence only one user will be an endpoint per browser thus any other new user created on this browser will take the place of the previous in my Pinpoint segment. Imagine you share your PC with another person and you both register from the same browser - this is an issue. \r\n\r\nIs there any way to use only the user email as a endpoint and not the browser? \r\n\r\nThank you in advance","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AO0B2","author":{"login":"baruishigold"},"title":"React Native 64  \"@aws-amplify/geo\" triggering location permission when deploying to Apple Store","body":"My app uses `\"aws-amplify\"` for `Auth, Storage` and  `Datastore` functionalities.\r\n`Geo` is not explicitly used, but it is listed as a sub-dependcy of the `\"aws-amplify\"`. \r\nThe app doesn't use any geo locations. \r\n\r\nWhen applying to Apple Store, the error showed up:\r\n_ITMS-90683: Missing Purpose String in Info.plist - Your app's code references one or more APIs that access sensitive user data. The app's Info.plist file should contain a NSLocationWhenInUseUsageDescription key..._\r\n\r\nIs there a way to manually remove/disable the @aws-amplify/geo\" from the project? \r\nAny advise on how to remove the Geo from React Native project would be appreciated. ","upvoteCount":0,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AOzgx","author":{"login":"rajeshbhatks"},"title":"Amplify error","body":"Getting the following Amplify error when code is deployed. Works fine on the local machine\r\n\r\n[ERROR] 06:12.40 AuthError - \r\n            Error: Amplify has not been configured correctly. \r\n            The configuration object is missing required auth properties.\r\n            This error is typically caused by one of the following scenarios:\r\n\r\n            1. Did you run `amplify push` after adding auth via `amplify add auth`?\r\n                See https://aws-amplify.github.io/docs/js/authentication#amplify-project-setup for more information\r\n\r\nHere is the code\r\n\r\nimport Amplify, { Auth } from 'aws-amplify';\r\n\r\nconst render = () => {\r\n\r\n  const awsConfig = {\r\n    Auth: {\r\n      region: \"us-east-1\",\r\n      userPoolId: \"xxxxxx\",\r\n      userPoolWebClientId: \"yyyyyy\"\r\n    }\r\n  };\r\n    \r\n  Amplify.configure(awsConfig);\r\n\r\n\tReactDOM.render(\r\n\t\t<AppContainer>\r\n\t\t\t<Root />\r\n\t\t</AppContainer>,\r\n\t\tdocument.getElementById(\"appMountPoint\")\r\n\t);\r\n};\r\n\r\nI tried the options mentioned here https://github.com/aws-amplify/amplify-js/issues/6930, but no success\r\nI am using -> aws-amplify: 4.3.14\r\n\r\nReally appreciate if some can help me","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNTA0Nw==","author":{"login":"Hideman85"},"title":"DataStore predicates exist and not exist?","body":"Hi community,\r\n\r\nI'm wondering how can I query objects that satisfy the predicates attribute A does not exist.\r\nI'm not able to see that predicates in the doc: https://docs.amplify.aws/lib/datastore/data-access/q/platform/js#predicates\r\n\r\nThanks in advance for your help","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"david-mcafee"},"body":"Thanks for starting this discussion, @Hideman85! Could you please share a code snippet of the query that is failing, and the related schema? Thank you!"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDg4MjYw","author":{"login":"MiladNazeri"},"title":"Fragile graphql","body":"Yesterday we were doing some tests for our app and one thing that worries me is if there is some bad data that gets written to the DB, graphql kind of craps out on all the queries that might be involved.  I know I'm not the only person that has run into this.  Is there anyway to mitigate this so one bad entry doesn't possibly shutdown the whole system?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"david-mcafee"},"body":"@MiladNazeri thanks for starting this discussion! Can you provide additional details on what error you were seeing? Is it on mutations, queries, etc? I've certainly done this a few times when testing, but never ran into an issue myself. If you provide us with additional repro steps, that would be helpful. Thanks!"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjczMTEx","author":{"login":"ambuu"},"title":"Am i doing this right ?","body":"","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"david-mcafee"},"body":"@ambuu seeing that you removed your question, assuming we can mark this as resolved. If you have further questions, please reach out to us again. Thanks!"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMTk5","author":{"login":"cthomaschase"},"title":"Does AppSync have a limit on number of subscriptions/client?","body":"Getting this back from AppSync:\r\n\r\n`Connection failed: {\"errors\":{\"errorType\":\"MaxSubscriptionsReachedError\",\"message\":\"Max number of 50 subscriptions reached\"}}`","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"david-mcafee"},"body":"@cthomaschase you're correct that there is a subscription limit, but after you opened this discussion, we increased the limit to 100 (see https://github.com/aws-amplify/amplify-js/issues/5050). We also have a tracking ticket for this issue (https://github.com/aws-amplify/amplify-js/issues/6260), and there are a few workarounds that may work depending on your specific use case. If you have further concerns or questions, please include your feedback on #6260. Thanks!!"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb241OTU4","author":{"login":"jjviton"},"title":"import Amplify from 'aws-amplify';","body":"Hi all\r\nI´m working in a POC using Amplify authentication using the simplest HTML & JS application (without using advanced tools such as React, only plain HTML and simple JS).\r\n\r\nAll setup process following the documentation (https://docs.amplify.aws/lib/q/platform/js) works properly, but in Js file at importing line I get this error:\r\n\r\n> _**import Amplify from 'aws-amplify';\r\n> ^^^^^^\r\n> SyntaxError: Cannot use import statement outside a module**_\r\n\r\nAny idea about how to fix it?\r\nIf I can not import the libraries, I can not progress.\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"mogarick"},"body":"Yo need to add more context. Are you trying to run the code from node without babel?"}}]}}},{"node":{"id":"D_kwDOBkswNc4AOUG5","author":{"login":"ricardoribas"},"title":"Detach services from amplify","body":"Hey there,\r\n\r\nThere is any proper way to detach services from amplify (for instance storage, api, etc...)? My idea is to isolate each part of amplify into a more owned app service. \r\n\r\nFor instance, if i want to remove API from amplify i would like to keep my database tables and everything related to it. Imagine that i want to create my own API that will communicate with those tables and return data to users. In this moment, if i remove API from amplify everything related to it will be removed. \r\n\r\nThere is any proper way to do this, or i need to use an (1) export/import service to export all data from a particular table and import it to a new one and (2) create a lambda trigger that will consume dyanmodb changes from old tables so i can keep all data up-to-date.\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"david-mcafee"},"body":"Hey @ricardoribas, thanks for starting this discussion! All of the AWS services that are spun up with Amplify can be used in isolation as regular AWS services. Does that answer your question?"}}]}}},{"node":{"id":"D_kwDOBkswNc4AOrOh","author":{"login":"simonthesurgery"},"title":"Error: Amplify has not been configured correctly.","body":"I'm in the process of trying to update a project I built in 2020 that no longer works but I keep running into this issue.\r\n\r\nI created a new angular project to see if I could pin-point the issue and again this issue has returned. I followed the documentation to set up amplify with the exception that we already have a backend so I ran `amplify pull --appId XXXXXX --envName XXXX` to get the aws-exports.js.\r\n\r\nI've done `npm i aws-amplify @aws-amplify/ui-angular`\r\nIn the main.ts I've added\r\n\r\n`import Amplify, { Auth } from 'aws-amplify';\r\nimport awsmobile from './aws-exports';\r\n\r\nAmplify.configure(awsmobile);\r\nAuth.configure(awsmobile) // I've tried both with and without this line`\r\n\r\nAnd I've implemented the Authenticator UI Component as per the documentation.\r\n\r\nAny information would be greatly appreciated!\r\n\r\n**Edit:**\r\nHere is some more information\r\n\r\nI'm in the process of trying to update a project I built in 2020 that no longer works but I keep running into this issue.\r\n\r\n```\r\n[ERROR] 04:09.562 AuthError - \r\n            Error: Amplify has not been configured correctly. \r\n            The configuration object is missing required auth properties.\r\n            This error is typically caused by one of the following scenarios:\r\n\r\n            1. Did you run `amplify push` after adding auth via `amplify add auth`?\r\n                See https://aws-amplify.github.io/docs/js/authentication#amplify-project-setup for more information\r\n\r\n            2. This could also be caused by multiple conflicting versions of amplify packages, see (https://docs.amplify.aws/lib/troubleshooting/upgrading/q/platform/js) for help upgrading Amplify packages.\r\n```\r\n\r\nI created a new angular (Ionic) project to see if I could pin-point the issue and again this issue has returned. I followed the documentation to set up amplify with the exception that we already have a backend so I ran `amplify pull --appId XXXXXX --envName XXXX` to get the **aws-exports.js**.\r\n\r\n1. I've done `npm i aws-amplify @aws-amplify/ui-angular`\r\n2. I've tried deleting **node-modules** and **package-lock.json**, and then running `npm i`\r\n3. I've renamed **aws-exports.js** to **aws-exports.ts** and added it to my **ts-config.app.json**\r\n```\r\n{\r\n  \"extends\": \"./tsconfig.json\",\r\n  \"compilerOptions\": {\r\n    \"outDir\": \"./out-tsc/app\",\r\n    \"types\": []\r\n  },\r\n  \"files\": [\r\n    \"src/main.ts\",\r\n    \"src/polyfills.ts\",\r\n\t\"src/aws-exports.ts\"\r\n  ],\r\n  \"include\": [\r\n    \"src/**/*.d.ts\"\r\n  ]\r\n}\r\n```\r\n4. In **main.ts** I've added\r\n```\r\nimport Amplify, { Auth } from 'aws-amplify';\r\nimport awsmobile from './aws-exports';\r\n\r\nAmplify.configure(awsmobile);\r\nAuth.configure(awsmobile); // I've tried both with and without this line\r\n```\r\n\r\n5. I've implemented the Authenticator UI Component as per the documentation.\r\n\r\nAny information would be greatly appreciated! I've read through multiple threads on the issue and none of the advice has worked.\r\n\r\nThis is the contents of my **aws-exports.ts** (with data redacted!)\r\n\r\n```\r\nconst awsmobile = {\r\n    \"aws_project_region\": \"eu-west-2\",\r\n    \"aws_appsync_graphqlEndpoint\": \"https://XXXXX.appsync-api.eu-west-2.amazonaws.com/graphql\",\r\n    \"aws_appsync_region\": \"eu-west-2\",\r\n    \"aws_appsync_authenticationType\": \"API_KEY\",\r\n    \"aws_appsync_apiKey\": \"XXXXX\",\r\n    \"aws_cognito_identity_pool_id\": \"eu-west-2:XXXXX\",\r\n    \"aws_cognito_region\": \"eu-west-2\",\r\n    \"oauth\": {},\r\n    \"aws_cognito_username_attributes\": [],\r\n    \"aws_cognito_social_providers\": [],\r\n    \"aws_cognito_signup_attributes\": [],\r\n    \"aws_cognito_mfa_types\": [],\r\n    \"aws_cognito_password_protection_settings\": {\r\n        \"passwordPolicyCharacters\": []\r\n    },\r\n    \"aws_cognito_verification_mechanisms\": [],\r\n    \"aws_mobile_analytics_app_id\": \"XXXXX\",\r\n    \"aws_mobile_analytics_app_region\": \"eu-west-1\"\r\n};\r\n\r\nexport default awsmobile;\r\n\r\n```\r\n\r\n**Edit:**\r\nI've also tried running `amplify init` and creating a new Amplify project but the issue persists\r\n\r\nHere's my package.json:\r\n```\r\n{\r\n  \"name\": \"XXXX\",\r\n  \"version\": \"0.0.1\",\r\n  \"author\": \"Ionic Framework\",\r\n  \"homepage\": \"https://ionicframework.com/\",\r\n  \"scripts\": {\r\n    \"ng\": \"ng\",\r\n    \"start\": \"ng serve\",\r\n    \"build\": \"ng build\",\r\n    \"test\": \"ng test\",\r\n    \"lint\": \"ng lint\",\r\n    \"e2e\": \"ng e2e\"\r\n  },\r\n  \"private\": true,\r\n  \"dependencies\": {\r\n    \"@angular/common\": \"~13.0.0\",\r\n    \"@angular/core\": \"~13.0.0\",\r\n    \"@angular/forms\": \"~13.0.0\",\r\n    \"@angular/platform-browser\": \"~13.0.0\",\r\n    \"@angular/platform-browser-dynamic\": \"~13.0.0\",\r\n    \"@angular/router\": \"~13.0.0\",\r\n    \"@aws-amplify/ui-angular\": \"^2.0.11\",\r\n    \"@capacitor/app\": \"1.1.0\",\r\n    \"@capacitor/core\": \"3.4.0\",\r\n    \"@capacitor/haptics\": \"1.1.4\",\r\n    \"@capacitor/keyboard\": \"1.2.1\",\r\n    \"@capacitor/status-bar\": \"1.0.7\",\r\n    \"@ionic/angular\": \"^6.0.0\",\r\n    \"aws-amplify\": \"^4.3.13\",\r\n    \"rxjs\": \"~6.6.0\",\r\n    \"tslib\": \"^2.2.0\",\r\n    \"zone.js\": \"~0.11.4\"\r\n  },\r\n  \"devDependencies\": {\r\n    \"@angular-devkit/build-angular\": \"~13.0.1\",\r\n    \"@angular-eslint/builder\": \"~13.0.1\",\r\n    \"@angular-eslint/eslint-plugin\": \"~13.0.1\",\r\n    \"@angular-eslint/eslint-plugin-template\": \"~13.0.1\",\r\n    \"@angular-eslint/template-parser\": \"~13.0.1\",\r\n    \"@angular/cli\": \"~13.0.1\",\r\n    \"@angular/compiler\": \"~13.0.0\",\r\n    \"@angular/compiler-cli\": \"~13.0.0\",\r\n    \"@angular/language-service\": \"~13.0.0\",\r\n    \"@capacitor/cli\": \"3.4.0\",\r\n    \"@ionic/angular-toolkit\": \"^5.0.0\",\r\n    \"@types/jasmine\": \"~3.6.0\",\r\n    \"@types/jasminewd2\": \"~2.0.3\",\r\n    \"@types/node\": \"^12.11.1\",\r\n    \"@typescript-eslint/eslint-plugin\": \"5.3.0\",\r\n    \"@typescript-eslint/parser\": \"5.3.0\",\r\n    \"eslint\": \"^7.6.0\",\r\n    \"eslint-plugin-import\": \"2.22.1\",\r\n    \"eslint-plugin-jsdoc\": \"30.7.6\",\r\n    \"eslint-plugin-prefer-arrow\": \"1.2.2\",\r\n    \"jasmine-core\": \"~3.8.0\",\r\n    \"jasmine-spec-reporter\": \"~5.0.0\",\r\n    \"karma\": \"~6.3.2\",\r\n    \"karma-chrome-launcher\": \"~3.1.0\",\r\n    \"karma-coverage\": \"~2.0.3\",\r\n    \"karma-coverage-istanbul-reporter\": \"~3.0.2\",\r\n    \"karma-jasmine\": \"~4.0.0\",\r\n    \"karma-jasmine-html-reporter\": \"^1.5.0\",\r\n    \"protractor\": \"~7.0.0\",\r\n    \"ts-node\": \"~8.3.0\",\r\n    \"typescript\": \"~4.4.4\"\r\n  },\r\n  \"description\": \"An Ionic project\"\r\n}\r\n```\r\n**Edit:**\r\nAs suggested by someone on StackOverflow, I've tried using \r\n``` \r\n\"@aws-amplify/auth\": \"^4.3.14\", \r\n\"@aws-amplify/core\": \"^4.3.14\" \r\n``` \r\nwith\r\n``` \r\nimport { Amplify } from '@aws-amplify/core'; \r\nimport { Auth } from '@aws-amplify/auth'; \r\nimport awsmobile from './aws-exports'; \r\nAmplify.configure(awsmobile); \r\nAuth.configure(awsmobile); \r\n``` \r\nand I'm still getting the same result. The latest version of @aws-amplify/auth seems to have an internal issue so I matched the latest version of @aws-amplify/core\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"david-mcafee"},"body":"@simonthesurgery thanks for starting this discussion! Can you tell us what Amplify dependencies you are using, and what versions they are? Thank you!"}},{"node":{"author":{"login":"simonthesurgery"},"body":"I've discovered the cause of my issue.\r\nThis is due to the fact that we had to migrate away from a previous Amplify project due to `UPDATE_ROLLBACK_FAILED` making the whole thing unrecoverable. The new project was not connected to the old Cognitio resources and so running `amplify pull` didn't provide me with the `aws_user_pools_id` and `aws_user_pools_web_client_id` fields in my aws-exports.js. I've had to manually provide that information and it works now.\r\n\r\nThank you for taking the time to look at my issue, but it turns out it was an issue with AWS rather than the amplify libraries."}}]}}},{"node":{"id":"D_kwDOBkswNc4AOy1R","author":{"login":"vytautas-softeta"},"title":"Is there a way to login with Social account (Google, Facebook, etc) using 'amazon-cognito-identity-js'?","body":"I have setup the sign up and login using 'amazon-cognito-identity-js' library, but there is a lack of information regarding how to use it for social logins. Is that even possible? Any feedback would be greatly appreciated.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AOySv","author":null,"title":"Multiple subdomain and single JWT authentication URL","body":"What I want to implement is to have `acounts.domain.com` as the main subdomain for register, sign in and forget password operations.\r\nAnd we have also separate web applications on different sub-domains like : \r\n- subdomain1.domain.com \r\n- subdomain2.domain.com \r\n\r\nthat should use `acounts.domain.com` for credentials. \r\nAll web apps are using the same **AWS Cognito** (user pool and user identity), and we are using **Amplify** now.\r\nSo the question is: Is it possible to use **JWT Authentication** method with Amplify? If yes, what is your suggested structure?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AOw0Z","author":{"login":"giulioambrogi"},"title":"amplifyPush in the CI - How to auto commit generated/updated files?","body":"Hello,\r\n\r\nToday I run `amplify push` from my own laptop, but I would like to move this to the Amplify CI.\r\nI already use the aws Amplify CI with Github webhook (every time I push), but currently doesn't handle the `amplify push` part.\r\n\r\n## Question\r\n\r\nI read in the docs that [we can use `amplifyPush`](https://docs.aws.amazon.com/amplify/latest/userguide/build-settings.html) for this matter. I noticed thought that sometimes files get updated/edited when running `amplify push` locally, how do I auto-commit tese changes as part of my CI process?\r\n\r\nThanks\r\n\r\n```\r\nversion: 1\r\nenv:\r\n  variables:\r\n    key: value\r\nbackend:\r\n  phases:\r\n    build:\r\n      commands:\r\n        - amplifyPush --simple\r\n  ``` ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNTc3NjE4","author":{"login":"codinronan"},"title":"How to restore an existing amplify app on new machine?","body":"So let's say I have gone through and created an app, done `amplify init`, added services and pushed my app and it's published.\r\n\r\nI now have a bunch of files inside the `amplify` folder, not checked into Git; and nor is the `aws-exports.js` file.\r\n\r\nMy colleague pulls the git repository, and he does `amplify init` at which point it creates a new project -- not initializing the existing one nor asking if it wants to initialize an existing one from the console.\r\n\r\nHow is this supposed to work? Without checking these files into Git, how is more than one developer supposed to be able to manage an amplify app?\r\n\r\nI've looked through the issues and discussions in this repository and although this has been asked, an answer has never been given. There was some talk of \"multienv\" 2 years ago, but those doc pages are completely gone and isn't what I am talking about, anyway.\r\n\r\nhttps://github.com/aws-amplify/amplify-cli/issues/508\r\nhttps://github.com/aws-amplify/amplify-js/issues/1635\r\nhttps://github.com/aws-amplify/amplify-cli/issues/37 -- this is the closest I could find, no answer","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"codinronan"},"body":"I think I found the answer, `amplify pull` with the given appId?"}},{"node":{"author":{"login":"david-mcafee"},"body":"@codinronan - To generate the `aws-exports.js` file in an existing project (or checkout a backend environment that exists in the console but does not show up locally), follow these steps:\r\n\r\n1. Go to the AWS console\r\n2. Choose `AWS Amplify`\r\n3. Find the app\r\n4. Go to `Backend environments`\r\n5. Find the backend environment\r\n6. Click `Edit backend`\r\n7. Run the command that is listed there, something like: \r\n    - `amplify pull --appId YOUR_APP_ID --envName YOUR_ENV_NAME`"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTAwNjM1","author":{"login":"fintechee"},"title":"Is it safe to expose aws_exports.js to the public repo, such as Github repo here?","body":"Is it safe to expose aws_exports.js to the public repo, such as Github repo here?\r\nBecause I saw there is an API key in the information.\r\nMany thanks.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"david-mcafee"},"body":"@fintechee the `aws-exports.js` file is added to `.gitignore` by default when creating an Amplify project - this file is not meant to be committed. If you are worried about being able to retrieve this file in the future (i.e. a new machine), follow the steps below:\r\n\r\nTo generate the `aws-exports.js` file in an existing project (or checkout a backend environment that exists in the console but does not show up locally), follow these steps:\r\n\r\n1. Go to the AWS console\r\n2. Choose `AWS Amplify`\r\n3. Find the app\r\n4. Go to `Backend environments`\r\n5. Find the backend environment\r\n6. Click `Edit backend`\r\n7. Run the command that is listed there, something like: \r\n    - `amplify pull --appId YOUR_APP_ID --envName YOUR_ENV_NAME`"}}]}}},{"node":{"id":"D_kwDOBkswNc4AOu3D","author":{"login":"allandallopez"},"title":"Error : undefined is not function when call Auth.sendCustomChallengeAnswer with separate Auth.signIn on server side","body":"Hi guys, need help to find out what is going wrong with the error undefined is not function on Auth.sendCustomChallengeAnswer.\r\n\r\nCurrently i am trying to do authentication with the aws amplify custom auth which is user can login using phone number and then verify the otp. But all of this, its running on separate side, first Auth.sigin ( when sending phone number ) i call this method on server side ( using node js ) then convert it to REST API then second one is Auth.sendCustomChallengeAnswer i call this method on client side ( using react native ). Actually it is running well when i call Auth.sigin on server side then its return the CognitoUser response. But when im trying to verify otp and calling this method Auth.sendCustomChallengeAnswer, its says undefined is not function. \r\n\r\n### I have question, is it possible to do the sigin and sendCustomChallengeAnswer on separate side ??\r\n\r\n\r\n\r\nI will share my example code, first on server side :\r\n\r\n1.  The method when call Auth.signIn :\r\n```\r\nimport Amplify from '@aws-amplify/core';\r\nimport {Auth} from '@aws-amplify/auth';\r\nimport awsConfig from '../../configs/aws.config';\r\n\r\npublic async signIn(signInRequestDto: SignInRequestDto): Promise<any> {\r\n    try {\r\n      const {phoneNumber, method} = signInRequestDto;\r\n      let methodOTP = method ? EOTPMethod[method.toUpperCase()] : 'sms';\r\n      await this.redis.setSendOTPMethod(phoneNumber, methodOTP);\r\n\r\n      const cognitoUser: CognitoUser = await Auth.signIn(phoneNumber);\r\n      return cognitoUser;\r\n    } catch (error) {\r\n      throw error;\r\n    }\r\n  }\r\n  ```\r\n  2.  The configuration code :\r\n  ```\r\nexport default {\r\n  region: process.env.REGION,\r\n  userPoolId: process.env.USER_POOL_ID,\r\n  userPoolWebClientId: process.env.USER_POOL_CLIENT_ID,\r\n  Storage: {\r\n    AWSS3: {\r\n      bucket: 'xxxx',\r\n      region: 'xxxx',\r\n    },\r\n  },\r\n  Auth: {\r\n    identityPoolId: process.env.IDENTITY_POOL_ID,\r\n    region: process.env.REGION,\r\n    userPoolId: process.env.USER_POOL_ID,\r\n    userPoolWebClientId: process.env.USER_POOL_CLIENT_ID,\r\n  },\r\n};\r\n  ```\r\n  \r\n And second, on client side : \r\n1. This method when i verify otp and Auth.sendCustomChallenge :\r\n```\r\nimport {Auth} from '@aws-amplify/auth';\r\nimport {CognitoUser} from 'amazon-cognito-identity-js';\r\n\r\nexport const checkVerificationCode = async (\r\n  cognitoUser: CognitoUser,\r\n  otp: string,\r\n): Promise<boolean> => {\r\n  let currentUser: any = {};\r\n  try {\r\n    currentUser = await Auth.sendCustomChallengeAnswer(cognitoUser, otp);\r\n  } catch (error: any) {\r\n    console.error( error.data || error.response?.data || error.response || error  );\r\n\r\n    throw error;\r\n  }\r\n\r\n  return true;\r\n};\r\n  ```\r\n2.  The configuration code on client side: \r\n  ```\r\nexport default {\r\n  region: env.REGION,\r\n  userPoolId: env.USER_POOL_ID,\r\n  userPoolWebClientId: env.USER_POOL_CLIENT_ID,\r\n  Storage: {\r\n    AWSS3: {\r\n      bucket: 'xxxx',\r\n      region: 'xxxx',\r\n    },\r\n  },\r\n  Auth: {\r\n    identityPoolId: env.IDENTITY_POOL_ID,\r\n    region: env.REGION,\r\n    userPoolId: env.USER_POOL_ID,\r\n    userPoolWebClientId: env.USER_POOL_CLIENT_ID,\r\n  },\r\n};\r\n  ```\r\n  \r\n  For your information im using the same version both of server and client side, the version :\r\n```\r\n\"@aws-amplify/auth\": \"^4.3.12\",\r\n\"@aws-amplify/core\": \"^4.3.4\",\r\n```","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AOaov","author":{"login":"gambithunt"},"title":"Amplify Console build issue - please help","body":"Hi all\r\n\r\nMy vue app is running fine locally and builds fine locally, however, I'm trying to build my app on Amplify using a link to my github repo. The link and the clone work fine but I'm getting an error during the build.\r\n\r\nAmplify push also works fine without problems.\r\n\r\nI've only ever used NPM for all modules along with the vue-cli and Amplify-cli.\r\n\r\nThe lambda function that I think it may have a problem with is a layers function, I've used it to include, layers for Axios, Express and Cloudinary all installed with npm.\r\n\r\nI have no idea where to start with this.\r\n\r\nThe main error seems to be : Cannot find module '/codebuild/output/src323788196/src/.yarn/releases/yarn-1.23.0-20210726.1745.cjs'\r\n\r\nI've tried 'yarn install' but that does not help. I'm not sure what to do next because I've never used yarn at all in this project.\r\n\r\nMy build config is standard -\r\n\r\n```version: 1\r\nbackend:\r\n  phases:\r\n    build:\r\n      commands:\r\n        - '# Execute Amplify CLI with the helper script'\r\n        - amplifyPush --simple\r\nfrontend:\r\n  phases:\r\n    preBuild:\r\n      commands:\r\n        - npm install\r\n    build:\r\n      commands:\r\n        - npm run build\r\n  artifacts:\r\n    baseDirectory: dist\r\n    files:\r\n      - '**/*'\r\n  cache:\r\n    paths:\r\n      - node_modules/**/*```\r\n\r\nHere is my error - \r\n\r\n```[WARNING]: ✖ An error occurred when pushing the resources to the cloud\r\n2022-01-04T06:47:49.986Z [WARNING]: ✖ There was an error initializing your environment.\r\n2022-01-04T06:47:49.993Z [INFO]: \u001b[0mError: Packaging lambda function failed with the error \u001b[0m\r\n[0mCommand failed with exit code 1: yarn --production\u001b[0m\r\n[0minternal/modules/cjs/loader.js:818\u001b[0m\r\n[0m  throw err;\u001b[0m\r\n[0m  ^\u001b[0m\r\n[0mError: Cannot find module '/codebuild/output/src323788196/src/.yarn/releases/yarn-1.23.0-20210726.1745.cjs'\u001b[0m\r\n[0m    at Function.Module._resolveFilename (internal/modules/cjs/loader.js:815:15)\u001b[0m\r\n                                 \u001b[0m    at Function.Module._load (internal/modules/cjs/loader.js:667:27)\u001b[0m\r\n                                 \u001b[0m    at Function.executeUserEntryPoint [as runMain] (internal/modules/run_main.js:60:12)\u001b[0m\r\n                                 \u001b[0m    at internal/main/run_main_module.js:17:47 {\u001b[0m\r\n                                 \u001b[0m  code: 'MODULE_NOT_FOUND',\u001b[0m\r\n                                 \u001b[0m  requireStack: []\u001b[0m\r\n                                 \u001b[0m}\u001b[0m\r\n                                 \u001b[0m    at runPackageManager (/root/.nvm/versions/node/v12.21.0/lib/node_modules/@aws-amplify/cli/node_modules/amplify-nodejs-function-runtime-provider/src/utils/legacyBuild.ts:66:13)\u001b[0m\r\n                                 \u001b[0m    at installDependencies (/root/.nvm/versions/node/v12.21.0/lib/node_modules/@aws-amplify/cli/node_modules/amplify-nodejs-function-runtime-provider/src/utils/legacyBuild.ts:40:3)\u001b[0m\r\n                                 \u001b[0m    at Object.buildResource [as build] (/root/.nvm/versions/node/v12.21.0/lib/node_modules/@aws-amplify/cli/node_modules/amplify-nodejs-function-runtime-provider/src/utils/legacyBuild.ts:13:5)\u001b[0m\r\n                                 \u001b[0m    at buildFunction (/root/.nvm/versions/node/v12.21.0/lib/node_modules/@aws-amplify/cli/node_modules/amplify-category-function/src/provider-utils/awscloudformation/utils/buildFunction.ts:41:36)\u001b[0m\r\n                                 \u001b[0m    at prepareResource (/root/.nvm/versions/node/v12.21.0/lib/node_modules/@aws-amplify/cli/node_modules/amplify-provider-awscloudformation/src/push-resources.ts:605:33)\u001b[0m\r\n                                 \u001b[0m    at async Promise.all (index 1)\u001b[0m\r\n                                 \u001b[0m    at prepareBuildableResources (/root/.nvm/versions/node/v12.21.0/lib/node_modules/@aws-amplify/cli/node_modules/amplify-provider-awscloudformation/src/push-resources.ts:601:10)\u001b[0m\r\n                                 \u001b[0m    at Object.run (/root/.nvm/versions/node/v12.21.0/lib/node_modules/@aws-amplify/cli/node_modules/amplify-provider-awscloudformation/src/push-resources.ts:173:5)\u001b[0m\r\n2022-01-04T06:47:50.024Z [ERROR]: !!! Build failed\r\n2022-01-04T06:47:50.024Z [ERROR]: !!! Non-Zero Exit Code detected```","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"gambithunt"},"body":"I managed to solve it"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xODkw","author":{"login":"mrichman"},"title":"Using Cognito in Vue.js without Amplify","body":"There used to be a standalone JS implementation which is now buried in Amplify and is now deprecated.\r\n\r\nI really don’t want to incur the bloat that comes along with `amplify add auth` as I have no use for most of Amplify and all it’s overhead.\r\n\r\nIsn’t there a simple (-ish) way to use Amplify’s auth components without sucking in the whole framework?\r\n\r\nI’m fine with Cognito’s hosted UI.\r\n\r\nA trivial example is most welcome.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"ashika01"},"body":"@mrichman `amplify add auth` is going to setup the backend for you. However if you choose not to use the CLI, you can still configure auth using `Auth.configure` options. \r\nhttps://docs.amplify.aws/lib/auth/start/q/platform/js#re-use-existing-authentication-resource\r\n\r\nyou could also do import only auth without the need of bringing in all of amplify by doing something like this,\r\n\r\n```\r\nimport {Auth} from \"@aws-amplify/auth\";\r\n....\r\nAuth.configure({\r\n        // REQUIRED only for Federated Authentication - Amazon Cognito Identity Pool ID\r\n        identityPoolId: 'XX-XXXX-X:XXXXXXXX-XXXX-1234-abcd-1234567890ab',\r\n\r\n        // REQUIRED - Amazon Cognito Region\r\n        region: 'XX-XXXX-X',\r\n\r\n        // OPTIONAL - Amazon Cognito Federated Identity Pool Region \r\n        // Required only if it's different from Amazon Cognito Region\r\n        identityPoolRegion: 'XX-XXXX-X',\r\n\r\n        // OPTIONAL - Amazon Cognito User Pool ID\r\n        userPoolId: 'XX-XXXX-X_abcd1234',\r\n\r\n        // OPTIONAL - Amazon Cognito Web Client ID (26-char alphanumeric string)\r\n        userPoolWebClientId: 'a1b2c3d4e5f6g7h8i9j0k1l2m3',\r\n\r\n        // OPTIONAL - Enforce user authentication prior to accessing AWS resources or not\r\n        mandatorySignIn: false,\r\n\r\n        // OPTIONAL - Configuration for cookie storage\r\n        // Note: if the secure flag is set to true, then the cookie transmission requires a secure protocol\r\n        cookieStorage: {\r\n        // REQUIRED - Cookie domain (only required if cookieStorage is provided)\r\n            domain: '.yourdomain.com',\r\n        // OPTIONAL - Cookie path\r\n            path: '/',\r\n        // OPTIONAL - Cookie expiration in days\r\n            expires: 365,\r\n        // OPTIONAL - Cookie secure flag\r\n        // Either true or false, indicating if the cookie transmission requires a secure protocol (https).\r\n            secure: true\r\n});\r\n```\r\n\r\nLooks like the last bit is unclear in docs. I ll open up an issue for that.\r\n"}}]}}},{"node":{"id":"D_kwDOBkswNc4AOqSs","author":{"login":"matart15"},"title":"Where does amplify cache static pages?","body":"about next cache I found [this article](https://flaviocopes.com/nextjs-cache-data-globally/). which uses a file for the cache.  [this article](https://blog.dennisokeeffe.com/blog/2021-09-30-introduction-to-caching-with-nextjs#caching-on-the-client-side) uses redis.\r\n\r\njust wondering by default where does amplify caches generated static pages.\r\n\r\nlooked at my profile `Elasticcahe`. but there was nothing.","upvoteCount":0,"comments":{"edges":[{"node":{"author":{"login":"matart15"},"body":"never mind. \r\nI found static pages in `S3`"}}]}}},{"node":{"id":"D_kwDOBkswNc4AOqKL","author":{"login":"Hevton"},"title":"Pricing criteria of amplify flutter","body":"I am confused about pricing criteria in aws amplify\r\n\r\nIt is said that the price is set per 1,000 SELECT, POST, GET, and LIST requests.\r\n\r\nLet's assume\r\n\r\n```\r\nList<Object> obj = Amplify.DataStore.query(Object.classtype, where: Object.ID.eq('123'));\r\n//obj.length is 1000\r\n\r\n```\r\nIs this command 1000 requests or 1 request?\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AOpyb","author":{"login":"ritika2291"},"title":"S3 KeyTooLongError","body":"The key that is being generated for my files in S3 is around 600 characters too long. The file name and path are both under 15 characters. When I try to access the object via a presigned url, generated via Storage.get, I get the error that KeyTooLongError. Any ideas on what to do?","upvoteCount":5,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AOoPP","author":{"login":"anastasiyamazheika"},"title":"How to use docker compose in Amplify pipeline?","body":"Hello! \r\nI want to launch my tests in docker in Amplify pipeline. \r\n\r\nDockerfile:\r\n```\r\nFROM mcr.microsoft.com/playwright:v1.16.3-focal\r\n\r\nRUN npx playwright install chrome\r\nENTRYPOINT [ \"npx\", \"playwright\", \"test\", \"--config=tests/playwright.config.ts\" ] \r\n```\r\n\r\ndocker-compose.yml\r\n\r\n```\r\nversion: \"3.4\"\r\nservices:\r\n  tests:\r\n    volumes:\r\n      - .:/code\r\n    build: \r\n      context: .\r\n      dockerfile: Dockerfile\r\n    working_dir: /code\r\n    ipc: host\r\n```\r\n\r\namplify.yml\r\n```\r\ntest:\r\n      commands:\r\n        - docker compose up\r\n```\r\n\r\nAmplify console\r\n\r\n```\r\n# Starting phase: test\r\n[INFO]: # Executing command: docker compose up\r\n[WARNING]: /codebuild/output/src983611118/src/{project_name}/tests.sh: line 29: docker: command not found\r\n[INFO]: # Completed phase: test\r\n[INFO]: ## Tests completed successfully\r\n```\r\n\r\nDid I forget something that docker isn't recognized?\r\nWhy error _docker: command not found_ is recognized only as **WARNING** instead of **ERROR**?\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"anastasiyamazheika"},"body":"Moved question to https://github.com/aws-amplify/amplify-console/issues/2550"}}]}}},{"node":{"id":"D_kwDOBkswNc4AOhI3","author":{"login":"benjamindoe"},"title":"Is it possible to authenticate a user from SSR routes in next.js?","body":"I am trying to authenticate users via a custom cognito challenge. Due to some constraints we have to do this from a `/api` route, which causes the code to run server-side. I am using something similar to below:\r\n\r\n```javascript\r\nconst { Auth }  = withSSRContext({ req });\r\n\r\nlet user = await Auth.signin(username);\r\nuser = Auth.sendCustomChallengeAnswer(user, challengeAnswer);\r\n\r\n// User is successfully authenticated\r\nconsole.log(user);\r\n\r\n// Any other logic in SSR works\r\n```\r\n\r\nAny other logic works within the SSR route. As soon as you try anything from another endpoint, SSR or client-side, there is no user in the session. I assume this is because the cognito cookie isn't being altered? ","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"davemooreuws"},"body":"Hi @benjamindoe ,\r\n\r\nWe have built an amplify library for ssr. We are currently using it in a NextJS app for protecting routes and persisting the user.\r\n\r\nFeel free to check it out: https://github.com/nitrictech/amplify-secure-js"}}]}}},{"node":{"id":"D_kwDOBkswNc4AOoPM","author":{"login":"poyashad"},"title":"GraphQL & Cognito - manyToMany on the groupsField","body":"Hi guys!\r\n\r\nI am working on a multitenant application. And i am using two resources for this. \r\nCognito for user authentication and Groups.\r\nGraphQL(DynamoDB) for storing data about Workspaces(Groups) and Users\r\n\r\nCognito Group = Tenant/Workspace.\r\nThe tenant = Workspace(In GraphQL). \r\n\r\nSo when a user signs up and confirms the account.  The post-confirmation lambda gets triggered.\r\nThe plan is to have the Lambda function do these things.\r\n1. Create a Cognito Group ✅\r\n2. Add the user to the Cognito Group. ✅\r\n3. Create the workspace with GraphQL(dynamodb) ❌ (Need to create the schema before doing mutations from the lambda)\r\n4. Create the user in with GraphQL ❌ (Need to create the schema before doing mutations from the lambda)\r\n\r\nSo I am working on the schema. But can't manage to get it right. Based on the documentation I should create something like this.\r\n```\r\ntype Workspace @model\r\n  @auth(rules: [\r\n    {allow: groups, groupsField: \"id\"}\r\n    {allow: private, provider: iam}\r\n    ]) {\r\n    id: ID! @primaryKey\r\n    workspace_name: String!\r\n}\r\n\r\ntype User @model\r\n  @auth(rules: [\r\n    {allow: groups, groupsField: \"workspaces\"}\r\n    {allow: private, provider: iam}\r\n    ]) {\r\n    id: ID! @primaryKey\r\n    workspaces: [String]\r\n    email: String!\r\n    firstName: String\r\n    lastName: String\r\n}\r\n ```\r\nBut i want relationships between the workspace and the users. \r\n\r\nFor example: a workspace could have many users. or users could access many workspaces. \r\n```\r\ntype Workspace @model\r\n  @auth(rules: [\r\n    {allow: groups, groupsField: \"id\"}\r\n    {allow: private provider: iam}\r\n    ]) {\r\n    id: ID! @primaryKey\r\n    workspace_name: String!\r\n    users: [User] @manyToMany(relationName: \"WorkspaceUsers\")\r\n}\r\n\r\ntype User @model\r\n  @auth(rules: [\r\n    {allow: groups, groupsField: \"workspaces\"}\r\n    {allow: private, provider: iam}\r\n    ]) {\r\n    id: ID! @primaryKey\r\n    workspaces: [Workspace!] @manyToMany(relationName: \"WorkspaceUsers\")\r\n    username: String!\r\n    email: String!\r\n    firstName: String\r\n    lastName: String\r\n} \r\n```\r\nDocumentation says this:\r\n```\r\nUnder the hood, the @manyToMany directive will create a \"join table\" named after the relationName to facilitate the many-to-many relationship. This generates queries and mutations that allow you to retrieve the related Comment records from the source Post record and vice versa:\r\n```\r\nJust by testing queries in App Sync GUI and using the newly created Cognito User, it throws not authorized. \r\nThe Cognito user is able to create a workspace. \r\nBut the Cognito user is not able to create a user or the relationship WorkspaceUsers. \r\nDoes anyone know how to tackle this?","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"poyashad"},"body":"Update: \r\nIn AppSync when looking at createUser mutation there is no workspaces field. And that is probably why i am getting not authorized because theres no input for the workspaces field... I am trying to create a user without inputing the workspaces field... hmmm how can i access the field. Does anyone know? Thanks\r\n![Skärmavbild 2022-01-26 kl  14 15 25](https://user-images.githubusercontent.com/20397026/151172313-07c4603c-9c1c-43d2-8008-bf37074c594e.png)\r\n"}}]}}},{"node":{"id":"D_kwDOBkswNc4AOnk7","author":{"login":"thevangelist"},"title":"React components: How to create a custom ConfirmSignUp?","body":"How can I customize other content in ConfirmSignUp than Header and Footer?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AOmjj","author":{"login":"thegoliathgeek"},"title":"Graphql Custom-Auth Auth Header Type","body":"Hey! \r\ni have setup the custom authentication with amplify on a model\r\n```graphql\r\ntype Module\r\n  @model\r\n  @auth(\r\n    rules: [{ allow: custom }]\r\n  ) {\r\n  id: ID!\r\n  name: String\r\n}\r\n```\r\n\r\nI have also setup a lambda for this ,for verification of the token.\r\n\r\nAm getting my jwt from cognito.\r\nIt seems lambda (custom auth) is not trigged.\r\nWhen the header is (this is the default auth header from amplify)\r\n\r\n`Authorization: {jwt}`\r\n\r\nBut when i change header\r\n\r\n`Authorization: Bearer {jwt}`\r\n\r\n\r\nLambda is triggered when auth header used as above with Bearer.\r\n\r\nWhy is not getting trigged in the first pattern?\r\nAmplify lib is using this `Authorization: {jwt}` by default for network calls.\r\n\r\nSo whats wrong here ?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNjY5","author":{"login":"Abuitime"},"title":"How to sort many to many connections","body":"I am currently building a react application with Amplify. I am building out the schema but having trouble adding sorting.\r\n\r\n**How can I set up my schema to return all the products for a collection sorted by product name?**\r\n\r\nA collection can have many products. A product can be in many collections.\r\n\r\n```\r\ntype Collection @model {\r\n    id: ID!\r\n    name: String!\r\n    products: [CollectionProduct] @connection(name: \"Product\")\r\n}\r\n\r\ntype CollectionProduct @model {\r\n    id: ID!\r\n    collection: Collection! @connection(name: \"Product\")\r\n    product: Product! @connection (name: \"Collection\")\r\n}\r\n\r\ntype Product @model {\r\n    id: ID!\r\n    name: String!\r\n    collections: [CollectionProduct] @connection(name: \"Collection\")\r\n}\r\n\r\nquery GetCollection {\r\n  getCollection() {\r\n    id\r\n    name\r\n    products {\r\n      items { #sort by product name\r\n        id\r\n        product {\r\n          name\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n```","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"dabit3"},"body":"Hey @Abuitime, I think you'll have to add the additional field to the connection.\r\n\r\nThe other main thing here is that you need some arbitrary field that is consistent across all three types (for the type field), this way you have a consistent field across all three tables that can be queried.\r\n\r\nI think something like this would work:\r\n\r\n```graphql\r\ntype Collection @model {\r\n    id: ID!\r\n    name: String!\r\n    type: String!\r\n    products: [CollectionProduct] @connection(keyName: \"byProductType\", fields: [\"type\"])\r\n}\r\n \r\ntype CollectionProduct @model \r\n  @key(name: \"byProductType\", fields: [\"type\", \"productName\"])\r\n  @key(name: \"byCollectionType\", fields: [\"type\", \"collectionName\"])\r\n  {\r\n    id: ID!\r\n    type: String\r\n    productName: String\r\n    collectionName: String\r\n    collection: Collection @connection\r\n    product: Product @connection\r\n}\r\n\r\ntype Product @model {\r\n    id: ID!\r\n    name: String!\r\n    type: String!\r\n    collections: [CollectionProduct] @connection(keyName: \"byCollectionType\", fields: [\"type\"])\r\n}\r\n```\r\n\r\n```graphql\r\n# create collection\r\nmutation createCollection {\r\n  createCollection(input:{\r\n    name: \"Collection1\"\r\n    type: \"CollectionIdentifier\"\r\n  }) {\r\n    id\r\n    name\r\n  }\r\n}\r\n\r\n# create product\r\nmutation createProduct {\r\n  createProduct(input:{\r\n    name: \"Product 1\"\r\n    type: \"CollectionIdentifier\"\r\n  }) {\r\n    id\r\n    name\r\n  }\r\n}\r\n\r\n# create the link between a product and a collection\r\nmutation createCollectionProduct {\r\n  createCollectionProduct(input: {\r\n    productName: \"Product 1\"\r\n    type: \"CollectionIdentifier\"\r\n    collectionName: \"Collection 2\"\r\n    collectionProductProductId: \"<productid>\"\r\n    collectionProductCollectionId: \"<collectionid>\"\r\n  }) {\r\n    id\r\n    product {\r\n      id\r\n      name\r\n    }\r\n  }\r\n}\r\n\r\n# query\r\nquery listCollections {\r\n  listCollections {\r\n    items {\r\n      id\r\n      name\r\n      products(sortDirection: ASC) {\r\n        items {\r\n          id\r\n          productName\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n```"}},{"node":{"author":{"login":"Abuitime"},"body":"I got it working with the following\r\n\r\n```\r\ntype Collection @model {\r\n    id: ID!\r\n    name: String!\r\n    products: [CollectionProduct] @connection(keyName: \"byCollection\", fields: [\"name\"])\r\n}\r\n\r\ntype CollectionProduct\r\n  @model(queries: null)\r\n  @key(name: \"byProduct\", fields: [\"productName\", \"collectionName\"])\r\n  @key(name: \"byCollection\", fields: [\"collectionName\", \"productName\"])\r\n  {\r\n    id: ID!\r\n    productName: String\r\n    collectionName: String\r\n    collection: Collection! @connection\r\n    product: Product!  @connection\r\n}\r\n\r\ntype Product @model {\r\n    id: ID!\r\n    name: String!\r\n    collections: [CollectionProduct] @connection(keyName: \"byProduct\", fields: [\"name\"])\r\n}\r\n```"}}]}}},{"node":{"id":"D_kwDOBkswNc4AOh_4","author":{"login":"matart15"},"title":"How to type cdk override with typescript","body":"trying to do [this](https://docs.amplify.aws/cli/project/override/) with amplify \r\n\r\nbut my tslint complains \r\n\r\n```\r\nTypeScript error in amplify/#current-cloud-backend/auth/salescircle/override.ts(12,3):\r\nObject is possibly 'undefined'.  TS2532\r\n\r\n    10 |   };\r\n    11 |   // eslint-disable-next-line no-param-reassign\r\n  > 12 |   resources.userPool.schema = [\r\n       |   ^\r\n    13 |     ...(resources.userPool.schema as any),\r\n    14 |     customAttribute,\r\n    15 |   ];\r\n```\r\n\r\n\r\nalso, minor issue with esint rule `no-param-reassign`. which is a bad practice I assume.\r\n\r\nSo, how to type `TS2532` error.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AOhDc","author":{"login":"gmineropfdrive"},"title":"Unable to delete app env using cli or from aws console","body":"appId: d37ekhbhp9fm2w\r\nregion: us-east2\r\nenv name: devsync\r\ntried deleting using the console or cli.\r\n\r\nSame for an app, which seems to be stuck in limbo:\r\n\r\nconsole displays, `Deletion completed 12/9/2021, 10:25:29 AM`, but the app is stuck in the Amplify apps UI\r\nappId: dh6mdw6ntdxjd\r\nregion: us-east2\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AOefg","author":{"login":"ashWhiteHat"},"title":"Lambda functions environment variable disappear when Amplify deploys","body":"Every time I deploy new version Lambda application, all the environment variables disappear as following.\r\n![env](https://user-images.githubusercontent.com/39494661/149099092-1142e98e-20fc-4d70-9746-ba1389bbfa6b.png)\r\nHow can I set permanent environment variable?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"ashWhiteHat"},"body":"Sorry this is mistake.\r\nMy amplify setting has problem so it's another problem."}}]}}},{"node":{"id":"D_kwDOBkswNc4AOfzO","author":{"login":"giovannigiordano"},"title":"Mutation inside a NodeJS lambda","body":"Hello everyone!\r\nI am trying to make a query on AppSync through a NodeJS lambda and I've followed [this guide](https://docs.amplify.aws/lib/graphqlapi/graphql-from-nodejs/q/platform/js/) from the official documentation.\r\n\r\n```\r\nimport https from \"https\";\r\nimport { init, getLambda } from \"@macai-tech/framework-node\";\r\nimport AWSAppSyncClient from \"aws-appsync\";\r\nimport * as AWS from \"aws-sdk\";\r\nimport SignerV4 from \"aws-sdk/lib/signers/v4\";\r\nimport * as M from \"./models\";\r\nimport url from \"url\";\r\nimport { CustomerInfrastructure } from \"./infrastructure/Customer\";\r\n\r\nconst endpoint = new url.URL(\r\n  process.env.AWS_APPSYNC_URL as string\r\n).hostname.toString();\r\n\r\nconst lambda = getLambda({ eventDetailSchema: M.EventDetail });\r\n\r\nexport const handler = async () => {\r\n  const req = new AWS.HttpRequest(\r\n    new AWS.Endpoint(process.env.AWS_APPSYNC_URL as string),\r\n    process.env.AWS_APPSYNC_REGION as string\r\n  );\r\n\r\n  req.method = \"POST\";\r\n  req.path = \"/graphql\";\r\n  req.headers.host = endpoint;\r\n  req.headers[\"Content-Type\"] = \"application/json\";\r\n  req.body = JSON.stringify({\r\n    query: `\r\n            mutation CreateCustomer($customer: CustomerInput!) {\r\n              createCustomer(customer: $customer) {\r\n                customer_id\r\n                phone_number {\r\n                  value\r\n                  prefix\r\n                }\r\n              }\r\n            }\r\n\r\n    `,\r\n    variables: {\r\n      customer: {\r\n        customer_id: \"asdasdad\",\r\n        phone_number: {\r\n          prefix: \"+39\",\r\n          value: \"3333333333\",\r\n        },\r\n      },\r\n    },\r\n  });\r\n\r\n  const signer = new SignerV4(req, \"appsync\", true);\r\n  signer.addAuthorization(AWS.config.credentials, new Date());\r\n\r\n  const data = await new Promise((resolve, reject) => {\r\n    const httpRequest = https.request({ ...req, host: endpoint }, (result) => {\r\n      let data = \"\";\r\n\r\n      result.on(\"data\", (chunk) => {\r\n        data += chunk;\r\n      });\r\n\r\n      result.on(\"end\", () => {\r\n        resolve(JSON.parse(data.toString()));\r\n      });\r\n    });\r\n    httpRequest.on(\"error\", reject);\r\n\r\n    httpRequest.write(req.body);\r\n    httpRequest.end();\r\n  });\r\n\r\n  return {\r\n    statusCode: 200,\r\n    body: data,\r\n  };\r\n};\r\n\r\n```\r\nFirst of all, I had to change the import of Signer V4, on the documentation there is no reference to the import, and there is no `Signers` under `AWS`.\r\n\r\nThe code works if the deployed, but if I try to run it on my local machine it doesn't work.\r\n\r\nThe steps I followed are:\r\n\r\n-  Login with the `aws-cli`\r\n- Export the env variables: `AWS_PROFILE`, `AWS_SDK_LOAD_CONFIG`\r\n- Run the script\r\n\r\nThe problem is that `AWS.config.credentials` is `null`, so the signer can't sign the request and I cannot test it locally.\r\n\r\nHow can i resolve this problem?","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AOdU0","author":{"login":"Ngandu"},"title":"Token refresher failing with 'code' responseType but works with 'token'","body":"Need assistance with refreshing jwt token from cognito.\r\n\r\nWhen using the 'code' responseType the token is failing to refresh, but when using 'token' the token is refreshing correctly. Refresher is doing so automatically after 1-hour.\r\n\r\nWe are using Amplify to manage authentication on the App with react-native and expo.\r\n\r\nWe are using a Federation - OpenID connects to sign-in users.\r\n\r\nCognito Allowed OAuth Flows are set with:\r\n* Authorization code grant\r\n* Implicit grant\r\n\r\nWhen responseType:'token' - the token is refreshing correctly.\r\n<img width=\"509\" alt=\"token_refresh\" src=\"https://user-images.githubusercontent.com/5862278/148730737-7a31fc58-20f3-4dfe-8521-ed195562838a.png\">\r\n\r\nWhen responseType:'code' - the refresher is failing.\r\n<img width=\"461\" alt=\"code_refrsh_failure\" src=\"https://user-images.githubusercontent.com/5862278/148730858-8a1b9668-dd26-487d-b4fe-a489d7103021.png\">\r\n\r\n\r\nFrom Amplify documentation it's supposed to work the other way around.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"hkjpotato"},"body":"Thank you for submitting this discussion. Based on the [Cognito doc](https://docs.aws.amazon.com/cognito/latest/developerguide/token-endpoint.html#:~:text=Note-,The%20token%20endpoint%20returns%20refresh_token%20only%20when%20the%20grant_type%20is%20authorization_code.,-code) and my local testing, refreshToken won't be available in the implicit grant type. It is only returned in the `code` grant. I need to do more testing to reproduce it. Can you provide me your `aws-export` config?"}},{"node":{"author":{"login":"Ngandu"},"body":"Hi @hkjpotato, thank you for your reply.\r\n\r\nIt started working correctly after one of my team members did an update on the App Client settings, we don't know why cause his update had nothing to do with the issue above.\r\n\r\nMy current guess, it needed a refresh or reset."}}]}}},{"node":{"id":"D_kwDOBkswNc4AOes6","author":{"login":"charithreddyv"},"title":"aws-amplify interactions(lex) way to start a conversation without user input.","body":"Hai There, \r\nI am new to aws-amplify, lex and react-native.\r\n\r\nTrying to work on way to create/fire and interaction with some intent without user interaction. basically the approach i am working on is when user clicks on a push notification it should automatically trigger intent  (which i am assuming as bot first conversation where bot first initiates a conversation ) i asked this same kinda question over aws re:post https://repost.aws/questions/QUONBDhLUBTViTCP-rsIvXPA/scheduling-a-aws-lex-intent-as-push-notification and got to know that there is this putSession API which can be used to create a conversation, but i have no idea on how to fit it with amplify.\r\n\r\nAnd another thing i am curious about is i see `PutSessionCommand` from `@aws-sdk/client-lex-runtime-service` and i see a class  `AVOSLexProvider` where `sendMessage` is configured to use `PostTextCommand` and there is this configuration in `App.tsx` `Interactions.addPluggable(new AVOSLexProvider());` so is there a way i can do PutSession using aws-amplify if not is there any other way to achieve what i am expecting ?\r\n\r\nThanks in advance.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AOeUE","author":{"login":"krikork"},"title":"Overriding Access-Control-Allow-Headers","body":"In older versions of the cli, I was able to edit the cloud formation template for an API resource. Now that's no longer possible as the cli generates those files on `push`. \r\n\r\nOne thing that I used to do is add custom headers to the following key: \"method.response.header.Access-Control-Allow-Headers\":\r\n\r\nThe following is what gets created by default.\r\n\r\n\"method.response.header.Access-Control-Allow-Headers\": \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,X-Amz-User-Agent'\"\r\n\r\nHow can I override these headers in the `override.ts` so that I end up with customer `Access-Control-Allow-Headers` once the cloud formation template is generated?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"krikork"},"body":"Looks like I found what I was looking for. Something like this should do the trick\r\n\r\n```\r\n\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.override = void 0;\r\nfunction override(resources) {\r\n    resources.restApi.body.paths[\"/invitation\"].options[\"x-amazon-apigateway-integration\"].responses.default.responseParameters[\"method.response.header.Access-Control-Allow-Headers\"] =\r\n        \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token,X-Amz-User-Agent,authorizationtoken'\";\r\n}\r\nexports.override = override;\r\n\r\n```"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjc5OTk5","author":{"login":"billycolley"},"title":"@aws-amplify/ui-react How To Customize SignIn/SignUp","body":"Hello,\r\n\r\nI am using @aws-amplify/ui-react and I would like to use a custom component for the SignIn/SignUp pages. Ideally I'd like to extend AmplifySignIn class, change the rendering to be what I want it to be, and call super to handle the majority of the logic. You used to be able to do this with the old aws-amplify-react package following something like [this](https://blog.kylegalbraith.com/2018/11/29/how-to-easily-customize-the-aws-amplify-authentication-ui/).\r\n\r\nI understand that with the new system you can do some basic field selection and css customization, but I want to supply an entirely different UI for the SignIn component and pass that to Authenticator, and as long as it adheres to the correct API it should be supported, but I can't get it to show up at all. Is this still possible with the new package? Is there any documentation that explains how you would go about this? Is it something super simple that I'm just not noticing?\r\n\r\nThanks in advance,\r\nBilly","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"blazinaj"},"body":"Having the same issue https://github.com/aws-amplify/amplify-js/issues/8491\r\n"}}]}}},{"node":{"id":"D_kwDOBkswNc4AOaPz","author":{"login":"rswerve"},"title":"Any Amplify method for S3's GetObjectTagging?","body":"In S3, there's a [GetObjectTagging](https://docs.aws.amazon.com/AWSJavaScriptSDK/v3/latest/clients/client-s3/classes/getobjecttaggingcommand.html) method that allows us to get all the tags associated with an object in an S3 bucket.  What's the best way to get object tags via Amplify?  Much searching hasn't turned up anything.\r\n\r\nTo describe the use case: upload a file, do a virus scan, tag infected files so that the front-end can use that information.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"zachjonesnoel"},"body":"Hi @rswerve,\r\n\r\nI'm not sure if you want the Object tags accessible on the front-end or backend. As per my knowledge, there is not equivalent method for getting object tags on Amplify instead you can use Lambda triggers to trigger a Lambda whenever a file is put and extract the object tags if that servers your purpose."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDU1MjQ3","author":{"login":"PeteDuncanson"},"title":"How to manage cascade deletes of hasOne relations?","body":"I've got a a type called Round which can have a technician assigned, technicians are of type StaffMember. I do this with a technicianID and technician ``@connection``. \r\n\r\nStaff can be assigned to multiple Jobs.\r\n\r\n```\r\n# Taken from my schema\r\ntype Round\r\n  @model {\r\n  id: ID!\r\n  date: AWSDateTime\r\n  technicianID: ID\r\n  technician: StaffMember @connection(fields: [\"technicianID\"])\r\n  status: String #RoundStatus\r\n}\r\n```\r\n\r\nWhen I delete a Job DataStore seems to be doing a cascade delete on the StaffMember and I don't want it too. This seems kind of dangerous. Following the docs I wouldn't have expected that to happen as its not a 1:M, it doesn't show you how to safely delete the Round but still leave the StaffMember undeleted in the database? \r\n\r\nAs a work around I've just found that you can seemingly get it to work if you first set the id of the technician on the Round to something else (I used an empty string) and then delete it that seems to work as I want it to.\r\n\r\n```\r\n// Fetch our existing round\r\nDataStore.query(Round, roundId).then((currentRound) => {\r\n      if (currentRound) {\r\n        // Save it to remove the technician\r\n        DataStore.save(\r\n          Round.copyOf(currentRound, (updated) => {\r\n            updated.technicianID = \"\";\r\n          })\r\n        ).then((toDelete) => {\r\n          // Now we can safely delete this Round but leave the StaffMember intact\r\n          DataStore.delete(toDelete);\r\n        });\r\n      }\r\n    });\r\n```\r\n\r\nTrouble is I can really see that biting someone if not careful. At a minimum it would be great to have this set up added to the docs here https://docs.amplify.aws/lib/datastore/relational/q/platform/js#deleting-relations\r\n\r\n\r\n\r\n\r\n","upvoteCount":4,"comments":{"edges":[{"node":{"author":{"login":"yucomds"},"body":"Hi @PeteDuncanson, have you find another solution for this? Do you think we should open a gh issue for officially describe this feature request?"}}]}}},{"node":{"id":"D_kwDOBkswNc4AOaKH","author":{"login":"LeJ84"},"title":"Automatically skip verifyContact","body":"Hi !\r\n\r\nIs there a way to automatically skip this step of the flow and how ?\r\n\r\nThx","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AOYVC","author":{"login":"mossa-Sammer"},"title":"Save the redirect query param after login with google","body":"when i give a user an invite link route to a resource in my website like ```/dashboard/join/1```, the user is not logged in so i redirect him to the route ```/login?redirect=/dashboard/join/1```, but after the user uses login with google, he get's redirect to login with google and after he finish back to the website but without the query param ```?redirect=/dashboard/join/1```, \r\ni searched the docs but didn't find something helpfull, the problem is  i need my query paramter to be saved when i redirected back to my website, help please  ","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AOXML","author":{"login":"peter-greekbase"},"title":"How to dynamically allow either phone or e-mail verification option to be send to user at signUp, based on user preferences?","body":"Hello!\r\n\r\nI would like to leverage amplify Auth, and I was wondering where I should look to implement the custom logic for the scenario that is described in the title: \"How to dynamically allow either phone or e-mail verification option to be send to user at signUp, based on user preferences?\"\r\n\r\nIf a user checks a box stating they prefer to receive an SMS to verify their sign in, I'd like to provide that, or if it's via e-mail, I'd like to provide that too. Is there a certain trigger I should customize based on some clientMetadata, or is this a matter of supplying a proper attribute to an existing method?\r\n\r\nThanks in advance ;)","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AN60H","author":{"login":"futurebenmorris"},"title":"How do I return object tags with Storage.list or Storage.get method?","body":"Hi there, I'm using the Amplify javascript package in a project and I have a need to return object tags along with the object itself. However, I can't see the option in the Storage.list or Storage.get config object to do this.\r\n\r\nI can download the object and parse it's contents fine, but I really need to grab the tags as well so I can use their values in my UI...\r\n\r\nCurrent code which works for getting an object is as follows:\r\n\r\n```javascript\r\nasync function getObject(filename) {\r\n  try {\r\n    const file = await Storage.get(filename, {\r\n      download: true,\r\n      cacheControl: 'no-cache',\r\n      contentType: 'application/json'\r\n    })\r\n    const text = await file.Body.text()\r\n    const parsedText = JSON.parse(text)\r\n    // Do things with parsed text here...\r\n  } catch (error) {\r\n    logger(error)\r\n  }\r\n}\r\n```\r\n\r\nI've been through the documentation and also through the issues and found #3547 which seems to suggest that tagging support is only available on the Storage.put method. This seems to be a severe limitation of using the Amplify library with S3. Is it even possible?\r\n\r\nI would rather avoid having to reach down for the AWS SDK as I like the abstraction that Amplify offers. Hope someone out there can help!","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"ashika01"},"body":"hi @futurebenmorris , looks like we send the response from S3 back as is. Reference to our code - https://github.com/aws-amplify/amplify-js/blob/main/packages/storage/src/providers/AWSS3Provider.ts#L431\r\n\r\nThis is the s3 doc on what they send as response -  https://docs.aws.amazon.com/AmazonS3/latest/API/API_GetObject.html#API_GetObject_ResponseSyntax\r\n\r\nwhat do u see as output? \r\n"}}]}}},{"node":{"id":"D_kwDOBkswNc4AOWL_","author":{"login":"funes79"},"title":"How to set owner field in case of group auth","body":"I have created a schema with the following auth rules:\r\n```\r\ntype Todo\r\n  @model\r\n  @auth(\r\n    rules: [\r\n      {\r\n        allow: groups\r\n        groups: [\"admins\"]\r\n        operations: [create, update, read, delete]\r\n      }\r\n      { allow: groups, groups: [\"users\"], operations: [read] }\r\n    ]\r\n  ) {\r\n  name: String! @primaryKey\r\n  author: String\r\n}\r\n```\r\nI tried to set the `ownerField` in auth to `author` but it does not fill the logged user name during the creation. Is it possible to store the creation/update user automatically or do I have to implement it in client side? \r\nAnd because of this when I got a subscription I do not know what user created the Todo item.\r\n\r\n\r\n### Update: \r\nwhen I use a simple owner authorization rule like this, then the `owner` field is created.\r\n\r\n```\r\n  @auth(\r\n    rules: [\r\n      { allow: owner }\r\n      { allow: groups, groups: [\"users\"], operations: [read] }\r\n    ]\r\n  ) \r\n```\r\n\r\nAccording to the legacy documentation I can combine owner and group auth\r\n\r\n> To enable advanced authorization use cases, you can layer auth rules to provide specialized functionality\r\nhttps://docs.amplify.aws/cli-legacy/graphql-transformer/auth/#ownership-with-create-mutations\r\n\r\nBut when I use a mix of owner and group authentication:\r\n\r\n```\r\n  @auth(\r\n    rules: [\r\n      { allow: owner }\r\n      {\r\n        allow: groups\r\n        groups: [\"admins\"]\r\n        operations: [create, update, read, delete]\r\n      }\r\n      { allow: groups, groups: [\"users\"], operations: [read] }\r\n    ]\r\n  ) \r\n```\r\n\r\nthe **owner field is not created any more**\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AOV2q","author":{"login":"kathara-jane"},"title":"Change reset password code expiration time from 1 hour to 24 hours","body":"I'm not finding any answers anywhere in the docs and I'm wondering if its functionality we can implement. ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AOVxt","author":{"login":"ayhoung"},"title":"Find items descending with multiple index keys","body":"Hi there,\r\n\r\nI'd like to sort by createdAt descending for the following schema definition:\r\n\r\n```\r\ntype Place @model \r\n{\r\n  id: ID!\r\n  city: String\r\n  approved: String\r\n  createdAt: String!\r\n}\r\n```\r\n\r\nFor instance I'd like to find all places that\r\ncity: 'Paris'\r\napproved: 'true'\r\n\r\nwhile sorting by createdAt descending.\r\n\r\nIs there any way to achieve this in the schema? It seems if I define a multiple key index \r\n`(i.e. @key(name: \"byApprovedCity\", fields: [\"active\", \"city\", \"createdAt\"])` \r\nit will force me to create a composite sort key, which is what I don't want, because I won't be able to sort on just the createdAt field.\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AOUwS","author":{"login":"jashsayani"},"title":"Get AWS credentials from Cognito Identity Pool?","body":"I have login implemented which uses Cognito User Pool. However, I need to use the JWT to get AWS credentials from Identity Pool next, in order to make calls to services like DynamoDB. I don't see Cognito APIs documented for this. Is this supported by the JS SDK? or do I need to proxy this through API Gateway?\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AOTt1","author":{"login":"jleskovar-tyro"},"title":"Grant lambda access to AppSync GraphQL endpoints using IAM auth","body":"Hi there,\r\n\r\nI'm trying to setup IAM authentication with my AppSync API defined using Amplify, with the aim of being able to send requests to the GraphQL endpoint from my lambda. I've checked all of the usual things - i.e. enabled IAM as an \"other\" authentication method (default is Cognito for access from front-end), and my models are correctly annotated I'm pretty sure, for e.g.:\r\n```\r\ntype Script @model @auth(rules: [\r\n  { allow: owner },\r\n  { allow: private, provider: iam }, \r\n]) {\r\n  id: ID!\r\n...\r\n}\r\n```\r\n\r\nWhen I attempt to call the AppSync API from my node lambda, I keep getting the following error returned in the GraphQL response body: `Not Authorized to access listScripts on type ModelScriptConnection`\r\n\r\nI've made sure my lambda execution role has correct permissions - in a desperate attempt I've granted appsync:* on * resources to rule out IAM policy related issues.\r\n\r\nI _think_ what I'm meant to do is modify the generated \"Auth\" function resolvers to accept my lambda's role, as I can see in the VTL there are various checks around groups and admin for IAM authentication. However, I'm not sure where to begin as to the \"correct\" way to do this.\r\n\r\nAny pointers would be greatly appreciated!\r\n\r\n\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"jleskovar-tyro"},"body":"FIgured it out - for future travellers, you need to add your external lambda role name to custom-roles.json, as per https://docs.amplify.aws/cli/graphql/authorization-rules/"}}]}}},{"node":{"id":"D_kwDOBkswNc4AOUo2","author":{"login":"fireflysemantics"},"title":"Setting up a Google OAuth Production Client?","body":"Hello,\r\n\r\nI'm trying to setup a Google OAuth Web Client.  I've followed the instructions provided by AWS and Google and gone through the process multiple times, however the Google Trust and Safety Team keeps requesting that I remove the client and once I remove it they request that I add it back.\r\n\r\nI've documented this here:\r\n\r\nhttps://stackoverflow.com/questions/70385799/setting-up-a-google-oauth-production-client\r\n\r\nDoes anyone know how to make it through this step?  ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AOUS6","author":{"login":"franklin113"},"title":"Mocking Admin Queries API Failing","body":"Hi, I'm trying to locally mock my admin queries api but am getting an error.  I copied the event from an actual lambda invocation which works in the lambda console, but I'm not sure how to configure the context that is passed in.\r\n```\r\n/root/projects/aspera-file-transfer/amplify/backend/function/AdminQueries142823f9/src/node_modules/@vendia/serverless-express/src/index.js:229\r\n\r\nif (params.resolutionMode === 'CONTEXT_SUCCEED') return params.context.succeed(params2.response)\r\n                                                                             ^\r\nTypeError: params.context.succeed is not a function\r\n```\r\n\r\nHas anyone seen this?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AOR-f","author":{"login":"xrn"},"title":"Cognito - switch application without new authorization","body":"Hi, \r\n\r\nI created my entire product based on multitenancy which is based on different Cognito apps. Organization 1 is creating Org1 which is creating new Cognito app org1.mydomain.com\r\n\r\nI would like to allow my users to switch between organizations without the requirement of providing a username/password again. Following Oauth2 flow and Cognito Hosted UI as well as `XSRF-TOKEN` and `cognito` cookies I am able to call `/oauth2/token` multiple times with different client_id and I will receive different authorization tokens. \r\n\r\nMy questions:\r\n1. Am I able to switch between client_id without providing each time password in Amplify-js?\r\n2. If not - Am I able to build my own UI using Cognito based endpoints like https://docs.aws.amazon.com/cognito/latest/developerguide/token-endpoint.html - from what I see I can not call as of now that endpoints because I have CORS / Set-Cookies security blockers\r\n\r\nI think this is also related to this discussion - https://github.com/aws-amplify/amplify-js/issues/1585","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AOR1u","author":{"login":"nadavdo"},"title":"react native biometric login","body":"Hi , is there any way to use the aws amplify and integrated it with device fingerprinr or face recognition .\r\nRegards Nadav","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AOPtR","author":{"login":"AchrafBn"},"title":"Check if a username exists in Cognito User pool","body":"i want to my flow authentication meet these scenarios :  check username exist if exist then navigate  to screen signIn otherwise  signUp.\r\nI cannot find documentation on how to check a username using AWS Cognito. I should be able to pass username/passcode in a call and get a response back that says User Exists/User does not exist ?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AOPoL","author":{"login":"neerajap-01"},"title":"\"Subscription timeout {\\\"query\\\":\\\"subscription OnOrderUpdated($Id: ID!)","body":"I was trying to use subscription in graphql below is the code ,\r\n\r\n```\r\nimport { onOrderUpdated } from \"./subscriptions\";\r\n\r\n// subscribe to order updates\r\n  useEffect(() => {\r\n    const subscription = API.graphql(\r\n      graphqlOperation(onOrderUpdated, { id: route.params.id })\r\n    ).subscribe({\r\n      next: ({ provider, value }) => console.log({ provider, value }),\r\n      error: ({ error }) => console.warn(error)\r\n    })\r\n\r\n    return () => subscription.unsubscribe();\r\n  }, [])\r\n```\r\n\r\n**onOrderUpdated.js**\r\n```\r\nexport const onOrderUpdated = /* GraphQL */ `\r\n    subscription OnOrderUpdated($Id: ID!) {\r\n        onOrderUpdated(Id: $Id) {\r\n            id\r\n            createdAt\r\n            type\r\n            status\r\n            originLatitude\r\n            originLongitude\r\n            destLatitude\r\n            destLongitude\r\n            userId\r\n            carId\r\n            updatedAt\r\n        }\r\n    }\r\n`;\r\n```\r\n\r\n**Aws-exports,js**\r\n```\r\n/* eslint-disable */\r\n// WARNING: DO NOT EDIT. This file is automatically generated by AWS Amplify. It will be overwritten.\r\n\r\nconst awsmobile = {\r\n    \"aws_project_region\": \"xxxxx\",\r\n    \"aws_cognito_identity_pool_id\": \"xxxxx-xxxxx-xxxxx-xxxx-xxx\",\r\n    \"aws_cognito_region\": \"xxxxx\",\r\n    \"aws_user_pools_id\": \"xxxxx-xxxxx-xxxxx-xxxx-xxx\",\r\n    \"aws_user_pools_web_client_id\": \"xxxxx\",\r\n    \"oauth\": {},\r\n    \"aws_cognito_username_attributes\": [],\r\n    \"aws_cognito_social_providers\": [],\r\n    \"aws_cognito_signup_attributes\": [\r\n        \"EMAIL\"\r\n    ],\r\n    \"aws_cognito_mfa_configuration\": \"OFF\",\r\n    \"aws_cognito_mfa_types\": [\r\n        \"SMS\"\r\n    ],\r\n    \"aws_cognito_password_protection_settings\": {\r\n        \"passwordPolicyMinLength\": 8,\r\n        \"passwordPolicyCharacters\": []\r\n    },\r\n    \"aws_cognito_verification_mechanisms\": [\r\n        \"EMAIL\"\r\n    ],\r\n    \"aws_appsync_graphqlEndpoint\": \"https://uhjxgztxgjejxic2mgc7hyjmza.appsync-api.ap-south-1.amazonaws.com/graphql\",\r\n    \"aws_appsync_region\": \"ap-south-1\",\r\n    \"aws_appsync_authenticationType\": \"AMAZON_COGNITO_USER_POOLS\"\r\n};\r\n\r\n\r\nexport default awsmobile;\r\n\r\n```\r\n It gives me this error,\r\n@amhinson i saw your answer on another same kind of issue but didn't understand much.\r\n![WhatsApp Image 2021-12-10 at 2 38 42 PM](https://user-images.githubusercontent.com/88912160/145547934-1c294021-d4d9-4688-acd9-3ef2e71806b2.jpeg)\r\n\r\n![Screenshot_2021-12-10-14-49-41-89_d0f5c12174170e37eb4af5e473653c8b](https://user-images.githubusercontent.com/88912160/145549649-681b1bdd-3177-421d-ac0e-fa3bb399b805.jpg)\r\n\r\n![Screenshot_2021-12-10-14-49-36-05_d0f5c12174170e37eb4af5e473653c8b](https://user-images.githubusercontent.com/88912160/145549656-1dc33179-b9b1-4390-9703-b5ea331d48b1.jpg)\r\n\r\n![Screenshot_2021-12-10-14-49-48-57_d0f5c12174170e37eb4af5e473653c8b](https://user-images.githubusercontent.com/88912160/145549666-430284c4-ef20-4b75-9081-1e3a1477e137.jpg)\r\n \r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AOO1o","author":{"login":"estebane-frb"},"title":"Invalid access_token obtained via Cognito pool authorizer configured in Amplify Auth","body":"Hello, I am using API Gateway with a Cognito User Pool Authorizer in the back end, and I am trying to use an Access Token provided by the pool, so that I can validate Cognito group and scope access. However, when using the Amplify framework, the Access token being retrieved is not valid. Here is my code below.\r\n\r\nIt is worth noting that when I manually retrieve an access token (Using method in this link https://aws.amazon.com/premiumsupport/knowledge-center/cognito-custom-scopes-api-gateway/ ), my authentication works fine. This issue is only happening when I'm using Amplify. My process.env.REACT_APP_API_ENDPOINTS_ENDPOINT is my API Gateway endpoint. Am I supposed to use a second endpoint to retrieve the access token?\r\n\r\n\r\n\r\n```\r\nAmplify.configure({\r\n  Auth: {\r\n    // REQUIRED - Amazon Cognito Region\r\n    region: process.env.REACT_APP_REGION,\r\n\r\n    // OPTIONAL - Amazon Cognito User Pool ID\r\n    userPoolId: process.env.REACT_APP_AUTH_USER_POOL_ID,\r\n\r\n    // OPTIONAL - Amazon Cognito Web Client ID (26-char alphanumeric string)\r\n    userPoolWebClientId: process.env.REACT_APP_AUTH_USER_POOL_WEB_CLIENT_ID,\r\n  },\r\n  API: {\r\n    endpoints: [\r\n      {\r\n        name: process.env.REACT_APP_API_ENDPOINTS_NAME,\r\n        region: process.env.REACT_APP_REGION,\r\n        endpoint: process.env.REACT_APP_API_ENDPOINTS_ENDPOINT,\r\n        custom_header: async () => {\r\n          return {\r\n            Authorization: `Bearer ${(await Auth.currentSession())\r\n              .getAccessToken()\r\n              .getJwtToken()\r\n            }`,\r\n          };\r\n        },\r\n      },\r\n    ],\r\n  },\r\n});\r\n```","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AOMi2","author":{"login":"gmineropfdrive"},"title":"JS Client Dynamo Table Model - Lambda Model Reference","body":"I have a lambda function which inserts data in my dynamoDb  for a given environment <MyModel >-<SOME_ID>-<EnvName>\r\nIn the same environment, my client is referencing the Model and, I would assume that the same format is used when referencing the table in DynamoDb for inserting data <MyModel >-<SOME_ID>-<EnvName> eventhough I only reference the Model itself in my client code:\r\n\r\n`import { MyModel } from '../../../models';`\r\n\r\nHowever, when I  perform an insert to my dynamoDb model from the client:\r\n\r\n`DataStore.save( new MyModel (form))`\r\n\r\nThe record never appears under the environment table in dynamoDb\r\n\r\nsame thing when I attempt to query data, no dynamodb records are returned which were inserted using my lambda function. Coudl someone shed any light as to why this happens?\r\n","upvoteCount":0,"comments":{"edges":[{"node":{"author":{"login":"gmineropfdrive"},"body":"Figured it out - When trying to sync the data between local -> datastore (vice versa) there were field errors thrown. Once the field errors were resolved, everything worked accordingly."}}]}}},{"node":{"id":"D_kwDOBkswNc4AONuy","author":{"login":"franklt69"},"title":"How to manipulate the flow of resetting the password by code ?","body":"Hi,\r\nIn the reset password process, I want to intercept the send code event to do an operation. After the reset password flow continues, I have been experimenting with the Hub, but I can't find what message I should send using the Hub to the app; go to the UI asking for the Verification Code and New Password. Could you help me with this, please?\r\n\r\n`\r\n  <amplify-forgot-password slot=\"forgot-password\" submitButtonText=\"Submit\"  [handleSend]=\"onSendCode\"\r\n                                         usernameAlias=\"email\" ></amplify-forgot-password>\r\n\r\n\r\n    onSendCode = async event => {\r\n        event.preventDefault();\r\n        await Auth.forgotPassword(this.userEmail);\r\n        Hub.dispatch(UI_AUTH_CHANNEL, {\r\n            event: AUTH_STATE_CHANGE_EVENT,\r\n            message: AuthState.ResetPassword\r\n        });\r\n\r\n`\r\n\r\nNote: I am using\r\n`    \"aws-amplify\": \"^3.3.24\",\r\n    \"aws-amplify-angular\": \"^5.0.53\",`\r\n\r\nThanks,\r\nFrank\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AOKUJ","author":{"login":"WathikAhmed"},"title":"Is `userSub` a permanent unique user ID for the users","body":"Question:\r\nIs `userSub` like a permanent unique user ID for the users? Because on the Amplify Admin UI it says `Unique identifier (username)` which means it is regarding the username as the ID for the user? I'm looking for something a little more distinguishable because the users may want to change their username in the future and so a separate ID would be a lot more reliable.\r\n\r\nWhen I try to search using this `userSub` on the Amplify UI of user management, it doesn't come up with any results because it relies on the username/email as the unique identifier which is not an ideal one, to begin with.\r\n\r\nThanks.","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AOJYb","author":{"login":"matthewapps"},"title":"Datastore  & Flutter GraphQL auth rules","body":"I am trying to set up auth rules for a Flutter app using Datastore but am not getting far. I have a Graphql  model for which I want public to have read access and the owner to read, create, update and delete. I expected the following rule to work:\r\n\r\n@auth(rules: [{allow: public, operations: [read]}, {allow: public, operations: [read], provider: iam}, {allow: owner}]) \r\nIn this situation updates to the table don't get synced up to the backend. I am using the standard command to save the data\r\n \"await Amplify.DataStore.save(item)\".\r\n\r\nThe following rules work:\r\n@auth(rules: [{allow: public  } ]) \r\n@auth(rules: [{allow: public  }, {allow: public, provider: iam} ]) \r\n \r\nThe following rules seem to have an effect in that the records are no longer synced down from the backend. I assume this is because the read operation is omitted from the list of owner operations:\r\n\r\n@auth(rules: [{allow: public, operations: [read]}, {allow: public, operations: [read], provider: iam}, {allow: owner, operations: [create, update, delete] }]).\r\n\r\nAny ideas why this doesn't work as I think it should??\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AOFrL","author":{"login":"duranmla"},"title":"Unable to have Content management working on Amplify console after migration to CLI 7+","body":"Hi!\r\n\r\nI am using `amplify-cli` (@aws-amplify/cli) version `7.3.6`, and I have migrated as suggested https://docs.amplify.aws/cli/migration/override/ my resources, while everything within the app seems to be working fine that problem I have still a blocker for my use case. The \"Content\" section on my Amplify console is not available as it suggests:\r\n\r\n> An additional deployment is needed to enable content management capabilities for your API. Navigate to \"Data\" and hit \"Save and deploy.\r\n\r\nWhen I try to do so, I go to the \"Data modeling\" and hit \"Save and deploy\" which then throws error like:\r\n\r\n```\r\nCannot read property 'push' of undefined, at AmplifyAuthCognitoStack.generateCognitoStackResources . \r\n```\r\n\r\nThe error on the stack trace suggests to update my schema but I have run the codegen command like:\r\n\r\n`amplify codegen models`, `amplify codegen`, `yarn amplify-modelgen` and none of them generate a diff that make a change on the cloud formation. \r\n\r\nI am a bit lost in terms of how to debug this error. Appreciate any type of help or guidance. Thanks in advance folks!\r\n\r\nStack Trace:\r\n```\r\nCommand failed with exit code 1: /root/.amplify/bin/amplify pull --amplify {\"envName\":\"migration\",\"defaultEditor\":\"code\",\"appId\":\"my-app-id\"} --providers {\"awscloudformation\":{\"configLevel\":\"project\",\"useProfile\":true,\"profileName\":\"amplify-backend-processor\"}} --frontend {\"frontend\":\"javascript\",\"framework\":\"react\",\"config\":{\"SourceDir\":\"src\",\"DistributionDir\":\"build\",\"BuildCommand\":\"npm run-script build\",\"StartCommand\":\"npm run-script start\"}} --yes\r\n- Fetching updates to backend environment: migration from the cloud.\r\n- Building resource auth/userPoolGroups\r\n- Building resource auth/solauth\r\n- Building resource storage/media\r\n2021-11-18T14:56:14.564Z - error: uncaughtException: Cannot read property 'push' of undefined date=Thu Nov 18 2021 14:56:14 GMT+0000 (Coordinated Universal Time), pid=489, uid=0, gid=0, cwd=/tmp/amplify-5eacc2e2-f578-4761-a266-7df59586b376, execPath=/root/.amplify/bin/amplify, version=v12.22.7, argv=[/root/.amplify/bin/amplify, /snapshot/node_modules/@aws-amplify/cli/bin/amplify, pull, --amplify, {\"envName\":\"migration\",\"defaultEditor\":\"code\",\"appId\":\"my-app-id\"}, --providers, {\"awscloudformation\":{\"configLevel\":\"project\",\"useProfile\":true,\"profileName\":\"amplify-backend-processor\"}}, --frontend, {\"frontend\":\"javascript\",\"framework\":\"react\",\"config\":{\"SourceDir\":\"src\",\"DistributionDir\":\"build\",\"BuildCommand\":\"npm run-script build\",\"StartCommand\":\"npm run-script start\"}}, --yes], rss=412897280, heapTotal=333860864, heapUsed=305550904, external=20525906, arrayBuffers=18958544, loadavg=[0.4, 0.32, 0.12], uptime=418, trace=[column=51, file=/snapshot/node_modules/@aws-amplify/amplify-category-auth/lib/provider-utils/awscloudformation/auth-stack-builder/auth-cognito-stack-builder.js, function=AmplifyAuthCognitoStack.generateCognitoStackResources, line=238, method=generateCognitoStackResources, native=false, column=31, file=/snapshot/node_modules/@aws-amplify/amplify-category-auth/lib/provider-utils/awscloudformation/auth-stack-builder/auth-stack-transform.js, function=AmplifyAuthTransform.generateStackResources, line=341, method=generateStackResources, native=false, column=20, file=/snapshot/node_modules/@aws-amplify/amplify-category-auth/lib/provider-utils/awscloudformation/auth-stack-builder/auth-stack-transform.js, function=AmplifyAuthTransform.transform, line=332, method=transform, native=false, column=12, file=/snapshot/node_modules/@aws-amplify/amplify-category-auth/lib/provider-utils/awscloudformation/utils/generate-auth-stack-template.js, function=generateAuthStackTemplate, line=7, method=null, native=false], stack=[TypeError: Cannot read property 'push' of undefined,     at AmplifyAuthCognitoStack.generateCognitoStackResources (/snapshot/node_modules/@aws-amplify/amplify-category-auth/lib/provider-utils/awscloudformation/auth-stack-builder/auth-cognito-stack-builder.js:238:51),     at AmplifyAuthTransform.generateStackResources (/snapshot/node_modules/@aws-amplify/amplify-category-auth/lib/provider-utils/awscloudformation/auth-stack-builder/auth-stack-transform.js:341:31),     at AmplifyAuthTransform.transform (/snapshot/node_modules/@aws-amplify/amplify-category-auth/lib/provider-utils/awscloudformation/auth-stack-builder/auth-stack-transform.js:332:20),     at generateAuthStackTemplate (/snapshot/node_modules/@aws-amplify/amplify-category-auth/lib/provider-utils/awscloudformation/utils/generate-auth-stack-template.js:7:12)]\r\n⚠️ Amplify command hooks are disabled in the current execution environment.\r\n⚠️ See https://docs.amplify.aws/cli/usage/command-hooks/ for more information.\r\n\u001b[0mAmplify AppID found: my-app-id. Amplify App name is: sol\u001b[0m\r\n\u001b[0mBackend environment migration found in Amplify Console app: sol\u001b[0m\r\n\u001b[32mGraphQL schema compiled successfully.\u001b[39m\r\n\r\n\u001b[32mEdit your schema at /tmp/amplify-5eacc2e2-f578-4761-a266-7df59586b376/amplify/backend/api/sol/schema.graphql or place .graphql files in a directory at /tmp/amplify-5eacc2e2-f578-4761-a266-7df59586b376/amplify/backend/api/sol/schema\u001b[39m\r\n\u001b[0mSuccessfully generated models. Generated models can be found in /tmp/amplify-5eacc2e2-f578-4761-a266-7df59586b376/src\u001b[0m\r\n```","upvoteCount":8,"comments":{"edges":[{"node":{"author":{"login":"sachscode"},"body":"@duranmla \r\n1. Could you please share the contents of your amplify folder. (this will help us debug the issue quicker ).  We are mainly looking for the contents of the `amplify/backend/auth/cli-inputs.json` file.\r\n\r\n2. Can you please upgrade  CLI version 7.4.1  ( this is the latest version of CLI ) "}},{"node":{"author":{"login":"duranmla"},"body":"I was going over this again, using CLI 7.5.1 and I now stumble upon something interesting:\r\n_I have the same issue, like everything on my infrastructure seems to be created successfully but I don't have the models created_\r\n\r\n![CleanShot 2021-11-24 at 13 35 58@2x](https://user-images.githubusercontent.com/1425162/143239893-4a2e8d54-e129-48c5-b083-94d6689e3e3f.png)\r\n\r\nIt seems that after the migration there is something bad with my schema.\r\nAfter the migration ran I also have this error on the terminal:\r\n\r\n```\r\nFailed to create models in the cloud: Modelgen job creation failed\r\n```\r\n\r\nPerhaps, this is the actual error and it is more actionable than before?"}}]}}},{"node":{"id":"D_kwDOBkswNc4AOG5v","author":{"login":"strugman"},"title":"GraphQL interface and `@connection`","body":"Hello\r\nI'm struggling with using an interface and `@connection` directive - maybe you could point me to some materials, where I could learn how to solve my problem? I know I could use lambda resolver for this, but I'm hoping there's another (better?) way...\r\n\r\nIn my `schema.graphql` I have an interface defined (I've minimised number of fields to present the idea):\r\n```\r\ninterface Company {\r\n\tid: ID!\r\n\tname: String\r\n}\r\n```\r\n\r\nand two types of companies:\r\n```\r\ntype Broker implements Company @model {\r\n\tid: ID!\r\n\tname: String\r\n}\r\n\r\ntype Customer implements Company @model {\r\n\tid: ID!\r\n\tname: String\r\n}\r\n```\r\n\r\n`Broker` and `Customer` are mapped into separate tables in DynamoDB and `amplify codegen` produces correct queries and mutations for them.\r\n\r\nThe problem appeared when I created a `Person` type - a person is assigned to a company of any of those 2 types, and the problem appears on the `company` field, which I defined as follows:\r\n```\r\ntype Person {\r\n\tid: ID!\r\n\tfname: String\r\n\tlname: String\r\n\tcompanyId: ID!\r\n\tcompany: Company @connection(fields: [\"companyId\"])\r\n}\r\n```\r\n\r\nWhen I execute `amplify api gql-compile` I get an error:\r\n`InvalidDirectiveError: Could not find an object type named Company`\r\n\r\nI probably am doing something wrong or missing something. Please advise.\r\n\r\nPiotr","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AOGDh","author":{"login":"DiegoMcDipster"},"title":"How to get/update/delete individual DynamoDB items using REST Api?","body":"I'm using NextJs and storing my data in DynamoDB, using the REST Api.\r\n\r\nAll of the Get started tutorials teach the GraphQl api.  Not the REST API.  So, I'm stuck doing simple things like fetching individual records or updating individual records because there are no 'real' examples in the documentation.  (I instead followed this tutorial: https://www.youtube.com/watch?v=A2LXm9TZJck)\r\n\r\nSo if i can list all records using this bit of code:\r\n```\r\n    API.get(apiName, `${path}/name`)\r\n      .then((fetchedPets) => {\r\n        setPets([...pets, ...fetchedPets]);\r\n      })\r\n```\r\n\r\nUsing this code as a basis, how would I:\r\n- get an individual pet\r\n- update an individual pet\r\n- delete an individual pet","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"DiegoMcDipster"},"body":"Please ignore this discussion. I figured it out. I was confused by the paths in the auto generated lambda function.  This discussion will therefore be closed."}}]}}},{"node":{"id":"D_kwDOBkswNc4AOC_3","author":{"login":"synapdk"},"title":"Administrative MFA TOTP reset","body":"### Before opening, please confirm:\n\n\n- [X] I have [searched for duplicate or closed issues](https://github.com/aws-amplify/amplify-js/issues?q=is%3Aissue+) and [discussions](https://github.com/aws-amplify/amplify-js/discussions).\n- [X] I have read the guide for [submitting bug reports](https://github.com/aws-amplify/amplify-js/blob/main/CONTRIBUTING.md#bug-reports).\n- [X] I have done my best to include a minimal, self-contained set of instructions for consistently reproducing the issue.\n\n### JavaScript Framework\n\nAngular\n\n### Amplify APIs\n\nAuthentication\n\n### Amplify Categories\n\nauth\n\n### Environment information\n\n<details>\r\n\r\n```\r\n# Put output below this line\r\n\r\n  System:\r\n    OS: macOS 11.6\r\n    CPU: (12) x64 Intel(R) Core(TM) i9-8950HK CPU @ 2.90GHz\r\n    Memory: 112.69 MB / 32.00 GB\r\n    Shell: 3.2.57 - /bin/bash\r\n  Binaries:\r\n    Node: 14.17.5 - ~/.nvm/versions/node/v14.17.5/bin/node\r\n    Yarn: 1.22.10 - /usr/local/bin/yarn\r\n    npm: 6.14.14 - ~/.nvm/versions/node/v14.17.5/bin/npm\r\n  Browsers:\r\n    Chrome: 94.0.4606.81\r\n    Firefox: 92.0.1\r\n    Safari: 15.0\r\n  npmPackages:\r\n    <%= name %>:  <%= version %>\r\n    @angular-devkit/build-angular: 0.1102.14 => 0.1102.14\r\n    @angular-eslint/builder: ^0.0.1-alpha.32 => 0.0.1-alpha.32\r\n    @angular-eslint/eslint-plugin: ~1.0.0 => 1.0.0\r\n    @angular-eslint/eslint-plugin-template: ~1.0.0 => 1.0.0\r\n    @angular-eslint/template-parser: ~1.0.0 => 1.0.0\r\n    @angular-material-components/datetime-picker: 5.1.1 => 5.1.1\r\n    @angular/animations: 11.2.14 => 11.2.14\r\n    @angular/animations/browser:  undefined ()\r\n    @angular/animations/browser/testing:  undefined ()\r\n    @angular/cdk: 11.2.13 => 11.2.13\r\n    @angular/cdk/a11y:  undefined ()\r\n    @angular/cdk/accordion:  undefined ()\r\n    @angular/cdk/bidi:  undefined ()\r\n    @angular/cdk/clipboard:  undefined ()\r\n    @angular/cdk/coercion:  undefined ()\r\n    @angular/cdk/collections:  undefined ()\r\n    @angular/cdk/drag-drop:  undefined ()\r\n    @angular/cdk/keycodes:  undefined ()\r\n    @angular/cdk/layout:  undefined ()\r\n    @angular/cdk/observers:  undefined ()\r\n    @angular/cdk/overlay:  undefined ()\r\n    @angular/cdk/platform:  undefined ()\r\n    @angular/cdk/portal:  undefined ()\r\n    @angular/cdk/scrolling:  undefined ()\r\n    @angular/cdk/stepper:  undefined ()\r\n    @angular/cdk/table:  undefined ()\r\n    @angular/cdk/testing:  undefined ()\r\n    @angular/cdk/testing/protractor:  undefined ()\r\n    @angular/cdk/testing/testbed:  undefined ()\r\n    @angular/cdk/text-field:  undefined ()\r\n    @angular/cdk/tree:  undefined ()\r\n    @angular/cli: 11.2.14 => 11.2.14\r\n    @angular/common: 11.2.14 => 11.2.14\r\n    @angular/common/http:  undefined ()\r\n    @angular/common/http/testing:  undefined ()\r\n    @angular/common/testing:  undefined ()\r\n    @angular/common/upgrade:  undefined ()\r\n    @angular/compiler: 11.2.14 => 11.2.14\r\n    @angular/compiler-cli: 11.2.14 => 11.2.14\r\n    @angular/compiler/testing:  undefined ()\r\n    @angular/core: 11.2.14 => 11.2.14\r\n    @angular/core/testing:  undefined ()\r\n    @angular/flex-layout: 11.0.0-beta.33 => 11.0.0-beta.33\r\n    @angular/flex-layout/core:  undefined ()\r\n    @angular/flex-layout/extended:  undefined ()\r\n    @angular/flex-layout/flex:  undefined ()\r\n    @angular/flex-layout/grid:  undefined ()\r\n    @angular/flex-layout/server:  undefined ()\r\n    @angular/forms: 11.2.14 => 11.2.14\r\n    @angular/language-service: 11.2.14 => 11.2.14\r\n    @angular/material: 11.2.13 => 11.2.13\r\n    @angular/material/autocomplete:  undefined ()\r\n    @angular/material/autocomplete/testing:  undefined ()\r\n    @angular/material/badge:  undefined ()\r\n    @angular/material/badge/testing:  undefined ()\r\n    @angular/material/bottom-sheet:  undefined ()\r\n    @angular/material/bottom-sheet/testing:  undefined ()\r\n    @angular/material/button:  undefined ()\r\n    @angular/material/button-toggle:  undefined ()\r\n    @angular/material/button-toggle/testing:  undefined ()\r\n    @angular/material/button/testing:  undefined ()\r\n    @angular/material/card:  undefined ()\r\n    @angular/material/card/testing:  undefined ()\r\n    @angular/material/checkbox:  undefined ()\r\n    @angular/material/checkbox/testing:  undefined ()\r\n    @angular/material/chips:  undefined ()\r\n    @angular/material/chips/testing:  undefined ()\r\n    @angular/material/core:  undefined ()\r\n    @angular/material/core/testing:  undefined ()\r\n    @angular/material/datepicker:  undefined ()\r\n    @angular/material/datepicker/testing:  undefined ()\r\n    @angular/material/dialog:  undefined ()\r\n    @angular/material/dialog/testing:  undefined ()\r\n    @angular/material/divider:  undefined ()\r\n    @angular/material/divider/testing:  undefined ()\r\n    @angular/material/expansion:  undefined ()\r\n    @angular/material/expansion/testing:  undefined ()\r\n    @angular/material/form-field:  undefined ()\r\n    @angular/material/form-field/testing:  undefined ()\r\n    @angular/material/form-field/testing/control:  undefined ()\r\n    @angular/material/grid-list:  undefined ()\r\n    @angular/material/grid-list/testing:  undefined ()\r\n    @angular/material/icon:  undefined ()\r\n    @angular/material/icon/testing:  undefined ()\r\n    @angular/material/input:  undefined ()\r\n    @angular/material/input/testing:  undefined ()\r\n    @angular/material/list:  undefined ()\r\n    @angular/material/list/testing:  undefined ()\r\n    @angular/material/menu:  undefined ()\r\n    @angular/material/menu/testing:  undefined ()\r\n    @angular/material/paginator:  undefined ()\r\n    @angular/material/paginator/testing:  undefined ()\r\n    @angular/material/progress-bar:  undefined ()\r\n    @angular/material/progress-bar/testing:  undefined ()\r\n    @angular/material/progress-spinner:  undefined ()\r\n    @angular/material/progress-spinner/testing:  undefined ()\r\n    @angular/material/radio:  undefined ()\r\n    @angular/material/radio/testing:  undefined ()\r\n    @angular/material/select:  undefined ()\r\n    @angular/material/select/testing:  undefined ()\r\n    @angular/material/sidenav:  undefined ()\r\n    @angular/material/sidenav/testing:  undefined ()\r\n    @angular/material/slide-toggle:  undefined ()\r\n    @angular/material/slide-toggle/testing:  undefined ()\r\n    @angular/material/slider:  undefined ()\r\n    @angular/material/slider/testing:  undefined ()\r\n    @angular/material/snack-bar:  undefined ()\r\n    @angular/material/snack-bar/testing:  undefined ()\r\n    @angular/material/sort:  undefined ()\r\n    @angular/material/sort/testing:  undefined ()\r\n    @angular/material/stepper:  undefined ()\r\n    @angular/material/stepper/testing:  undefined ()\r\n    @angular/material/table:  undefined ()\r\n    @angular/material/table/testing:  undefined ()\r\n    @angular/material/tabs:  undefined ()\r\n    @angular/material/tabs/testing:  undefined ()\r\n    @angular/material/toolbar:  undefined ()\r\n    @angular/material/toolbar/testing:  undefined ()\r\n    @angular/material/tooltip:  undefined ()\r\n    @angular/material/tooltip/testing:  undefined ()\r\n    @angular/material/tree:  undefined ()\r\n    @angular/material/tree/testing:  undefined ()\r\n    @angular/platform-browser: 11.2.14 => 11.2.14\r\n    @angular/platform-browser-dynamic: 11.2.14 => 11.2.14\r\n    @angular/platform-browser-dynamic/testing:  undefined ()\r\n    @angular/platform-browser/animations:  undefined ()\r\n    @angular/platform-browser/testing:  undefined ()\r\n    @angular/router: 11.2.14 => 11.2.14\r\n    @angular/router/testing:  undefined ()\r\n    @angular/router/upgrade:  undefined ()\r\n    @apollo/client: ^3.0.0 => 3.2.2\r\n    @apollo/client/cache:  undefined ()\r\n    @apollo/client/core:  undefined ()\r\n    @apollo/client/errors:  undefined ()\r\n    @apollo/client/link/batch:  undefined ()\r\n    @apollo/client/link/batch-http:  undefined ()\r\n    @apollo/client/link/context:  undefined ()\r\n    @apollo/client/link/core:  undefined ()\r\n    @apollo/client/link/error:  undefined ()\r\n    @apollo/client/link/http:  undefined ()\r\n    @apollo/client/link/persisted-queries:  undefined ()\r\n    @apollo/client/link/retry:  undefined ()\r\n    @apollo/client/link/schema:  undefined ()\r\n    @apollo/client/link/utils:  undefined ()\r\n    @apollo/client/link/ws:  undefined ()\r\n    @apollo/client/react:  undefined ()\r\n    @apollo/client/react/components:  undefined ()\r\n    @apollo/client/react/context:  undefined ()\r\n    @apollo/client/react/data:  undefined ()\r\n    @apollo/client/react/hoc:  undefined ()\r\n    @apollo/client/react/hooks:  undefined ()\r\n    @apollo/client/react/parser:  undefined ()\r\n    @apollo/client/react/ssr:  undefined ()\r\n    @apollo/client/testing:  undefined ()\r\n    @apollo/client/utilities:  undefined ()\r\n    @aws-amplify/ui-angular: ^1.0.3 => 1.0.3\r\n    @casl/ability: ^5.2.2 => 5.2.2\r\n    @casl/ability/extra:  undefined ()\r\n    @casl/angular: ^5.1.0 => 5.1.0\r\n    @datorama/akita: ^4.23.2 => 4.23.2\r\n    @graphql-codegen/cli: ^1.13.3 => 1.14.0\r\n    @graphql-codegen/introspection: ^1.18.0 => 1.18.0\r\n    @graphql-codegen/typescript-apollo-angular: ^1.13.3 => 1.14.0\r\n    @graphql-codegen/typescript-document-nodes: ^1.13.3 => 1.14.0\r\n    @graphql-codegen/typescript-operations: ^1.13.3 => 1.14.0\r\n    @nestjs/common: 7.6.18 => 7.6.18 (7.4.2)\r\n    @nestjs/core: 7.6.18 => 7.6.18\r\n    @nestjs/graphql: ^7.6.0 => 7.7.0\r\n    @nestjs/platform-express: 7.6.18 => 7.6.18\r\n    @nestjs/schematics: 7.3.1 => 7.3.1\r\n    @nestjs/testing: 7.6.18 => 7.6.18\r\n    @nestjs/typeorm: ^7.1.0 => 7.1.0\r\n    @ngx-formly/core: ^5.9.3 => 5.9.3\r\n    @ngx-formly/core/json-schema:  undefined ()\r\n    @ngx-formly/core/select:  undefined ()\r\n    @nrwl/angular: 11.6.3 => 11.6.3\r\n    @nrwl/angular/testing:  undefined ()\r\n    @nrwl/cli: 11.6.3 => 11.6.3\r\n    @nrwl/cypress: 11.6.3 => 11.6.3\r\n    @nrwl/eslint-plugin-nx: 11.6.3 => 11.6.3\r\n    @nrwl/jest: 11.6.3 => 11.6.3\r\n    @nrwl/linter: 11.6.3 => 11.6.3\r\n    @nrwl/nest: 11.6.3 => 11.6.3\r\n    @nrwl/node: 11.6.3 => 11.6.3\r\n    @nrwl/nx-cloud: ^12.2.7 => 12.2.7\r\n    @nrwl/tao: 11.6.3 => 11.6.3\r\n    @nrwl/workspace: 11.6.3 => 11.6.3\r\n    @synap/nest-aws-kms: ^0.0.2 => 0.0.2\r\n    @synap/ngx-subscription-helpers: ^0.0.1 => 0.0.1\r\n    @types/config: ^0.0.36 => 0.0.36\r\n    @types/jest: 26.0.8 => 26.0.8 (26.0.23)\r\n    @types/lodash-es: ^4.17.3 => 4.17.3\r\n    @types/node: 14.14.33 => 14.14.33 (14.0.5, 10.17.24, 14.6.4)\r\n    @typescript-eslint/eslint-plugin: 4.3.0 => 4.3.0\r\n    @typescript-eslint/parser: 4.3.0 => 4.3.0\r\n    apollo-angular: ^2.0.4 => 2.0.4\r\n    apollo-angular/headers:  undefined ()\r\n    apollo-angular/http:  undefined ()\r\n    apollo-angular/testing:  undefined ()\r\n    apollo-link-scalars: ^2.0.1 => 2.0.1\r\n    apollo-server-express: ^2.12.0 => 2.13.1\r\n    aws-amplify: ^3.3.22 => 3.3.22\r\n    aws-sdk: ^2.730.0 => 2.730.0 (2.738.0)\r\n    casual: ^1.6.2 => 1.6.2\r\n    chart.js: ^2.9.4 => 2.9.4\r\n    chartjs-node-canvas: ^3.0.6 => 3.0.6\r\n    class-transformer: ^0.3.1 => 0.3.1\r\n    class-validator: ^0.12.2 => 0.12.2\r\n    config: ^3.3.1 => 3.3.1\r\n    core-js: ^2.5.4 => 2.6.11 (3.8.3, 3.6.5)\r\n    cypress: ^4.1.0 => 4.6.0\r\n    deep-object-diff: ^1.1.0 => 1.1.0\r\n    dotenv: 8.2.0 => 8.2.0 (4.0.0, 6.2.0)\r\n    eslint: 7.10.0 => 7.10.0\r\n    eslint-config-prettier: 8.1.0 => 8.1.0\r\n    eslint-plugin-cypress: ^2.10.3 => 2.11.3\r\n    eslint-plugin-no-null: ^1.0.2 => 1.0.2\r\n    eslint-plugin-prettier: ^3.1.4 => 3.1.4\r\n    exceljs: ^4.1.1 => 4.1.1\r\n    graphql: ^15.0.0 => 15.3.0 (14.0.0, 14.6.0)\r\n    graphql-tools: ^5.0.0 => 5.0.0 (4.0.8)\r\n    jest: 26.2.2 => 26.2.2\r\n    jest-preset-angular: 8.3.2 => 8.3.2\r\n    jsonwebtoken: ^8.5.1 => 8.5.1\r\n    jwk-to-pem: ^2.0.4 => 2.0.4\r\n    lib:  0.0.1\r\n    lodash-es: ^4.17.15 => 4.17.15\r\n    moment: ^2.27.0 => 2.27.0 (2.29.1, 2.26.0, 2.24.0)\r\n    moment-timezone: ^0.5.31 => 0.5.31\r\n    morgan: ^1.10.0 => 1.10.0\r\n    mysql: ^2.18.1 => 2.18.1\r\n    nest-aws-sdk: ^1.1.1 => 1.1.1\r\n    ng2-charts: ^2.4.2 => 2.4.2\r\n    ngx-dropzone: ^2.2.2 => 2.2.2\r\n    ngx-markdown: 11.0.0 => 11.0.0\r\n    nodemailer: ^6.4.16 => 6.4.16\r\n    pdf-lib: ^1.11.2 => 1.11.2\r\n    prettier: 2.2.1 => 2.2.1\r\n    reflect-metadata: ^0.1.13 => 0.1.13\r\n    rxjs: 6.5.5 => 6.5.5 (6.6.3, 6.6.7, 6.3.3)\r\n    rxjs/ajax:  undefined ()\r\n    rxjs/fetch:  undefined ()\r\n    rxjs/internal-compatibility:  undefined ()\r\n    rxjs/operators:  undefined ()\r\n    rxjs/testing:  undefined ()\r\n    rxjs/webSocket:  undefined ()\r\n    ts-jest: 26.4.0 => 26.4.0 (26.5.6)\r\n    ts-node: 9.1.1 => 9.1.1\r\n    tslib: ^2.0.0 => 2.0.0 (1.13.0, 2.1.0, 1.14.1, 2.0.1, 1.11.2, 2.2.0)\r\n    typeorm: ^0.2.25 => 0.2.25\r\n    typeorm-seeding: ^1.6.1 => 1.6.1\r\n    typescript: 4.0.8 => 4.0.8 (4.1.5, 4.0.3, 3.9.3)\r\n    zone.js: ^0.10.2 => 0.10.3\r\n  npmGlobalPackages:\r\n    @angular/cli: 12.2.2\r\n    npm: 6.14.14\r\n\r\n```\r\n\r\n</details>\r\n\n\n### Describe the bug\n\nWhen a user's MFA preference is removed, that user can no longer log in and is stuck with a spinner in the login button.\n\n### Expected behavior\n\nFrom the  [AdminSetUserMFAPreference docs](https://docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_AdminSetUserMFAPreference.html) the expected behavior is:\r\n\r\n> If  multiple options  are enabled and no preference is set, a challenge to choose an MFA option will be returned during sign in.\n\n### Reproduction steps\n\nBegin with a user in an MFA-required pool with software token MFA enabled and preferred:\r\n\r\n```json\r\n{\r\n    \"Username\": \"...\",\r\n    \"UserAttributes\": [\"...\"],\r\n    \"Enabled\": true,\r\n    \"UserStatus\": \"CONFIRMED\",\r\n    \"MFAOptions\": [\r\n        {\r\n            \"DeliveryMedium\": \"SMS\",\r\n            \"AttributeName\": \"phone_number\"\r\n        }\r\n    ],\r\n    \"PreferredMfaSetting\": \"SOFTWARE_TOKEN_MFA\",\r\n    \"UserMFASettingList\": [\r\n        \"SOFTWARE_TOKEN_MFA\"\r\n    ]\r\n}\r\n```\r\n\r\nUse the [AdminSetUserMFAPreference](https://docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_AdminSetUserMFAPreference.html) action to remove the preferred MFA, putting the user in this state:\r\n\r\n```json\r\n{\r\n    \"Username\": \"...\",\r\n    \"UserAttributes\": [\"...\"],\r\n    \"Enabled\": true,\r\n    \"UserStatus\": \"CONFIRMED\",\r\n    \"MFAOptions\": [\r\n        {\r\n            \"DeliveryMedium\": \"SMS\",\r\n            \"AttributeName\": \"phone_number\"\r\n        }\r\n    ],\r\n    \"UserMFASettingList\": [\r\n        \"SOFTWARE_TOKEN_MFA\"\r\n    ]\r\n}\r\n```\r\n\r\nNow when the user tries to log in they receive this console error: \"Unhandled Promise rejection: Local storage is missing an ID Token, Please authenticate\".\r\n\r\n```\r\n\r\n```\n\n### Code Snippet\n\n```javascript\r\n// Put your code below this line.\r\n\r\n```\r\n\n\n### Log output\n\n<details>\r\n\r\n```\r\n// Put your logs below this line\r\n\r\nzone-evergreen.js:659 Unhandled Promise rejection: Local storage is missing an ID Token, Please authenticate ; Zone: <root> ; Task: Promise.then ; Value: Error: Local storage is missing an ID Token, Please authenticate\r\n    at CognitoUser.getSession (CognitoUser.js:1324)\r\n    at Auth.js:1305\r\n    at new ZoneAwarePromise (zone-evergreen.js:960)\r\n    at AuthClass.push.v4IS.AuthClass.userSession (Auth.js:1303)\r\n    at Auth.js:1030\r\n    at new ZoneAwarePromise (zone-evergreen.js:960)\r\n    at AuthClass.push.v4IS.AuthClass.userAttributes (Auth.js:1029)\r\n    at AuthClass.push.v4IS.AuthClass.verifiedContact (Auth.js:1044)\r\n    at checkContact (auth-helpers-bd096ca7.js:20)\r\n    at handleSignIn (auth-helpers-bd096ca7.js:59) Error: Local storage is missing an ID Token, Please authenticate\r\n    at CognitoUser.getSession (https://staging.iask.works/vendor.js:68019:16)\r\n    at https://staging.iask.works/vendor.js:198008:18\r\n    at new ZoneAwarePromise (https://staging.iask.works/polyfills.js:1058:33)\r\n    at AuthClass.push.v4IS.AuthClass.userSession (https://staging.iask.works/vendor.js:198006:16)\r\n    at https://staging.iask.works/vendor.js:197733:19\r\n    at new ZoneAwarePromise (https://staging.iask.works/polyfills.js:1058:33)\r\n    at AuthClass.push.v4IS.AuthClass.userAttributes (https://staging.iask.works/vendor.js:197732:16)\r\n    at AuthClass.push.v4IS.AuthClass.verifiedContact (https://staging.iask.works/vendor.js:197747:21)\r\n    at checkContact (https://staging.iask.works/common.js:60:83)\r\n    at handleSignIn (https://staging.iask.works/common.js:99:19)\r\n```\r\n\r\n</details>\r\n\n\n### aws-exports.js\n\n_No response_\n\n### Manual configuration\n\n```js \r\n       Auth: {\r\n            userPoolId: 'us-west-1_Zj5xZfsJI',\r\n            userPoolWebClientId: '5gs4rr5nlstvb2qaegunfejhtf',\r\n            region: 'us-west-1',\r\n        }\r\n```\n\n### Additional configuration\n\n_No response_\n\n### Mobile Device\n\n_No response_\n\n### Mobile Operating System\n\n_No response_\n\n### Mobile Browser\n\n_No response_\n\n### Mobile Browser Version\n\n_No response_\n\n### Additional information and screenshots\n\n![Screen Shot 2021-10-15 at 11 00 51 AM](https://user-images.githubusercontent.com/37423570/137532384-33de3ff9-2d38-4f8c-9ebb-de02d6979982.png)\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"ashika01"},"body":"@synapdk are you using Amplify at all? the doc you have mentioned links to Cognito docs. If you are using Amplify, I think you might still need to use `setPreferedMFA` method since that is where we persist the data in localStorage in our code. If you are doing a combination of Cognito API calls and Amplify, I think you might have to replicate what we have done in our code to set the localStorage.\r\n\r\nCould you share a minimal code so we can see your usage? Also, after you have called the API, can you do `getCurrentAuthenticatedUser` to see if the challengeName and mfaPreference have updated?"}},{"node":{"author":{"login":"synapdk"},"body":"@ashika01 we are using a pretty vanilla implementation of the Angular sign in component:\r\n\r\n\r\n```html\r\n    <amplify-authenticator>\r\n        <amplify-sign-in slot=\"sign-in\" [hideSignUp]=\"true\"></amplify-sign-in>\r\n    </amplify-authenticator>\r\n```\r\n\r\nThere is no other code in that component. In a service we use the hub to listen for an auth event, but this is never received when the sign in component is stuck with a spinner.\r\n\r\n```ts\r\nimport { Hub } from '@aws-amplify/core';\r\n\r\n@Injectable()\r\nexport class NgxAuthService {\r\n \r\n    constructor(\r\n        private ngZone: NgZone,\r\n    ) {\r\n        Hub.listen('auth', ({ payload: { event, data } }) => {\r\n            if (event === 'signIn') this.ngZone.run(() => this.startSession(data));\r\n        });\r\n    }\r\n\r\n    private startSession = (data: any) => {\r\n        const token = data?.signInUserSession?.accessToken?.jwtToken ?? undefined;\r\n        if (!token) return undefined;\r\n\r\n       // ...the rest of our session setup, but a user whose MFA preference has been reset never gets here\r\n    }\r\n}\r\n```\r\n\r\nIs that helpful? It would be a fair amount of work to create a publicly accessible example, is there some kind of sandbox you use for that?"}},{"node":{"author":{"login":"ashika01"},"body":"@synapdk since we dont directly support all cognito APIs I would have to get more info to reproduce this issue. \r\n\r\nCould you give us a psuedo code/code snippet of your AdminSetUserMFAPreference sample https://docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_AdminSetUserMFAPreference.html"}},{"node":{"author":{"login":"synapdk"},"body":"@ashika01 I'm currently using the CLI to plan how I will call the API, hoping this is equivalent. It does behave a little strangely. If I just make the call I would expect to remove the MFA preference it appears to have succeeded  but nothing changes:\r\n\r\n```sh\r\naws cognito-idp admin-set-user-mfa-preference --cli-input-json '{\r\n    \"SMSMfaSettings\": {\r\n        \"Enabled\": true,\r\n        \"PreferredMfa\": false\r\n    },\r\n    \"SoftwareTokenMfaSettings\": {\r\n        \"Enabled\": true,\r\n        \"PreferredMfa\": false\r\n    },\r\n    \"Username\": \"dylan@synap.io\",\r\n    \"UserPoolId\": \"us-west-1_Zj5xZfsJI\"\r\n}\r\n'\r\n```\r\nIf I disable both MFA methods first, then re-enable them with the above command, the preference is successfully removed.\r\n```sh\r\naws cognito-idp admin-set-user-mfa-preference --cli-input-json '{\r\n    \"SMSMfaSettings\": {\r\n        \"Enabled\": false,\r\n        \"PreferredMfa\": false\r\n    },\r\n    \"SoftwareTokenMfaSettings\": {\r\n        \"Enabled\": false,\r\n        \"PreferredMfa\": false\r\n    },\r\n    \"Username\": \"dylan@synap.io\",\r\n    \"UserPoolId\": \"us-west-1_Zj5xZfsJI\"\r\n}\r\n'\r\naws cognito-idp admin-set-user-mfa-preference --cli-input-json '{\r\n    \"SMSMfaSettings\": {\r\n        \"Enabled\": true,\r\n        \"PreferredMfa\": false\r\n    },\r\n    \"SoftwareTokenMfaSettings\": {\r\n        \"Enabled\": true,\r\n        \"PreferredMfa\": false\r\n    },\r\n    \"Username\": \"dylan@synap.io\",\r\n    \"UserPoolId\": \"us-west-1_Zj5xZfsJI\"\r\n}\r\n'\r\n```\r\n\r\nAfter doing both the user is in the state that causes the error."}},{"node":{"author":{"login":"ashika01"},"body":"@synapdk I am not sure how this relates to Amplify. I would suggest reaching out in AWS forum to discuss the strange behavior. With respect to Amplify's support, this is the admin queries we support at the moment - https://docs.amplify.aws/cli/auth/admin/\r\n\r\nYou can use the doc and try to setup an api for admin action and then see if the issue still exists."}},{"node":{"author":{"login":"synapdk"},"body":"Thank you @ashika01 . I should note that #8103 would work for me also, but in the absence of that feature I was hoping it would at least be possible for an administrator to reset TOTP for a user, that's what I was after here. If there is another way to accomplish that I would love to know."}},{"node":{"author":{"login":"ashika01"},"body":"@synapdk Yeah I see your use case. It is definitely one of the use case we have been trying to work around cognito limitations. But we need support from cognito service to make it smoother. At the moment this has been marked as feature request and we are very much aware and looking into how to get this experience.\r\n\r\nSo if I have understood your usage here right, you are trying to use this Admin API to disable TOTP and re enable them with TOTP preferred so the customer can go through the setup again?"}},{"node":{"author":{"login":"synapdk"},"body":"@ashika01 You've got it, yes. I sent feedback on the [AdminSetUserMFAPreference doc page](https://docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_AdminSetUserMFAPreference.html). Is there anywhere else I should push for improvements on the Cognito side?"}},{"node":{"author":{"login":"ashika01"},"body":"@synapdk I tried setting up Admin Query support for the API you called out. I was able to update the settings as need. Please refer to [this doc](https://docs.amplify.aws/cli/auth/admin/)\r\n\r\nI added a function in `cognitoActions.js` created by our CLI for AdminMFA,\r\n```\r\nasync function mfaPref (params){\r\n  try {\r\n    console.log(\"params mfa\", params);\r\n    const result = await cognitoIdentityServiceProvider.adminSetUserMFAPreference(params).promise();\r\n    console.log(\"result mfa\", result);\r\n    return result;\r\n  } catch (err) {\r\n    console.log(err);\r\n    throw err;\r\n  }\r\n}\r\n```\r\n\r\nIn my function/AdminQueriesXXX/app.js\r\n```\r\napp.post('/mfaPref', async (req,res,next) => {\r\n  try {\r\n    console.log(\"mfa request\", req);\r\n    let response = await mfaPref(req.body);\r\n    res.status(200).json(response);\r\n  } catch (err) {\r\n    next(err);\r\n  }\r\n});\r\n```\r\n\r\n\r\nAnd from my client app.js,\r\n\r\n```\r\nasync function setMfa() {\r\n  let apiName = \"AdminQueries\";\r\n  let path = \"/mfaPref\";\r\n  const params = {\r\n    SMSMfaSettings: { \r\n       Enabled: false,\r\n       PreferredMfa: false\r\n    },\r\n    Username: 'test4',\r\n    UserPoolId: awsConfig.aws_user_pools_id\r\n  }\r\n\r\n  let myInit = {\r\n    body: params,\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      Authorization: `${(await Auth.currentSession())\r\n        .getAccessToken()\r\n        .getJwtToken()}`,\r\n    },\r\n  };\r\n  const { NextToken, ...rest } = await API.post(apiName, path, myInit);\r\n  nextToken = NextToken;\r\n  console.log(\"rest\", rest);\r\n  return rest;\r\n}\r\n```\r\n"}},{"node":{"author":{"login":"ashika01"},"body":"To reach out to cognito forum - https://forums.aws.amazon.com/forum.jspa?forumID=173. \r\n\r\nI am moving this to discussion since this is more of a question than issue or bug. "}},{"node":{"author":{"login":"synapdk"},"body":"I also got a reply from my feedback on the documentation with some more information:\r\n\r\nThe next step (after resetting MFA preference) is not possible in the hosted UI. The choice must be made in your software. I performed the same operation as you in the CLI, and then ran an InitiateAuth [1] for that user. This was the response:\r\n\r\n```json\r\n{\r\n    \"ChallengeName\": \"SELECT_MFA_TYPE\",\r\n    \"ChallengeParameters\": {\r\n        \"CODE_DELIVERY_DELIVERY_MEDIUM\": \"SMS\",\r\n        \"CODE_DELIVERY_DESTINATION\": \"+*******1212\",\r\n        \"FRIENDLY_DEVICE_NAME\": \"phoneGauth\",\r\n        \"MFAS_CAN_CHOOSE\": \"[\\\"SMS_MFA\\\",\\\"SOFTWARE_TOKEN_MFA\\\"]\",\r\n        \"USER_ID_FOR_SRP\": \"testuser\"\r\n    }\r\n}\r\n```\r\n\r\nThe auth challenge I received after resetting my MFA preferences was to choose a new preference. I can follow that up with RespondToAuthChallenge [2] and provide my preferred MFA type. I will then be presented with a SMS_MFA | SOFTWARE_TOKEN_MFA challenge, provide my code, and proceed with authentication.\r\n\r\nI do understand that the process is not intuitive, and I am working on improving the docs around these processes. I hope this helps.\r\n\r\nThanks for taking the time to send us feedback! We appreciate all feedback, whether it's positive or it alerts us to a problem we need to address. Please don't hesitate to contact us with any other feedback you might have about our documentation.\r\n\r\n[1]  InitiateAuth  - https://docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_InitiateAuth.html\r\n\r\n[2]  RespondToAuthChallenge  - https://docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_RespondToAuthChallenge.html"}},{"node":{"author":{"login":"ashika01"},"body":"Just to summarize,\r\n1. The UX you would like to achieve and as described in https://github.com/aws-amplify/amplify-js/issues/8103 is not currently possible because of limitations\r\n2. However for your workaround, where you would like Admin to override you could use the admin queries feature. You would need some sort of UI/API introduced for Admin to do this.\r\n\r\nI am going to mark this answered. If you have further queries specific to Cognito or feature requests, we recommend AWS forum for response from Cognito team."}}]}}},{"node":{"id":"D_kwDOBkswNc4AODFY","author":{"login":"mguja-fcc"},"title":"Getting error \"error on fetching instances Error: No current user\" with initial login.","body":"I want to load initial data but only for authenticated users. Currently, I am using useEffect hook, however, it tries to fetch data before authentication. If it is my initial login then I am getting error \"error on fetching instances Error: No current user\". If I refresh the browser than no issue fetching data from the database and it works until authentication token expires. How can I fetch data only after authentication ?\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"david-mcafee"},"body":"@mguja-fcc - what type of auth are you using (IAM, Cognito, etc)? Additionally, how are you enforcing auth? Have you added auth to your schema? Additionally, how are you enforcing auth on the page (i.e. are you using `withAuthenticator`, and if so, where are you placing it?). \r\n\r\nFor instance, if your schema looks like this:\r\n```js\r\ntype Todo @model @auth(rules: [{ allow: owner }]) {\r\n  id: ID!\r\n  name: String!\r\n  description: String!\r\n  owner: String\r\n}\r\n```\r\n\r\nand you are also wrapping your App, or component, with the authenticator, like this:\r\n```js\r\nimport { withAuthenticator } from \"@aws-amplify/ui-react\";\r\n\r\nconst App = () => {\r\n[...]\r\n};\r\n\r\nexport default withAuthenticator(App);\r\n```\r\nthen you should have no problem retrieving the data like so:\r\n```js\r\n useEffect(() => {\r\n    fetchTodos();\r\n}, []);\r\n\r\nasync function fetchTodos() {\r\n    try {\r\n        const todoData = await API.graphql(graphqlOperation(listTodos));\r\n        const todos = todoData?.data?.listTodos?.items;\r\n        setTodos(todos);\r\n    } catch (err) {\r\n        console.log(\"error fetching todos\", err);\r\n    }\r\n}\r\n```"}},{"node":{"author":{"login":"mguja-fcc"},"body":"Hi,\r\n\r\nI was able to figure it out. It actually worked the way it should. I moved my post authentication event to `<AmplifyAuthenticator handleAuthStateChange={handleAuthStateChange}>` where `handleAuthStateChange` function is fetching data from the database. I do not fetch data from `useEffect` react hook since it tries to fetch data before authentication happens."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMjgyNw==","author":{"login":"danrivett"},"title":"DataStore: Subscriptions should show previous state as well as current state","body":"# Request\r\nWhen subscribing to data model changes, it would be incredibly useful when the `opType` is `UPDATE` for the `SubscriptionMessage` returned to the subscriber to not just include the current value, but also the previous value in order for the application to be able to identify what's changed since depending on what's changed then different responses may be required.\r\n\r\nI see this analogous to DynamoDB streams where the streams contain old and new image records for each update so subscribers can identify what's changed and react accordingly.\r\n\r\nAlternatively, if there are better ways to solve this use case I'd be very happy to consider them.","upvoteCount":3,"comments":{"edges":[{"node":{"author":{"login":"danrivett"},"body":"Copying @manueliglesias so you're aware as this could be a pretty helpful change to `SubscriptionMessage` and perhaps one that isn't very complicated to implement if the underlying subscription event is being triggered by a DynamoDB stream event and so DataStore already has access to the previous value?\r\n\r\nAs for use cases for this functionality, we have a few, but an example of one of them is highlighting the fields that have been just updated so the user can easily see what's been updated in the model."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNjgyMjEw","author":{"login":"ericclemmons"},"title":"RFC: React Hooks for Amplify API","body":"_This issue is a Request For Comments (RFC). It is intended to elicit community feedback regarding a proposed change to the library. Please feel free to post comments or questions here._\r\n\r\n## Purpose\r\n\r\nSimplify integration of the Amplify API category to accomplish common use-cases within modern React applications.\r\n\r\n## The Problem\r\n\r\nRunning asynchronous GraphQL queries can easily lead to memory leaks, setting state on unmounted components, and incorrectly catching/handling errors:\r\n\r\n```js\r\nuseEffect(() => {\r\n    setIsLoading(true);\r\n    \r\n    API.graphql({\r\n      authMode: owner ? 'AMAZON_COGNITO_USER_POOLS' : 'AWS_IAM',\r\n      query: listAlbums,\r\n      variables: {\r\n        nextToken: pageToken\r\n      }\r\n    })\r\n      .then(payload => {\r\n        setNextToken(payload.data.listAlbums.nextToken);\r\n        setAlbums(payload.data.listAlbums.items);\r\n        setIsLoading(false);\r\n      })\r\n      .catch(payload => {\r\n        throw new Error(payload.errors[0].message);\r\n      });\r\n      \r\n}, [owner, pageToken]);\r\n```\r\n\r\nAdditionally, [`API.graphql` may require the user to pass `authMode`](#2396), whereas it would be preferably for it to work \"out of the box\" without [explicitly listening to `Hub` events](#2542).\r\n\r\n## Proposed Solution\r\n\r\n### `useQuery(query, variables?, setData?)`\r\n\r\n_returns `[res, runQuery]`._\r\n\r\n`useQuery` turns `API.graphql` into a synchronous API for managing the fetch/loading/data/error life-cycle:\r\n\r\n```js\r\nconst [res, runQuery] = useQuery(listAlbums, { nextToken: pageToken });\r\n\r\nif (res.loading) return <Loader />;\r\n\r\nif (res.error) return (\r\n  <button onClick={() => runQuery()}>Retry</Button>\r\n);\r\n\r\nreturn (\r\n  <>\r\n    <AlbumList albums={res.data.listAlbums.items} />\r\n    \r\n    <button onClick={() => setPageToken(res.data.listAlbums.nextToken}>\r\n      Next Page\r\n    </button> \r\n  </>\r\n);\r\n```\r\n\r\n- The `query` is automatically ran on mount.\r\n- `res` has the shape `{ data, error, loading }`, similar to [urql](https://formidable.com/open-source/urql/docs/getting-started/#using-hooks).  This signature allows for users to provide semantic meaning (e.g. `albumRes`) when there are multiple `useQuery` hooks in a single component.\r\n- `runQuery` has the signature `runQuery(overrideVariables?)` for re-fetching data (typically in the event of an error).\r\n- `setData` has the signature `setData(data)`, which simplifies data normalization & computed property scenarios:\r\n\r\n    ```js\r\n    const [album, setAlbum] = useState()\r\n    const [res] = useQuery(getAlbum, { id: album.id }, (data) => {\r\n      setAlbum(data.getAlbum)\r\n    })\r\n    ```\r\n\r\n    Typically, `useQuery` and `useMutation` won't use this, but it exists due to constraints with `useSubscription` & for symmetry.\r\n\r\n### `useMutation(query, setData?)`\r\n\r\n_Returns `[res, runMutation]`._\r\n\r\n`useMutation` provides a handler for `API.graphql` that turns the asynchronous event into a synchronous API for managing the fetch/loading/data/error life-cycle:\r\n\r\n```js\r\nconst [res, runMutation] = useMutation(deleteAlbum);\r\n\r\nif (res.error) throw res.error;\r\nif (res.data) return <Redirect to=\"/\" />\r\n\r\nreturn (\r\n  <button onClick={() => runMutation({\r\n    input: {\r\n      expectedVersion: album.version,\r\n      id: album.id\r\n    }\r\n  )}>Delete Album</button>\r\n);\r\n```\r\n\r\n- `query` is _not_ ran on mount, but triggered via the `runMutation` callback.\r\n- `res` has the shape `{ data, error, loading }`.\r\n- `runMutation` has the signature `runMutation(variables?)`, since mutations often require scoped values (e.g. `event.target.value)`.\r\n- `setData` has the signature `setData(data)` to simplify keeping local state in sync after a mutation succeeds:\r\n\r\n    ```js\r\n    const [album, setAlbum] = useState()\r\n    const [query] = useQuery(getAlbum, { id: album.id }, (data) => {\r\n      setAlbum(data.getAlbum)\r\n    })\r\n    const [mutation, runMutation] = useMutation(updateAlbum, (data) => {\r\n      setAlbum(data.updateAlbum)\r\n    })\r\n    ...\r\n    ```\r\n\r\n### `useSubscription(query, variables?, setData?)`\r\n\r\n_returns `undefined`._\r\n\r\n`useSubscription` pairs naturally with `useQuery` and `useMutation` for keeping state in sync, especially when mutations happen in other components:\r\n\r\n```js\r\nconst [album, setAlbum] = useState();\r\n\r\nconst [res] = useQuery(getAlbum, { id }, (data) => {\r\n  setAlbum(data.getAlbum);\r\n});\r\n\r\nuseSubscription(onUpdateAlbum, { owner }, (data) => {\r\n  setAlbum(data.onUpdateAlbum);\r\n});\r\n\r\nif (res.loading) return <Loader />\r\n\r\nreturn <AlbumDetails album={album} />\r\n```\r\n\r\n### `useGraphQL(query, variables?)`\r\n\r\n_returns `[runQuery]`._\r\n\r\n`useQuery`, `useMutation`, and `useSubscription` are all powered by `useGraphQL`, which memoizes `API.graphql` calls to reduce network connections and automatically handle `authMode`.\r\n\r\nThis isn't intended to be used directly, but is leveraged by the other hooks.\r\n\r\n## Related Issues\r\n\r\n- #2611\r\n- #2542\r\n- https://github.com/aws-amplify/amplify-cli/issues/2396\r\n- #474 \r\n\r\n\r\n## Resources\r\n\r\n- https://github.com/mwarger/amplify-query-helpers\r\n- [React v16.8: The One With Hooks](https://reactjs.org/blog/2019/02/06/react-v16.8.0.html) is released in February, 2019.\r\n- In 3 months [55% of 6,632 respondents were using hooks](https://twitter.com/icookandcode/status/1131740303780712448).\r\n- [Should I use Hooks, classes, or a mix of both?](https://reactjs.org/docs/hooks-faq.html#should-i-use-hooks-classes-or-a-mix-of-both)\r\n- [80% of users' time is spent in function components](https://twitter.com/kentcdodds/status/1136261881696382977).\r\n- [Hooks, Suspense, the death of render props, the-platform, and migrating sanely](https://twitter.com/ReactPodcast/status/1064865948333744128)\r\n- [Creating reusable abstractions with Amplify and React hooks](https://itnext.io/creating-reusable-abstractions-with-amplify-and-react-hooks-97784c8b5c2a)\r\n- [AWS Amplify GraphQL Operations with TypeScript and Hooks - Part 1 [Queries]](https://dev.to/mwarger/aws-amplify-graphql-queries-with-typescript-and-hooks-1e2)\r\n- [Authorizing Subscriptions](https://aws-amplify.github.io/docs/cli-toolchain/graphql#authorizing-subscriptions)\r\n- [Observable types like RxJS `BehaviorSubject` and `ReplaySubject`. (Types like RxJS `Subject` or `Observable` are not supported, because they provide no way to read the \"current\" value after it has been emitted.)](https://github.com/facebook/react/pull/15022/files#diff-f3a2eff7618256a34a255026486e7e9fR27)\r\n\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"jkeys-ecg-nmsu"},"body":"Nice proposal! \r\n\r\nOne question: does the below code not exactly simulate this functionality asynchronously by having a local useState hook that will hold your API data and give it an initial state of undefined? Or is there something I'm missing about React lifecycles? \r\n\r\n```\r\nconst [myApiData, setMyApiData] = useState(undefined);\r\n\r\nuseEffect( () => {\r\n   const _effect = async () => await API.graphql(props.apiConfig);\r\n   let data = _effect();\r\n   setMyApiData(data);\r\n\r\n  return () => setMyApiData(undefined); //set back to undefined so the lifecycle restarts on unmount and remount\r\n}, []);\r\n\r\nif(myApiData === undefined) return <Loading />\r\nelse if(myApiData.data.errors.length !== 0) return <Error />\r\nelse return <div>{myApiData.map( datum => <ul>{datum}</ul>}</div>\r\n```\r\n\r\nThen set it to undefined on unmount.  The most annoying part with this pattern is that you have to wrap your async call to `API.graphql` in an async IIFE / closure inside your useEffect hook (which is then called synchronously).\r\n\r\nAll that being said, I am sure we will convert to using this just to reduce cruft."}},{"node":{"author":{"login":"3nvi"},"body":"Thanks for that! It's nice how most GraphQL libraries have an aligned API in the use of hooks. \r\n\r\nA few things I'm wondering:\r\n\r\n1. Doesn't the callback on `useQuery` & `useMutation` create the same memory-leak issues? If it executes right after the promise has resolved, I feel it might inevitably lead to the same problems if the component has unmounted while the request is in-flight.\r\n\r\n2. How is query memoization handled? Is the user allowed to choose among different cache & network strategies? \r\n\r\n3. Does the query get re-executed on a variable change or what's the plan to handle this scenario?\r\n\r\n4. I feel that an option to make the query \"lazy\" (behave like way mutation does) would be interesting whenever the query is triggered by some user action (i.e. button click)."}},{"node":{"author":{"login":"ericclemmons"},"body":"@3nvi Great feedback!\r\n\r\n1. Potentially, but in a reference implementation the mount status is tracked to prevent firing callbacks as the GraphQL Promise resolves.  (There's an opportunity for `AbortController` to be used internally)\r\n\r\n2. The reference implementation memoizes based on `query` & `variables` (and potentially on auth state, based on how `authMode` is handled) via `useMemo`. At the very least the same as https://aws-amplify.github.io/docs/js/api#amplify-graphql-client for starters.\r\n\r\n3. The `useQuery` implementation would re-fire as `variables` change.\r\n\r\n4. Something like `useLazyQuery` would work, which is similar to how `useMutation` currently behaves: https://www.apollographql.com/docs/react/api/react-hooks/#uselazyquery\r\n"}},{"node":{"author":{"login":"ajhool"},"body":"According to the docs, the amplify api client is a lightweight alternative to apollo. Out of curiosity, in what way is this api client a lightweight alternative? It appears to have less features (apollo has ssr, hooks, caching, multiple languages, good documentation, etc.), has a much larger dependency footprint (gigantic), and doesn't offer codegen for custom queries/mutations. Configuration might be 10 LOC quicker.\r\n\r\nAmplify feels overextended and my sincere RFC feedback for adding api hooks is to just add a page of documentation explaining how to point apollo at amplify's generated backend and drop support for this bespoke graphql client to focus on the more novel components of the amplify client"}},{"node":{"author":{"login":"ericclemmons"},"body":"@ajhool Thanks for your feedback! Your concerns are totally valid: Amplify covers a lot of ground (e.g. Analytics, API, Authentication, etc.), so over-extending and providing immature or unsupported APIs isn't an option.\r\n\r\nThe wording in the docs could be improved, but we offer Amplify as a \"lightweight alternative\" to the AWS SDK Client: \r\n\r\n> <p>The <a href=\"https://github.com/awslabs/aws-mobile-appsync-sdk-js/\">AWS AppSync SDK</a> enables you to integrate your app with the AWS AppSync service and integrates with the Apollo client found <a href=\"https://github.com/apollographql/apollo-client/\">here</a>. The SDK supports multiple authorization models, handles subscription handshake protocols for real-time updates to data, and has built-in capabilities for offline support that makes it easy to integrate into your app.</p>\r\n>\r\n> <p>The Amplify GraphQL client is a lighter weight option if you’re looking for a simple way to leverage GraphQL features and do not need the offline capabilities or caching of the Apollo client. If you need those features, choose the AWS AppSync SDK.</p>\r\n– https://aws-amplify.github.io/docs/js/api#using-aws-appsync\r\n\r\nThe ideal result of the hooks RFC is identifying common use-cases from you and others have, then iron out that friction in the underlying, framework-agnostic APIs.\r\n\r\nA good example of identifying use-cases is your suggestion here: https://github.com/aws-amplify/amplify-js/issues/4325\r\n\r\nKeep up the feedback and examples! They're essential to prioritize our efforts & make your experiences better.\r\n\r\n\r\n"}},{"node":{"author":{"login":"ajhool"},"body":"Thanks for the response. Two of the feature requests that I have open with Amplify are #4325 (the one you linked, a convenience function for making private files public) and #1910 (not mine, but I would have opened it if it wasn't already -- add cloudfront to the Storage module). Both of these use-cases are examples of where amplify is most useful for us; implementing common AWS-specific access patterns that Amplify is uniquely suited to make convenient for users. They make it easier for us to spend money on AWS infrastructure and add features to our own services.\r\n\r\nThe fact that the Storage module does not already have Cloudfront integration is precisely why it seems wasteful for the Amplify team to be reinventing/cloning-but-a-few-months-slower a graphql client. While the Storage module is not directly related to the API module, presumably time spent working on a Graphql API client is time not spent working on Storage or Auth or one of the more AWS-specific tools.\r\n\r\nPointing out a \"good example\" of a use-case that I've provided feels a littleee like it's dismissing my criticism here as being \"not a good example.\" On the contrary, the feedback I'm trying to provide is that there is simply no use-case for me, an Amplify user, to use API hooks because we've already been using graphql hooks + ssr + cache + polling + other features for a few months via apollo-react.\r\n\r\n> The wording in the docs could be improved, but we offer Amplify as a \"lightweight alternative\" to the AWS SDK Client: https://github.com/awslabs/aws-mobile-appsync-sdk-js/\r\n\r\nIt's still unclear what \"llightweight alternative\" means in that context. Smaller footprint? Less features? It looks like the Appsync team has the right idea; that client + apollo integration documentation is already perfect and everything else about the API module is a distraction from that implementation IMO. Might solve this issue, too: https://github.com/aws-amplify/amplify-js/issues/3365#issuecomment-502009495"}},{"node":{"author":{"login":"ericclemmons"},"body":"That was my mistake.  Your feedback has been great!  What I didn't understand was if the hooks RFC was potentially redundant or conflicting with your needs.\r\n\r\nAnd yes, your understanding of \"lightweight alternative\" is correct: smaller footprint, fewer features, fewer dependencies.\r\n\r\n> there is simply no use-case for me, an Amplify user, to use API hooks because we've already been using graphql hooks + ssr + cache + polling + other features for a few months.\r\n> ...\r\n> It looks like the Appsync team has the right idea; that client + apollo integration documentation is already perfect and everything else about the API module is a distraction from that implementation IMO.\r\n\r\nThis is fantastic feedback! Thanks so much for your thoughtful responses @ajhool.\r\n"}},{"node":{"author":{"login":"jkeys-ecg-nmsu"},"body":">Pointing out a \"good example\" of a use-case that I've provided feels a littleee like it's dismissing my criticism here as being \"not a good example.\" \r\n\r\nI tried to point out in a polite way that, unless I and most working React developers are missing something about lifecycles and useEffect, it was a proposed solution in search of a problem, and then got ignored. Feelsbadman. Maybe I need to be more direct when telling someone that I don't see the benefit of their proposed solution so that my criticism won't be similarly dismissed. @ericclemmons \r\n\r\nI'd much rather see Amplify developers spend their efforts locking the authorization rules down for the API category than make it mildly easier to actually use the Amplify API SDK, which as @ajhool points out is redundant in the ecosystem. "}},{"node":{"author":{"login":"ajhool"},"body":"@jkeys-ecg-nmsu The apollo hooks implementation provides a loading, data, and error return for the hooks, so you can write very clean code to handle the three main states (If you have 3 different queries or mutations in a component, then things can get ugly quickly with the old HOC code but it is very clean with hooks).\r\n\r\nReact hooks, themselves, are so nice that they do make these implementations somewhat trivial, but the graphql clients do add some useful functionality over your basic `useEffect` and I recommend trying them out or adding it to your code!\r\n\r\nUnder the hood, those hooks are basically doing what you've described with `useEffect` + some convenience parameters and caching (https://github.com/apollographql/react-apollo/blob/master/packages/hooks/src/utils/useBaseQuery.ts), but I do find the react-apollo implementation to be a breath of fresh air after the previous HOC components strategy (both amplify's and apollo's, before apollo added hooks)."}},{"node":{"author":{"login":"ericclemmons"},"body":"Thanks everyone who's participated in this RFC, both here & on Twitter!\r\n\r\nWhile we continue planning out our roadmap, I'd recommend anyone interested in hooks review the **Resources** in the original post body, which has existing, community-driven solutions for integrating Amplify within your existing React projects using hooks. 🙏\r\n\r\n\r\n\r\n"}},{"node":{"author":{"login":"jkeys-ecg-nmsu"},"body":"@ajhool thanks for the advice, I'll take a look at it. FWIW I specifically don't want caching and server-side rendering is not an option. So I use the API sdk since it's already a dependency and meets our needs. It also does the sigv4 signing to be fair which does free up some developer resources.\r\n\r\nI absolutely agree that the Amplify team should be coding for the common Amazon use case -- if Azure or GCP want to leverage Amplify, they can submit pull requests and build plugins to implement boilerplate logic for their common use cases. I appreciate the provider-agnostic design, but when it comes to the actual Amplify SDK I want it to solve AWS problems first. \r\n\r\nMaybe one feature request that branches from this conversation is the Amplify team declaring itself _opinionated_ on things like **recommended** GraphQL clients, backend methods for querying AppSync* that don't require hacks to make Amplify work in a Lambda, etc. In general, any JS/TS software that is already popular in the ecosystem and solves a use case in a more robust manner than Amplify currently does or would, while still remaining _unopinionated_ on application architecture. Then compile the list of recommended software / packages into a RFC and see what the community thinks about it. @ericclemmons could you please consider this (or consider, considering?) this in your roadmap planning?\r\n\r\n*It's a shame that the AppSync documentation is so focused on how to create the API that it doesn't even mention how to access it, nor provide an SDK to communicate with it from the backend. You're just given an endpoint and [trial-and-error](https://github.com/aws-amplify/amplify-js/issues/2231#issuecomment-447628455). So then you have developers turning to Amplify and asking questions about how to use Amplify from Lambda, how to import just the API category to keep Lambda size small, etc. When really those questions should already be documented by the service team. \r\n\r\nEven just a blurb on the AppSync page that describes how to use a client like `axios` would have probably prevented a lot of issues from being opened on this page."}},{"node":{"author":{"login":"amcdnl"},"body":"I'd curious why not just use apollo hooks? I setup my project using apollo and appysync client and it works great (except for the tremendous amount of effort it took to figure it out).\r\n\r\nHere is my appsync setup:\r\n\r\n```ts\r\nimport Amplify from 'aws-amplify';\r\nimport AWSAppSyncClient, { createAppSyncLink } from 'aws-appsync';\r\nimport { ApolloLink } from 'apollo-link';\r\nimport { AWS_CUSTOM_CONFIG } from '../../aws-custom-exports';\r\nimport { errorLink } from 'core/Apollo';\r\nimport { jsonLink } from 'core/Apollo';\r\nimport { getToken } from 'core/Auth';\r\n\r\nAmplify.configure(AWS_CUSTOM_CONFIG);\r\n\r\nconst auth = {\r\n  type: AWS_CUSTOM_CONFIG.aws_appsync_authenticationType as any,\r\n  jwtToken: () => getToken()\r\n};\r\n\r\nexport const appSyncClient = new AWSAppSyncClient(\r\n  {\r\n    url: AWS_CUSTOM_CONFIG.aws_appsync_graphqlEndpoint,\r\n    disableOffline: true,\r\n    region: AWS_CUSTOM_CONFIG.aws_appsync_region,\r\n    auth,\r\n    cacheOptions: {\r\n      addTypename: false\r\n    }\r\n  },\r\n  {\r\n    link: ApolloLink.from([\r\n      jsonLink,\r\n      errorLink,\r\n      createAppSyncLink({\r\n        url: AWS_CUSTOM_CONFIG.aws_appsync_graphqlEndpoint,\r\n        region: AWS_CUSTOM_CONFIG.aws_appsync_region,\r\n        auth,\r\n        complexObjectsCredentials: () => Amplify.Auth.currentCredentials()\r\n      })\r\n    ])\r\n  }\r\n);\r\n```\r\n\r\nI had to hack the rehydrate like this:\r\n\r\n```ts\r\nimport { useEffect, useState } from 'react';\r\nimport { useApolloClient } from 'react-apollo';\r\nimport AWSAppSyncClient from 'aws-appsync';\r\n\r\nexport const Rehydrated = ({ children }) => {\r\n  const client = useApolloClient();\r\n  const [rehydrated, setState] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (client instanceof AWSAppSyncClient) {\r\n      (async () => {\r\n        await client.hydrated();\r\n        setState(true);\r\n      })();\r\n    }\r\n  }, [client]);\r\n\r\n  return rehydrated ? children : null;\r\n};\r\n```\r\n\r\nbut now that is all working I can do my queries just like apollo, example:\r\n\r\n```ts\r\nexport const ConnectionsContainer: FC<ConnectionsContainerProps> = props => {\r\n  const { data, loading } = useQuery(CONNECTION_QUERY);\r\n\r\n  const [deleteConnection] = useMutation(\r\n    DELETE_CONNECTION_MUTATION,\r\n    mutationOptions\r\n  );\r\n````\r\n\r\n and take advantage of the middlewares like error link:\r\n\r\n```ts\r\nimport { onError } from 'apollo-link-error';\r\n\r\nexport const errorLink = onError(({ graphQLErrors, networkError }) => {\r\n  if (graphQLErrors) {\r\n    graphQLErrors.forEach(({ message, locations, path }) => {\r\n      if (message === 'Valid authorization header not provided.') {\r\n        window.location.replace('/login');\r\n      }\r\n\r\n      console.error(\r\n        `[GraphQL error]: Message: ${message}, Location: ${locations}, Path: ${path}`\r\n      );\r\n    });\r\n  }\r\n\r\n  if (networkError) {\r\n    console.error(`[Network error]: ${networkError}`);\r\n  }\r\n});\r\n```"}},{"node":{"author":{"login":"ericclemmons"},"body":"This RFC focused on simplifying existing usage patterns for the [Amplify's GraphQL API](https://docs.amplify.aws/lib/graphqlapi/getting-started/q/platform/js) within the React community, while preventing common bugs (forgetting to `unsubscribe` to subscriptions, setting state  after unmounting, etc.).\r\n\r\nNot all apps use `react-apollo`, but for those that do can re-use Apollo Client's hooks as you've done here!"}},{"node":{"author":{"login":"amcdnl"},"body":"@ericclemmons - It would be awesome if we could improve the docs to talk about this and maybe show how to do it easier."}},{"node":{"author":{"login":"mdegrees"},"body":"@amcdnl, to @ericclemmons point, I went, for e.g,  the route of react-apollo but hit a wall with multi authentications. My app have guests and users. Switching between Cognito pool and API key was cumbersome + subscriptions didn't work: \r\nhttps://github.com/awslabs/aws-mobile-appsync-sdk-js/issues/562"}},{"node":{"author":{"login":"lenarmazitov"},"body":"> I'd curious why not just use apollo hooks? I setup my project using apollo and appysync client and it works great (except for the tremendous amount of effort it took to figure it out).\r\n> \r\n> Here is my appsync setup:\r\n> \r\n> ```ts\r\n> import Amplify from 'aws-amplify';\r\n> import AWSAppSyncClient, { createAppSyncLink } from 'aws-appsync';\r\n> import { ApolloLink } from 'apollo-link';\r\n> import { AWS_CUSTOM_CONFIG } from '../../aws-custom-exports';\r\n> import { errorLink } from 'core/Apollo';\r\n> import { jsonLink } from 'core/Apollo';\r\n> import { getToken } from 'core/Auth';\r\n> \r\n> Amplify.configure(AWS_CUSTOM_CONFIG);\r\n> \r\n> const auth = {\r\n>   type: AWS_CUSTOM_CONFIG.aws_appsync_authenticationType as any,\r\n>   jwtToken: () => getToken()\r\n> };\r\n> \r\n> export const appSyncClient = new AWSAppSyncClient(\r\n>   {\r\n>     url: AWS_CUSTOM_CONFIG.aws_appsync_graphqlEndpoint,\r\n>     disableOffline: true,\r\n>     region: AWS_CUSTOM_CONFIG.aws_appsync_region,\r\n>     auth,\r\n>     cacheOptions: {\r\n>       addTypename: false\r\n>     }\r\n>   },\r\n>   {\r\n>     link: ApolloLink.from([\r\n>       jsonLink,\r\n>       errorLink,\r\n>       createAppSyncLink({\r\n>         url: AWS_CUSTOM_CONFIG.aws_appsync_graphqlEndpoint,\r\n>         region: AWS_CUSTOM_CONFIG.aws_appsync_region,\r\n>         auth,\r\n>         complexObjectsCredentials: () => Amplify.Auth.currentCredentials()\r\n>       })\r\n>     ])\r\n>   }\r\n> );\r\n> ```\r\n> \r\n> I had to hack the rehydrate like this:\r\n> \r\n> ```ts\r\n> import { useEffect, useState } from 'react';\r\n> import { useApolloClient } from 'react-apollo';\r\n> import AWSAppSyncClient from 'aws-appsync';\r\n> \r\n> export const Rehydrated = ({ children }) => {\r\n>   const client = useApolloClient();\r\n>   const [rehydrated, setState] = useState(false);\r\n> \r\n>   useEffect(() => {\r\n>     if (client instanceof AWSAppSyncClient) {\r\n>       (async () => {\r\n>         await client.hydrated();\r\n>         setState(true);\r\n>       })();\r\n>     }\r\n>   }, [client]);\r\n> \r\n>   return rehydrated ? children : null;\r\n> };\r\n> ```\r\n> \r\n> but now that is all working I can do my queries just like apollo, example:\r\n> \r\n> ```ts\r\n> export const ConnectionsContainer: FC<ConnectionsContainerProps> = props => {\r\n>   const { data, loading } = useQuery(CONNECTION_QUERY);\r\n> \r\n>   const [deleteConnection] = useMutation(\r\n>     DELETE_CONNECTION_MUTATION,\r\n>     mutationOptions\r\n>   );\r\n> ```\r\n> \r\n> and take advantage of the middlewares like error link:\r\n> \r\n> ```ts\r\n> import { onError } from 'apollo-link-error';\r\n> \r\n> export const errorLink = onError(({ graphQLErrors, networkError }) => {\r\n>   if (graphQLErrors) {\r\n>     graphQLErrors.forEach(({ message, locations, path }) => {\r\n>       if (message === 'Valid authorization header not provided.') {\r\n>         window.location.replace('/login');\r\n>       }\r\n> \r\n>       console.error(\r\n>         `[GraphQL error]: Message: ${message}, Location: ${locations}, Path: ${path}`\r\n>       );\r\n>     });\r\n>   }\r\n> \r\n>   if (networkError) {\r\n>     console.error(`[Network error]: ${networkError}`);\r\n>   }\r\n> });\r\n> ```\r\n\r\nThanks @amcdnl this works. \r\nBut also there is need to add resolutions to package.json\r\n```\r\n  \"resolutions\": {\r\n    \"apollo-client\": \"2.6.8\"\r\n  }\r\n```\r\n\r\nBecause AppSync uses apollo-client@2.4.6 which causes error see https://github.com/apollographql/react-apollo/issues/3148"}},{"node":{"author":{"login":"amcdnl"},"body":"@lenarmazitov I ended up changing the setup to this:\r\n\r\n```\r\n    \"apollo-cache-inmemory\": \"^1.6.6\",\r\n    \"apollo-client\": \"^2.6.10\",\r\n    \"apollo-link\": \"^1.2.14\",\r\n    \"apollo-link-error\": \"^1.1.13\",\r\n    \"apollo-link-http\": \"^1.5.17\",\r\n    \"apollo-link-ws\": \"^1.0.20\",\r\n    \"aws-amplify\": \"^3.0.13\",\r\n    \"aws-appsync-auth-link\": \"^2.0.2\",\r\n    \"aws-appsync-subscription-link\": \"^2.1.0\",\r\n```\r\n\r\nand \r\n\r\n```ts\r\nimport Amplify from 'aws-amplify';\r\nimport { ApolloLink } from 'apollo-link';\r\nimport { AWS_CUSTOM_CONFIG } from '../../aws-custom-exports';\r\nimport { errorLink } from 'core/Apollo';\r\nimport { jsonLink } from 'core/Apollo';\r\nimport { getToken } from 'core/Auth';\r\nimport { createAuthLink } from 'aws-appsync-auth-link';\r\nimport { createSubscriptionHandshakeLink } from 'aws-appsync-subscription-link';\r\nimport ApolloClient from 'apollo-client';\r\nimport { InMemoryCache } from 'apollo-cache-inmemory';\r\nimport { createHttpLink } from 'apollo-link-http';\r\n\r\nAmplify.configure(AWS_CUSTOM_CONFIG);\r\n\r\nconst auth = {\r\n  type: AWS_CUSTOM_CONFIG.aws_appsync_authenticationType as any,\r\n  jwtToken: () => getToken()\r\n};\r\n\r\nconst config = {\r\n  url: AWS_CUSTOM_CONFIG.aws_appsync_graphqlEndpoint,\r\n  region: AWS_CUSTOM_CONFIG.aws_appsync_region,\r\n  auth,\r\n  disableOffline: true\r\n};\r\n\r\nconst cache = new InMemoryCache({ addTypename: false });\r\nconst httpLink = createHttpLink({ uri: config.url });\r\n\r\nconst link = ApolloLink.from([\r\n  errorLink,\r\n  jsonLink,\r\n  createAuthLink(config),\r\n  createSubscriptionHandshakeLink(config, httpLink)\r\n]);\r\n\r\nexport const client = new ApolloClient({\r\n  link,\r\n  cache\r\n});\r\n```\r\n\r\nto prevent the resolutions issue and just make things more simple."}},{"node":{"author":{"login":"lenarmazitov"},"body":"@amcdnl why are you refused **createAppSyncLink**?"}},{"node":{"author":{"login":"amcdnl"},"body":"@lenarmazitov - See: https://github.com/awslabs/aws-mobile-appsync-sdk-js#using-authorization-and-subscription-links-with-apollo-client-no-offline-support"}},{"node":{"author":{"login":"lenarmazitov"},"body":"@amcdnl I tested both configs you provided\r\n - the first one with **createAppSyncLink** and **AppSyncClient**.\r\n - the second one with ApolloClient.\r\n\r\nAppSyncClient works fine, I did not notice some troubles so far.\r\nApolloClient: There is one problem with it, I lost ability to upload files via GraphQL like described [here](https://docs.amplify.aws/cli/graphql-transformer/storage) (of course it can uploaded manually with Storage module)\r\n\r\nDid you have some troubles with AppSyncClient or why are you decided to use ApolloClient instead?\r\n\r\n"}},{"node":{"author":{"login":"ChrisSargent"},"body":"I think I am echoing most of the comments here when I say that, since I am already quite confused with a number of amplify vs appsync vs @aws-amplify vs aws-amplify imports vs AWS CDK etc etc.., I would prefer to use a defacto GraphQL client with an already established community and documentation (such as Apollo Client), and for the AWS team to document how to integrate it with the a GraphQL API built using Amplify. At the moment it feels like there is quite a lot of magic going on behind the scenes, which isn't always documented - great for going through tutorials and for when things 'just work' - but incredibly difficult to debug in the other 95% of usage.\r\n\r\nAnd just to say that I do, so far, love using Amplify and to encourage keeping up the good work! :-)"}},{"node":{"author":{"login":"carlosvega20"},"body":"Other way to achieve something similar with small footprint.\r\n\r\n**Query:**\r\n```javascript\r\nimport { API, graphqlOperation } from 'aws-amplify'\r\nimport { listSomething } from 'graphql/query'\r\nimport {useAsync} from 'react-use'\r\n\r\n\r\nconst Demo = () => {\r\n  const {loading, error, value} = useAsync(async () =>\r\n    API.graphql(graphqlOperation(listSomething)) //await client.query({query: gql(listSomething)})\r\n  , [])\r\n\r\n  return (\r\n    <div>\r\n      {loading\r\n        ? <div>Loading...</div>\r\n        : error\r\n          ? <div>Error: {error.message}</div>\r\n          : <div>Value: {JSON.stringify(value)}</div>\r\n      }\r\n    </div>\r\n  )\r\n}\r\n\r\n```\r\n\r\n**Mutation:**\r\n```javascript\r\nimport { API, graphqlOperation } from 'aws-amplify'\r\nimport { createSomething } from 'graphql/mutations'\r\nimport {useAsyncFn} from 'react-use'\r\n\r\n\r\nconst Demo = () => {\r\n  const [{loading, error, value}, mutateFn] = useAsyncFn(async (method, variables) =>\r\n    API.graphql(graphqlOperation(method, variables)) //await client.mutate({mutation: gql(method), variables})\r\n  , [])\r\n\r\n  return (\r\n    <div>\r\n      {loading\r\n        ? <div>Loading...</div>\r\n        : error\r\n          ? <div>Error: {error.message}</div>\r\n          : <div>Value: {JSON.stringify(value)}</div>\r\n      }\r\n      <button onClick={() => mutateFn(createSomething, {input: {a: 10} })}>Create Something</button>\r\n    </div>\r\n  )\r\n}\r\n\r\n```\r\n\r\n\r\n"}},{"node":{"author":{"login":"danigb"},"body":"Following @carlosvega20 suggestion, this is the same with [react-query](https://github.com/tannerlinsley/react-query) (adds cache and other goodies) \r\n\r\nExample in typescript👇\r\n\r\n#### Query\r\n\r\n```ts\r\nimport { API, graphqlOperation } from 'aws-amplify'\r\nimport { useQuery } from \"react-query\";\r\n// those are generated by Amplify\r\nimport { GetPostQuery } from \"../API\";\r\nimport { getPost } from \"../graphql/queries\";\r\n\r\nconst { data: post, isLoading, refetch } = useQuery(\r\n  [\"post\", { id: params.id }],\r\n  async (_, { id }) => {\r\n    const result: any = await API.graphql(graphqlOperation(getPost, { id }));\r\n    return result.data as GetPostQuery;\r\n  }\r\n);\r\n```\r\n\r\n#### Mutation\r\n\r\n```ts\r\nimport { API, graphqlOperation } from 'aws-amplify'\r\nimport { useMutation } from \"react-query\";\r\n// those are generated by Amplify\r\nimport { DeletePostMutationVariables } from \"../API\";\r\nimport { deletePost } from \"../graphql/mutations\";\r\n\r\nconst [deleteGalleryMutation, { isLoading: isDeleting }] = useMutation(\r\n  async (variables: DeletePostMutationVariables) =>\r\n    await API.graphql(graphqlOperation(deletePost, variables))\r\n);\r\n```\r\n"}},{"node":{"author":{"login":"amcdnl"},"body":"Each of these approaches have some downsides, for instance:\r\n\r\n- `useAsyncFn` doesn't have caching, de-duplication, error handling, auth handling, sockets\r\n- `useQuery` is great but doesn't have the native de-duplication / caching that apollo has. It also doesn't have the subscriptions natively either."}},{"node":{"author":{"login":"github-actions"},"body":"This issue has been automatically locked since there hasn't been any recent activity after it was closed. Please open a [new issue](https://github.com/aws-amplify/amplify-js/issues/new?assignees=&labels=&template=1.bug_report.yaml) for related bugs.\n\nLooking for a help forum? We recommend joining the [Amplify Community Discord server](https://discord.com/invite/amplify) `*-help` channels or [Discussions](https://github.com/aws-amplify/amplify-js/discussions) for those types of questions."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb240MDc0","author":{"login":"safwanolaimat"},"title":"Invoke lambda functiona AccessDenied","body":"Hello i have created function using amplify add function\r\n\r\nwhen i call it i recieved \r\n```\r\nAccessDenied\r\nUser: arn:aws:sts::*****:assumed-role/amplify-projectname-22816-authRole/CognitoIdentityCredentials is not authorized to perform: lambda:InvokeFunction on resource: arn:aws:lambda:us-east-1:******:function:test\r\n```\r\ncode:\r\n```\r\nAuth.currentCredentials().then((credentials) => {\r\n      console.log(Auth.essentialCredentials(credentials));\r\n      const lambda = new Lambda({\r\n        credentials: Auth.essentialCredentials(credentials),\r\n        region: \"us-east-1\",\r\n      });\r\n      lambda.invoke(\r\n        {\r\n          FunctionName: \"test\",\r\n          Payload: JSON.stringify({ name: file.name }),\r\n        },\r\n        function (err, data) {\r\n          if (err) {\r\n            console.log(err);\r\n            return;\r\n          }\r\n          console.log(data);\r\n        }\r\n      );\r\n    });\r\n```","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"david-mcafee"},"body":"Hi @safwanolaimat - can you explain a little more about your use case, and what you're trying to accomplish with the lambda function? We have several guides in our docs, with code samples, that may help you address your specific usecase. https://docs.amplify.aws/"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDAw","author":{"login":"BeagleTechno"},"title":"aws s3/ cannot see my images in my app","body":"Hi, I have aws s3 provisioned to my app. I can upload and delete files to my bucket, but I cannot see them on the app (method GET returns an error?). Ideas?\r\nBucket policies, IAM permissions seem to be fine.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"david-mcafee"},"body":"@BeagleTechno what error are you receiving? Have you tried the following?\r\n\r\n```js\r\nasync function fetchFiles() {\r\n    try {\r\n      const result = await Storage.list(\"\");\r\n      setFiles(result);\r\n    } catch (error) {\r\n      console.log(\"error fetching files\", error);\r\n    }\r\n  }\r\n```"}}]}}},{"node":{"id":"D_kwDOBkswNc4AOBEK","author":{"login":"atzawada"},"title":"Additional MFA Security Features","body":"Along the lines of #804, are there any plans to implement more stringent security policies around MFA, as well as the ability to appropriately recover MFA for users who have lost their devices? these seem like standard features that Cognito lacks, seriously affecting the security and usability of Cognito with MFA devices.\r\n\r\nCurrently if you have TOTP MFA set up, you can both reset your password and disable MFA without having to input a TOTP code, which both seem like serious security flaws.\r\n\r\nAlong the same lines, it would be great to allow some kind of recovery method for accounts with MFA enabled when the MFA device has been lost. Potentially something like storable recovery codes would be a good option to have.\r\n\r\nThanks!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AN-Ys","author":{"login":"joelzwarrington"},"title":"[Auth] How to prompt the user for MFA or password when doing actions in frontend after sign in","body":"Hello,\r\n\r\nI hope someone would be able to help clarify how one could prompt the user for their password or for their MFA TOTP once they've already signed in.\r\n\r\nI would like to be able to start an authentication flow when doing high-risk actions which require verification. I can't seem to find anything about this on Cognito or Amplify side of things.\r\n\r\nWould either of you know @chrisbonifacio & @david-mcafee ?","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"ashika01"},"body":"@joelwarrington-jobber You are asking for already signed in user with password or TOTP to reverify their password again for an action?\r\n\r\nIf it is part of authentication lifecycle, you could use lambda triggers, there are different parts here\r\nCognito- https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-user-identity-pools-working-with-aws-lambda-triggers.html\r\nAmplify support - https://docs.amplify.aws/cli/usage/lambda-triggers/\r\n\r\nIf it is not part of auth cycle, just another extra signin introduced. You could use `Auth.confirmSignIn` and confirm sign in again and block the rest of the action based on the success or failure. \r\n\r\nhttps://docs.amplify.aws/lib/auth/mfa/q/platform/js/#advanced-use-cases\r\n\r\nLet us know if it answers your question\r\n"}}]}}},{"node":{"id":"D_kwDOBkswNc4AOAyn","author":{"login":"rosscturner"},"title":"Build environment between branches","body":"I'm hoping this is a simple question but I can't find a good answer anywhere. \r\n\r\nI have a master branch which was bootstrapped with create react app. This has been working and deploying fine for months. \r\n\r\nI've recently decided to port the project to Next JS which I was developing on a separate branch. This has been building fine with SSR pages working correctly. \r\n\r\nHowever, since I started on this I can no longer deploy to my master branch retaining my original setup. It fails at the deploy stage as if it's trying to build a NEXT app. I have a seperate amplify.yml in each of my branches but this makes no difference. I need to continue using the original CRA app while I finish the NEXT migration, how do I do this? Do I need to create a new APP? If so how do I reset my environment to roll back to my original config. \r\n\r\nThanks!\r\n\r\nError I'm getting at the deploy stage:\r\n\r\n2021-11-08T12:35:02 [INFO]: Beginning deployment for application ************, branch:master,  buildId master\r\n2021-11-08T12:35:02 [INFO]: Cannot find any generated SSR resources to deploy. If you intend for your app to be SSR, please check your app Service Role permissions. Otherwise, please check out our docs on how to setup your app to be detected as SSG (https://docs.aws.amazon.com/amplify/latest/userguide/server-side-rendering-amplify.html#deploy-nextjs-app)\r\n2021-11-08T12:35:02 [ERROR]: {\"code\":\"7\",\"message\":\"No ssrResources.json file\"}\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AOAfC","author":{"login":"bojidaryovchev"},"title":"AWS Amplify + Prisma (\"ENOENT: no such file or directory, open '/var/task/chunks/schema.prisma'\")","body":"Hello, so I followed this tutorial [AWS Amplify Next.js SSR](https://docs.amplify.aws/guides/hosting/nextjs/q/platform/js/) and deployed a Next.js app to AWS using Amplify. I added Prisma and it works fine locally, however I am getting this error in the deployed lambda function:\r\n\r\n![prisma](https://user-images.githubusercontent.com/8954749/140654898-1f991fa4-3394-4b04-99e8-c70417bc1f04.png)\r\n\r\nthis is how the deployed lambda function looks like:\r\n\r\n![image](https://user-images.githubusercontent.com/8954749/140654943-acfb1b65-10cc-4295-9a7b-14955e4c29ac.png)\r\n\r\napparently the ```LibraryEngine``` tries to look for ```schema.prisma``` in the ```chunks``` folder but I have no idea how to copy it there.. so I am unable to figure out what should I do to make it work sadly..\r\n\r\nI'd greatly appreciate it if you could help me out\r\n\r\n\r\n\r\n","upvoteCount":6,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDg4ODgz","author":{"login":"thathurtabit"},"title":"GQL Mutations only seems to work once","body":"This is likely a n00b question, but I have a GQL Mutation which works (and updates the values in the datastore), but if I change the mutation values and run it again, nothing changes. Could this be down to cacheing?\r\n\r\n```\r\nmutation MyMutation($input: UpdateShowdownInput!) {\r\n  updateShowdown(input: $input) {\r\n    id\r\n    name\r\n    ...\r\n  }\r\n}\r\n\r\nMutation 1:\r\n{\r\n  \"input\": {\r\n    \"id\": \"xxxxx\",\r\n    \"name\": \"updated name\"\r\n  }\r\n}\r\n\r\n```\r\n\r\nRETURN: `name` is now  \"updated name\"\r\n\r\n```\r\nMutation 2:\r\n{\r\n  \"input\": {\r\n    \"id\": \"xxxxx\",\r\n    \"name\": \"please change again\"\r\n  }\r\n}\r\n```\r\nRETURN: `name` is _still_ \"updated name\"","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"thathurtabit"},"body":"It seems to answer to this is to make sure the current `_version` value is present in the mutation input values, i.e.\r\n\r\n```\r\nmutation MyMutation($input: UpdateShowdownInput!) {\r\n  updateShowdown(input: $input) {\r\n    id\r\n    name\r\n    _version\r\n    ...\r\n  }\r\n}\r\n\r\nMutation 1:\r\n{\r\n  \"input\": {\r\n    \"id\": \"xxxxx\",\r\n    \"name\": \"updated name\",\r\n    \"_version\": \"my_current_version\"\r\n  }\r\n}\r\n```\r\n\r\nAmplify GQL must be using the `_version` value to track changes, if it isn't present, the mutation seems to get ignored (or won't be processed). Hat tip to this comment: https://github.com/aws-amplify/amplify-cli/issues/3237#issuecomment-619359322"}},{"node":{"author":{"login":"thathurtabit"},"body":"There's also this solution which other people have tried, though I have just kept the above: https://github.com/aws-amplify/amplify-cli/issues/3796#issuecomment-607519187"}}]}}},{"node":{"id":"D_kwDOBkswNc4AOAMk","author":{"login":"leonardocfor"},"title":"Import from multiple schema.graphql","body":"Hi guys,\r\n\r\nI'm wondering if it is possible to split a very complex schema.graphql file in multiple .grapql files and importing some how in schema.graphql. I've been googling around and having found something clear enough. If this is actually possible could you please point to the corresponding documentation or ideally an example? \r\n\r\nthank you,","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AN-0N","author":{"login":"phaedonmit"},"title":"DataStore blocked by firewall","body":"I am using DataStore to set up a database for our application. When a user logs in all the requests/updates to the database work as expected. However, when the user is logging in from a device that is behind a corporate firewall, they can log in but the database does not get downloaded and synced.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AN7dA","author":{"login":"sergeyjsg"},"title":"Is there IN operator?","body":"Is there IN operator in Amplify Datastore? How to use it?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"ashika01"},"body":"If you are asking for that in the predicates, these are the supported one at the moment\r\n\r\nhttps://docs.amplify.aws/lib/datastore/data-access/q/platform/js/#predicates"}}]}}},{"node":{"id":"D_kwDOBkswNc4AN-fr","author":{"login":"24jr"},"title":"Build sveltekit adapter","body":"For sveltekit I'm at a point I would like to publish an aws amplify site and the build fails.  I need to use something called an adapter to build the app before that and I found https://github.com/sveltejs/kit/tree/master/packages/adapter-node seems to be what I should use however `npm run build` fails from aws problems like `> 'request' is not exported by __vite-browser-external, imported by node_modules/@aws-sdk/credential-provider-imds/dist/es/remoteProvider/httpRequest.js`  will this not work with aws or i just need to do something differently","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"24jr"},"body":"actually this is covered here and seems to be ongoing but perhaps being worked on issue https://github.com/aws/aws-sdk-js/issues/3673"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMTc5","author":{"login":"jasper72"},"title":"How to position sign in screen","body":"I'm migrating my app to the new framework. Previously the signing screen centred itself. Now it squashes into the top left corner.\r\n\r\nI've tried wrapping it in a div to add margin but then my app has the margin as well.\r\n\r\nWhat is the best approach for recovering the previous behaviour?\r\n![squashed](https://user-images.githubusercontent.com/939156/81696950-82c3e600-945c-11ea-8e58-9a278ada8e56.png)\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"david-mcafee"},"body":"@jasper72 - please see [this guide](https://docs.amplify.aws/ui/auth/authenticator/q/framework/react/#props-css-amplify-authenticator), and let me know if you need further help!"}}]}}},{"node":{"id":"D_kwDOBkswNc4AN1Vf","author":{"login":"Jun711"},"title":"How to configure AWS IoT PubSub Timeout?","body":"Hi, I followed this [documentation](https://docs.amplify.aws/lib/pubsub/getting-started/q/platform/js/) to set up PubSub. It seems to work fine for now.\r\n\r\nQuestions\r\n1) what is the max connection timeout is?  I can't find it in the documentation / aws console.\r\n2) Is it configurable? \r\n\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"ashika01"},"body":"@Jun711 to answer your question the best, can you provide more info on what provider you are using? and why are you interested in the maxTimeout? What is your use case?"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xODUxODM2","author":{"login":"slimandslam"},"title":"36 vulnerabilities after npm install","body":"After I did an \"npm install aws-amplify --save\", npm now reports \"36 low severity vulnerabilities\".\r\nIs this a known problem? I can't see what's causing it. The audit results seem unclear as to the origin of the issues. Here's my package.json:\r\n\r\n```\r\n{\r\n  \"name\": \"MYapp\",\r\n  \"version\": \"0.4.0\",\r\n  \"private\": true,\r\n  \"dependencies\": {\r\n    \"aws-amplify\": \"^3.3.14\",\r\n    \"react\": \"^17.0.1\"\r\n  },\r\n  \"scripts\": {\r\n    \"start\": \"react-scripts start\",\r\n    \"build\": \"react-scripts build\",\r\n    \"test\": \"react-scripts test\",\r\n    \"eject\": \"react-scripts eject\"\r\n  },\r\n  \"browserslist\": {\r\n    \"production\": [\r\n      \">0.2%\",\r\n      \"not dead\",\r\n      \"not op_mini all\"\r\n    ],\r\n    \"development\": [\r\n      \"last 1 chrome version\",\r\n      \"last 1 firefox version\",\r\n      \"last 1 safari version\"\r\n    ]\r\n  }\r\n}\r\n```","upvoteCount":6,"comments":{"edges":[{"node":{"author":{"login":"alditis"},"body":"I have the same problem. \r\nAny suggestions please?"}},{"node":{"author":{"login":"david-mcafee"},"body":"Related issue: https://github.com/aws-amplify/amplify-js/issues/7583"}},{"node":{"author":{"login":"sammartinez"},"body":"Since this is related to the issue customers brought up, we will be tracking the progress there. "}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNzUxOA==","author":{"login":"rohit8"},"title":"Async Lambda Resolver in GraphQL API","body":"Hi,\r\nIs there any way to use the `@function` directive to create a GQL API resolver that executes a lambda function asynchronously in the background and returns an immediate response? Specifically execute a lambda function similar to this way: https://docs.aws.amazon.com/apigateway/latest/developerguide/set-up-lambda-integration-async.html\r\n","upvoteCount":3,"comments":{"edges":[{"node":{"author":{"login":"eugen-maser"},"body":"> Hi, Is there any way to use the `@function` directive to create a GQL API resolver that executes a lambda function asynchronously in the background and returns an immediate response? Specifically execute a lambda function similar to this way: https://docs.aws.amazon.com/apigateway/latest/developerguide/set-up-lambda-integration-async.html\r\n\r\nHi @rohit8 \r\nDid you find a solution for that case?"}}]}}},{"node":{"id":"D_kwDOBkswNc4AN_1C","author":{"login":"kannieWeesNie"},"title":"Update DataStore item using AWS-SDK DynamoDBClient","body":"I am using DataStore and would like some advice with the following:\r\n\r\nCan I update a DynamoDB item by directly accessing the DynamoDB item in the table using the AWS-SDK DynamoDBClient?\r\n\r\nI have set the DataStore configuration for maxRecordsToSync to 100 items however, I would like to be able to retrieve and update items that are not synced to the local database.\r\n\r\nI am aware that the _version, updatedAt and _lastChangedAt fields probably need to be altered if/when updating the item using the DynamoDBClient\r\n\r\nSo can I update the item like this or is there a better way of doing it?\r\n\r\nThanks","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AN7Qh","author":{"login":"coe720"},"title":"Help with imgprops in AmplifyS3Image","body":"Hi! I'm working with AmplifyS3Image from @aws-amplify/ui-react and I'm a bit confused on what the \"imgProps\" prop is expecting. I'm just trying to set the width of the image to 100% and I've tried both \r\n`<AmplifyS3Image\r\n     imgKey={key}\r\n     imgProps={{\"width\": \"100%\"}}\r\n />`\r\n\r\nAs well as:\r\n\r\n`<AmplifyS3Image\r\n     imgKey={key}\r\n     imgProps={{\"--width\": \"100%\"}}\r\n />`\r\n\r\nNeither of which are setting the width of the underlying img component.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"david-mcafee"},"body":"Hey @coe720, thanks for starting this discussion! \r\n\r\n[Here's the documentation on the component / imgProps](https://docs.amplify.aws/ui/storage/s3-image/q/framework/react/#props-attr-amplify-s3-image). There's a link to MDN that further explains how to use the attributes.\r\n\r\nInstead of passing the css properties as a prop, you can set the css of the component as explained under `Custom CSS Properties` in the docs linked above. Example: \r\n\r\n```js\r\namplify-s3-image {\r\n  --width: 400px;\r\n}\r\n```\r\n\r\nHope this helps!"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNjI1Mg==","author":{"login":"cgorrieri"},"title":"What is the recommended way to call AppSync GraphQL endpoint from a function","body":"Hello,\r\n\r\nI am building an app where I need to run a few checks before letting a user add an entity for example.\r\nTo do so, I added a function triggered by a qraphql query that will pull data from the graphql api and do the checks before running the mutation to add the entity.\r\n\r\nLooking at the online resources, I found so many different ways to call the graphql endpoint that I am not sure which one is the recommended way. I see multiple options in the official docs https://docs.amplify.aws/cli/function (with axios and https), and I have seen others resources using the AWSAppSyncClient or fetch. Also, I see in the documentation the use of IAM or API key for the function.\r\n\r\n**Which client solution is the most recommended to implement and what kind of auth do you use for your functions?**\r\n\r\nThank you for your help.\r\nCheers,\r\nCyril","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"jesuscovam"},"body":"Hey I wanted to know if you reached a conclusion about this??\r\n\r\nI'm using axios because I want the same function to work on nodejs | web | React native.\r\nMaybe the API that comes from 'aws-amplify' package works in those 3 but I'm not sure.\r\nAnd from that I'm only doing requests that are signed with the API KEY, because I don't know\r\nhow to do it with COGNITO user pols ore IAM with axios...\r\n\r\nbut it goes like this \r\n\r\n```\r\n const result = await axios({\r\n      url: config?.endpoint || process.env.API_SLISSTO_GRAPHQLAPIENDPOINTOUTPUT,\r\n      method: 'post',\r\n      headers: {\r\n        'x-api-key':\r\n          config?.apiKey || process.env.API_SLISSTO_GRAPHQLAPIKEYOUTPUT,\r\n      },\r\n      data: {\r\n        query,\r\n        variables,\r\n      },\r\n    })\r\n```"}}]}}},{"node":{"id":"D_kwDOBkswNc4ANzcm","author":{"login":"slynn100"},"title":"Debugging and Tracing Amplify.PubSub","body":"- \r\n- \r\n- Hi Team,\r\n- \r\n- i've gone trhoug the pubsub guide at \r\n- https://docs.amplify.aws/lib/pubsub/getting-started/q/platform/js/\r\n- \r\n- \r\n- \r\n- -------------------------\r\n- For now, I've given full permissions on the Policy:\r\n- {\r\n- \"Version\": \"2012-10-17\",\r\n- \"Statement\": [\r\n- {\r\n- \"Effect\": \"Allow\",\r\n- \"Action\": \"iot:\",\r\n- \"Resource\": \"\"\r\n- }\r\n- ]\r\n- }\r\n- -------------------------\r\n- \r\n- In my code , i have the following:\r\n- \r\n- \r\n- =========\r\n-   await PubSub.subscribe('test/SOMETHING_CHANGED').subscribe({\r\n-               next: data => console.log('Message received', data),\r\n-               error: error => console.error('ERROR  !')              \r\n-             });\r\n-             await PubSub.publish('test/SOMETHING_CHANGED', { msg: 'Hello Testing!' });\r\n- =========\r\n- \r\n- The pubsub statement appears to succeed. (Code execution continues and no error message generated.)\r\n- \r\n- However nothing arrives on the topic on AWS. Have checked the CloudWatch logs - nothing is visible there with regard to mqtt messages \r\n- \r\n- \r\n- ( I've hada successful Storage.put call with a file arriving on s3 -i believe\r\n- all is ok with the cognito user... https://docs.amplify.aws/lib/storage/getting-started/q/platform/js/   ) \r\n-  \r\n- \r\n- \r\n- Please can you give me some pointers on how to retrieve some  error/tracing information on the PubSub issue.\r\n- \r\n- \r\n- \r\n- Thanks\r\n- \r\n- Stephen","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"slynn100"},"body":"Issue appears to be due to conflicting versions of amplify"}}]}}},{"node":{"id":"D_kwDOBkswNc4AN6mQ","author":{"login":"Jack-Huskinson"},"title":"Is it possible to use Datastore subscriptions to execute a function when a specified field was changed?","body":"In my project I am wanting to run a function when a certain field of a data model is changed/updated.\r\n\r\nThis is the subscription I have made currently and it returns when the data is updated, but it does this when any of the fields change.\r\n> useEffect(() => {\r\n    const subscriptions = wishList.map(wlp =>\r\n      DataStore.observe(Product, wlp.productID).subscribe(msg => {\r\n        if (msg.opType === 'UPDATE') {\r\n          console.log('Made an update to Product');\r\n        }\r\n      }),\r\n    );\r\n    return () => {\r\n      subscriptions.forEach(sub => sub.unsubscribe());\r\n    };\r\n  }, [wishList]);\r\n\r\nI have looked around through the docs and cant seem to find anything but I was wondering if there was a way to only have it returned if a certain field was changed.\r\n\r\nIf it is not possible with Datastore then any other method to do this is appreciated.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AN6k-","author":{"login":"hoan-pham-duy"},"title":"How client to do Graphql subcription with a provided token","body":"Hi everyone, \r\nCurrently, I get a problem when designing a system that client needs to watch real-time graph from Amplify Backend with a provided token (client didn't log in with AWS Cognito)\r\nHere are the steps I want:\r\nStep 1: Client requires to subscribe data of graph with a provided token.\r\nStep 2: Backend checks the token is legit or not and accepts the connection.\r\nStep 3: Any modified data in backend data will be notified to the client\r\nStep 4: The client will upload the graph.\r\n\r\nCurrently, my design is client sends REST APIs each period to get data with provided token and the backend must check provided token each period. \r\nIt had disadvantages because the client always send requests to the back-end.\r\nI try to make the client do GraphQL subscription data from the backend with provided token but can't think any solution can handle it.\r\n\r\nHope so much for your suggestion!\r\nThank you so much for your help!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AN6kO","author":{"login":"maxludovicohofer"},"title":"Geo: calculate route","body":"Is it possible to leverage the new Geo functionality to calculate distance\\route (time) between two points on a map? Since this is an Amazon Location Service feature (https://docs.aws.amazon.com/location/latest/developerguide/calculate-route.html), I would love to have it also with Amplify.","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AN58W","author":{"login":"anjali89r"},"title":"Web notification support","body":"Hi, \r\nI'm trying to implement web notification on our application. We use amplify and Cognito for the authentication and is interested to know if Amplify support web push notification. I do see in the documentation where it talks about service workers, but my question can AWS pinpoint be used as a web notification provider or the notification is only supported for mobile apps.\r\nDoc referred:\r\nhttps://docs.amplify.aws/lib/utilities/serviceworker/","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AN56v","author":{"login":"bronz3son"},"title":"Auth.signOut opens Expo web browser (React Native)","body":"Hello, I am trying to get Federated sign in to work with my Expo project (React Native).\r\n\r\nI was looking at this issue https://github.com/aws-amplify/amplify-js/issues/7213 (I have the same issue but that's not the point of this question), and I see that the expected flow is to open the web browser on sign out. \r\n \r\nFor me, my sign out button works and correctly signs the user out, but then tries to open the web browser again. I don't see why it needs to do this, and I see in other apps, this doesn't happen.\r\nIs there some way to not open the web browser on sign out? ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMDIyMQ==","author":{"login":"jhw"},"title":"Does Amplify currently support authorization code grant workflow + hosted UI ?","body":"I'm looking to implement the Cognito authorization code grant workflow with the Cognito hosted UI, using Amplify.\r\n\r\nThere's a good example here\r\n\r\nhttps://github.com/arronharden/cognito-demo-ui\r\n\r\nwhich uses the npm `amazon-cognito-auth-js` package and specifically a method called `CognitoAuth.parseCognitoWebResponse` to exchange the `code` value returned by the hosted UI for (JWT) `id/access/refresh_tokens`.\r\n\r\nNow this works fine but I'm a bit concerned about using `amazon-cognito-auth-js` as it seems to have been archived / made read only / generally end-of-life'd / assimulated into the Amplify borg lol :-)\r\n\r\nhttps://github.com/amazon-archives/amazon-cognito-auth-js\r\n\r\nBut browsing the Amplify Auth code\r\n\r\nhttps://github.com/aws-amplify/amplify-js/blob/main/packages/auth/src/Auth.ts\r\n\r\nI can't find anything which calls `/oauth2/token` (which `CognitoAuth.parseCognitoWebResponse` does under the hood)\r\n\r\nDoes Amplify currently support authorization code grant workflow + hosted UI, or not ? And if so, which methods should I be looking at ?\r\n","upvoteCount":4,"comments":{"edges":[{"node":{"author":{"login":"ume-benard"},"body":"Also curious about this."}}]}}},{"node":{"id":"D_kwDOBkswNc4AN5yw","author":{"login":"philohelp"},"title":"\"You may only supply one @key\": why that ?","body":"Sorry if the question has already been asked but I got `InvalidDirectiveError: You may only supply one @key with the name 'byProfile' on type 'Article'` \r\n\r\nI used to do that in my former graphql schema and it was handy:\r\n\r\nFor ex. a Facebook post is reposted by a user. It has an owner (the one who shares the post) and an original author (the one who wrote it in the first place). I'd wish I could do something like:\r\n\r\n````\r\n{\r\ntitle: \"FW: Cats are evil\",\r\ncontent: \"Let me explain why\",\r\nauthor:\"joe_Who_Doesnt_Like_Cats_Id\",\r\nowner:\"bernard_Who_Shares_The_Post_Id\r\n}\r\n````","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AN5Mt","author":{"login":"T-DiegoF"},"title":"How can I limit an email that has only one cognito user associated with it?","body":"Currently, by default, cognito allows creating several users with the same email and I would like to have a relationship of one to one, email-user.","upvoteCount":0,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AN27f","author":{"login":"cfbo"},"title":"Implementing a sharing functionality (authorization)","body":"Does anyone have some feedback on how to implement a **sharing functionality** and how to do this using Amplify with Datastore / AppSync.\r\n\r\nBasically we need to implement a feature where a user can share an item they have created with other users. \r\n\r\nI have read https://docs.aws.amazon.com/appsync/latest/devguide/security-authorization-use-cases.html, but I was wondering if I could implement something similar using @auth as presented below.\r\n\r\nI have written an example of a possible approach with fake types. It would be great to get some inputs on it or have someone share their approach to this problem.\r\n```\r\ntype Item\r\n  @model\r\n  @auth(\r\n    rules: [\r\n      { allow: owner, operations: [create, update, delete, read] }\r\n    ]\r\n  ) {\r\n  id: ID!\r\n  title: String!\r\n  owner: String\r\n  description: String\r\n}\r\n\r\ntype SharedItem\r\n  @model\r\n  @auth(\r\n    rules: [\r\n      { allow: owner, operations: [create, update, delete, read] }\r\n      {\r\n        allow: owner\r\n        ownerField: \"sharedWithEmailReadOnly\"\r\n        identityClaim: \"email\"\r\n        operations: [read]\r\n      }\r\n      {\r\n        allow: owner\r\n        ownerField: \"sharedWithEmailReadWrite\"\r\n        identityClaim: \"email\"\r\n        operations: [update, read]\r\n      }\r\n    ]\r\n  ) {\r\n  id: ID!\r\n  itemId: ID!\r\n  item: Item @connection(fields: [\"itemId\"])\r\n  owner: String\r\n  sharedWithEmailReadOnly: String\r\n  sharedWithEmailReadWrite: String\r\n  sharedAt: AWSDateTime!\r\n}\r\n```\r\n\r\nAs a start we were actually thinking of implementing just an option to share via a link, and that would be \"view only\".. but how can I model this case in graphql?\r\nThe Item is only accessible to the owner. I guess I could use the SharedItem, but how can I modify it to handle the \"anyone\" case, which means I don't have an email to add?\r\nI guess I could create another type SharedWithAnyoneItem\r\n```\r\ntype SharedWithAnyoneItem\r\n  @model\r\n  @auth(\r\n    rules: [\r\n      { allow: private, operations: [read] }\r\n      { allow: owner, operations: [create, update, delete, read] }\r\n    ]\r\n  ) {\r\n  id: ID!\r\n  itemId: ID!\r\n  item: Item @connection(fields: [\"itemId\"])\r\n  owner: String\r\n  sharedAt: AWSDateTime!\r\n}\r\n```\r\nDoes it makes sense? Would that work?\r\n\r\nMy stack: React / Amplify with Datastore / API AppSync, Cognito, etc.\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"evcodes"},"body":"Check out @renegoretzka Gist: https://gist.github.com/renegoretzka/9ed754c4463b19c883ff8c98492ee5fe"}}]}}},{"node":{"id":"D_kwDOBkswNc4AN2Jb","author":{"login":"man517"},"title":"Add Item to DynamoDB Table and Propagate Change to AWS Amplify","body":"I have an AWS Amplify project that is using DataStore and I'm trying to add multiple items to a table. I've tried using DynamoDB and the put_item() method to add the items like this:\r\n```\r\nclient = boto3.client('dynamodb')\r\nresponse = client.put_item(\r\n    Item={\r\n        'AlbumTitle': {\r\n            'S': 'Somewhat Famous',\r\n        },\r\n        'Artist': {\r\n            'S': 'No One You Know',\r\n        },\r\n        'SongTitle': {\r\n            'S': 'Call Me Today',\r\n        },\r\n    },\r\n    ReturnConsumedCapacity='TOTAL',\r\n    TableName='Music',\r\n)\r\n```\r\nI'm able to successfully add items to my table in DynamoDB; however, the added items don't show up when looking at the table's items through Admin UI. Any tips?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AN1vP","author":{"login":"spormeon"},"title":"loads of lambda functions and don't know whats what","body":"I setup a few apps, then deleted a few apps, leaving the one that I'm working on but there are now loads of lambda functions and I have no clue which ones relate to the app thats still running , so as I can delete the others, there is no ref number or anything that relates to the running app.  Anyone help with this ( i've been asked to post here from the Amplify discord)\r\n![Functions_-_Lambda](https://user-images.githubusercontent.com/8503167/137538641-e7b1ec0d-fd73-49e8-993a-d3f106bc6f7a.png)\r\n\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AN1Ou","author":{"login":"kchangch"},"title":"How to get authentication code grant from amplify signin","body":"Hi, Im trying to get the authorization code grant from amplify signin to use it for a SSO to a third platform page (no the social media ones from AWS docs). Is there a way to get this from amplify authenticator? It seems that the only way is using AWS Cognito Hosted UI.\r\n\r\nAny help would be great.","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AN1GB","author":{"login":"MaxOrelus"},"title":"Does amplify require having public buckets for the deployment and the build?","body":"Hi, \r\n\r\nWhen you set up amplify for a project, it creates an initial bucket containing:\r\n\r\n- current-cloud-backend.zip\r\n- amplify-meta.json\r\n- hooks/\r\n- nested-cloudformation-stack.yml\r\n\r\nThis bucket that contains this has \"Block all public access\" all turned off.\r\n\r\nAlso, when you successfully complete a build it creates an additional bucket with your deployed application. This bucket also has \"Block all public access\" all turned off with a policy that only allows cloudfront getObject permissions into the bucket.\r\n\r\nFor amplify to work correctly, does it need these buckets to be public or is there a strategy to actually have these buckets private?\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4AN0D8","author":{"login":"271915902"},"title":"How to  set user attributes during sign up, with UI component <SignUp/> with react native","body":"in react i can use  this to set attributes , but i do not know how to set in react native UI component\r\n\r\n\r\n<AmplifySignUp\r\n      handleSignUp={handleSignUp}\r\n        />\r\n\r\n const handleSignUp = async (formData) => {\r\n    try {\r\n      console.log(\"handle\");\r\n      const param = {\r\n        ...formData,\r\n        attributes: {\r\n          ...formData.attributes,\r\n          \"custom:phoneNumber\": \"111\",\r\n          \"custom:notifications\": \"222\",\r\n        },\r\n      };\r\n      const data = await Auth.signUp(param);\r\n      return data;\r\n     } catch (error) {\r\n       console.log(error)\r\n     }","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4ANzwV","author":{"login":"menkari"},"title":"Multiple IAM User roles","body":"I've come across a situation where I'm using amplify with the following configuration: \r\n\r\n- There is an unauth section of the storefront using IAM as the provider to access data via AppSync.\r\n\r\nThis unauth section is capable of read-only access to a particular model. This is defined via the `schema.graphql` in my `~amplify/...` folder as\r\n\r\n`{allow: public, operations: [read], provider: iam}`\r\n\r\nHowever I also have a lambda trigger attached to dynamodb stream to interpret INSERT streams. This lambda function has the ability to update the model based on certain parameters. The problem is that the IAM user that makes the changes CANNOT update the model as the rules defined in the schema prohibit this.\r\n\r\nI've reviewed my IAM configurations and there is indeed 2 separate IAM users - both with the correct permissions for accessing the particular types in AppSync, however no matter what the setup, the appsync schema has `@aws_iam` specified and seems to default to the permissions outlined in the `schema.graphql`\r\n\r\nSo here's my question: How do you facilitate unauthed permissions on say a frontend website, granting readonly permissions to IAM and also having IAM users on the backend to perform update/delete/create functions on the same AppSync types in lambda? They both use IAM but it seems you cannot specify specific IAM users for specific tasks.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4ANzu5","author":{"login":"mojodna"},"title":"How do I access `region` with a `MapStyle`?","body":"`Geo.getDefaultMap()` returns a `MapStyle`, which does not include `region`. `AmazonLocationServiceMapStyle` extends `MapStyle` to introduce `region`, but the only way to get an `AmazonLocationServiceMapStyle` is via [`AmazonLocationServiceProvider`](https://github.com/aws-amplify/amplify-js/blob/e2788723edad3a798720982d6fba14e3f0e20e4a/packages/geo/src/Providers/AmazonLocationServiceProvider.ts), which must be constructed explicitly. Given the existence of the [`Geo` singleton](https://github.com/aws-amplify/amplify-js/blob/e2788723edad3a798720982d6fba14e3f0e20e4a/packages/geo/src/index.ts#L1), I would expect the preferred access model to be through that.\r\n\r\nFurthermore, `AmazonLocationServiceProvider`'s constructor expects a [`GeoConfig`](https://github.com/aws-amplify/amplify-js/blob/e2788723edad3a798720982d6fba14e3f0e20e4a/packages/geo/src/types/Geo.ts#L14-L26), which [doesn't match the shape of the config created by `amplify add geo`](https://github.com/aws-amplify/amplify-cli/issues/8405).\r\n\r\nComplicating things even more, `AmazonLocationServiceProvider` must be imported via `@aws-amplify/geo/lib/Providers/AmazonLocationServiceProvider`.\r\n\r\nWhat is the recommended pattern for using Geo with Amazon Location?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4ANyds","author":{"login":"homosape"},"title":"Translate variables in aws-amplify i18n","body":"Hi, I've just started using i18n in my React Native app and everything seems to work just fine.\r\n\r\nOne question though, how would one translate variables using i18n:\r\n\r\nOption 1:\r\n<img width=\"620\" alt=\"Screenshot 2021-10-08 at 13 25 48\" src=\"https://user-images.githubusercontent.com/70649220/136532366-dd17096f-04fb-42e1-a1fe-e7199fe1b787.png\">\r\n\r\nOption 2:\r\n<img width=\"656\" alt=\"Screenshot 2021-10-08 at 13 26 57\" src=\"https://user-images.githubusercontent.com/70649220/136532497-05b33188-e505-43c6-88ef-470130fe175f.png\">\r\n\r\nWhich one is optimal way? \r\n\r\nPlease note that reminder here is always a number.\r\n\r\nAlso, how to translate if reminder is not a number but dynamically generated text.\r\n\r\nExample: if reminder = 10 generated text would be \"10 is too short\" or \"10 is too much\" etc.\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMTI4OA==","author":{"login":"ajay-wohlig"},"title":"Auth.updateUserAttributes()  vuex mutation  error","body":"I am using aws amplify with vuex in nuxt. \r\nOn calling Auth.updateUserAttributes() is giving me a successfull response but it's also gives me the,\r\n[vuex] do not change vuex store state outside mutation handler, even though I am not doing any mutation\r\n\r\n\r\n```\r\nexport default state = () =>({\r\nuser: {} \r\n//CognitoUser data\r\n}) \r\n\r\nexport default actions = {\r\nasync updateUserAttribute(_, data), {\r\nvar user = data.user\r\nvar params = data. params \r\nawait Auth.updateUserAttributes(user, \r\nparams )\r\n} \r\n} \r\n\r\n```\r\n\r\nThis is not the exact same code I have written, \r\nBut I think the problem lies with the aws amplify trying to manipulate the user state where  CognitoUser is saved ","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"dacarva"},"body":"I am having the same issue here. Can somebody give some light on this?"}},{"node":{"author":{"login":"khanguslee"},"body":"Would also like to know how to solve this. Thanks in advance."}},{"node":{"author":{"login":"abelant"},"body":"I have the same issue with signOut() method\r\n\r\nIt throws a mutation error when I try to Sign Out.\r\n\r\nWould like to know if there is some kind of solution ."}}]}}},{"node":{"id":"D_kwDOBkswNc4ANxDJ","author":{"login":"ysuzuki19"},"title":"[api-graphql] would like to use private method in typescript.","body":"`API.graphql()` is hard to use with typescript. Because return type is `Promise<GraphQLResult> | Observable<object>` ([link](https://github.com/aws-amplify/amplify-js/blob/bd528c7c2d65a7476bd8601d7f3f135d1a24fd53/packages/api-graphql/src/GraphQLAPI.ts#L220)). In this implementation, we must check type for using `then()`/`catch()`😭.\r\nFor use this method, \r\n\r\nSo I would like to use two methods following.\r\n\r\n[private async _graphql()](https://github.com/aws-amplify/amplify-js/blob/bd528c7c2d65a7476bd8601d7f3f135d1a24fd53/packages/api-graphql/src/GraphQLAPI.ts#L265)\r\n[private _graphqlSubscribe()](https://github.com/aws-amplify/amplify-js/blob/bd528c7c2d65a7476bd8601d7f3f135d1a24fd53/packages/api-graphql/src/GraphQLAPI.ts#L367)\r\n\r\nI think that by using these methdos, we can resolve  #6369 and #7589 cleary and easily.\r\n\r\nHow about this?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4ANxAF","author":{"login":"hpatel-vohra"},"title":"Is it possible to use AWS amplify with Xamarin forms?","body":"Is it possible to use AWS amplify with Xamarin forms?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4ANvnF","author":{"login":"suparerkk"},"title":"how to prevent endpoint from update userid on app launch","body":"I'm using react-native here, the situation is that every times you open. the app, amplify will update my endpoint userid to cognito identity and my push notification will stop working at that moment until i update it again with my userid\r\n\r\nand here the issue is that user can close my app and my update endpoint userid function will not gonna fire, result in user will not receive any notification.\r\n\r\nso the question is can i prevent the auto update endpoint ?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4ANvVu","author":{"login":"Kumar-Aakash"},"title":"Amplify Storage put and S3 ManageUpload","body":"Hello AWS team,\r\n\r\nI'm a bit confused as to the usage for Storage put and S3 SDK. I will try to explain everything in detail as possible. I am using Angular 8 application.\r\n\r\nOur existing implementation is working fine with the usage of S3.ManageUpload for uploading the photos/doc. Here is a code snippet for the config part that we have been using.\r\n\r\nFor Amplify configure code, we have this.\r\n\r\n```\r\nimport Amplify from 'aws-amplify';\r\nAmplify.configure({\r\n  Auth: {\r\n    identityPoolId: '*******',\r\n    region: '******',\r\n    identityPoolRegion: '*******',\r\n    userPoolId: '*******',\r\n    userPoolWebClientId: '*******',\r\n    authenticationFlowType: 'USER_PASSWORD_AUTH'\r\n  }\r\n});\r\n```\r\n\r\nWhen app gets initialize we have this.\r\n\r\n```\r\nimport Amplify from 'aws-amplify';\r\n\r\nAmplify.configure({\r\n                Auth: data,\r\n                Storage: {\r\n                    AWSS3: {\r\n                        bucket: this.bucket,\r\n                        region: localStorage.getItem('region'),\r\n                    }\r\n                }\r\n            });\r\n```\r\n\r\nWhen we are using S3 for the upload like this:\r\n\r\n```\r\nimport * as S3 from 'aws-sdk/clients/s3';\r\nconst upload = new S3.ManagedUpload({\r\n                    partSize: 5 * 1024 * 1024, queueSize: 10,\r\n                    params: {\r\n                        Bucket: BucketName,\r\n                        Key: Key, // This contains the path including the filename. example- See the attached image 1\r\n                        Body: file,\r\n                        ContentType: file.type\r\n\r\n                    },\r\n                    tags: tagObject\r\n                }).on('httpUploadProgress', function (evt) {\r\n                    const uploaded = Math.round(evt.loaded / file['size'] * 100);\r\n                    that.setProgressValue(uploaded);\r\n                });\r\n                const promise = upload.promise();\r\n\r\n```\r\n\r\nNow when I use S3.ManageUpload, my network PUT call looks like this:\r\n\r\n**`https://bucketName.s3.us-east-2.amazonaws.com/photos/9979789080/alexandr-bormotin-UmzV-gKPx6I-unsplash.jpg`**\r\n\r\nFor the above, when promise returns data, Response data looks like this:\r\n![S3-ManageUpload](https://user-images.githubusercontent.com/31201591/135520799-2011c24f-125c-4e64-9e67-c392eabeb29c.PNG)\r\n\r\nAnd above all look fine. You have a bucket name and private location where photos are getting uploaded. In the above snap, it is: photos/9979789080/alexandr-bormotin-UmzV-gKPx6I-unsplash.jpg \r\n\r\n------------------------------------------------------\r\n\r\nNow let's come to Storage.\r\n\r\nThis is how Storage put code looks:\r\n\r\n```\r\nreturn new Promise((resolve, reject) => {\r\n      const customPrefix = {\r\n        private: uploadPath  // Same path as S3 path -\"photos/9979789080/\"\r\n      };\r\n      Storage.put(filename, file, { /// filename  - alexandr-bormotin-UmzV-gKPx6I-unsplash.jpg\r\n        progressCallback(progress) {\r\n          const value = Math.round(progress.loaded / progress.total * 100);\r\n        },\r\n        contentType: contentType,\r\n        level: 'private',\r\n        customPrefix: customPrefix  // For customize path\r\n      }).then((result: any) => {\r\n        console.log('Success result =>', result);\r\n        // Need to resolve a promise here\r\n        resolve({ status: true, uploadedKey: result.key });\r\n\r\n      }).catch((err) => {\r\n        // Need to add a debug alert here\r\n        // Need to reject a promise here\r\n        reject(false);\r\n\r\n      });\r\n    });\r\n```\r\n\r\nNow when I use Storage.put, my network PUT call looks like this:\r\n\r\n**`https://bucketName.s3.us-east-2.amazonaws.com/photos/9979789080/us-east-2%3Aa7feb7eb-ef12-4c60-8119-06617e5f998b/alexandr-bormotin-UmzV-gKPx6I-unsplash.jpg`**\r\n\r\nI believe \"us-east-2%3Aa7feb7eb-ef12-4c60-8119-06617e5f998b\" is something called identity id. \r\n\r\nResponse for Storage.put look like this:\r\n![image](https://user-images.githubusercontent.com/31201591/135522171-f55e3755-baf7-43f9-a6e0-72201a61d307.png)\r\n\r\n\r\n\r\nNotice the difference between NETWORK  HTTP PUT CALL for both S3.ManageUpload and Storage.put:\r\n\r\nS3.ManageUpload - **`https://bucketName.s3.us-east-2.amazonaws.com/photos/9979789080/alexandr-bormotin-UmzV-gKPx6I-unsplash.jpg`**\r\n\r\nStorage.put - **`https://bucketName.s3.us-east-2.amazonaws.com/photos/9979789080/us-east-2%3Aa7feb7eb-ef12-4c60-8119-06617e5f998b/alexandr-bormotin-UmzV-gKPx6I-unsplash.jpg`**\r\n\r\n---------------------------------------------------------------------------------\r\n\r\nI know it's been a long question but here are my questions.\r\n\r\n- Both are working fine for upload but how can I get result output the same as what I am getting in S3.ManageUpload because that's how I have been processing other work in my application like using ETAG.\r\n- Why we have two different kind of HTTP PUT call. Storage.put method adds \"us-east-2%3Aa7feb7eb-ef12-4c60-8119-06617e5f998b\" extra.\r\n- Stupid question, both methods in the above case uploading photos in the same directory called \"photos/9979789080\" ? \r\n- Which one to use based on the performance or they both are equal?\r\n- I like Storage Amplify better and the team suggested using this and remove all S3.ManageUpload but making sure desired results are the same.\r\n\r\nPlease let me know your answers. Thanks in advance.\r\n\r\n/Aakash\r\n\r\n","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4ANvMa","author":{"login":"istashak"},"title":"Geo.searchByText --> [Error: URL.hostname is not implemented]","body":"In my React Native app when I call:\r\n\r\n```\r\ntry{\r\n   let result = await Geo.searchByText('<Address String>');\r\n} catch(error) {\r\n   console.error(error);\r\n}\r\n```\r\n\r\nI get the following error:\r\n\r\n[Error: URL.hostname is not implemented]\r\n\r\nI've manually set up a Place index from the AWS Management Console.\r\nI've configured both my authorized and unauthorized Identity Pool Roles to allow for access to it through the prescribed inline policy.\r\nI've added the appropriate Amplify.configure() additions:\r\n\r\n```\r\nAmplify.configure({\r\n...\r\ngeo: {\r\n    amazon_location_service: {\r\n      search_indices: {\r\n        items: ['MyPlaceIndex'], // REQUIRED - Amazon Location Service Place Index name\r\n        default: 'MyPlaceIndex', // REQUIRED - Amazon Location Service Place Index name to set as default\r\n      },\r\n      region: 'us-east-1', // REQUIRED - Amazon Location Service Region\r\n    },\r\n});\r\n```\r\n\r\nAny ideas what I may be missing?\r\nThanks.\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4ANsO6","author":{"login":"wjureczka"},"title":"How to detect the provider which user have used to log in?","body":"Hi there! Thanks for your work!\r\n\r\nI have no idea how to check where the user logged in from. \r\n\r\nCase: \r\nI have a settings page where users can change their passwords. As far as I know, it is possible if a user is logged in via email and password, but not via a social provider. I would like to hide a password change section when a user is logged in via a social provider. How to check that?","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"noahking27"},"body":"I got it this way in my app. I use google and linkedin and can tell between the three login types with the code below.\r\n\r\n```\r\n  const getLoginType = identities => {\r\n    const parsedIdentities = identities ? JSON.parse(identities) : [{ providerName: 'Local' }];\r\n\r\n    return parsedIdentities[0].providerName;\r\n  };\r\n      \r\n      const { attributes } = await Auth.currentAuthenticatedUser();\r\n      getLoginType(attributes.identities)\r\n```"}}]}}},{"node":{"id":"D_kwDOBkswNc4ANs58","author":{"login":"webdog-rich"},"title":"Using @auth owner directive with federatedSignIn","body":"I have set up federated sign-in for my app using the capacitor plugin https://github.com/capacitor-community/facebook-login and call `Auth.federatedSignIn()` as per the below. This logs my user in with a federated identity. This is great, but it means I cannot use `@auth(rules: [{ allow: owner }])` in my graphql schema. Is there any way to create a user in the userpool when calling `Auth.federatedSignIn()`? I know that calling `Auth.federatedSignIn({ provider: \"Facebook\" })` and using the hosted UI works like this, but I do not want to redirect my user to a browser/chrome tab to sign in. I would like the authentication to be provided by the native functionality provided by the above capacitor plugin.\r\n\r\nUsing the federated identity allows me to restrict access to my graphql schema using IAM: `@auth(rules: [{ allow: private, provider: iam }])` but this is limited to private and public rules. I want to limit the graphql api so that users can see only their own entries with functionality like `@auth(rules: [{ allow: owner }])`. \r\n\r\nMaybe I am going about this the wrong way? I'm stumped. Any help is appreciated. Thanks.\r\n\r\n```javascript\r\nconst FBLogIn = async () => {\r\n    const result = await FacebookLogin.login({ permissions: FACEBOOK_PERMISSIONS });\r\n    const { email } = await FacebookLogin.getProfile({ fields: ['email'] });\r\n   \r\n    try {\r\n      const userDetails = await Auth.federatedSignIn(\"facebook\", { token: result.accessToken.token, expires_at: result.accessToken.expires }, { name: result.accessToken.userId, email: email })\r\n      \r\n    } catch (error) {\r\n      console.log(error)\r\n    }\r\n  }\r\n```","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4ANsnQ","author":{"login":"cshenrik"},"title":"How to use DataStore with an exising backend?","body":"I'm a serverless developer that is trying to get my head around how I make best use of Amplify DataStore.\r\n\r\nI'm used to manage all my cloud resources with AWS SAM. Here I have my DynamoDB table definitions, api gateway, lambda functions etc. The clients that are accessing my api gateway are web applications that are expected to always be online, as well as third parties that expect a REST-like api.\r\n\r\nNow I'm writing a mobile app which should use the existing backend. The app needs to work while being offline, so I am looking into ways of syncing data to the mobile device. That's why I stumbled upon Amplify DataStore. It solves a lot of the syncing problems, but in return it seems to take over the ownership of e.g. the DynamoDB table.\r\n\r\nMy DynamoDB table follows a single-table design, where I carefully structure my data according to the queries. For this reason I have a hard time seeing how DataStore will be able to take ownership of my DynamoDB table.\r\n\r\nEven if I went with DataStore and accepted that it manages my DynamoDB table, I'm not sure how I would use the table from my existing Lambda functions. I mean, with DataStore there's a sync table and a main table, and I suppose it's not the intention that my lambda function should be concerned with that.\r\n\r\nSo to sum up, I'm looking for advice on how to make best use of Amplify DataStore if I'm not willing to let go of the control of my existing cloud resources.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4ANsgg","author":{"login":"runzun1987"},"title":"Amplify Flutter and Amplify React same project different result","body":"I am working on a project where I have completed my website through React JS. Now I am working on developing App using flutter. All backend are done using aws amplify. While working on flutter I am facing strange issue. When I am querying the aws Table in flutter I am getting empty list, as there are data on that table, query same table on React works and working till now.\r\n\r\nSo I planned to create some test file to check what the issue so I create test flutter project and test react project .\r\n\r\nI will add the code down below\r\n\r\n. After doing the test I came to know that, data I save from flutter can be only queried using flutter and data saved in react can only queried through react as it is same table, same region ,every thing is same. Why is this strange behaviour .\r\n\r\n\r\n\r\n![https://i.stack.imgur.com/QK9t0.png](https://i.stack.imgur.com/QK9t0.png)\r\n\r\n![https://i.stack.imgur.com/nlt2g.png](https://i.stack.imgur.com/nlt2g.png)\r\n\r\nAs you can see query same table but results are different and flutter created data is not showing up in react app and even here ![https://i.stack.imgur.com/FfYQC.png](https://i.stack.imgur.com/FfYQC.png)\r\n\r\nCode of flutter are as below: Main.dart :\r\n\r\n```\r\nimport 'package:amplify_datastore/amplify_datastore.dart';\r\nimport 'package:amplify_flutter/amplify.dart';\r\nimport 'package:flutter/material.dart';\r\nimport 'package:my_app/amplifyconfiguration.dart';\r\n\r\nimport 'models/ModelProvider.dart';\r\nimport 'screens/homepage.dart';\r\n\r\nFuture<void> main() async {\r\n  WidgetsFlutterBinding.ensureInitialized();\r\n  await configureAmplify();\r\n  runApp(MyApp());\r\n}\r\n\r\nFuture<void> configureAmplify() async {\r\n  Amplify.addPlugin(AmplifyDataStore(modelProvider: ModelProvider.instance));\r\n  try {\r\n    await Amplify.configure(amplifyconfig);\r\n  } catch (e) {\r\n    print(\"Amplify is alreay configured\");\r\n  }\r\n}\r\n\r\nclass MyApp extends StatelessWidget {\r\n  // This widget is the root of your application.\r\n\r\n  @override\r\n  Widget build(BuildContext context) {\r\n    return MaterialApp(\r\n      title: 'Flutter Demo',\r\n      theme: ThemeData(\r\n        // This is the theme of your application.\r\n        //\r\n        // Try running your application with \"flutter run\". You'll see the\r\n        // application has a blue toolbar. Then, without quitting the app, try\r\n        // changing the primarySwatch below to Colors.green and then invoke\r\n        // \"hot reload\" (press \"r\" in the console where you ran \"flutter run\",\r\n        // or simply save your changes to \"hot reload\" in a Flutter IDE).\r\n        // Notice that the counter didn't reset back to zero; the application\r\n        // is not restarted.\r\n        primarySwatch: Colors.blue,\r\n      ),\r\n      home: HomePage(),\r\n    );\r\n  }\r\n}\r\n```\r\nHomePage:\r\n\r\n```\r\nimport 'package:amplify_flutter/amplify.dart';\r\nimport 'package:flutter/cupertino.dart';\r\nimport 'package:flutter/material.dart';\r\n\r\nimport 'package:my_app/models/Person.dart';\r\n\r\nclass HomePage extends StatelessWidget {\r\n  Future<void> initTodos() async {\r\n    final model = Person(name: \"runzun\");\r\n    await Amplify.DataStore.save(model);\r\n    final persons = await Amplify.DataStore.query(Person.classType);\r\n    print(persons);\r\n    print('======================');\r\n  }\r\n\r\n  @override\r\n  Widget build(BuildContext context) {\r\n    return Scaffold(\r\n      appBar: AppBar(\r\n        title: Text('Hello'),\r\n      ),\r\n      body: Center(\r\n        child: GestureDetector(\r\n            onTap: () async {\r\n              await initTodos();\r\n              // var todos = Todo(name: \"runzun\", description: \"this is a blog\");\r\n              // await Amplify.DataStore.save(todos);\r\n            },\r\n            child: Text('Add todos')),\r\n      ),\r\n    );\r\n  }\r\n}\r\n```\r\nmodels: ModelProvider.dart\r\n\r\n```\r\n/*\r\n* Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\").\r\n* You may not use this file except in compliance with the License.\r\n* A copy of the License is located at\r\n*\r\n*  http://aws.amazon.com/apache2.0\r\n*\r\n* or in the \"license\" file accompanying this file. This file is distributed\r\n* on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\r\n* express or implied. See the License for the specific language governing\r\n* permissions and limitations under the License.\r\n*/\r\n\r\n// ignore_for_file: public_member_api_docs\r\n\r\nimport 'package:amplify_datastore_plugin_interface/amplify_datastore_plugin_interface.dart';\r\nimport 'Person.dart';\r\n\r\nexport 'Person.dart';\r\n\r\nclass ModelProvider implements ModelProviderInterface {\r\n  @override\r\n  String version = \"115942e9588e46ca9df7bb771727f5c7\";\r\n  @override\r\n  List<ModelSchema> modelSchemas = [Person.schema];\r\n  static final ModelProvider _instance = ModelProvider();\r\n\r\n  static ModelProvider get instance => _instance;\r\n  \r\n  ModelType getModelTypeByModelName(String modelName) {\r\n    switch(modelName) {\r\n    case \"Person\": {\r\n    return Person.classType;\r\n    }\r\n    break;\r\n    default: {\r\n    throw Exception(\"Failed to find model in model provider for model name: \" + modelName);\r\n    }\r\n    }\r\n  }\r\n}\r\n```\r\nPerson.dart:\r\n\r\n```\r\n/*\r\n* Copyright 2021 Amazon.com, Inc. or its affiliates. All Rights Reserved.\r\n*\r\n* Licensed under the Apache License, Version 2.0 (the \"License\").\r\n* You may not use this file except in compliance with the License.\r\n* A copy of the License is located at\r\n*\r\n*  http://aws.amazon.com/apache2.0\r\n*\r\n* or in the \"license\" file accompanying this file. This file is distributed\r\n* on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either\r\n* express or implied. See the License for the specific language governing\r\n* permissions and limitations under the License.\r\n*/\r\n\r\n// ignore_for_file: public_member_api_docs\r\n\r\nimport 'package:amplify_datastore_plugin_interface/amplify_datastore_plugin_interface.dart';\r\nimport 'package:flutter/foundation.dart';\r\n\r\n\r\n/** This is an auto generated class representing the Person type in your schema. */\r\n@immutable\r\nclass Person extends Model {\r\n  static const classType = const _PersonModelType();\r\n  final String id;\r\n  final String? _name;\r\n  final String? _des;\r\n\r\n  @override\r\n  getInstanceType() => classType;\r\n  \r\n  @override\r\n  String getId() {\r\n    return id;\r\n  }\r\n  \r\n  String get name {\r\n    try {\r\n      return _name!;\r\n    } catch(e) {\r\n      throw new DataStoreException(DataStoreExceptionMessages.codeGenRequiredFieldForceCastExceptionMessage, recoverySuggestion: DataStoreExceptionMessages.codeGenRequiredFieldForceCastRecoverySuggestion, underlyingException: e.toString());\r\n    }\r\n  }\r\n  \r\n  String? get des {\r\n    return _des;\r\n  }\r\n  \r\n  const Person._internal({required this.id, required name, des}): _name = name, _des = des;\r\n  \r\n  factory Person({String? id, required String name, String? des}) {\r\n    return Person._internal(\r\n      id: id == null ? UUID.getUUID() : id,\r\n      name: name,\r\n      des: des);\r\n  }\r\n  \r\n  bool equals(Object other) {\r\n    return this == other;\r\n  }\r\n  \r\n  @override\r\n  bool operator ==(Object other) {\r\n    if (identical(other, this)) return true;\r\n    return other is Person &&\r\n      id == other.id &&\r\n      _name == other._name &&\r\n      _des == other._des;\r\n  }\r\n  \r\n  @override\r\n  int get hashCode => toString().hashCode;\r\n  \r\n  @override\r\n  String toString() {\r\n    var buffer = new StringBuffer();\r\n    \r\n    buffer.write(\"Person {\");\r\n    buffer.write(\"id=\" + \"$id\" + \", \");\r\n    buffer.write(\"name=\" + \"$_name\" + \", \");\r\n    buffer.write(\"des=\" + \"$_des\");\r\n    buffer.write(\"}\");\r\n    \r\n    return buffer.toString();\r\n  }\r\n  \r\n  Person copyWith({String? id, String? name, String? des}) {\r\n    return Person(\r\n      id: id ?? this.id,\r\n      name: name ?? this.name,\r\n      des: des ?? this.des);\r\n  }\r\n  \r\n  Person.fromJson(Map<String, dynamic> json)  \r\n    : id = json['id'],\r\n      _name = json['name'],\r\n      _des = json['des'];\r\n  \r\n  Map<String, dynamic> toJson() => {\r\n    'id': id, 'name': _name, 'des': _des\r\n  };\r\n\r\n  static final QueryField ID = QueryField(fieldName: \"person.id\");\r\n  static final QueryField NAME = QueryField(fieldName: \"name\");\r\n  static final QueryField DES = QueryField(fieldName: \"des\");\r\n  static var schema = Model.defineSchema(define: (ModelSchemaDefinition modelSchemaDefinition) {\r\n    modelSchemaDefinition.name = \"Person\";\r\n    modelSchemaDefinition.pluralName = \"People\";\r\n    \r\n    modelSchemaDefinition.addField(ModelFieldDefinition.id());\r\n    \r\n    modelSchemaDefinition.addField(ModelFieldDefinition.field(\r\n      key: Person.NAME,\r\n      isRequired: true,\r\n      ofType: ModelFieldType(ModelFieldTypeEnum.string)\r\n    ));\r\n    \r\n    modelSchemaDefinition.addField(ModelFieldDefinition.field(\r\n      key: Person.DES,\r\n      isRequired: false,\r\n      ofType: ModelFieldType(ModelFieldTypeEnum.string)\r\n    ));\r\n  });\r\n}\r\n\r\nclass _PersonModelType extends ModelType<Person> {\r\n  const _PersonModelType();\r\n  \r\n  @override\r\n  Person fromJson(Map<String, dynamic> jsonData) {\r\n    return Person.fromJson(jsonData);\r\n  }\r\n}\r\n```\r\n\r\n\r\n\r\n\r\n```\r\nbackend schema.graphql:\r\n\r\ntype Person @model {\r\n  id: ID!\r\n  name: String!\r\n  des: String\r\n}\r\n```\r\n\r\n\r\n\r\n\r\n\r\nReact JS app: index.js\r\n```\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\nimport Amplify from 'aws-amplify';\r\nimport aws_exports from './../src/aws-exports';\r\nAmplify.configure(aws_exports);\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n\r\nreportWebVitals();\r\napp.js:\r\n\r\nimport logo from './logo.svg';\r\nimport './App.css';\r\nimport { useEffect } from 'react';\r\nimport { API, graphqlOperation } from 'aws-amplify';\r\nimport { listPeople } from './graphql/queries';\r\nimport { createPerson } from './graphql/mutations';\r\nfunction App() {\r\n  useEffect(() => {\r\n    const test = async () => {\r\n      try {\r\n        await API.graphql(\r\n          graphqlOperation(createPerson, {\r\n            input: {\r\n              name: 'runzun Node',\r\n            },\r\n          })\r\n        );\r\n        const result = await API.graphql(graphqlOperation(listPeople));\r\n        console.log(result);\r\n      } catch (err) {\r\n        console.log(err);\r\n      }\r\n\r\n      // const peopleList = result.data.listPeople;\r\n    };\r\n\r\n    test();\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <header className=\"App-header\">\r\n        <img src={logo} className=\"App-logo\" alt=\"logo\" />\r\n        <p>\r\n          Edit <code>src/App.js</code> and save to reload.\r\n        </p>\r\n        <a\r\n          className=\"App-link\"\r\n          href=\"https://reactjs.org\"\r\n          target=\"_blank\"\r\n          rel=\"noopener noreferrer\"\r\n        >\r\n          Learn React\r\n        </a>\r\n      </header>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n```\r\ngraphql Query :\r\n\r\n```\r\n/* eslint-disable */\r\n// this is an auto generated file. This will be overwritten\r\n\r\nexport const getPerson = /* GraphQL */ `\r\n  query GetPerson($id: ID!) {\r\n    getPerson(id: $id) {\r\n      id\r\n      name\r\n      des\r\n      createdAt\r\n      updatedAt\r\n    }\r\n  }\r\n`;\r\nexport const listPeople = /* GraphQL */ `\r\n  query ListPeople(\r\n    $filter: ModelPersonFilterInput\r\n    $limit: Int\r\n    $nextToken: String\r\n  ) {\r\n    listPeople(filter: $filter, limit: $limit, nextToken: $nextToken) {\r\n      items {\r\n        id\r\n        name\r\n        des\r\n        createdAt\r\n        updatedAt\r\n      }\r\n      nextToken\r\n    }\r\n  }\r\n`;\r\n```\r\ngraphql Mutation:\r\n\r\n```\r\n/* eslint-disable */\r\n// this is an auto generated file. This will be overwritten\r\n\r\nexport const createPerson = /* GraphQL */ `\r\n  mutation CreatePerson(\r\n    $input: CreatePersonInput!\r\n    $condition: ModelPersonConditionInput\r\n  ) {\r\n    createPerson(input: $input, condition: $condition) {\r\n      id\r\n      name\r\n      des\r\n      createdAt\r\n      updatedAt\r\n    }\r\n  }\r\n`;\r\nexport const updatePerson = /* GraphQL */ `\r\n  mutation UpdatePerson(\r\n    $input: UpdatePersonInput!\r\n    $condition: ModelPersonConditionInput\r\n  ) {\r\n    updatePerson(input: $input, condition: $condition) {\r\n      id\r\n      name\r\n      des\r\n      createdAt\r\n      updatedAt\r\n    }\r\n  }\r\n`;\r\nexport const deletePerson = /* GraphQL */ `\r\n  mutation DeletePerson(\r\n    $input: DeletePersonInput!\r\n    $condition: ModelPersonConditionInput\r\n  ) {\r\n    deletePerson(input: $input, condition: $condition) {\r\n      id\r\n      name\r\n      des\r\n      createdAt\r\n      updatedAt\r\n    }\r\n  }\r\n`;\r\n```\r\nbackend schema.graphql\r\n\r\n```\r\ntype Person @model {\r\n  id: ID!\r\n  name: String!\r\n  des: String\r\n}\r\n```","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xODIx","author":{"login":"Jun711"},"title":"Social Federated Login and currentAuthenticatedUser vs currentUserInfo","body":"I noticed that after social sign-in, currentAuthenticatedUser returns `CognitoUser` but currentUserInfo return an empty object `{}`.  \r\n\r\n**Describe the issue**\r\nAfter social login, currentAuthenticatedUser returns CognitoUser but currentUserInfo returns empty object\r\n\r\nThe social sign-in doc does only uses currentAuthenticatedUser as an example. https://docs.amplify.aws/lib/auth/social/q/platform/js#setup-frontend\r\n\r\nAfter turning on debug, I noticed that I need another scope permission.\r\n\r\n```\r\n{code: \"NotAuthorizedException\", name: \"NotAuthorizedException\", message: \"Access Token does not have required scopes\"}\r\ncode: \"NotAuthorizedException\"\r\nmessage: \"Access Token does not have required scopes\"\r\nname: \"NotAuthorizedException\"\r\n__proto__: Object\r\n``\r\n\r\n![Screen Shot 2020-04-23 at 1 34 28 PM](https://user-images.githubusercontent.com/6880939/80146755-2cebd480-8567-11ea-807f-2a5d182d8cfe.png)\r\n\r\n**Questions**\r\n1 What scope do I need to call currentUserInfo? \r\n2 Is there a map of functions and scopes?\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n\r\n1. social login e.g. Google login\r\n2. call currentAuthenticatedUser and currentUserInfo\r\n3. currentAuthenticatedUser returns CognitoUser but currentUserInfo returns an empty object\r\n\r\n**Code Snippet**\r\nPlease provide a code snippet or a link to sample code of the issue you are experiencing to help us reproduce the issue. (Be sure to remove any sensitive data)\r\n```\r\nAuth.currentAuthenticatedUser()\r\n      .then(user => console.log('currentAuthenticatedUser', user))\r\n      .catch(() => console.log(\"Not signed in\")\r\n\r\nAuth.currentUserInfo()\r\n      .then(user => console.log('currentUserInfo', user))\r\n      .catch(() => console.log(\"Not signed in\"));\r\n```\r\n\r\n\r\n","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"LOMFM"},"body":"I have same issue with this.\r\n\r\nI have integrated the social provider with the user pool.\r\n\r\n`Auth.federatedSignIn('google', {token, expire_at}, user)`\r\nI have implemented the sign in using above function.\r\n\r\nBut I can get the full user infomation.\r\nThis function returns following values.\r\n`Auth.currentAuthenticatedUser(data => {console.log(data)}).catch(err => {});`\r\n\r\n```\r\noutput: \r\nemail: \"\",\r\nid: \"identity-id\"\r\n```\r\n\r\nBut I want the same result with the normal signIn.\r\n```\r\n{\r\n   userSession: {\r\n    token: {}\r\n  },\r\n  userAttributes: [\r\n...\r\n  ]\r\n}\r\n```\r\n\r\n\r\nThere is no method???"}},{"node":{"author":{"login":"PabloLION"},"body":"# REPOSTING ISSUE\r\n(for a correct format)\r\n\r\nI noticed that after social sign-in, currentAuthenticatedUser returns `CognitoUser` but currentUserInfo return an empty object `{}`.\r\n\r\n**Describe the issue**\r\nAfter social login, currentAuthenticatedUser returns CognitoUser but currentUserInfo returns empty object\r\nThe social sign-in doc does only uses currentAuthenticatedUser as an example. https://docs.amplify.aws/lib/auth/social/q/platform/js#setup-frontend\r\nAfter turning on debug, I noticed that I need another scope permission.\r\n```\r\n{code: \"NotAuthorizedException\", name: \"NotAuthorizedException\", message: \"Access Token does not have required scopes\"}\r\ncode: \"NotAuthorizedException\"\r\nmessage: \"Access Token does not have required scopes\"\r\nname: \"NotAuthorizedException\"\r\n__proto__: Object\r\n```\r\n![Screen Shot 2020-04-23 at 1 34 28 PM](https://user-images.githubusercontent.com/6880939/80146755-2cebd480-8567-11ea-807f-2a5d182d8cfe.png)\r\n**Questions**\r\n1 What scope do I need to call currentUserInfo? \r\n2 Is there a map of functions and scopes?\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n1. social login e.g. Google login\r\n2. call currentAuthenticatedUser and currentUserInfo\r\n3. currentAuthenticatedUser returns CognitoUser but currentUserInfo returns an empty object\r\n**Code Snippet**\r\nPlease provide a code snippet or a link to sample code of the issue you are experiencing to help us reproduce the issue. (Be sure to remove any sensitive data)\r\n```\r\nAuth.currentAuthenticatedUser()\r\n.then(user => console.log('currentAuthenticatedUser', user))\r\n.catch(() => console.log(\"Not signed in\")\r\nAuth.currentUserInfo()\r\n.then(user => console.log('currentUserInfo', user))\r\n.catch(() => console.log(\"Not signed in\"));\r\n```\r\n\r\n"}}]}}},{"node":{"id":"D_kwDOBkswNc4ANqyq","author":{"login":"babaralishah"},"title":"Changing lambda layer version from console resulted in code not working","body":"When we changed the version from AWS console, our whole code stopped working.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4ANoyY","author":{"login":"zhenyamarinovich"},"title":"Shorter manual setup code for AWS Amplify Cognito TOTP setup","body":"We are using Amplify, Cognito and Angular to build a login workflow. During setup of TOTP, we show a QR code to the user.\r\n\r\nAs good practice, we also want to allow the user to manually enter a \"setup code\" in case they can't use the QR code.\r\n\r\nI can't really find any specific documentation on this, but it seems like some people suggest having a \"Copy to Clipboard\" button, that copies the result of Auth.setupTOTP() so that it can then be copied into Google Authenticator or Authy, or whatever the user is using to manage their MFA.\r\n\r\nThe problem is that:\r\n\r\nUsers typically setup TOTP on their desktop computer, with a cellphone as their two factor authentication. Therefore the 'Copy to Clipboard' technique is useless. They have to manually type in the code.\r\nThe code is 52 characters long! No one in their right mind will want to type in 52 characters.\r\nIs there a way to get a shorter code, e.g. up to 16 characters?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4ANorP","author":{"login":"v-raja"},"title":"Generating API key for customer to consume GraphQL API externally","body":"I'd like to create an API key for each customer that lets them consume my AppSync GraphQL API using that key. From what I understand, this is a common use case which is described [here](https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-scenarios.html#scenario-api-gateway).\r\n\r\nWhat I don't understand, however, is how to manage the issuing of the API key. What can I call to generate an API key for a user? Is it possible to issue an API key that never expires?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4ANoBV","author":null,"title":"Getting DataStore updates to the UI without using a reactive framework","body":"How do we get changes to the UI without using a reactive framework? Delta Sync + hybrid auth, so users don't see changes they aren't authorized for? How do we get alerts when there are new items available in the Delta Sync table, an infinite loop in the browser that checks?\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"D_kwDOBkswNc4ANnud","author":{"login":"andy-HM"},"title":"Amplify Predictions & Content Moderation","body":"Hello, \r\n\r\nI am using Amplify to build an application where I need to provide content moderation.  I have added predictions to my application and have this working successfully.  However, I am wondering why the Predictions.identify.labels does not include detecting inappropriate content.  It will return a simple boolean of \"unsafe\" but it does not return any labels discussed under the [Moderating Content within AWS Rekognition](https://docs.aws.amazon.com/rekognition/latest/dg/moderation.html#moderation-api).  \r\n\r\nTo be clear, I have been working with the Amplify Predictions referenced [here](https://docs.amplify.aws/lib/predictions/label-image/q/platform/js/).\r\n\r\nMy questions are:\r\n\r\n- What is the difference (if any) between the two?\r\n- How can i get the content moderation labels specified [here](https://docs.aws.amazon.com/rekognition/latest/dg/moderation.html#moderation-api)?\r\n- If these are separate, is there a reason for the separation?  I am confused why I would have to make separate calls to specific content moderation.  The Amplify Predictions seems well suited for this.\r\n\r\nThank you.","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTY5NDcy","author":{"login":"s1mrankaur"},"title":"cognito token revocation through Amplify","body":"Can anyone on this thread confirm that \"Amazon Cognito now supports token revocation and Amplify (from version 4.1.0) will revoke Amazon Cognito tokens if the application is online.\" as per here actually works? After upgrading amplify/auth to\r\n\r\nnpm i aws-amplify@4.1.0\r\nnpm i @aws-amplify/auth\r\n\r\nthere is no invalidation.\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTY5MzEw","author":{"login":"jesuscovam"},"title":"Using Appsync with axios","body":"Hello, I wanted to know if a can add the JWT token from CognitoUser as a header\r\nin a axios.post to send queries and mutations ?\r\n\r\nAt the moment I do mutations with the API KEY like this:\r\n```\r\n  const result = await axios({\r\n      url: config?.endpoint || process.env.API_SLISSTO_GRAPHQLAPIENDPOINTOUTPUT,\r\n      method: 'post',\r\n      headers: {\r\n        'x-api-key':\r\n          config?.apiKey || process.env.API_SLISSTO_GRAPHQLAPIKEYOUTPUT,\r\n      },\r\n      data: {\r\n        query,\r\n        variables,\r\n      },\r\n    })\r\n```\r\n\r\nAnd I would like to know if these could also be extended to use IAM Auth?\r\n\r\nThanks in advance to anyone with the time to help me!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTE4OTUy","author":{"login":"valin0k"},"title":"Amplify.configure storage - issue with Android while authorization","body":"hey guys, i want to use MMKV storage with amplify and add my own storage class\r\n```\r\nimport Amplify, { Auth } from 'aws-amplify';\r\nimport aws_exports from 'src/aws-exports';\r\nimport Analytics from '@aws-amplify/analytics';\r\nimport MmkvStorage from 'mmkvStorage';\r\n\r\nconst config = {\r\n  ...aws_exports,\r\n  graphql_headers: async () => {\r\n    try {\r\n      const token = (await Auth.currentSession()).getIdToken().getJwtToken();\r\n      return { Authorization: token };\r\n    } catch (e) {\r\n      return {};\r\n    }\r\n  },\r\n  Auth: {\r\n    storage: MmkvStorage, // <- this line\r\n  },\r\n\r\n  PushNotification: {\r\n    appId: aws_exports.aws_mobile_analytics_app_id,\r\n    requestIOSPermissions: false,\r\n  },\r\n};\r\nAmplify.configure(config);\r\n\r\nAnalytics.configure(aws_exports);\r\n\r\n```\r\nfor iOS it working well, but Android throws an error while authorization `[ERROR] 14:54.437 AuthClass - Failed to get the signed in user [TypeError: Cannot read property 'length' of undefined]`. Any examples of how to fix it?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"hkjpotato"},"body":"Hi, are you looking for a different storage provider (other than AWS S3)? If so, you can refer to https://docs.amplify.aws/lib/storage/getting-started/q/platform/js/#using-a-custom-plugin to add a plugin."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTY2NTg3","author":{"login":"vthukral94"},"title":"What's the utility of function-parameters.json generated for lambda functions?","body":"This file is located at `amplify/backend/function/<name>/src/function-parameters.json`. \r\nI have a hunch that it could be used for mocking. But, couldn't find any documentation or pointers to do so.\r\n\r\nThanks","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTY1OTk0","author":{"login":"slikk66"},"title":"Amplify Storage - cant retrieve browser uploaded files as Administrator","body":"Hi - I've given up on using the Amplify CLI and the frontend/backend automation.  I am using Pulumi to do all of my backend work and deploying to s3 using code bulid including Cognito, Dynamo, AppSync, Lambda etc.\r\n\r\nBut, I've been still using the Amplify JS SDK in my app taking advantage of that side of things using a manually configured `aws-exports.js` file.\r\n\r\nI have recently been working with Storage. I have my app now uploading items to S3 using storage eg: `await Storage.put(fileId, file, {});`\r\n\r\nI can also retrieve the files from the app.  The thing is, my other AWS users (including `Administrator` role) are not able to download the files that Amplify uploads.  It seems like Amplify must be setting some DENY rules in the uploaded file.\r\n\r\nI get this when trying to download or view permissions on a file:\r\n\r\n````\r\nYou don’t have permission to get object ACL\r\nAfter you or your AWS administrator have updated your permissions to allow the s3:GetObjectAcl action, refresh the page. \r\nAPI response\r\nAccess Denied\r\n````\r\nor from CLI:\r\n````\r\naws s3 cp s3://my-bucket/public/8a44ec17-4993-4f1a-8dcb-399e32c0ff4e .\r\nfatal error: An error occurred (403) when calling the HeadObject operation: Forbidden\r\n````\r\n\r\nIs this a known thing that Amplify adds DENY to all other users except somehow through the same method to put it (such as cognito) ?\r\n\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"slikk66"},"body":"OK, so what I think has happened here is that I'm using a centralized Cognito in another account to grant access to this app (and several others) which is then uploading to a bucket into the account/bucket where the app is running.  I have a bucket policy on the bucket in the app account that allows uploads from the Cognito account ID.\r\n\r\nThis seems to be the problem however: https://aws.amazon.com/premiumsupport/knowledge-center/s3-bucket-owner-access/\r\n\r\nSeems like the object owner needs to grant ACL access to `--acl bucket-owner-full-control` meaning the Cognito account would need to add that permission of \"bucket owner has control\" at time of upload.  I'm guessing that this is probably not something Amplify supports.. not from what I've seen.\r\n\r\nAm I stuck here?"}},{"node":{"author":{"login":"slikk66"},"body":"Ah! Well that was easy.. answer staring right in face..  The docs \r\n\r\n````\r\n            await Storage.put(fileId, file, {\r\n                acl: \"bucket-owner-full-control\",\r\n            });\r\n````\r\n\r\nThe docs mention `public-read` as an option, but apparently the other built-ins work as well.  Cool!"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMjUwNg==","author":{"login":"ethiers"},"title":"How I can get the value of the form","body":"Hi everyone,\r\n\r\nI'm trying to figure out how I can get the value of the form, and to pass to API Auth.sign as parameters. Thank you.  \r\n\r\nI'm working with Angular 10.\r\n\r\n```\r\n    \"@aws-amplify/auth\": \"^3.3.3\",\r\n    \"@aws-amplify/ui-angular\": \"^0.2.13\",\r\n    \"@aws-amplify/ui-components\": \"^0.6.0\",\r\n```\r\n\r\n\r\n**login.component.html**\r\n\r\n```\r\n<amplify-authenticator [handleAuthStateChange]=\"handleAuthStateChange\">\r\n<amplify-sign-in\r\n    headerText=\"{{title}}\"\r\n    submitButtonText=\"{{submitButtonText}}\"\r\n    [handleSubmit]=\"handleSubmit\"\r\n    slot=\"sign-in\"\r\n    [formFields]=\"formFields\">\r\n  </amplify-sign-in>\r\n</amplify-authenticator> \r\n```\r\n\r\n\r\n**login.components.ts**\r\n```\r\nexport class LoginComponent implements OnInit {\r\n  handleAuthStateChange = this._handleAuthStateChange.bind(this);\r\n  handleSubmit = this._handlerSubmit.bind(this);\r\n  formFields: FormFieldTypes;\r\n  ...\r\n```\r\n\r\n```\r\npublic _handlerSubmit(event: Event): void {\r\n    console.log('handler Submit', event, this);\r\n    event.preventDefault();\r\n\r\n    Auth.signIn('**[getUsername]**', **'[getPassword]**').then((value: CognitoUser) => {\r\n      console.log('SIGN IN', value);\r\n    }).catch(err => {\r\n      console.error('SIGN ERROR', err);\r\n    });\r\n  }\r\n```","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"datarster"},"body":"Hello @ethiers Any luck? I am also looking for an answer. I also do the same step with Angular 10 and Amplify."}},{"node":{"author":{"login":"ethiers"},"body":"yes, you can get this values from the \"**handleInputChange**\" callback. When the input is modified by the user, try to grab the values and set them into an object like this.inputs.username and this.inputs.password...\r\n\r\nPlease see this example made with React, you can inspire of that for the Angular code. \r\nhttps://blog.kylegalbraith.com/2020/03/31/customizing-the-aws-amplify-authentication-ui-with-your-own-react-components/"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTU5OTMz","author":{"login":"ntmk"},"title":"TypeError: Cannot read properties of undefined (reading 'association')","body":"I have just updated my packages and it has resulted in the following error. If anyone has any ideas let me know! \r\n\r\nAmplify project with React\r\n\r\n-  \"@aws-amplify/api\": \"^4.0.13\",\r\n-  \"@aws-amplify/auth\": \"^4.3.3\",\r\n-  \"@aws-amplify/core\": \"^4.2.7\",\r\n-  \"@aws-amplify/datastore\": \"^3.4.1\",\r\n\r\n```\r\nstorage.ts:327 Uncaught (in promise) TypeError: Cannot read properties of undefined (reading 'association')\r\n    at storage.ts:327\r\n    at Array.forEach (<anonymous>)\r\n    at e.getUpdateMutationInput (storage.ts:325)\r\n    at storage.ts:124\r\n    at Array.forEach (<anonymous>)\r\n    at e.<anonymous> (storage.ts:114)\r\n    at 2.d88a823a.chunk.js:2\r\n    at Object.next (2.d88a823a.chunk.js:2)\r\n    at a (2.d88a823a.chunk.js:2)\r\n(anonymous) @ storage.ts:327\r\ne.getUpdateMutationInput @ storage.ts:325\r\n(anonymous) @ storage.ts:124\r\n(anonymous) @ storage.ts:114\r\n(anonymous) @ 2.d88a823a.chunk.js:2\r\n(anonymous) @ 2.d88a823a.chunk.js:2\r\na @ 2.d88a823a.chunk.js:2\r\nPromise.then (async)\r\nvalue @ EditExperience.js:418\r\n(anonymous) @ EditExperience.js:1145\r\nvo @ react-dom.production.min.js:131\r\nus @ react-dom.production.min.js:212\r\nwc @ react-dom.production.min.js:255\r\nt.unstable_runWithPriority @ scheduler.production.min.js:19\r\nYi @ react-dom.production.min.js:122\r\n_c @ react-dom.production.min.js:248\r\nsc @ react-dom.production.min.js:239\r\n(anonymous) @ react-dom.production.min.js:123\r\nt.unstable_runWithPriority @ scheduler.production.min.js:19\r\nYi @ react-dom.production.min.js:122\r\nXi @ react-dom.production.min.js:123\r\n$i @ react-dom.production.min.js:122\r\nN @ react-dom.production.min.js:287\r\nXt @ react-dom.production.min.js:68\r\n```","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb243NTEy","author":{"login":"atoiv"},"title":"Missing dependencies","body":"**Describe the bug**\r\nMissing dependencies in `package.json`s of multiple workspaces:\r\n* Internal dependencies between workspaces are not defined.\r\n* external dependencies to packages under @aws-sdk organization are not defined.\r\n\r\nFor example \"@aws-amplify/api\" uses \"@aws-amplify/core\", without listing it in package.json.\r\n\r\nThis becomes a show stopper when trying to use aws-amplify from a regular yarn 2 (a.k.a yarn berry or yarn modern) project, without [falling back to using node_modules](https://yarnpkg.com/api/modules/plugin_node_modules.html) for the whole project. Given that not all of the packages used in aws-amplify repository are exposed as npm packages, it is not possible to get past the problem by just using yarn's [packageExtensions](https://yarnpkg.com/advanced/migration#a-package-is-trying-to-access-another-package-). \r\n\r\n**Solution**\r\nList all dependencies inside each workspace's package.json.\r\n\r\n**Additional information**\r\n\r\nIf all the missing dependencies would be npm packages, it would be possible to override them via the following .yarnrc.yml config:\r\n\r\n```yaml\r\npackageExtensions:\r\n  \"@aws-amplify/api@*\":\r\n    dependencies:\r\n      \"@aws-amplify/core\": \"*\"\r\n  \"@aws-amplify/datastore@*\":\r\n    dependencies:\r\n      \"@aws-amplify/auth\": \"*\"\r\n      \"@aws-amplify/cache\": \"*\"\r\n      crypto-js: \"*\"\r\n  \"@aws-amplify/storage@*\":\r\n    # following doesn't work, as the packages are not found in npm\r\n    dependencies:\r\n      \"@aws-sdk/fetch-http-handler\": \"*\"\r\n      \"@aws-sdk/protocol-http\": \"*\"\r\n      \"@aws-sdk/querystring-builder\": \"*\"\r\n      \"@aws-sdk/url-parser-node\": \"*\"\r\n  \"@aws-sdk/fetch-http-handler@*\":\r\n    # following doesn't work, as the packages are not found in npm\r\n    dependencies:\r\n      \"@aws-sdk/util-base64-browser\": \"*\"\r\n```\r\n\r\nAs it is, they are apparently not npm packages, and yarn 2 can't fetch them.\r\n\r\n---\r\n\r\nThere could be more missing dependencies. These are just the one's that came up when trying to use auth functionality.","upvoteCount":3,"comments":{"edges":[{"node":{"author":{"login":"milichev"},"body":"@atoiv , first of all, thanks for raising this.\r\n\r\nI succeeded to run the CRA+amplify app as follows:\r\n\r\n1. In `package.json`:\r\n\r\n```\r\n  \"dependencies\": {\r\n    \"@aws-amplify/ui-react\": \"^0.2.32\",\r\n    \"aws-amplify\": \"^3.3.12\",\r\n```\r\n\r\n2. In `.yarnrc.yml`:\r\n\r\n```\r\npackageExtensions:\r\n  \"@aws-amplify/api@*\":\r\n    dependencies:\r\n      \"@aws-amplify/auth\": \"*\"\r\n      \"@aws-amplify/cache\": \"*\"\r\n      \"@aws-amplify/core\": \"*\"\r\n  \"@aws-amplify/datastore@*\":\r\n    dependencies:\r\n      \"@aws-amplify/auth\": \"*\"\r\n      \"@aws-amplify/cache\": \"*\"\r\n      \"crypto-js\": \"*\"\r\n  \"@aws-amplify/storage@*\":\r\n    dependencies:\r\n      \"@aws-sdk/fetch-http-handler\": \"*\"\r\n      \"@aws-sdk/protocol-http\": \"*\"\r\n      \"@aws-sdk/querystring-builder\": \"*\"\r\n      \"@aws-sdk/url-parser-node\": \"*\"\r\n  \"@aws-amplify/ui-react@*\":\r\n    dependencies:\r\n      \"@aws-amplify/auth\": \"*\"\r\n      \"@aws-amplify/core\": \"*\"\r\n```\r\n\r\n3. Run `yarn install`\r\n"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTU3NTY2","author":{"login":"akhalinem"},"title":"Store multiple identity providers data in Auth instance","body":"When I try to use Auth.federatedSignIn with multiple providers, Auth instance clears the previous signed-in providers' data and stores only the last signed-in provider data. Is it possible to store previous providers' data among with the last signed-in provider?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTQ5MTQx","author":{"login":"julie777"},"title":"DataStore: need more information about implicit model fields","body":"Now that I am past the initial learning curve, and have read all the DataStore documentation that I can find multiple times, I still have many questions about use in a \"real\" application. If there is an advance usage doc somewhere please let me know.\r\n\r\nIf I create a DataStore model \r\n```\r\n    type Todo @model {\r\n        id: ID!\r\n        title: String!\r\n        completed: Boolean\r\n    }\r\n```\r\nDataStore adds several fields to the model that is generated, \r\n   CreatedAt, UpdatedAt - they appear in the generated schema.js file and are readonly and I found documentation about renaming them\r\n   _deleted, _lastChanged, _version - don't appear in the generated schema\r\n\r\nCreatedAt and UpdatedAt don't appear in the local store, but the _fields do.\r\n\r\nid which I defined is assigned a value when datastore creates the model instance, and any value I provide is ignored\r\nall the other fields are always undefined when running locally\r\n\r\nThere is no field as far as I can see that relates the model instance to a user.\r\n\r\nMy assumption is that the fields will be filled in by the backend if/when I sync to the cloud. I don't know if this is correct.\r\n\r\nIs there any way other than reading the datastore code for me to find out the details of implicit fields and sync to the cloud?\r\n\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTQ1OTgw","author":{"login":"rutwick-alic"},"title":"How to configure Logger to work with VueJs?","body":"In my Vue Project I am already using Pinpoint and Auth using aws-amplify package. I need to configure Logger to work so I can send error logs to Cloudwatch. The documentation state the usage, but not the configuration part.\r\n\r\nI have looked at this PR, but even the exact config doesn't work: https://github.com/aws-amplify/amplify-js/pull/8309. My aws-amplify version is 4.2.3 (^).\r\n\r\nThere is absolutely no information on how to configure it, or at least I am not able to find it. Please can someone help?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMzg3Nw==","author":{"login":"aossey"},"title":"Syntax/object structure for federated property on Authenticator/Signin UI Component","body":"I am attempting to add Federated Identity Providers to my Vue application that is use the pre-built Amplify UI components.  When I add a binding for federated.prop (see below), I get a horizontal divider above the existing login form, but there are no buttons appearing for the federated identity providers.  I would expect a button for Google to appear in this case.  I can't seem to find any documentation on using the federated property of the Authenticator or Signin components, can someone please point me to the documentation or post a working code sample?\r\n\r\n```javascript\r\n<template>\r\n  <div class=\"auth\">\r\n    <amplify-authenticator username-alias=\"username\" :federated=\"federatedIds\">\r\n      <amplify-sign-in slot=\"sign-in\" :federated.prop=\"federatedConfig\">\r\n      </amplify-sign-in>\r\n    </amplify-authenticator>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: \"Auth\",\r\n  data() {\r\n    return {\r\n      federatedConfig: { provider: \"Google\" },\r\n      federatedIds: {\r\n        google_client_id:\r\n          \"XXXXXXXXXXXXXXXXXXXXX.apps.googleusercontent.com\",\r\n        facebook_app_id: \"\",\r\n        amazon_client_id: \"\",\r\n      },\r\n    };\r\n  },\r\n};\r\n</script>\r\n```\r\n\r\n---\r\n![Screen Shot 2020-08-14 at 7 57 17 PM](https://user-images.githubusercontent.com/10093753/90304023-76d72e00-de68-11ea-8784-6754766758d5.png)\r\n\r\n@dabit3 - Any thoughts?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"frawgie"},"body":"Did you find a solution? I'm having the same problem."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTQzNjgx","author":{"login":"debotos"},"title":"How to prevent Auth 'signIn' event?","body":"Hi, Is there any way to just collect userId from Auth.federatedSignIn() call without logging in the user?\r\nI want just the 'userId' property but don't wanna log in the user. Trying to implement Social Connect functionality(like, Connect with Google, Facebook, Apple).","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTQzNjY4","author":{"login":"debotos"},"title":"How to detect user has a password?","body":"Currently i am using social login(`Auth.federatedSignIn()`). Now there is an option to change the password. Before showing that form I wanna confirm that this user has a password already set up or not neither I will show him create password form(`Auth.completeNewPassword()`).\r\n\r\nPlease help me to figure out the correct way to detect it. Thanks.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTM4MDUy","author":{"login":"jysung"},"title":"Is Google One-tap Sign-up supported?","body":"Is Google one-tap sign-up (https://developers.google.com/identity/gsi/web) possible to integrate with Amplify? Has anyone successfully done it? Would I have to integrate it myself using Google's SDK?\r\n\r\nI currently sign up users using\r\n```\r\nAuth.federatedSignIn({ provider: 'Google' };\r\n```\r\n\r\nThanks!","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTMzODk5","author":{"login":"htmnk"},"title":"Amplify with gitpod","body":"Hi, could anybody point me in the right direction or have any experience with setting up amplify with [gitpod](https://www.gitpod.io/)? I would like to be able to have aws-exports.js generated automatically, be able to push new changes, etc. inside the cloud dev workspaces.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"htmnk"},"body":"I've got it working (mirror: https://stackoverflow.com/questions/68896926/aws-amplify-javascript-gitpod-automatic-setup) first I've added these environment variables for the `amplify` setup using the [Gitpod account settings][1]:\r\n```bash\r\nAWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE\r\nAWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY\r\nAWS_DEFAULT_REGION=us-west-2\r\nAWS_AMPLIFY_PROJECT_NAME=headlessProjectName\r\nAWS_AMPLIFY_APP_ID=amplifyServiceProjectAppId\r\n```\r\nThe first three are the IAM user credentials and config, the latter two are amplify specific and can be found inside the AWS console on the Amplify project.\r\n\r\nAfter that, I've created a [Dockerfile][2] for the Gitpod Custom Docker Image and a bash script that creates `~/.aws` config files and runs `amplify pull` in a headless mode.\r\n\r\n*.gitpod.dockerfile*\r\n```sh\r\nFROM gitpod/workspace-full\r\n\r\n# install aws-cli v2\r\nRUN sudo curl \"https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip\" -o \"awscliv2.zip\" \\\r\n  && unzip awscliv2.zip \\\r\n  && sudo ./aws/install\r\n\r\n# install amplify-cli\r\nRUN sudo curl -sL https://aws-amplify.github.io/amplify-cli/install | bash && $SHELL\r\n```\r\n\r\nThis will preinstall [aws-cli][4] and [amplify-cli][5] on the docker image so they are ready to use inside the workspace. Also don't forget to add the docker configuration to the top of `.gitpod.yml` file:\r\n\r\n*.gitpod.yml*\r\n```yml\r\nimage:\r\n  file: .gitpod.Dockerfile\r\n```\r\n\r\nAt this point, I'm setting up Amplify in a way that I don't have to manually pick the `amplify-cli` options when a new workspace is started. The magic happens inside a custom bash script with the help of the environment variables specified at the start:\r\n\r\n*amplify-pull.bash*\r\n```bash\r\n#!/bin/bash\r\nset -e\r\nIFS='|'\r\n\r\n# Specify the headless amplify pull parameters\r\n# https://docs.amplify.aws/cli/usage/headless/#amplify-pull-parameters\r\nVUECONFIG=\"{\\\r\n\\\"SourceDir\\\":\\\"src\\\",\\\r\n\\\"DistributionDir\\\":\\\"dist\\\",\\\r\n\\\"BuildCommand\\\":\\\"npm run-script build\\\",\\\r\n\\\"StartCommand\\\":\\\"npm run-script serve\\\"\\\r\n}\"\r\nAWSCLOUDFORMATIONCONFIG=\"{\\\r\n\\\"configLevel\\\":\\\"project\\\",\\\r\n\\\"useProfile\\\":false,\\\r\n\\\"profileName\\\":\\\"default\\\",\\\r\n\\\"accessKeyId\\\":\\\"$AWS_ACCESS_KEY_ID\\\",\\\r\n\\\"secretAccessKey\\\":\\\"$AWS_SECRET_ACCESS_KEY\\\",\\\r\n\\\"region\\\":\\\"$AWS_DEFAULT_REGION\\\"\\\r\n}\"\r\nAMPLIFY=\"{\\\r\n\\\"projectName\\\":\\\"$AWS_AMPLIFY_PROJECT_NAME\\\",\\\r\n\\\"appId\\\":\\\"$AWS_AMPLIFY_APP_ID\\\",\\\r\n\\\"envName\\\":\\\"dev\\\",\\\r\n\\\"defaultEditor\\\":\\\"code\\\"\\\r\n}\"\r\nFRONTEND=\"{\\\r\n\\\"frontend\\\":\\\"javascript\\\",\\\r\n\\\"framework\\\":\\\"vue\\\",\\\r\n\\\"config\\\":$VUECONFIG\\\r\n}\"\r\nPROVIDERS=\"{\\\r\n\\\"awscloudformation\\\":$AWSCLOUDFORMATIONCONFIG\\\r\n}\"\r\n\r\n# Create AWS credential file inside ~/.aws\r\nmkdir -p ~/.aws \\\r\n&& echo -e \"[default]\\naws_access_key_id=$AWS_ACCESS_KEY_ID\\naws_secret_access_key=$AWS_SECRET_ACCESS_KEY\" \\\r\n>> ~/.aws/credentials\r\n\r\n# Create AWS config file ~/.aws\r\necho -e \"[default]\\nregion=$AWS_DEFAULT_REGION\" >> ~/.aws/config\r\n\r\n# Run amplify pull in Headless mode, \r\n# this also generates thw aws-exports.js file inside /src\r\namplify pull \\\r\n--amplify $AMPLIFY \\\r\n--frontend $FRONTEND \\\r\n--providers $PROVIDERS \\\r\n--yes\r\n\r\n```\r\nI'm using Vue for my frontend as an example, so those values need to be changed depending on the project type. The rest of the params are pretty straightforward, more info about the headless mode can be found [here][6]. I'm also creating the [aws config files][7] before the `amplify pull` command as mentioned before.\r\n\r\nAnd this is what the final `.gitpod.yml` file looks like\r\n\r\n*.gitpod.yml*\r\n```yml\r\nimage:\r\n  file: .gitpod.dockerfile\r\n  \r\ntasks:\r\n  - name: Amplify pull dev\r\n    command: |\r\n      bash amplify-pull.bash\r\n      gp sync-done amplify\r\n  \r\n  - name: Install npm packages, run dev\r\n    init: yarn install\r\n    command: |\r\n      gp sync-await amplify\r\n      yarn serve\r\n    \r\nports:\r\n  - port: 8080\r\n    onOpen: open-preview\r\n```\r\n\r\nI'm also waiting for the Amplify pull to finish before running the dev server using [gp sync][8].\r\n\r\n\r\n  [1]: https://www.gitpod.io/docs/environment-variables#using-the-account-settings\r\n  [2]: https://www.gitpod.io/docs/config-docker#configure-a-custom-dockerfile\r\n  [3]: https://stackoverflow.com/users/16736076/pauline-p-narvas\r\n  [4]: https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2-linux.html\r\n  [5]: https://docs.amplify.aws/cli/start/install/\r\n  [6]: https://docs.amplify.aws/cli/usage/headless/\r\n  [7]: https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-files.html\r\n  [8]: https://www.gitpod.io/docs/config-start-tasks#wait-for-commands-to-complete"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTM2NDA0","author":{"login":"dgastudio"},"title":"Custom field for signin, alter jwt token","body":"Hello\r\nI have two questions, I hope for your help\r\n\r\n1. I have a multitenant system where the user must log in by username + password + property code. But after checking the documentation, I can't find a way to use the additional login field (Auth.signIn (username, password)).\r\n2. I am already using custom jwt token and part of its payload is for configuring websocket library. Will it be possible to attach custom fields to aws ampify jwt payload?\r\n\r\nthank you!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTM0MjU3","author":{"login":"Anishshettyk"},"title":"HOW TO SET UNIQUE PROPERTY ON A TABLE ATTRIBUTE","body":"is there a way to set unique property on graphQL schema","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMzc2Nw==","author":{"login":"edoardo849"},"title":"Cannot upload file to S3 using Angular","body":"**Describe the bug**\r\nI want to upload an image to the configured Storage bucket. When I do, I receive the following error:\r\n```\r\nAccess to XMLHttpRequest at 'https://BUCKETs3.eu-west-1.amazonaws.com/public/public/eu-west-1%3A7d2fa609-a252-474d-9de2-3144d0f77cbf/19C0927_062.jpg.jpg?uploads=' from origin 'http://localhost:4201' has been blocked by CORS policy: Response to preflight request doesn't pass access control check: No 'Access-Control-Allow-Origin' header is present on the requested resource.\r\n\r\n[ERROR] 49:18.972 axios-http-handler Error: Network Error\r\n```\r\n\r\nI have created the bucket via the console and I this is the created CORS policy:\r\n\r\n```\r\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<CORSConfiguration xmlns=\"http://s3.amazonaws.com/doc/2006-03-01/\">\r\n<CORSRule>\r\n    <ID>S3CORSRuleId1</ID>\r\n    <AllowedOrigin>*</AllowedOrigin>\r\n    <AllowedMethod>GET</AllowedMethod>\r\n    <AllowedMethod>HEAD</AllowedMethod>\r\n    <AllowedMethod>PUT</AllowedMethod>\r\n    <AllowedMethod>POST</AllowedMethod>\r\n    <AllowedMethod>DELETE</AllowedMethod>\r\n    <MaxAgeSeconds>3000</MaxAgeSeconds>\r\n    <ExposeHeader>x-amz-server-side-encryption</ExposeHeader>\r\n    <ExposeHeader>x-amz-request-id</ExposeHeader>\r\n    <ExposeHeader>x-amz-id-2</ExposeHeader>\r\n    <ExposeHeader>ETag</ExposeHeader>\r\n    <AllowedHeader>*</AllowedHeader>\r\n</CORSRule>\r\n</CORSConfiguration>\r\n\r\n```\r\n\r\n**Code Snippet**\r\n\r\n```typescript\r\nconst { identityId } = await Auth.currentCredentials();\r\nconst key = `public/${identityId}/${fileName}${fileExtension}`;\r\nconst storage = await Storage.put(key, await this.mediaFile.text(), { contentType: mimeType });\r\n```\r\n\r\n\r\n**What is Configured?**\r\nIf applicable, please provide what is configured for Amplify CLI:\r\n\r\n| Category                 | Resource name                         | Operation | Provider plugin   |\r\n| ------------------------ | ------------------------------------- | --------- | ----------------- |\r\n| Hosting                  | amplifyhosting                        | No Change    |                   |\r\n| Auth                     | sixtythreeapp563ea47e                 | No Change | awscloudformation |\r\n| Auth                     | userPoolGroups                        | No Change | awscloudformation |\r\n| Api                      | sixtythreeapp                         | No Change | awscloudformation |\r\n| Function                 | sixtythreeapp563ea47ePostConfirmation | No Change | awscloudformation |\r\n| Function                 | generateFeed                          | No Change | awscloudformation |\r\n| Function                 | userEvent                             | No Change | awscloudformation |\r\n| Lambdatriggerpermissions | postConfirmationPermissions           | No Change | awscloudformation |\r\n| Storage                  | sixtythree                            | No Change | awscloudformation |\r\n\r\n\r\n* Which steps did you follow via Amplify CLI when configuring your resources.\r\n* Which resources do you have configured?\r\n  * If applicable, please provide your `aws-exports` file:\r\n\r\n```json\r\n\r\nconst awsmobile = {\r\n    \"aws_project_region\": \"eu-west-1\",\r\n    \"aws_cognito_identity_pool_id\": \"eu-west-XXX\",\r\n    \"aws_cognito_region\": \"eu-west-1\",\r\n    \"aws_user_pools_id\": \"eu-west-XXX\",\r\n    \"aws_user_pools_web_client_id\": \"XXX\",\r\n    \"oauth\": {},\r\n    \"aws_appsync_graphqlEndpoint\": \"https:/XXX.appsync-api.eu-west-1.amazonaws.com/graphql\",\r\n    \"aws_appsync_region\": \"eu-west-1\",\r\n    \"aws_appsync_authenticationType\": \"AMAZON_COGNITO_USER_POOLS\",\r\n    \"aws_appsync_apiKey\": \"XXX\",\r\n    \"aws_user_files_s3_bucket\": \"XXX\",\r\n    \"aws_user_files_s3_bucket_region\": \"eu-west-1\"\r\n};\r\n\r\n```\r\n   * If applicable, please provide your manual configuration example:\r\n   \r\n```typescript\r\n\r\nimport aws_exports from \"./aws-exports\";\r\nimport Amplify from 'aws-amplify';\r\n\r\nAmplify.configure(aws_exports);\r\n```\r\n\r\n\r\n<details>\r\n  <summary><strong>Environment</strong></summary>\r\n\r\n<!-- Please run the following command inside your project and copy/paste the output into the codeblock: -->\r\n\r\n```\r\n  System:\r\n    OS: Linux 5.4 Ubuntu 20.04.1 LTS (Focal Fossa)\r\n    CPU: (8) x64 Intel(R) Core(TM) i7-1065G7 CPU @ 1.30GHz\r\n    Memory: 555.65 MB / 15.47 GB\r\n    Container: Yes\r\n    Shell: 5.0.17 - /bin/bash\r\n  Binaries:\r\n    Node: 14.13.0 - ~/.nvm/versions/node/v14.13.0/bin/node\r\n    npm: 6.14.8 - ~/.nvm/versions/node/v14.13.0/bin/npm\r\n  Browsers:\r\n    Chrome: 85.0.4183.121\r\n    Firefox: 81.0\r\n  npmPackages:\r\n    @angular-devkit/build-angular: ^0.1000.8 => 0.1000.8 \r\n    @angular/animations: ^10.1.2 => 10.1.2 \r\n    @angular/cli: ^10.1.2 => 10.1.2 \r\n    @angular/common: ^10.1.2 => 10.1.2 \r\n    @angular/compiler: ^10.1.2 => 10.1.2 \r\n    @angular/compiler-cli: ^10.1.2 => 10.1.2 \r\n    @angular/core: ^10.1.2 => 10.1.2 \r\n    @angular/forms: ^10.1.2 => 10.1.2 \r\n    @angular/platform-browser: ^10.1.2 => 10.1.2 \r\n    @angular/platform-browser-dynamic: ^10.1.2 => 10.1.2 \r\n    @angular/router: ^10.1.2 => 10.1.2 \r\n    @aws-amplify/ui-angular: ^0.3.0 => 0.3.0 \r\n    @types/jasmine: ^3.5.14 => 3.5.14 \r\n    @types/jasminewd2: ~2.0.3 => 2.0.8 \r\n    @types/node: ^12.12.61 => 12.12.61 \r\n    aws-amplify: ^3.3.1 => 3.3.1 \r\n    bulma: ^0.9.0 => 0.9.0 \r\n    codelyzer: ^6.0.0 => 6.0.0 \r\n    jasmine-core: ~3.5.0 => 3.5.0 \r\n    jasmine-spec-reporter: ~5.0.0 => 5.0.2 \r\n    karma: ~5.0.0 => 5.0.9 \r\n    karma-chrome-launcher: ~3.1.0 => 3.1.0 \r\n    karma-coverage-istanbul-reporter: ~3.0.2 => 3.0.3 \r\n    karma-jasmine: ~3.3.0 => 3.3.1 \r\n    karma-jasmine-html-reporter: ^1.5.0 => 1.5.4 \r\n    material-icons: ^0.3.1 => 0.3.1 \r\n    protractor: ~7.0.0 => 7.0.0 \r\n    rxjs: ~6.5.5 => 6.5.5 \r\n    ts-node: ~8.3.0 => 8.3.0 \r\n    tslib: ^2.0.0 => 2.0.1 \r\n    tslint: ~6.1.0 => 6.1.3 \r\n    typescript: ~3.9.5 => 3.9.7 \r\n    zone.js: ~0.10.3 => 0.10.3 \r\n  npmGlobalPackages:\r\n    @angular/cli: 10.1.4\r\n    @aws-amplify/cli: 4.29.4\r\n    npm: 6.14.8\r\n```\r\n\r\n</details>\r\n\r\n**Smartphone (please complete the following information):**\r\n\r\n- Device: [e.g. iPhone6]\r\n- OS: [e.g. iOS8.1]\r\n- Browser [e.g. stock browser, safari]\r\n- Version [e.g. 22]\r\n\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"ashika01"},"body":"@edoardo849 what version of angular are you using? also, could you post your amplify dependency versions too?\r\n"}},{"node":{"author":{"login":"edoardo849"},"body":"@ashika01 I'm using angular `~10.0.9` - but you can see the dependencies in the \"Environment\" section in the above post, but Let me post the entire dependency tree here:\r\n\r\n`npm ls`\r\n\r\n<details>\r\n  <summary><strong>Dependency Tree</strong></summary>\r\n\r\nREPO@0.0.0 /home/edo/code/REPO\r\n├─┬ @angular-devkit/build-angular@0.1000.8\r\n│ ├─┬ @angular-devkit/architect@0.1000.8\r\n│ │ ├── @angular-devkit/core@10.0.8 deduped\r\n│ │ └── rxjs@6.5.5 deduped\r\n│ ├─┬ @angular-devkit/build-optimizer@0.1000.8\r\n│ │ ├── loader-utils@2.0.0 deduped\r\n│ │ ├── source-map@0.7.3 deduped\r\n│ │ ├── tslib@2.0.0\r\n│ │ └── webpack-sources@1.4.3 deduped\r\n│ ├─┬ @angular-devkit/build-webpack@0.1000.8\r\n│ │ ├── @angular-devkit/architect@0.1000.8 deduped\r\n│ │ ├── @angular-devkit/core@10.0.8 deduped\r\n│ │ └── rxjs@6.5.5 deduped\r\n│ ├─┬ @angular-devkit/core@10.0.8\r\n│ │ ├── ajv@6.12.3 deduped\r\n│ │ ├── fast-json-stable-stringify@2.1.0\r\n│ │ ├── magic-string@0.25.7 deduped\r\n│ │ ├── rxjs@6.5.5 deduped\r\n│ │ └── source-map@0.7.3 deduped\r\n│ ├─┬ @babel/core@7.9.6\r\n│ │ ├── @babel/code-frame@7.10.4 deduped\r\n│ │ ├── @babel/generator@7.9.6 deduped\r\n│ │ ├─┬ @babel/helper-module-transforms@7.11.0\r\n│ │ │ ├── @babel/helper-module-imports@7.10.4 deduped\r\n│ │ │ ├─┬ @babel/helper-replace-supers@7.10.4\r\n│ │ │ │ ├─┬ @babel/helper-member-expression-to-functions@7.11.0\r\n│ │ │ │ │ └── @babel/types@7.11.5 deduped\r\n│ │ │ │ ├── @babel/helper-optimise-call-expression@7.10.4 deduped\r\n│ │ │ │ ├── @babel/traverse@7.11.5 deduped\r\n│ │ │ │ └── @babel/types@7.11.5 deduped\r\n│ │ │ ├─┬ @babel/helper-simple-access@7.10.4\r\n│ │ │ │ ├─┬ @babel/template@7.10.4\r\n│ │ │ │ │ ├── @babel/code-frame@7.10.4 deduped\r\n│ │ │ │ │ ├── @babel/parser@7.11.5 deduped\r\n│ │ │ │ │ └── @babel/types@7.11.5 deduped\r\n│ │ │ │ └── @babel/types@7.11.5 deduped\r\n│ │ │ ├─┬ @babel/helper-split-export-declaration@7.11.0\r\n│ │ │ │ └── @babel/types@7.11.5 deduped\r\n│ │ │ ├─┬ @babel/template@7.10.4\r\n│ │ │ │ ├── @babel/code-frame@7.10.4 deduped\r\n│ │ │ │ ├── @babel/parser@7.11.5 deduped\r\n│ │ │ │ └── @babel/types@7.11.5 deduped\r\n│ │ │ ├── @babel/types@7.11.5 deduped\r\n│ │ │ └── lodash@4.17.20 deduped\r\n│ │ ├─┬ @babel/helpers@7.10.4\r\n│ │ │ ├─┬ @babel/template@7.10.4\r\n│ │ │ │ ├── @babel/code-frame@7.10.4 deduped\r\n│ │ │ │ ├── @babel/parser@7.11.5 deduped\r\n│ │ │ │ └── @babel/types@7.11.5 deduped\r\n│ │ │ ├── @babel/traverse@7.11.5 deduped\r\n│ │ │ └── @babel/types@7.11.5 deduped\r\n│ │ ├── @babel/parser@7.11.5\r\n│ │ ├── @babel/template@7.8.6 deduped\r\n│ │ ├─┬ @babel/traverse@7.11.5\r\n│ │ │ ├── @babel/code-frame@7.10.4 deduped\r\n│ │ │ ├─┬ @babel/generator@7.11.6\r\n│ │ │ │ ├── @babel/types@7.11.5 deduped\r\n│ │ │ │ ├── jsesc@2.5.2 deduped\r\n│ │ │ │ └── source-map@0.5.7\r\n│ │ │ ├─┬ @babel/helper-function-name@7.10.4\r\n│ │ │ │ ├── @babel/helper-get-function-arity@7.10.4 deduped\r\n│ │ │ │ ├─┬ @babel/template@7.10.4\r\n│ │ │ │ │ ├── @babel/code-frame@7.10.4 deduped\r\n│ │ │ │ │ ├── @babel/parser@7.11.5 deduped\r\n│ │ │ │ │ └── @babel/types@7.11.5 deduped\r\n│ │ │ │ └── @babel/types@7.11.5 deduped\r\n│ │ │ ├── @babel/helper-split-export-declaration@7.11.0 deduped\r\n│ │ │ ├── @babel/parser@7.11.5 deduped\r\n│ │ │ ├── @babel/types@7.11.5 deduped\r\n│ │ │ ├─┬ debug@4.2.0\r\n│ │ │ │ └── ms@2.1.2\r\n│ │ │ ├── globals@11.12.0\r\n│ │ │ └── lodash@4.17.20 deduped\r\n│ │ ├─┬ @babel/types@7.11.5\r\n│ │ │ ├── @babel/helper-validator-identifier@7.10.4\r\n│ │ │ ├── lodash@4.17.20 deduped\r\n│ │ │ └── to-fast-properties@2.0.0\r\n│ │ ├── convert-source-map@1.7.0 deduped\r\n│ │ ├─┬ debug@4.2.0\r\n│ │ │ └── ms@2.1.2\r\n│ │ ├── gensync@1.0.0-beta.1\r\n│ │ ├─┬ json5@2.1.3\r\n│ │ │ └── minimist@1.2.5 deduped\r\n│ │ ├── lodash@4.17.20 deduped\r\n│ │ ├── resolve@1.17.0 deduped\r\n│ │ ├── semver@5.7.1\r\n│ │ └── source-map@0.5.7\r\n│ ├─┬ @babel/generator@7.9.6\r\n│ │ ├── @babel/types@7.11.5 deduped\r\n│ │ ├── jsesc@2.5.2\r\n│ │ ├── lodash@4.17.20 deduped\r\n│ │ └── source-map@0.5.7\r\n│ ├─┬ @babel/plugin-transform-runtime@7.9.6\r\n│ │ ├─┬ @babel/helper-module-imports@7.10.4\r\n│ │ │ └── @babel/types@7.11.5 deduped\r\n│ │ ├── @babel/helper-plugin-utils@7.10.4\r\n│ │ ├── resolve@1.17.0 deduped\r\n│ │ └── semver@5.7.1\r\n│ ├─┬ @babel/preset-env@7.9.6\r\n│ │ ├─┬ @babel/compat-data@7.11.0\r\n│ │ │ ├── browserslist@4.14.5 deduped\r\n│ │ │ ├── invariant@2.2.4 deduped\r\n│ │ │ └── semver@5.7.1\r\n│ │ ├─┬ @babel/helper-compilation-targets@7.10.4\r\n│ │ │ ├── @babel/compat-data@7.11.0 deduped\r\n│ │ │ ├── browserslist@4.14.5 deduped\r\n│ │ │ ├── invariant@2.2.4 deduped\r\n│ │ │ ├── levenary@1.1.1 deduped\r\n│ │ │ └── semver@5.7.1\r\n│ │ ├── @babel/helper-module-imports@7.10.4 deduped\r\n│ │ ├── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ ├─┬ @babel/plugin-proposal-async-generator-functions@7.10.5\r\n│ │ │ ├── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ │ ├─┬ @babel/helper-remap-async-to-generator@7.11.4\r\n│ │ │ │ ├── @babel/helper-annotate-as-pure@7.10.4 deduped\r\n│ │ │ │ ├─┬ @babel/helper-wrap-function@7.10.4\r\n│ │ │ │ │ ├── @babel/helper-function-name@7.10.4 deduped\r\n│ │ │ │ │ ├─┬ @babel/template@7.10.4\r\n│ │ │ │ │ │ ├── @babel/code-frame@7.10.4 deduped\r\n│ │ │ │ │ │ ├── @babel/parser@7.11.5 deduped\r\n│ │ │ │ │ │ └── @babel/types@7.11.5 deduped\r\n│ │ │ │ │ ├── @babel/traverse@7.11.5 deduped\r\n│ │ │ │ │ └── @babel/types@7.11.5 deduped\r\n│ │ │ │ ├─┬ @babel/template@7.10.4\r\n│ │ │ │ │ ├── @babel/code-frame@7.10.4 deduped\r\n│ │ │ │ │ ├── @babel/parser@7.11.5 deduped\r\n│ │ │ │ │ └── @babel/types@7.11.5 deduped\r\n│ │ │ │ └── @babel/types@7.11.5 deduped\r\n│ │ │ └── @babel/plugin-syntax-async-generators@7.8.4 deduped\r\n│ │ ├─┬ @babel/plugin-proposal-dynamic-import@7.10.4\r\n│ │ │ ├── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ │ └── @babel/plugin-syntax-dynamic-import@7.8.3 deduped\r\n│ │ ├─┬ @babel/plugin-proposal-json-strings@7.10.4\r\n│ │ │ ├── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ │ └── @babel/plugin-syntax-json-strings@7.8.3 deduped\r\n│ │ ├─┬ @babel/plugin-proposal-nullish-coalescing-operator@7.10.4\r\n│ │ │ ├── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ │ └── @babel/plugin-syntax-nullish-coalescing-operator@7.8.3 deduped\r\n│ │ ├─┬ @babel/plugin-proposal-numeric-separator@7.10.4\r\n│ │ │ ├── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ │ └── @babel/plugin-syntax-numeric-separator@7.10.4 deduped\r\n│ │ ├─┬ @babel/plugin-proposal-object-rest-spread@7.11.0\r\n│ │ │ ├── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ │ ├── @babel/plugin-syntax-object-rest-spread@7.8.3 deduped\r\n│ │ │ └── @babel/plugin-transform-parameters@7.10.5 deduped\r\n│ │ ├─┬ @babel/plugin-proposal-optional-catch-binding@7.10.4\r\n│ │ │ ├── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ │ └── @babel/plugin-syntax-optional-catch-binding@7.8.3 deduped\r\n│ │ ├─┬ @babel/plugin-proposal-optional-chaining@7.11.0\r\n│ │ │ ├── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ │ ├─┬ @babel/helper-skip-transparent-expression-wrappers@7.11.0\r\n│ │ │ │ └── @babel/types@7.11.5 deduped\r\n│ │ │ └── @babel/plugin-syntax-optional-chaining@7.8.3 deduped\r\n│ │ ├─┬ @babel/plugin-proposal-unicode-property-regex@7.10.4\r\n│ │ │ ├─┬ @babel/helper-create-regexp-features-plugin@7.10.4\r\n│ │ │ │ ├── @babel/helper-annotate-as-pure@7.10.4 deduped\r\n│ │ │ │ ├── @babel/helper-regex@7.10.5 deduped\r\n│ │ │ │ └─┬ regexpu-core@4.7.1\r\n│ │ │ │   ├── regenerate@1.4.1\r\n│ │ │ │   ├─┬ regenerate-unicode-properties@8.2.0\r\n│ │ │ │   │ └── regenerate@1.4.1 deduped\r\n│ │ │ │   ├── regjsgen@0.5.2\r\n│ │ │ │   ├─┬ regjsparser@0.6.4\r\n│ │ │ │   │ └── jsesc@0.5.0\r\n│ │ │ │   ├─┬ unicode-match-property-ecmascript@1.0.4\r\n│ │ │ │   │ ├── unicode-canonical-property-names-ecmascript@1.0.4\r\n│ │ │ │   │ └── unicode-property-aliases-ecmascript@1.1.0\r\n│ │ │ │   └── unicode-match-property-value-ecmascript@1.2.0\r\n│ │ │ └── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ ├─┬ @babel/plugin-syntax-async-generators@7.8.4\r\n│ │ │ └── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ ├─┬ @babel/plugin-syntax-dynamic-import@7.8.3\r\n│ │ │ └── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ ├─┬ @babel/plugin-syntax-json-strings@7.8.3\r\n│ │ │ └── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ ├─┬ @babel/plugin-syntax-nullish-coalescing-operator@7.8.3\r\n│ │ │ └── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ ├─┬ @babel/plugin-syntax-numeric-separator@7.10.4\r\n│ │ │ └── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ ├─┬ @babel/plugin-syntax-object-rest-spread@7.8.3\r\n│ │ │ └── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ ├─┬ @babel/plugin-syntax-optional-catch-binding@7.8.3\r\n│ │ │ └── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ ├─┬ @babel/plugin-syntax-optional-chaining@7.8.3\r\n│ │ │ └── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ ├─┬ @babel/plugin-syntax-top-level-await@7.10.4\r\n│ │ │ └── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ ├─┬ @babel/plugin-transform-arrow-functions@7.10.4\r\n│ │ │ └── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ ├─┬ @babel/plugin-transform-async-to-generator@7.10.4\r\n│ │ │ ├── @babel/helper-module-imports@7.10.4 deduped\r\n│ │ │ ├── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ │ └── @babel/helper-remap-async-to-generator@7.11.4 deduped\r\n│ │ ├─┬ @babel/plugin-transform-block-scoped-functions@7.10.4\r\n│ │ │ └── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ ├─┬ @babel/plugin-transform-block-scoping@7.11.1\r\n│ │ │ └── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ ├─┬ @babel/plugin-transform-classes@7.10.4\r\n│ │ │ ├─┬ @babel/helper-annotate-as-pure@7.10.4\r\n│ │ │ │ └── @babel/types@7.11.5 deduped\r\n│ │ │ ├─┬ @babel/helper-define-map@7.10.5\r\n│ │ │ │ ├── @babel/helper-function-name@7.10.4 deduped\r\n│ │ │ │ ├── @babel/types@7.11.5 deduped\r\n│ │ │ │ └── lodash@4.17.20 deduped\r\n│ │ │ ├── @babel/helper-function-name@7.10.4 deduped\r\n│ │ │ ├─┬ @babel/helper-optimise-call-expression@7.10.4\r\n│ │ │ │ └── @babel/types@7.11.5 deduped\r\n│ │ │ ├── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ │ ├── @babel/helper-replace-supers@7.10.4 deduped\r\n│ │ │ ├── @babel/helper-split-export-declaration@7.11.0 deduped\r\n│ │ │ └── globals@11.12.0 deduped\r\n│ │ ├─┬ @babel/plugin-transform-computed-properties@7.10.4\r\n│ │ │ └── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ ├─┬ @babel/plugin-transform-destructuring@7.10.4\r\n│ │ │ └── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ ├─┬ @babel/plugin-transform-dotall-regex@7.10.4\r\n│ │ │ ├── @babel/helper-create-regexp-features-plugin@7.10.4 deduped\r\n│ │ │ └── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ ├─┬ @babel/plugin-transform-duplicate-keys@7.10.4\r\n│ │ │ └── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ ├─┬ @babel/plugin-transform-exponentiation-operator@7.10.4\r\n│ │ │ ├─┬ @babel/helper-builder-binary-assignment-operator-visitor@7.10.4\r\n│ │ │ │ ├─┬ @babel/helper-explode-assignable-expression@7.11.4\r\n│ │ │ │ │ └── @babel/types@7.11.5 deduped\r\n│ │ │ │ └── @babel/types@7.11.5 deduped\r\n│ │ │ └── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ ├─┬ @babel/plugin-transform-for-of@7.10.4\r\n│ │ │ └── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ ├─┬ @babel/plugin-transform-function-name@7.10.4\r\n│ │ │ ├── @babel/helper-function-name@7.10.4 deduped\r\n│ │ │ └── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ ├─┬ @babel/plugin-transform-literals@7.10.4\r\n│ │ │ └── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ ├─┬ @babel/plugin-transform-member-expression-literals@7.10.4\r\n│ │ │ └── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ ├─┬ @babel/plugin-transform-modules-amd@7.10.5\r\n│ │ │ ├── @babel/helper-module-transforms@7.11.0 deduped\r\n│ │ │ ├── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ │ └─┬ babel-plugin-dynamic-import-node@2.3.3\r\n│ │ │   └─┬ object.assign@4.1.1\r\n│ │ │     ├── define-properties@1.1.3 deduped\r\n│ │ │     ├─┬ es-abstract@1.18.0-next.1\r\n│ │ │     │ ├── es-to-primitive@1.2.1 deduped\r\n│ │ │     │ ├── function-bind@1.1.1 deduped\r\n│ │ │     │ ├── has@1.0.3 deduped\r\n│ │ │     │ ├── has-symbols@1.0.1 deduped\r\n│ │ │     │ ├── is-callable@1.2.2 deduped\r\n│ │ │     │ ├── is-negative-zero@2.0.0\r\n│ │ │     │ ├── is-regex@1.1.1 deduped\r\n│ │ │     │ ├── object-inspect@1.8.0 deduped\r\n│ │ │     │ ├── object-keys@1.1.1 deduped\r\n│ │ │     │ ├── object.assign@4.1.1 deduped\r\n│ │ │     │ ├── string.prototype.trimend@1.0.1 deduped\r\n│ │ │     │ └── string.prototype.trimstart@1.0.1 deduped\r\n│ │ │     ├── has-symbols@1.0.1\r\n│ │ │     └── object-keys@1.1.1 deduped\r\n│ │ ├─┬ @babel/plugin-transform-modules-commonjs@7.10.4\r\n│ │ │ ├── @babel/helper-module-transforms@7.11.0 deduped\r\n│ │ │ ├── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ │ ├── @babel/helper-simple-access@7.10.4 deduped\r\n│ │ │ └── babel-plugin-dynamic-import-node@2.3.3 deduped\r\n│ │ ├─┬ @babel/plugin-transform-modules-systemjs@7.10.5\r\n│ │ │ ├─┬ @babel/helper-hoist-variables@7.10.4\r\n│ │ │ │ └── @babel/types@7.11.5 deduped\r\n│ │ │ ├── @babel/helper-module-transforms@7.11.0 deduped\r\n│ │ │ ├── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ │ └── babel-plugin-dynamic-import-node@2.3.3 deduped\r\n│ │ ├─┬ @babel/plugin-transform-modules-umd@7.10.4\r\n│ │ │ ├── @babel/helper-module-transforms@7.11.0 deduped\r\n│ │ │ └── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ ├─┬ @babel/plugin-transform-named-capturing-groups-regex@7.10.4\r\n│ │ │ └── @babel/helper-create-regexp-features-plugin@7.10.4 deduped\r\n│ │ ├─┬ @babel/plugin-transform-new-target@7.10.4\r\n│ │ │ └── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ ├─┬ @babel/plugin-transform-object-super@7.10.4\r\n│ │ │ ├── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ │ └── @babel/helper-replace-supers@7.10.4 deduped\r\n│ │ ├─┬ @babel/plugin-transform-parameters@7.10.5\r\n│ │ │ ├─┬ @babel/helper-get-function-arity@7.10.4\r\n│ │ │ │ └── @babel/types@7.11.5 deduped\r\n│ │ │ └── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ ├─┬ @babel/plugin-transform-property-literals@7.10.4\r\n│ │ │ └── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ ├─┬ @babel/plugin-transform-regenerator@7.10.4\r\n│ │ │ └─┬ regenerator-transform@0.14.5\r\n│ │ │   └── @babel/runtime@7.9.6 deduped\r\n│ │ ├─┬ @babel/plugin-transform-reserved-words@7.10.4\r\n│ │ │ └── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ ├─┬ @babel/plugin-transform-shorthand-properties@7.10.4\r\n│ │ │ └── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ ├─┬ @babel/plugin-transform-spread@7.11.0\r\n│ │ │ ├── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ │ └── @babel/helper-skip-transparent-expression-wrappers@7.11.0 deduped\r\n│ │ ├─┬ @babel/plugin-transform-sticky-regex@7.10.4\r\n│ │ │ ├── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ │ └─┬ @babel/helper-regex@7.10.5\r\n│ │ │   └── lodash@4.17.20 deduped\r\n│ │ ├─┬ @babel/plugin-transform-template-literals@7.10.5\r\n│ │ │ ├── @babel/helper-annotate-as-pure@7.10.4 deduped\r\n│ │ │ └── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ ├─┬ @babel/plugin-transform-typeof-symbol@7.10.4\r\n│ │ │ └── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ ├─┬ @babel/plugin-transform-unicode-regex@7.10.4\r\n│ │ │ ├── @babel/helper-create-regexp-features-plugin@7.10.4 deduped\r\n│ │ │ └── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ ├─┬ @babel/preset-modules@0.1.4\r\n│ │ │ ├── @babel/helper-plugin-utils@7.10.4 deduped\r\n│ │ │ ├── @babel/plugin-proposal-unicode-property-regex@7.10.4 deduped\r\n│ │ │ ├── @babel/plugin-transform-dotall-regex@7.10.4 deduped\r\n│ │ │ ├── @babel/types@7.11.5 deduped\r\n│ │ │ └── esutils@2.0.3\r\n│ │ ├── @babel/types@7.11.5 deduped\r\n│ │ ├── browserslist@4.14.5 deduped\r\n│ │ ├─┬ core-js-compat@3.6.5\r\n│ │ │ ├── browserslist@4.14.5 deduped\r\n│ │ │ └── semver@7.0.0\r\n│ │ ├─┬ invariant@2.2.4\r\n│ │ │ └─┬ loose-envify@1.4.0\r\n│ │ │   └── js-tokens@4.0.0 deduped\r\n│ │ ├─┬ levenary@1.1.1\r\n│ │ │ └── leven@3.1.0\r\n│ │ └── semver@5.7.1\r\n│ ├─┬ @babel/runtime@7.9.6\r\n│ │ └── regenerator-runtime@0.13.5 deduped\r\n│ ├─┬ @babel/template@7.8.6\r\n│ │ ├── @babel/code-frame@7.10.4 deduped\r\n│ │ ├── @babel/parser@7.11.5 deduped\r\n│ │ └── @babel/types@7.11.5 deduped\r\n│ ├─┬ @jsdevtools/coverage-istanbul-loader@3.0.3\r\n│ │ ├── convert-source-map@1.7.0 deduped\r\n│ │ ├─┬ istanbul-lib-instrument@4.0.3\r\n│ │ │ ├── @babel/core@7.9.6 deduped\r\n│ │ │ ├── @istanbuljs/schema@0.1.2\r\n│ │ │ ├── istanbul-lib-coverage@3.0.0 deduped\r\n│ │ │ └── semver@6.3.0\r\n│ │ ├─┬ loader-utils@1.4.0\r\n│ │ │ ├── big.js@5.2.2 deduped\r\n│ │ │ ├── emojis-list@3.0.0 deduped\r\n│ │ │ └─┬ json5@1.0.1\r\n│ │ │   └── minimist@1.2.5 deduped\r\n│ │ ├─┬ merge-source-map@1.1.0\r\n│ │ │ └── source-map@0.6.1\r\n│ │ └─┬ schema-utils@2.7.1\r\n│ │   ├── @types/json-schema@7.0.6\r\n│ │   ├─┬ ajv@6.12.5\r\n│ │   │ ├── fast-deep-equal@3.1.3 deduped\r\n│ │   │ ├── fast-json-stable-stringify@2.1.0 deduped\r\n│ │   │ ├── json-schema-traverse@0.4.1 deduped\r\n│ │   │ └── uri-js@4.4.0 deduped\r\n│ │   └── ajv-keywords@3.5.2 deduped\r\n│ ├─┬ @ngtools/webpack@10.0.8\r\n│ │ ├── @angular-devkit/core@10.0.8 deduped\r\n│ │ ├─┬ enhanced-resolve@4.1.1\r\n│ │ │ ├── graceful-fs@4.2.4 deduped\r\n│ │ │ ├─┬ memory-fs@0.5.0\r\n│ │ │ │ ├── errno@0.1.7 deduped\r\n│ │ │ │ └── readable-stream@2.3.7 deduped\r\n│ │ │ └── tapable@1.1.3 deduped\r\n│ │ ├── rxjs@6.5.5 deduped\r\n│ │ └── webpack-sources@1.4.3 deduped\r\n│ ├─┬ ajv@6.12.3\r\n│ │ ├── fast-deep-equal@3.1.3\r\n│ │ ├── fast-json-stable-stringify@2.1.0 deduped\r\n│ │ ├── json-schema-traverse@0.4.1\r\n│ │ └─┬ uri-js@4.4.0\r\n│ │   └── punycode@2.1.1\r\n│ ├─┬ autoprefixer@9.8.0\r\n│ │ ├── browserslist@4.14.5 deduped\r\n│ │ ├── caniuse-lite@1.0.30001144 deduped\r\n│ │ ├── chalk@2.4.2 deduped\r\n│ │ ├── normalize-range@0.1.2\r\n│ │ ├── num2fraction@1.2.2\r\n│ │ ├── postcss@7.0.31 deduped\r\n│ │ └── postcss-value-parser@4.1.0\r\n│ ├─┬ babel-loader@8.1.0\r\n│ │ ├─┬ find-cache-dir@2.1.0\r\n│ │ │ ├── commondir@1.0.1 deduped\r\n│ │ │ ├── make-dir@2.1.0 deduped\r\n│ │ │ └─┬ pkg-dir@3.0.0\r\n│ │ │   └── find-up@3.0.0 deduped\r\n│ │ ├─┬ loader-utils@1.4.0\r\n│ │ │ ├── big.js@5.2.2 deduped\r\n│ │ │ ├── emojis-list@3.0.0 deduped\r\n│ │ │ └─┬ json5@1.0.1\r\n│ │ │   └── minimist@1.2.5 deduped\r\n│ │ ├── mkdirp@0.5.5 deduped\r\n│ │ ├── pify@4.0.1\r\n│ │ └── schema-utils@2.7.1 deduped\r\n│ ├─┬ browserslist@4.14.5\r\n│ │ ├── caniuse-lite@1.0.30001144 deduped\r\n│ │ ├── electron-to-chromium@1.3.577\r\n│ │ ├── escalade@3.1.0\r\n│ │ └── node-releases@1.1.61\r\n│ ├─┬ cacache@15.0.3\r\n│ │ ├── chownr@2.0.0\r\n│ │ ├─┬ fs-minipass@2.1.0\r\n│ │ │ └── minipass@3.1.3 deduped\r\n│ │ ├── glob@7.1.6 deduped\r\n│ │ ├── infer-owner@1.0.4\r\n│ │ ├─┬ lru-cache@5.1.1\r\n│ │ │ └── yallist@3.1.1\r\n│ │ ├─┬ minipass@3.1.3\r\n│ │ │ └── yallist@4.0.0\r\n│ │ ├─┬ minipass-collect@1.0.2\r\n│ │ │ └── minipass@3.1.3 deduped\r\n│ │ ├─┬ minipass-flush@1.0.5\r\n│ │ │ └── minipass@3.1.3 deduped\r\n│ │ ├─┬ minipass-pipeline@1.2.4\r\n│ │ │ └── minipass@3.1.3 deduped\r\n│ │ ├── mkdirp@1.0.4\r\n│ │ ├─┬ move-file@2.0.0\r\n│ │ │ └── path-exists@4.0.0\r\n│ │ ├─┬ p-map@4.0.0\r\n│ │ │ └─┬ aggregate-error@3.1.0\r\n│ │ │   ├── clean-stack@2.2.0\r\n│ │ │   └── indent-string@4.0.0\r\n│ │ ├── promise-inflight@1.0.1\r\n│ │ ├── rimraf@3.0.2 deduped\r\n│ │ ├─┬ ssri@8.0.0\r\n│ │ │ └── minipass@3.1.3 deduped\r\n│ │ ├─┬ tar@6.0.5\r\n│ │ │ ├── chownr@2.0.0 deduped\r\n│ │ │ ├── fs-minipass@2.1.0 deduped\r\n│ │ │ ├── minipass@3.1.3 deduped\r\n│ │ │ ├─┬ minizlib@2.1.2\r\n│ │ │ │ ├── minipass@3.1.3 deduped\r\n│ │ │ │ └── yallist@4.0.0 deduped\r\n│ │ │ ├── mkdirp@1.0.4\r\n│ │ │ └── yallist@4.0.0 deduped\r\n│ │ └─┬ unique-filename@1.1.1\r\n│ │   └─┬ unique-slug@2.0.2\r\n│ │     └── imurmurhash@0.1.4\r\n│ ├── caniuse-lite@1.0.30001144\r\n│ ├── circular-dependency-plugin@5.2.0\r\n│ ├─┬ copy-webpack-plugin@6.0.3\r\n│ │ ├─┬ cacache@15.0.5\r\n│ │ │ ├─┬ @npmcli/move-file@1.0.1\r\n│ │ │ │ └── mkdirp@1.0.4\r\n│ │ │ ├── chownr@2.0.0 deduped\r\n│ │ │ ├── fs-minipass@2.1.0 deduped\r\n│ │ │ ├── glob@7.1.6 deduped\r\n│ │ │ ├── infer-owner@1.0.4 deduped\r\n│ │ │ ├─┬ lru-cache@6.0.0\r\n│ │ │ │ └── yallist@4.0.0 deduped\r\n│ │ │ ├── minipass@3.1.3 deduped\r\n│ │ │ ├── minipass-collect@1.0.2 deduped\r\n│ │ │ ├── minipass-flush@1.0.5 deduped\r\n│ │ │ ├── minipass-pipeline@1.2.4 deduped\r\n│ │ │ ├── mkdirp@1.0.4\r\n│ │ │ ├── p-map@4.0.0 deduped\r\n│ │ │ ├── promise-inflight@1.0.1 deduped\r\n│ │ │ ├── rimraf@3.0.2 deduped\r\n│ │ │ ├── ssri@8.0.0 deduped\r\n│ │ │ ├── tar@6.0.5 deduped\r\n│ │ │ └── unique-filename@1.1.1 deduped\r\n│ │ ├─┬ fast-glob@3.2.4\r\n│ │ │ ├── @nodelib/fs.stat@2.0.3\r\n│ │ │ ├─┬ @nodelib/fs.walk@1.2.4\r\n│ │ │ │ ├─┬ @nodelib/fs.scandir@2.1.3\r\n│ │ │ │ │ ├── @nodelib/fs.stat@2.0.3 deduped\r\n│ │ │ │ │ └── run-parallel@1.1.9\r\n│ │ │ │ └─┬ fastq@1.8.0\r\n│ │ │ │   └── reusify@1.0.4\r\n│ │ │ ├── glob-parent@5.1.1 deduped\r\n│ │ │ ├── merge2@1.4.1\r\n│ │ │ ├─┬ micromatch@4.0.2\r\n│ │ │ │ ├── braces@3.0.2 deduped\r\n│ │ │ │ └── picomatch@2.2.2 deduped\r\n│ │ │ └── picomatch@2.2.2\r\n│ │ ├── find-cache-dir@3.3.1 deduped\r\n│ │ ├─┬ glob-parent@5.1.1\r\n│ │ │ └── is-glob@4.0.1 deduped\r\n│ │ ├─┬ globby@11.0.1\r\n│ │ │ ├── array-union@2.1.0\r\n│ │ │ ├─┬ dir-glob@3.0.1\r\n│ │ │ │ └── path-type@4.0.0\r\n│ │ │ ├── fast-glob@3.2.4 deduped\r\n│ │ │ ├── ignore@5.1.8\r\n│ │ │ ├── merge2@1.4.1 deduped\r\n│ │ │ └── slash@3.0.0\r\n│ │ ├── loader-utils@2.0.0 deduped\r\n│ │ ├── normalize-path@3.0.0\r\n│ │ ├─┬ p-limit@3.0.2\r\n│ │ │ └── p-try@2.2.0\r\n│ │ ├── schema-utils@2.7.1 deduped\r\n│ │ ├─┬ serialize-javascript@4.0.0\r\n│ │ │ └─┬ randombytes@2.1.0\r\n│ │ │   └── safe-buffer@5.1.2 deduped\r\n│ │ └── webpack-sources@1.4.3 deduped\r\n│ ├── core-js@3.6.4\r\n│ ├─┬ css-loader@3.5.3\r\n│ │ ├── camelcase@5.3.1\r\n│ │ ├── cssesc@3.0.0\r\n│ │ ├─┬ icss-utils@4.1.1\r\n│ │ │ └── postcss@7.0.31 deduped\r\n│ │ ├─┬ loader-utils@1.4.0\r\n│ │ │ ├── big.js@5.2.2 deduped\r\n│ │ │ ├── emojis-list@3.0.0 deduped\r\n│ │ │ └─┬ json5@1.0.1\r\n│ │ │   └── minimist@1.2.5 deduped\r\n│ │ ├── normalize-path@3.0.0 deduped\r\n│ │ ├── postcss@7.0.31 deduped\r\n│ │ ├─┬ postcss-modules-extract-imports@2.0.0\r\n│ │ │ └── postcss@7.0.31 deduped\r\n│ │ ├─┬ postcss-modules-local-by-default@3.0.3\r\n│ │ │ ├── icss-utils@4.1.1 deduped\r\n│ │ │ ├─┬ postcss@7.0.35\r\n│ │ │ │ ├── chalk@2.4.2 deduped\r\n│ │ │ │ ├── source-map@0.6.1\r\n│ │ │ │ └─┬ supports-color@6.1.0\r\n│ │ │ │   └── has-flag@3.0.0 deduped\r\n│ │ │ ├─┬ postcss-selector-parser@6.0.4\r\n│ │ │ │ ├── cssesc@3.0.0 deduped\r\n│ │ │ │ ├── indexes-of@1.0.1\r\n│ │ │ │ ├── uniq@1.0.1\r\n│ │ │ │ └── util-deprecate@1.0.2\r\n│ │ │ └── postcss-value-parser@4.1.0 deduped\r\n│ │ ├─┬ postcss-modules-scope@2.2.0\r\n│ │ │ ├── postcss@7.0.31 deduped\r\n│ │ │ └── postcss-selector-parser@6.0.4 deduped\r\n│ │ ├─┬ postcss-modules-values@3.0.0\r\n│ │ │ ├── icss-utils@4.1.1 deduped\r\n│ │ │ └── postcss@7.0.31 deduped\r\n│ │ ├── postcss-value-parser@4.1.0 deduped\r\n│ │ ├── schema-utils@2.7.1 deduped\r\n│ │ └── semver@6.3.0\r\n│ ├─┬ cssnano@4.1.10\r\n│ │ ├─┬ cosmiconfig@5.2.1\r\n│ │ │ ├─┬ import-fresh@2.0.0\r\n│ │ │ │ ├─┬ caller-path@2.0.0\r\n│ │ │ │ │ └─┬ caller-callsite@2.0.0\r\n│ │ │ │ │   └── callsites@2.0.0\r\n│ │ │ │ └── resolve-from@3.0.0\r\n│ │ │ ├── is-directory@0.3.1\r\n│ │ │ ├── js-yaml@3.14.0 deduped\r\n│ │ │ └─┬ parse-json@4.0.0\r\n│ │ │   ├─┬ error-ex@1.3.2\r\n│ │ │   │ └── is-arrayish@0.2.1\r\n│ │ │   └── json-parse-better-errors@1.0.2 deduped\r\n│ │ ├─┬ cssnano-preset-default@4.0.7\r\n│ │ │ ├─┬ css-declaration-sorter@4.0.1\r\n│ │ │ │ ├── postcss@7.0.31 deduped\r\n│ │ │ │ └── timsort@0.3.0\r\n│ │ │ ├─┬ cssnano-util-raw-cache@4.0.1\r\n│ │ │ │ └── postcss@7.0.31 deduped\r\n│ │ │ ├── postcss@7.0.31 deduped\r\n│ │ │ ├─┬ postcss-calc@7.0.5\r\n│ │ │ │ ├── postcss@7.0.31 deduped\r\n│ │ │ │ ├── postcss-selector-parser@6.0.4 deduped\r\n│ │ │ │ └── postcss-value-parser@4.1.0 deduped\r\n│ │ │ ├─┬ postcss-colormin@4.0.3\r\n│ │ │ │ ├── browserslist@4.14.5 deduped\r\n│ │ │ │ ├─┬ color@3.1.2\r\n│ │ │ │ │ ├── color-convert@1.9.3 deduped\r\n│ │ │ │ │ └─┬ color-string@1.5.3\r\n│ │ │ │ │   ├── color-name@1.1.3 deduped\r\n│ │ │ │ │   └─┬ simple-swizzle@0.2.2\r\n│ │ │ │ │     └── is-arrayish@0.3.2\r\n│ │ │ │ ├─┬ has@1.0.3\r\n│ │ │ │ │ └── function-bind@1.1.1\r\n│ │ │ │ ├── postcss@7.0.31 deduped\r\n│ │ │ │ └── postcss-value-parser@3.3.1\r\n│ │ │ ├─┬ postcss-convert-values@4.0.1\r\n│ │ │ │ ├── postcss@7.0.31 deduped\r\n│ │ │ │ └── postcss-value-parser@3.3.1\r\n│ │ │ ├─┬ postcss-discard-comments@4.0.2\r\n│ │ │ │ └── postcss@7.0.31 deduped\r\n│ │ │ ├─┬ postcss-discard-duplicates@4.0.2\r\n│ │ │ │ └── postcss@7.0.31 deduped\r\n│ │ │ ├─┬ postcss-discard-empty@4.0.1\r\n│ │ │ │ └── postcss@7.0.31 deduped\r\n│ │ │ ├─┬ postcss-discard-overridden@4.0.1\r\n│ │ │ │ └── postcss@7.0.31 deduped\r\n│ │ │ ├─┬ postcss-merge-longhand@4.0.11\r\n│ │ │ │ ├── css-color-names@0.0.4\r\n│ │ │ │ ├── postcss@7.0.31 deduped\r\n│ │ │ │ ├── postcss-value-parser@3.3.1\r\n│ │ │ │ └─┬ stylehacks@4.0.3\r\n│ │ │ │   ├── browserslist@4.14.5 deduped\r\n│ │ │ │   ├── postcss@7.0.31 deduped\r\n│ │ │ │   └─┬ postcss-selector-parser@3.1.2\r\n│ │ │ │     ├── dot-prop@5.3.0 deduped\r\n│ │ │ │     ├── indexes-of@1.0.1 deduped\r\n│ │ │ │     └── uniq@1.0.1 deduped\r\n│ │ │ ├─┬ postcss-merge-rules@4.0.3\r\n│ │ │ │ ├── browserslist@4.14.5 deduped\r\n│ │ │ │ ├─┬ caniuse-api@3.0.0\r\n│ │ │ │ │ ├── browserslist@4.14.5 deduped\r\n│ │ │ │ │ ├── caniuse-lite@1.0.30001144 deduped\r\n│ │ │ │ │ ├── lodash.memoize@4.1.2\r\n│ │ │ │ │ └── lodash.uniq@4.5.0\r\n│ │ │ │ ├── cssnano-util-same-parent@4.0.1\r\n│ │ │ │ ├── postcss@7.0.31 deduped\r\n│ │ │ │ ├─┬ postcss-selector-parser@3.1.2\r\n│ │ │ │ │ ├─┬ dot-prop@5.3.0\r\n│ │ │ │ │ │ └── is-obj@2.0.0\r\n│ │ │ │ │ ├── indexes-of@1.0.1 deduped\r\n│ │ │ │ │ └── uniq@1.0.1 deduped\r\n│ │ │ │ └── vendors@1.0.4\r\n│ │ │ ├─┬ postcss-minify-font-values@4.0.2\r\n│ │ │ │ ├── postcss@7.0.31 deduped\r\n│ │ │ │ └── postcss-value-parser@3.3.1\r\n│ │ │ ├─┬ postcss-minify-gradients@4.0.2\r\n│ │ │ │ ├── cssnano-util-get-arguments@4.0.0\r\n│ │ │ │ ├─┬ is-color-stop@1.1.0\r\n│ │ │ │ │ ├── css-color-names@0.0.4 deduped\r\n│ │ │ │ │ ├── hex-color-regex@1.1.0\r\n│ │ │ │ │ ├── hsl-regex@1.0.0\r\n│ │ │ │ │ ├── hsla-regex@1.0.0\r\n│ │ │ │ │ ├── rgb-regex@1.0.1\r\n│ │ │ │ │ └── rgba-regex@1.0.0\r\n│ │ │ │ ├── postcss@7.0.31 deduped\r\n│ │ │ │ └── postcss-value-parser@3.3.1\r\n│ │ │ ├─┬ postcss-minify-params@4.0.2\r\n│ │ │ │ ├── alphanum-sort@1.0.2\r\n│ │ │ │ ├── browserslist@4.14.5 deduped\r\n│ │ │ │ ├── cssnano-util-get-arguments@4.0.0 deduped\r\n│ │ │ │ ├── postcss@7.0.31 deduped\r\n│ │ │ │ ├── postcss-value-parser@3.3.1\r\n│ │ │ │ └── uniqs@2.0.0\r\n│ │ │ ├─┬ postcss-minify-selectors@4.0.2\r\n│ │ │ │ ├── alphanum-sort@1.0.2 deduped\r\n│ │ │ │ ├── has@1.0.3 deduped\r\n│ │ │ │ ├── postcss@7.0.31 deduped\r\n│ │ │ │ └─┬ postcss-selector-parser@3.1.2\r\n│ │ │ │   ├── dot-prop@5.3.0 deduped\r\n│ │ │ │   ├── indexes-of@1.0.1 deduped\r\n│ │ │ │   └── uniq@1.0.1 deduped\r\n│ │ │ ├─┬ postcss-normalize-charset@4.0.1\r\n│ │ │ │ └── postcss@7.0.31 deduped\r\n│ │ │ ├─┬ postcss-normalize-display-values@4.0.2\r\n│ │ │ │ ├── cssnano-util-get-match@4.0.0\r\n│ │ │ │ ├── postcss@7.0.31 deduped\r\n│ │ │ │ └── postcss-value-parser@3.3.1\r\n│ │ │ ├─┬ postcss-normalize-positions@4.0.2\r\n│ │ │ │ ├── cssnano-util-get-arguments@4.0.0 deduped\r\n│ │ │ │ ├── has@1.0.3 deduped\r\n│ │ │ │ ├── postcss@7.0.31 deduped\r\n│ │ │ │ └── postcss-value-parser@3.3.1\r\n│ │ │ ├─┬ postcss-normalize-repeat-style@4.0.2\r\n│ │ │ │ ├── cssnano-util-get-arguments@4.0.0 deduped\r\n│ │ │ │ ├── cssnano-util-get-match@4.0.0 deduped\r\n│ │ │ │ ├── postcss@7.0.31 deduped\r\n│ │ │ │ └── postcss-value-parser@3.3.1\r\n│ │ │ ├─┬ postcss-normalize-string@4.0.2\r\n│ │ │ │ ├── has@1.0.3 deduped\r\n│ │ │ │ ├── postcss@7.0.31 deduped\r\n│ │ │ │ └── postcss-value-parser@3.3.1\r\n│ │ │ ├─┬ postcss-normalize-timing-functions@4.0.2\r\n│ │ │ │ ├── cssnano-util-get-match@4.0.0 deduped\r\n│ │ │ │ ├── postcss@7.0.31 deduped\r\n│ │ │ │ └── postcss-value-parser@3.3.1\r\n│ │ │ ├─┬ postcss-normalize-unicode@4.0.1\r\n│ │ │ │ ├── browserslist@4.14.5 deduped\r\n│ │ │ │ ├── postcss@7.0.31 deduped\r\n│ │ │ │ └── postcss-value-parser@3.3.1\r\n│ │ │ ├─┬ postcss-normalize-url@4.0.1\r\n│ │ │ │ ├── is-absolute-url@2.1.0\r\n│ │ │ │ ├── normalize-url@3.3.0\r\n│ │ │ │ ├── postcss@7.0.31 deduped\r\n│ │ │ │ └── postcss-value-parser@3.3.1\r\n│ │ │ ├─┬ postcss-normalize-whitespace@4.0.2\r\n│ │ │ │ ├── postcss@7.0.31 deduped\r\n│ │ │ │ └── postcss-value-parser@3.3.1\r\n│ │ │ ├─┬ postcss-ordered-values@4.1.2\r\n│ │ │ │ ├── cssnano-util-get-arguments@4.0.0 deduped\r\n│ │ │ │ ├── postcss@7.0.31 deduped\r\n│ │ │ │ └── postcss-value-parser@3.3.1\r\n│ │ │ ├─┬ postcss-reduce-initial@4.0.3\r\n│ │ │ │ ├── browserslist@4.14.5 deduped\r\n│ │ │ │ ├── caniuse-api@3.0.0 deduped\r\n│ │ │ │ ├── has@1.0.3 deduped\r\n│ │ │ │ └── postcss@7.0.31 deduped\r\n│ │ │ ├─┬ postcss-reduce-transforms@4.0.2\r\n│ │ │ │ ├── cssnano-util-get-match@4.0.0 deduped\r\n│ │ │ │ ├── has@1.0.3 deduped\r\n│ │ │ │ ├── postcss@7.0.31 deduped\r\n│ │ │ │ └── postcss-value-parser@3.3.1\r\n│ │ │ ├─┬ postcss-svgo@4.0.2\r\n│ │ │ │ ├─┬ is-svg@3.0.0\r\n│ │ │ │ │ └── html-comment-regex@1.1.2\r\n│ │ │ │ ├── postcss@7.0.31 deduped\r\n│ │ │ │ ├── postcss-value-parser@3.3.1\r\n│ │ │ │ └─┬ svgo@1.3.2\r\n│ │ │ │   ├── chalk@2.4.2 deduped\r\n│ │ │ │   ├─┬ coa@2.0.2\r\n│ │ │ │   │ ├── @types/q@1.5.4\r\n│ │ │ │   │ ├── chalk@2.4.2 deduped\r\n│ │ │ │   │ └── q@1.5.1\r\n│ │ │ │   ├─┬ css-select@2.1.0\r\n│ │ │ │   │ ├── boolbase@1.0.0\r\n│ │ │ │   │ ├── css-what@3.4.1\r\n│ │ │ │   │ ├─┬ domutils@1.7.0\r\n│ │ │ │   │ │ ├─┬ dom-serializer@0.2.2\r\n│ │ │ │   │ │ │ ├── domelementtype@2.0.2\r\n│ │ │ │   │ │ │ └── entities@2.0.3\r\n│ │ │ │   │ │ └── domelementtype@1.3.1\r\n│ │ │ │   │ └─┬ nth-check@1.0.2\r\n│ │ │ │   │   └── boolbase@1.0.0 deduped\r\n│ │ │ │   ├── css-select-base-adapter@0.1.1\r\n│ │ │ │   ├─┬ css-tree@1.0.0-alpha.37\r\n│ │ │ │   │ ├── mdn-data@2.0.4\r\n│ │ │ │   │ └── source-map@0.6.1\r\n│ │ │ │   ├─┬ csso@4.0.3\r\n│ │ │ │   │ └─┬ css-tree@1.0.0-alpha.39\r\n│ │ │ │   │   ├── mdn-data@2.0.6\r\n│ │ │ │   │   └── source-map@0.6.1\r\n│ │ │ │   ├── js-yaml@3.14.0 deduped\r\n│ │ │ │   ├── mkdirp@0.5.5 deduped\r\n│ │ │ │   ├─┬ object.values@1.1.1\r\n│ │ │ │   │ ├── define-properties@1.1.3 deduped\r\n│ │ │ │   │ ├─┬ es-abstract@1.17.7\r\n│ │ │ │   │ │ ├── es-to-primitive@1.2.1 deduped\r\n│ │ │ │   │ │ ├── function-bind@1.1.1 deduped\r\n│ │ │ │   │ │ ├── has@1.0.3 deduped\r\n│ │ │ │   │ │ ├── has-symbols@1.0.1 deduped\r\n│ │ │ │   │ │ ├── is-callable@1.2.2 deduped\r\n│ │ │ │   │ │ ├── is-regex@1.1.1 deduped\r\n│ │ │ │   │ │ ├── object-inspect@1.8.0 deduped\r\n│ │ │ │   │ │ ├── object-keys@1.1.1 deduped\r\n│ │ │ │   │ │ ├── object.assign@4.1.1 deduped\r\n│ │ │ │   │ │ ├── string.prototype.trimend@1.0.1 deduped\r\n│ │ │ │   │ │ └── string.prototype.trimstart@1.0.1 deduped\r\n│ │ │ │   │ ├── function-bind@1.1.1 deduped\r\n│ │ │ │   │ └── has@1.0.3 deduped\r\n│ │ │ │   ├── sax@1.2.4 deduped\r\n│ │ │ │   ├── stable@0.1.8\r\n│ │ │ │   ├── unquote@1.1.1\r\n│ │ │ │   └─┬ util.promisify@1.0.1\r\n│ │ │ │     ├── define-properties@1.1.3 deduped\r\n│ │ │ │     ├─┬ es-abstract@1.17.7\r\n│ │ │ │     │ ├── es-to-primitive@1.2.1 deduped\r\n│ │ │ │     │ ├── function-bind@1.1.1 deduped\r\n│ │ │ │     │ ├── has@1.0.3 deduped\r\n│ │ │ │     │ ├── has-symbols@1.0.1 deduped\r\n│ │ │ │     │ ├── is-callable@1.2.2 deduped\r\n│ │ │ │     │ ├── is-regex@1.1.1 deduped\r\n│ │ │ │     │ ├── object-inspect@1.8.0 deduped\r\n│ │ │ │     │ ├── object-keys@1.1.1 deduped\r\n│ │ │ │     │ ├── object.assign@4.1.1 deduped\r\n│ │ │ │     │ ├── string.prototype.trimend@1.0.1 deduped\r\n│ │ │ │     │ └── string.prototype.trimstart@1.0.1 deduped\r\n│ │ │ │     ├── has-symbols@1.0.1 deduped\r\n│ │ │ │     └── object.getownpropertydescriptors@2.1.0 deduped\r\n│ │ │ └─┬ postcss-unique-selectors@4.0.1\r\n│ │ │   ├── alphanum-sort@1.0.2 deduped\r\n│ │ │   ├── postcss@7.0.31 deduped\r\n│ │ │   └── uniqs@2.0.0 deduped\r\n│ │ ├── is-resolvable@1.1.0\r\n│ │ └── postcss@7.0.31 deduped\r\n│ ├─┬ file-loader@6.0.0\r\n│ │ ├── loader-utils@2.0.0 deduped\r\n│ │ └── schema-utils@2.7.1 deduped\r\n│ ├─┬ find-cache-dir@3.3.1\r\n│ │ ├── commondir@1.0.1\r\n│ │ ├─┬ make-dir@3.1.0\r\n│ │ │ └── semver@6.3.0\r\n│ │ └─┬ pkg-dir@4.2.0\r\n│ │   └─┬ find-up@4.1.0\r\n│ │     ├─┬ locate-path@5.0.0\r\n│ │     │ └─┬ p-locate@4.1.0\r\n│ │     │   └── p-limit@2.3.0 deduped\r\n│ │     └── path-exists@4.0.0\r\n│ ├─┬ glob@7.1.6\r\n│ │ ├── fs.realpath@1.0.0\r\n│ │ ├─┬ inflight@1.0.6\r\n│ │ │ ├── once@1.4.0 deduped\r\n│ │ │ └── wrappy@1.0.2\r\n│ │ ├── inherits@2.0.4\r\n│ │ ├── minimatch@3.0.4 deduped\r\n│ │ ├─┬ once@1.4.0\r\n│ │ │ └── wrappy@1.0.2 deduped\r\n│ │ └── path-is-absolute@1.0.1\r\n│ ├─┬ jest-worker@26.0.0\r\n│ │ ├── merge-stream@2.0.0\r\n│ │ └─┬ supports-color@7.2.0\r\n│ │   └── has-flag@4.0.0\r\n│ ├─┬ karma-source-map-support@1.4.0\r\n│ │ └── source-map-support@0.5.19 deduped\r\n│ ├─┬ less-loader@6.1.0\r\n│ │ ├── clone@2.1.2\r\n│ │ ├─┬ less@3.12.2\r\n│ │ │ ├─┬ errno@0.1.7\r\n│ │ │ │ └── prr@1.0.1\r\n│ │ │ ├── graceful-fs@4.2.4 deduped\r\n│ │ │ ├── image-size@0.5.5\r\n│ │ │ ├── make-dir@2.1.0 deduped\r\n│ │ │ ├── mime@1.6.0\r\n│ │ │ ├── native-request@1.0.7\r\n│ │ │ ├── source-map@0.6.1\r\n│ │ │ └── tslib@1.13.0\r\n│ │ ├── loader-utils@2.0.0 deduped\r\n│ │ └── schema-utils@2.7.1 deduped\r\n│ ├─┬ license-webpack-plugin@2.2.0\r\n│ │ ├─┬ @types/webpack-sources@0.1.8\r\n│ │ │ ├── @types/node@12.12.64 deduped\r\n│ │ │ ├── @types/source-list-map@0.1.2\r\n│ │ │ └── source-map@0.6.1\r\n│ │ └── webpack-sources@1.4.3 deduped\r\n│ ├─┬ loader-utils@2.0.0\r\n│ │ ├── big.js@5.2.2\r\n│ │ ├── emojis-list@3.0.0\r\n│ │ └── json5@2.1.3 deduped\r\n│ ├─┬ mini-css-extract-plugin@0.9.0\r\n│ │ ├─┬ loader-utils@1.4.0\r\n│ │ │ ├── big.js@5.2.2 deduped\r\n│ │ │ ├── emojis-list@3.0.0 deduped\r\n│ │ │ └─┬ json5@1.0.1\r\n│ │ │   └── minimist@1.2.5 deduped\r\n│ │ ├─┬ normalize-url@1.9.1\r\n│ │ │ ├── object-assign@4.1.1\r\n│ │ │ ├── prepend-http@1.0.4\r\n│ │ │ ├─┬ query-string@4.3.4\r\n│ │ │ │ ├── object-assign@4.1.1 deduped\r\n│ │ │ │ └── strict-uri-encode@1.1.0\r\n│ │ │ └─┬ sort-keys@1.1.2\r\n│ │ │   └── is-plain-obj@1.1.0\r\n│ │ ├─┬ schema-utils@1.0.0\r\n│ │ │ ├── ajv@6.12.3 deduped\r\n│ │ │ ├── ajv-errors@1.0.1\r\n│ │ │ └── ajv-keywords@3.5.2 deduped\r\n│ │ └── webpack-sources@1.4.3 deduped\r\n│ ├─┬ minimatch@3.0.4\r\n│ │ └─┬ brace-expansion@1.1.11\r\n│ │   ├── balanced-match@1.0.0\r\n│ │   └── concat-map@0.0.1\r\n│ ├─┬ open@7.0.4\r\n│ │ ├── is-docker@2.1.1\r\n│ │ └─┬ is-wsl@2.2.0\r\n│ │   └── is-docker@2.1.1 deduped\r\n│ ├── parse5@4.0.0\r\n│ ├─┬ pnp-webpack-plugin@1.6.4\r\n│ │ └── ts-pnp@1.2.0\r\n│ ├─┬ postcss@7.0.31\r\n│ │ ├── chalk@2.4.2 deduped\r\n│ │ ├── source-map@0.6.1\r\n│ │ └─┬ supports-color@6.1.0\r\n│ │   └── has-flag@3.0.0\r\n│ ├─┬ postcss-import@12.0.1\r\n│ │ ├── postcss@7.0.31 deduped\r\n│ │ ├── postcss-value-parser@3.3.1\r\n│ │ ├─┬ read-cache@1.0.0\r\n│ │ │ └── pify@2.3.0\r\n│ │ └── resolve@1.17.0 deduped\r\n│ ├─┬ postcss-loader@3.0.0\r\n│ │ ├─┬ loader-utils@1.4.0\r\n│ │ │ ├── big.js@5.2.2 deduped\r\n│ │ │ ├── emojis-list@3.0.0 deduped\r\n│ │ │ └─┬ json5@1.0.1\r\n│ │ │   └── minimist@1.2.5 deduped\r\n│ │ ├── postcss@7.0.31 deduped\r\n│ │ ├─┬ postcss-load-config@2.1.2\r\n│ │ │ ├── cosmiconfig@5.2.1 deduped\r\n│ │ │ └─┬ import-cwd@2.1.0\r\n│ │ │   └─┬ import-from@2.1.0\r\n│ │ │     └── resolve-from@3.0.0 deduped\r\n│ │ └─┬ schema-utils@1.0.0\r\n│ │   ├── ajv@6.12.3 deduped\r\n│ │   ├── ajv-errors@1.0.1 deduped\r\n│ │   └── ajv-keywords@3.5.2 deduped\r\n│ ├─┬ raw-loader@4.0.1\r\n│ │ ├── loader-utils@2.0.0 deduped\r\n│ │ └── schema-utils@2.7.1 deduped\r\n│ ├── regenerator-runtime@0.13.5\r\n│ ├─┬ resolve-url-loader@3.1.1\r\n│ │ ├─┬ adjust-sourcemap-loader@2.0.0\r\n│ │ │ ├─┬ assert@1.4.1\r\n│ │ │ │ └─┬ util@0.10.3\r\n│ │ │ │   └── inherits@2.0.1\r\n│ │ │ ├── camelcase@5.0.0\r\n│ │ │ ├─┬ loader-utils@1.2.3\r\n│ │ │ │ ├── big.js@5.2.2 deduped\r\n│ │ │ │ ├── emojis-list@2.1.0\r\n│ │ │ │ └─┬ json5@1.0.1\r\n│ │ │ │   └── minimist@1.2.5 deduped\r\n│ │ │ ├── object-path@0.11.4\r\n│ │ │ └── regex-parser@2.2.10\r\n│ │ ├── camelcase@5.3.1 deduped\r\n│ │ ├─┬ compose-function@3.0.3\r\n│ │ │ └── arity-n@1.0.4\r\n│ │ ├── convert-source-map@1.7.0 deduped\r\n│ │ ├─┬ es6-iterator@2.0.3\r\n│ │ │ ├─┬ d@1.0.1\r\n│ │ │ │ ├── es5-ext@0.10.53 deduped\r\n│ │ │ │ └── type@1.2.0\r\n│ │ │ ├─┬ es5-ext@0.10.53\r\n│ │ │ │ ├── es6-iterator@2.0.3 deduped\r\n│ │ │ │ ├── es6-symbol@3.1.3 deduped\r\n│ │ │ │ └── next-tick@1.0.0\r\n│ │ │ └─┬ es6-symbol@3.1.3\r\n│ │ │   ├── d@1.0.1 deduped\r\n│ │ │   └─┬ ext@1.4.0\r\n│ │ │     └── type@2.1.0\r\n│ │ ├─┬ loader-utils@1.2.3\r\n│ │ │ ├── big.js@5.2.2 deduped\r\n│ │ │ ├── emojis-list@2.1.0\r\n│ │ │ └─┬ json5@1.0.1\r\n│ │ │   └── minimist@1.2.5 deduped\r\n│ │ ├─┬ postcss@7.0.21\r\n│ │ │ ├── chalk@2.4.2 deduped\r\n│ │ │ ├── source-map@0.6.1 deduped\r\n│ │ │ └─┬ supports-color@6.1.0\r\n│ │ │   └── has-flag@3.0.0 deduped\r\n│ │ ├─┬ rework@1.0.1\r\n│ │ │ ├── convert-source-map@0.3.5\r\n│ │ │ └─┬ css@2.2.4\r\n│ │ │   ├── inherits@2.0.4 deduped\r\n│ │ │   ├── source-map@0.6.1\r\n│ │ │   ├─┬ source-map-resolve@0.5.3\r\n│ │ │   │ ├── atob@2.1.2\r\n│ │ │   │ ├── decode-uri-component@0.2.0\r\n│ │ │   │ ├── resolve-url@0.2.1\r\n│ │ │   │ ├── source-map-url@0.4.0\r\n│ │ │   │ └── urix@0.1.0 deduped\r\n│ │ │   └── urix@0.1.0\r\n│ │ ├── rework-visit@1.0.0\r\n│ │ └── source-map@0.6.1\r\n│ ├─┬ rimraf@3.0.2\r\n│ │ └── glob@7.1.6 deduped\r\n│ ├─┬ rollup@2.10.9\r\n│ │ └── UNMET OPTIONAL DEPENDENCY fsevents@2.1.3\r\n│ ├── rxjs@6.5.5 deduped\r\n│ ├─┬ sass@1.26.5\r\n│ │ └── chokidar@3.4.2 deduped\r\n│ ├─┬ sass-loader@8.0.2\r\n│ │ ├─┬ clone-deep@4.0.1\r\n│ │ │ ├─┬ is-plain-object@2.0.4\r\n│ │ │ │ └── isobject@3.0.1\r\n│ │ │ ├── kind-of@6.0.3\r\n│ │ │ └─┬ shallow-clone@3.0.1\r\n│ │ │   └── kind-of@6.0.3 deduped\r\n│ │ ├─┬ loader-utils@1.4.0\r\n│ │ │ ├── big.js@5.2.2 deduped\r\n│ │ │ ├── emojis-list@3.0.0 deduped\r\n│ │ │ └─┬ json5@1.0.1\r\n│ │ │   └── minimist@1.2.5 deduped\r\n│ │ ├── neo-async@2.6.2\r\n│ │ ├── schema-utils@2.7.1 deduped\r\n│ │ └── semver@6.3.0\r\n│ ├── semver@7.3.2\r\n│ ├── source-map@0.7.3\r\n│ ├─┬ source-map-loader@1.0.0\r\n│ │ ├─┬ data-urls@2.0.0\r\n│ │ │ ├── abab@2.0.5\r\n│ │ │ ├── whatwg-mimetype@2.3.0\r\n│ │ │ └─┬ whatwg-url@8.3.0\r\n│ │ │   ├── lodash.sortby@4.7.0\r\n│ │ │   ├─┬ tr46@2.0.2\r\n│ │ │   │ └── punycode@2.1.1\r\n│ │ │   └── webidl-conversions@6.1.0\r\n│ │ ├─┬ iconv-lite@0.5.2\r\n│ │ │ └── safer-buffer@2.1.2 deduped\r\n│ │ ├── loader-utils@2.0.0 deduped\r\n│ │ ├── schema-utils@2.7.1 deduped\r\n│ │ └── source-map@0.6.1\r\n│ ├─┬ source-map-support@0.5.19\r\n│ │ ├── buffer-from@1.1.1\r\n│ │ └── source-map@0.6.1\r\n│ ├─┬ speed-measure-webpack-plugin@1.3.3\r\n│ │ └── chalk@2.4.2 deduped\r\n│ ├─┬ style-loader@1.2.1\r\n│ │ ├── loader-utils@2.0.0 deduped\r\n│ │ └── schema-utils@2.7.1 deduped\r\n│ ├─┬ stylus@0.54.7\r\n│ │ ├─┬ css-parse@2.0.0\r\n│ │ │ └── css@2.2.4 deduped\r\n│ │ ├─┬ debug@3.1.0\r\n│ │ │ └── ms@2.0.0\r\n│ │ ├── glob@7.1.6 deduped\r\n│ │ ├── mkdirp@0.5.5 deduped\r\n│ │ ├── safer-buffer@2.1.2\r\n│ │ ├── sax@1.2.4\r\n│ │ ├── semver@6.3.0\r\n│ │ └── source-map@0.7.3 deduped\r\n│ ├─┬ stylus-loader@3.0.2\r\n│ │ ├─┬ loader-utils@1.4.0\r\n│ │ │ ├── big.js@5.2.2 deduped\r\n│ │ │ ├── emojis-list@3.0.0 deduped\r\n│ │ │ └─┬ json5@1.0.1\r\n│ │ │   └── minimist@1.2.5 deduped\r\n│ │ ├── lodash.clonedeep@4.5.0\r\n│ │ └── when@3.6.4\r\n│ ├─┬ terser@4.7.0\r\n│ │ ├── commander@2.20.3 deduped\r\n│ │ ├── source-map@0.6.1\r\n│ │ └── source-map-support@0.5.19 deduped\r\n│ ├─┬ terser-webpack-plugin@3.0.1\r\n│ │ ├── cacache@15.0.3 deduped\r\n│ │ ├── find-cache-dir@3.3.1 deduped\r\n│ │ ├── jest-worker@26.0.0 deduped\r\n│ │ ├─┬ p-limit@2.3.0\r\n│ │ │ └── p-try@2.2.0 deduped\r\n│ │ ├── schema-utils@2.7.1 deduped\r\n│ │ ├─┬ serialize-javascript@3.1.0\r\n│ │ │ └── randombytes@2.1.0 deduped\r\n│ │ ├── source-map@0.6.1\r\n│ │ ├── terser@4.7.0 deduped\r\n│ │ └── webpack-sources@1.4.3 deduped\r\n│ ├── tree-kill@1.2.2\r\n│ ├─┬ webpack@4.43.0\r\n│ │ ├─┬ @webassemblyjs/ast@1.9.0\r\n│ │ │ ├── @webassemblyjs/helper-module-context@1.9.0 deduped\r\n│ │ │ ├── @webassemblyjs/helper-wasm-bytecode@1.9.0\r\n│ │ │ └─┬ @webassemblyjs/wast-parser@1.9.0\r\n│ │ │   ├── @webassemblyjs/ast@1.9.0 deduped\r\n│ │ │   ├── @webassemblyjs/floating-point-hex-parser@1.9.0\r\n│ │ │   ├── @webassemblyjs/helper-api-error@1.9.0 deduped\r\n│ │ │   ├─┬ @webassemblyjs/helper-code-frame@1.9.0\r\n│ │ │   │ └── @webassemblyjs/wast-printer@1.9.0 deduped\r\n│ │ │   ├── @webassemblyjs/helper-fsm@1.9.0\r\n│ │ │   └── @xtuc/long@4.2.2\r\n│ │ ├─┬ @webassemblyjs/helper-module-context@1.9.0\r\n│ │ │ └── @webassemblyjs/ast@1.9.0 deduped\r\n│ │ ├─┬ @webassemblyjs/wasm-edit@1.9.0\r\n│ │ │ ├── @webassemblyjs/ast@1.9.0 deduped\r\n│ │ │ ├── @webassemblyjs/helper-buffer@1.9.0\r\n│ │ │ ├── @webassemblyjs/helper-wasm-bytecode@1.9.0 deduped\r\n│ │ │ ├─┬ @webassemblyjs/helper-wasm-section@1.9.0\r\n│ │ │ │ ├── @webassemblyjs/ast@1.9.0 deduped\r\n│ │ │ │ ├── @webassemblyjs/helper-buffer@1.9.0 deduped\r\n│ │ │ │ ├── @webassemblyjs/helper-wasm-bytecode@1.9.0 deduped\r\n│ │ │ │ └── @webassemblyjs/wasm-gen@1.9.0 deduped\r\n│ │ │ ├─┬ @webassemblyjs/wasm-gen@1.9.0\r\n│ │ │ │ ├── @webassemblyjs/ast@1.9.0 deduped\r\n│ │ │ │ ├── @webassemblyjs/helper-wasm-bytecode@1.9.0 deduped\r\n│ │ │ │ ├── @webassemblyjs/ieee754@1.9.0 deduped\r\n│ │ │ │ ├── @webassemblyjs/leb128@1.9.0 deduped\r\n│ │ │ │ └── @webassemblyjs/utf8@1.9.0 deduped\r\n│ │ │ ├─┬ @webassemblyjs/wasm-opt@1.9.0\r\n│ │ │ │ ├── @webassemblyjs/ast@1.9.0 deduped\r\n│ │ │ │ ├── @webassemblyjs/helper-buffer@1.9.0 deduped\r\n│ │ │ │ ├── @webassemblyjs/wasm-gen@1.9.0 deduped\r\n│ │ │ │ └── @webassemblyjs/wasm-parser@1.9.0 deduped\r\n│ │ │ ├── @webassemblyjs/wasm-parser@1.9.0 deduped\r\n│ │ │ └─┬ @webassemblyjs/wast-printer@1.9.0\r\n│ │ │   ├── @webassemblyjs/ast@1.9.0 deduped\r\n│ │ │   ├── @webassemblyjs/wast-parser@1.9.0 deduped\r\n│ │ │   └── @xtuc/long@4.2.2 deduped\r\n│ │ ├─┬ @webassemblyjs/wasm-parser@1.9.0\r\n│ │ │ ├── @webassemblyjs/ast@1.9.0 deduped\r\n│ │ │ ├── @webassemblyjs/helper-api-error@1.9.0\r\n│ │ │ ├── @webassemblyjs/helper-wasm-bytecode@1.9.0 deduped\r\n│ │ │ ├─┬ @webassemblyjs/ieee754@1.9.0\r\n│ │ │ │ └── @xtuc/ieee754@1.2.0\r\n│ │ │ ├─┬ @webassemblyjs/leb128@1.9.0\r\n│ │ │ │ └── @xtuc/long@4.2.2 deduped\r\n│ │ │ └── @webassemblyjs/utf8@1.9.0\r\n│ │ ├── acorn@6.4.2\r\n│ │ ├── ajv@6.12.3 deduped\r\n│ │ ├── ajv-keywords@3.5.2\r\n│ │ ├─┬ chrome-trace-event@1.0.2\r\n│ │ │ └── tslib@1.13.0\r\n│ │ ├── enhanced-resolve@4.1.1 deduped\r\n│ │ ├─┬ eslint-scope@4.0.3\r\n│ │ │ ├─┬ esrecurse@4.3.0\r\n│ │ │ │ └── estraverse@5.2.0\r\n│ │ │ └── estraverse@4.3.0\r\n│ │ ├── json-parse-better-errors@1.0.2\r\n│ │ ├── loader-runner@2.4.0\r\n│ │ ├─┬ loader-utils@1.4.0\r\n│ │ │ ├── big.js@5.2.2 deduped\r\n│ │ │ ├── emojis-list@3.0.0 deduped\r\n│ │ │ └─┬ json5@1.0.1\r\n│ │ │   └── minimist@1.2.5 deduped\r\n│ │ ├─┬ memory-fs@0.4.1\r\n│ │ │ ├── errno@0.1.7 deduped\r\n│ │ │ └── readable-stream@2.3.7 deduped\r\n│ │ ├─┬ micromatch@3.1.10\r\n│ │ │ ├── arr-diff@4.0.0\r\n│ │ │ ├── array-unique@0.3.2\r\n│ │ │ ├─┬ braces@2.3.2\r\n│ │ │ │ ├── arr-flatten@1.1.0\r\n│ │ │ │ ├── array-unique@0.3.2 deduped\r\n│ │ │ │ ├─┬ extend-shallow@2.0.1\r\n│ │ │ │ │ └── is-extendable@0.1.1 deduped\r\n│ │ │ │ ├─┬ fill-range@4.0.0\r\n│ │ │ │ │ ├─┬ extend-shallow@2.0.1\r\n│ │ │ │ │ │ └── is-extendable@0.1.1 deduped\r\n│ │ │ │ │ ├─┬ is-number@3.0.0\r\n│ │ │ │ │ │ └─┬ kind-of@3.2.2\r\n│ │ │ │ │ │   └── is-buffer@1.1.6\r\n│ │ │ │ │ ├── repeat-string@1.6.1\r\n│ │ │ │ │ └─┬ to-regex-range@2.1.1\r\n│ │ │ │ │   ├── is-number@3.0.0 deduped\r\n│ │ │ │ │   └── repeat-string@1.6.1 deduped\r\n│ │ │ │ ├── isobject@3.0.1 deduped\r\n│ │ │ │ ├── repeat-element@1.1.3\r\n│ │ │ │ ├── snapdragon@0.8.2 deduped\r\n│ │ │ │ ├─┬ snapdragon-node@2.1.1\r\n│ │ │ │ │ ├─┬ define-property@1.0.0\r\n│ │ │ │ │ │ └─┬ is-descriptor@1.0.2\r\n│ │ │ │ │ │   ├─┬ is-accessor-descriptor@1.0.0\r\n│ │ │ │ │ │   │ └── kind-of@6.0.3 deduped\r\n│ │ │ │ │ │   ├─┬ is-data-descriptor@1.0.0\r\n│ │ │ │ │ │   │ └── kind-of@6.0.3 deduped\r\n│ │ │ │ │ │   └── kind-of@6.0.3 deduped\r\n│ │ │ │ │ ├── isobject@3.0.1 deduped\r\n│ │ │ │ │ └─┬ snapdragon-util@3.0.1\r\n│ │ │ │ │   └─┬ kind-of@3.2.2\r\n│ │ │ │ │     └── is-buffer@1.1.6\r\n│ │ │ │ ├─┬ split-string@3.1.0\r\n│ │ │ │ │ └── extend-shallow@3.0.2 deduped\r\n│ │ │ │ └── to-regex@3.0.2 deduped\r\n│ │ │ ├─┬ define-property@2.0.2\r\n│ │ │ │ ├─┬ is-descriptor@1.0.2\r\n│ │ │ │ │ ├─┬ is-accessor-descriptor@1.0.0\r\n│ │ │ │ │ │ └── kind-of@6.0.3 deduped\r\n│ │ │ │ │ ├─┬ is-data-descriptor@1.0.0\r\n│ │ │ │ │ │ └── kind-of@6.0.3 deduped\r\n│ │ │ │ │ └── kind-of@6.0.3 deduped\r\n│ │ │ │ └── isobject@3.0.1 deduped\r\n│ │ │ ├─┬ extend-shallow@3.0.2\r\n│ │ │ │ ├── assign-symbols@1.0.0\r\n│ │ │ │ └─┬ is-extendable@1.0.1\r\n│ │ │ │   └── is-plain-object@2.0.4 deduped\r\n│ │ │ ├─┬ extglob@2.0.4\r\n│ │ │ │ ├── array-unique@0.3.2 deduped\r\n│ │ │ │ ├─┬ define-property@1.0.0\r\n│ │ │ │ │ └─┬ is-descriptor@1.0.2\r\n│ │ │ │ │   ├─┬ is-accessor-descriptor@1.0.0\r\n│ │ │ │ │   │ └── kind-of@6.0.3 deduped\r\n│ │ │ │ │   ├─┬ is-data-descriptor@1.0.0\r\n│ │ │ │ │   │ └── kind-of@6.0.3 deduped\r\n│ │ │ │ │   └── kind-of@6.0.3 deduped\r\n│ │ │ │ ├─┬ expand-brackets@2.1.4\r\n│ │ │ │ │ ├─┬ debug@2.6.9\r\n│ │ │ │ │ │ └── ms@2.0.0 deduped\r\n│ │ │ │ │ ├─┬ define-property@0.2.5\r\n│ │ │ │ │ │ └── is-descriptor@0.1.6 deduped\r\n│ │ │ │ │ ├─┬ extend-shallow@2.0.1\r\n│ │ │ │ │ │ └── is-extendable@0.1.1 deduped\r\n│ │ │ │ │ ├── posix-character-classes@0.1.1\r\n│ │ │ │ │ ├── regex-not@1.0.2 deduped\r\n│ │ │ │ │ ├── snapdragon@0.8.2 deduped\r\n│ │ │ │ │ └── to-regex@3.0.2 deduped\r\n│ │ │ │ ├─┬ extend-shallow@2.0.1\r\n│ │ │ │ │ └── is-extendable@0.1.1\r\n│ │ │ │ ├── fragment-cache@0.2.1 deduped\r\n│ │ │ │ ├── regex-not@1.0.2 deduped\r\n│ │ │ │ ├── snapdragon@0.8.2 deduped\r\n│ │ │ │ └── to-regex@3.0.2 deduped\r\n│ │ │ ├─┬ fragment-cache@0.2.1\r\n│ │ │ │ └── map-cache@0.2.2\r\n│ │ │ ├── kind-of@6.0.3 deduped\r\n│ │ │ ├─┬ nanomatch@1.2.13\r\n│ │ │ │ ├── arr-diff@4.0.0 deduped\r\n│ │ │ │ ├── array-unique@0.3.2 deduped\r\n│ │ │ │ ├── define-property@2.0.2 deduped\r\n│ │ │ │ ├── extend-shallow@3.0.2 deduped\r\n│ │ │ │ ├── fragment-cache@0.2.1 deduped\r\n│ │ │ │ ├── is-windows@1.0.2\r\n│ │ │ │ ├── kind-of@6.0.3 deduped\r\n│ │ │ │ ├── object.pick@1.3.0 deduped\r\n│ │ │ │ ├── regex-not@1.0.2 deduped\r\n│ │ │ │ ├── snapdragon@0.8.2 deduped\r\n│ │ │ │ └── to-regex@3.0.2 deduped\r\n│ │ │ ├─┬ object.pick@1.3.0\r\n│ │ │ │ └── isobject@3.0.1 deduped\r\n│ │ │ ├─┬ regex-not@1.0.2\r\n│ │ │ │ ├── extend-shallow@3.0.2 deduped\r\n│ │ │ │ └─┬ safe-regex@1.1.0\r\n│ │ │ │   └── ret@0.1.15\r\n│ │ │ ├─┬ snapdragon@0.8.2\r\n│ │ │ │ ├─┬ base@0.11.2\r\n│ │ │ │ │ ├─┬ cache-base@1.0.1\r\n│ │ │ │ │ │ ├─┬ collection-visit@1.0.0\r\n│ │ │ │ │ │ │ ├─┬ map-visit@1.0.0\r\n│ │ │ │ │ │ │ │ └── object-visit@1.0.1 deduped\r\n│ │ │ │ │ │ │ └─┬ object-visit@1.0.1\r\n│ │ │ │ │ │ │   └── isobject@3.0.1 deduped\r\n│ │ │ │ │ │ ├── component-emitter@1.3.0 deduped\r\n│ │ │ │ │ │ ├── get-value@2.0.6\r\n│ │ │ │ │ │ ├─┬ has-value@1.0.0\r\n│ │ │ │ │ │ │ ├── get-value@2.0.6 deduped\r\n│ │ │ │ │ │ │ ├─┬ has-values@1.0.0\r\n│ │ │ │ │ │ │ │ ├─┬ is-number@3.0.0\r\n│ │ │ │ │ │ │ │ │ └─┬ kind-of@3.2.2\r\n│ │ │ │ │ │ │ │ │   └── is-buffer@1.1.6 deduped\r\n│ │ │ │ │ │ │ │ └─┬ kind-of@4.0.0\r\n│ │ │ │ │ │ │ │   └── is-buffer@1.1.6\r\n│ │ │ │ │ │ │ └── isobject@3.0.1 deduped\r\n│ │ │ │ │ │ ├── isobject@3.0.1 deduped\r\n│ │ │ │ │ │ ├─┬ set-value@2.0.1\r\n│ │ │ │ │ │ │ ├─┬ extend-shallow@2.0.1\r\n│ │ │ │ │ │ │ │ └── is-extendable@0.1.1 deduped\r\n│ │ │ │ │ │ │ ├── is-extendable@0.1.1 deduped\r\n│ │ │ │ │ │ │ ├── is-plain-object@2.0.4 deduped\r\n│ │ │ │ │ │ │ └── split-string@3.1.0 deduped\r\n│ │ │ │ │ │ ├─┬ to-object-path@0.3.0\r\n│ │ │ │ │ │ │ └─┬ kind-of@3.2.2\r\n│ │ │ │ │ │ │   └── is-buffer@1.1.6\r\n│ │ │ │ │ │ ├─┬ union-value@1.0.1\r\n│ │ │ │ │ │ │ ├── arr-union@3.1.0 deduped\r\n│ │ │ │ │ │ │ ├── get-value@2.0.6 deduped\r\n│ │ │ │ │ │ │ ├── is-extendable@0.1.1 deduped\r\n│ │ │ │ │ │ │ └── set-value@2.0.1 deduped\r\n│ │ │ │ │ │ └─┬ unset-value@1.0.0\r\n│ │ │ │ │ │   ├─┬ has-value@0.3.1\r\n│ │ │ │ │ │   │ ├── get-value@2.0.6 deduped\r\n│ │ │ │ │ │   │ ├── has-values@0.1.4\r\n│ │ │ │ │ │   │ └─┬ isobject@2.1.0\r\n│ │ │ │ │ │   │   └── isarray@1.0.0 deduped\r\n│ │ │ │ │ │   └── isobject@3.0.1 deduped\r\n│ │ │ │ │ ├─┬ class-utils@0.3.6\r\n│ │ │ │ │ │ ├── arr-union@3.1.0\r\n│ │ │ │ │ │ ├─┬ define-property@0.2.5\r\n│ │ │ │ │ │ │ └── is-descriptor@0.1.6 deduped\r\n│ │ │ │ │ │ ├── isobject@3.0.1 deduped\r\n│ │ │ │ │ │ └─┬ static-extend@0.1.2\r\n│ │ │ │ │ │   ├─┬ define-property@0.2.5\r\n│ │ │ │ │ │   │ └── is-descriptor@0.1.6 deduped\r\n│ │ │ │ │ │   └─┬ object-copy@0.1.0\r\n│ │ │ │ │ │     ├── copy-descriptor@0.1.1\r\n│ │ │ │ │ │     ├─┬ define-property@0.2.5\r\n│ │ │ │ │ │     │ └── is-descriptor@0.1.6 deduped\r\n│ │ │ │ │ │     └─┬ kind-of@3.2.2\r\n│ │ │ │ │ │       └── is-buffer@1.1.6\r\n│ │ │ │ │ ├── component-emitter@1.3.0 deduped\r\n│ │ │ │ │ ├─┬ define-property@1.0.0\r\n│ │ │ │ │ │ └─┬ is-descriptor@1.0.2\r\n│ │ │ │ │ │   ├─┬ is-accessor-descriptor@1.0.0\r\n│ │ │ │ │ │   │ └── kind-of@6.0.3 deduped\r\n│ │ │ │ │ │   ├─┬ is-data-descriptor@1.0.0\r\n│ │ │ │ │ │   │ └── kind-of@6.0.3 deduped\r\n│ │ │ │ │ │   └── kind-of@6.0.3 deduped\r\n│ │ │ │ │ ├── isobject@3.0.1 deduped\r\n│ │ │ │ │ ├─┬ mixin-deep@1.3.2\r\n│ │ │ │ │ │ ├── for-in@1.0.2\r\n│ │ │ │ │ │ └─┬ is-extendable@1.0.1\r\n│ │ │ │ │ │   └── is-plain-object@2.0.4 deduped\r\n│ │ │ │ │ └── pascalcase@0.1.1\r\n│ │ │ │ ├─┬ debug@2.6.9\r\n│ │ │ │ │ └── ms@2.0.0 deduped\r\n│ │ │ │ ├─┬ define-property@0.2.5\r\n│ │ │ │ │ └─┬ is-descriptor@0.1.6\r\n│ │ │ │ │   ├─┬ is-accessor-descriptor@0.1.6\r\n│ │ │ │ │   │ └─┬ kind-of@3.2.2\r\n│ │ │ │ │   │   └── is-buffer@1.1.6\r\n│ │ │ │ │   ├─┬ is-data-descriptor@0.1.4\r\n│ │ │ │ │   │ └─┬ kind-of@3.2.2\r\n│ │ │ │ │   │   └── is-buffer@1.1.6\r\n│ │ │ │ │   └── kind-of@5.1.0\r\n│ │ │ │ ├─┬ extend-shallow@2.0.1\r\n│ │ │ │ │ └── is-extendable@0.1.1 deduped\r\n│ │ │ │ ├── map-cache@0.2.2 deduped\r\n│ │ │ │ ├── source-map@0.5.7\r\n│ │ │ │ ├── source-map-resolve@0.5.3 deduped\r\n│ │ │ │ └── use@3.1.1\r\n│ │ │ └─┬ to-regex@3.0.2\r\n│ │ │   ├── define-property@2.0.2 deduped\r\n│ │ │   ├── extend-shallow@3.0.2 deduped\r\n│ │ │   ├── regex-not@1.0.2 deduped\r\n│ │ │   └── safe-regex@1.1.0 deduped\r\n│ │ ├── mkdirp@0.5.5 deduped\r\n│ │ ├── neo-async@2.6.2 deduped\r\n│ │ ├─┬ node-libs-browser@2.2.1\r\n│ │ │ ├── assert@1.4.1 deduped\r\n│ │ │ ├─┬ browserify-zlib@0.2.0\r\n│ │ │ │ └── pako@1.0.11 deduped\r\n│ │ │ ├─┬ buffer@4.9.2\r\n│ │ │ │ ├── base64-js@1.3.1 deduped\r\n│ │ │ │ ├── ieee754@1.1.13 deduped\r\n│ │ │ │ └── isarray@1.0.0\r\n│ │ │ ├── console-browserify@1.2.0\r\n│ │ │ ├── constants-browserify@1.0.0\r\n│ │ │ ├─┬ crypto-browserify@3.12.0\r\n│ │ │ │ ├─┬ browserify-cipher@1.0.1\r\n│ │ │ │ │ ├─┬ browserify-aes@1.2.0\r\n│ │ │ │ │ │ ├── buffer-xor@1.0.3\r\n│ │ │ │ │ │ ├── cipher-base@1.0.4 deduped\r\n│ │ │ │ │ │ ├── create-hash@1.2.0 deduped\r\n│ │ │ │ │ │ ├── evp_bytestokey@1.0.3 deduped\r\n│ │ │ │ │ │ ├── inherits@2.0.4 deduped\r\n│ │ │ │ │ │ └── safe-buffer@5.1.2 deduped\r\n│ │ │ │ │ ├─┬ browserify-des@1.0.2\r\n│ │ │ │ │ │ ├── cipher-base@1.0.4 deduped\r\n│ │ │ │ │ │ ├─┬ des.js@1.0.1\r\n│ │ │ │ │ │ │ ├── inherits@2.0.4 deduped\r\n│ │ │ │ │ │ │ └── minimalistic-assert@1.0.1 deduped\r\n│ │ │ │ │ │ ├── inherits@2.0.4 deduped\r\n│ │ │ │ │ │ └── safe-buffer@5.1.2 deduped\r\n│ │ │ │ │ └─┬ evp_bytestokey@1.0.3\r\n│ │ │ │ │   ├── md5.js@1.3.5 deduped\r\n│ │ │ │ │   └── safe-buffer@5.1.2 deduped\r\n│ │ │ │ ├─┬ browserify-sign@4.2.1\r\n│ │ │ │ │ ├── bn.js@5.1.3\r\n│ │ │ │ │ ├─┬ browserify-rsa@4.0.1\r\n│ │ │ │ │ │ ├── bn.js@4.11.9\r\n│ │ │ │ │ │ └── randombytes@2.1.0 deduped\r\n│ │ │ │ │ ├── create-hash@1.2.0 deduped\r\n│ │ │ │ │ ├── create-hmac@1.1.7 deduped\r\n│ │ │ │ │ ├─┬ elliptic@6.5.3\r\n│ │ │ │ │ │ ├── bn.js@4.11.9\r\n│ │ │ │ │ │ ├── brorand@1.1.0\r\n│ │ │ │ │ │ ├─┬ hash.js@1.1.7\r\n│ │ │ │ │ │ │ ├── inherits@2.0.4 deduped\r\n│ │ │ │ │ │ │ └── minimalistic-assert@1.0.1 deduped\r\n│ │ │ │ │ │ ├─┬ hmac-drbg@1.0.1\r\n│ │ │ │ │ │ │ ├── hash.js@1.1.7 deduped\r\n│ │ │ │ │ │ │ ├── minimalistic-assert@1.0.1 deduped\r\n│ │ │ │ │ │ │ └── minimalistic-crypto-utils@1.0.1 deduped\r\n│ │ │ │ │ │ ├── inherits@2.0.4 deduped\r\n│ │ │ │ │ │ ├── minimalistic-assert@1.0.1 deduped\r\n│ │ │ │ │ │ └── minimalistic-crypto-utils@1.0.1\r\n│ │ │ │ │ ├── inherits@2.0.4 deduped\r\n│ │ │ │ │ ├─┬ parse-asn1@5.1.6\r\n│ │ │ │ │ │ ├─┬ asn1.js@5.4.1\r\n│ │ │ │ │ │ │ ├── bn.js@4.11.9\r\n│ │ │ │ │ │ │ ├── inherits@2.0.4 deduped\r\n│ │ │ │ │ │ │ ├── minimalistic-assert@1.0.1 deduped\r\n│ │ │ │ │ │ │ └── safer-buffer@2.1.2 deduped\r\n│ │ │ │ │ │ ├── browserify-aes@1.2.0 deduped\r\n│ │ │ │ │ │ ├── evp_bytestokey@1.0.3 deduped\r\n│ │ │ │ │ │ ├── pbkdf2@3.1.1 deduped\r\n│ │ │ │ │ │ └── safe-buffer@5.1.2 deduped\r\n│ │ │ │ │ ├─┬ readable-stream@3.6.0\r\n│ │ │ │ │ │ ├── inherits@2.0.4 deduped\r\n│ │ │ │ │ │ ├── string_decoder@1.1.1 deduped\r\n│ │ │ │ │ │ └── util-deprecate@1.0.2 deduped\r\n│ │ │ │ │ └── safe-buffer@5.2.1\r\n│ │ │ │ ├─┬ create-ecdh@4.0.4\r\n│ │ │ │ │ ├── bn.js@4.11.9\r\n│ │ │ │ │ └── elliptic@6.5.3 deduped\r\n│ │ │ │ ├─┬ create-hash@1.2.0\r\n│ │ │ │ │ ├─┬ cipher-base@1.0.4\r\n│ │ │ │ │ │ ├── inherits@2.0.4 deduped\r\n│ │ │ │ │ │ └── safe-buffer@5.1.2 deduped\r\n│ │ │ │ │ ├── inherits@2.0.4 deduped\r\n│ │ │ │ │ ├─┬ md5.js@1.3.5\r\n│ │ │ │ │ │ ├─┬ hash-base@3.1.0\r\n│ │ │ │ │ │ │ ├── inherits@2.0.4 deduped\r\n│ │ │ │ │ │ │ ├─┬ readable-stream@3.6.0\r\n│ │ │ │ │ │ │ │ ├── inherits@2.0.4 deduped\r\n│ │ │ │ │ │ │ │ ├── string_decoder@1.1.1 deduped\r\n│ │ │ │ │ │ │ │ └── util-deprecate@1.0.2 deduped\r\n│ │ │ │ │ │ │ └── safe-buffer@5.2.1\r\n│ │ │ │ │ │ ├── inherits@2.0.4 deduped\r\n│ │ │ │ │ │ └── safe-buffer@5.1.2 deduped\r\n│ │ │ │ │ ├─┬ ripemd160@2.0.2\r\n│ │ │ │ │ │ ├── hash-base@3.1.0 deduped\r\n│ │ │ │ │ │ └── inherits@2.0.4 deduped\r\n│ │ │ │ │ └─┬ sha.js@2.4.11\r\n│ │ │ │ │   ├── inherits@2.0.4 deduped\r\n│ │ │ │ │   └── safe-buffer@5.1.2 deduped\r\n│ │ │ │ ├─┬ create-hmac@1.1.7\r\n│ │ │ │ │ ├── cipher-base@1.0.4 deduped\r\n│ │ │ │ │ ├── create-hash@1.2.0 deduped\r\n│ │ │ │ │ ├── inherits@2.0.4 deduped\r\n│ │ │ │ │ ├── ripemd160@2.0.2 deduped\r\n│ │ │ │ │ ├── safe-buffer@5.1.2 deduped\r\n│ │ │ │ │ └── sha.js@2.4.11 deduped\r\n│ │ │ │ ├─┬ diffie-hellman@5.0.3\r\n│ │ │ │ │ ├── bn.js@4.11.9\r\n│ │ │ │ │ ├─┬ miller-rabin@4.0.1\r\n│ │ │ │ │ │ ├── bn.js@4.11.9\r\n│ │ │ │ │ │ └── brorand@1.1.0 deduped\r\n│ │ │ │ │ └── randombytes@2.1.0 deduped\r\n│ │ │ │ ├── inherits@2.0.4 deduped\r\n│ │ │ │ ├─┬ pbkdf2@3.1.1\r\n│ │ │ │ │ ├── create-hash@1.2.0 deduped\r\n│ │ │ │ │ ├── create-hmac@1.1.7 deduped\r\n│ │ │ │ │ ├── ripemd160@2.0.2 deduped\r\n│ │ │ │ │ ├── safe-buffer@5.1.2 deduped\r\n│ │ │ │ │ └── sha.js@2.4.11 deduped\r\n│ │ │ │ ├─┬ public-encrypt@4.0.3\r\n│ │ │ │ │ ├── bn.js@4.11.9\r\n│ │ │ │ │ ├── browserify-rsa@4.0.1 deduped\r\n│ │ │ │ │ ├── create-hash@1.2.0 deduped\r\n│ │ │ │ │ ├── parse-asn1@5.1.6 deduped\r\n│ │ │ │ │ ├── randombytes@2.1.0 deduped\r\n│ │ │ │ │ └── safe-buffer@5.1.2 deduped\r\n│ │ │ │ ├── randombytes@2.1.0 deduped\r\n│ │ │ │ └─┬ randomfill@1.0.4\r\n│ │ │ │   ├── randombytes@2.1.0 deduped\r\n│ │ │ │   └── safe-buffer@5.1.2 deduped\r\n│ │ │ ├── domain-browser@1.2.0\r\n│ │ │ ├── events@3.2.0 deduped\r\n│ │ │ ├── https-browserify@1.0.0\r\n│ │ │ ├── os-browserify@0.3.0\r\n│ │ │ ├── path-browserify@0.0.1\r\n│ │ │ ├── process@0.11.10\r\n│ │ │ ├── punycode@1.3.2\r\n│ │ │ ├── querystring-es3@0.2.1\r\n│ │ │ ├─┬ readable-stream@2.3.7\r\n│ │ │ │ ├── core-util-is@1.0.2\r\n│ │ │ │ ├── inherits@2.0.4 deduped\r\n│ │ │ │ ├── isarray@1.0.0 deduped\r\n│ │ │ │ ├── process-nextick-args@2.0.1\r\n│ │ │ │ ├── safe-buffer@5.1.2 deduped\r\n│ │ │ │ ├── string_decoder@1.1.1 deduped\r\n│ │ │ │ └── util-deprecate@1.0.2 deduped\r\n│ │ │ ├─┬ stream-browserify@2.0.2\r\n│ │ │ │ ├── inherits@2.0.4 deduped\r\n│ │ │ │ └── readable-stream@2.3.7 deduped\r\n│ │ │ ├─┬ stream-http@2.8.3\r\n│ │ │ │ ├── builtin-status-codes@3.0.0\r\n│ │ │ │ ├── inherits@2.0.4 deduped\r\n│ │ │ │ ├── readable-stream@2.3.7 deduped\r\n│ │ │ │ ├── to-arraybuffer@1.0.1\r\n│ │ │ │ └── xtend@4.0.2\r\n│ │ │ ├─┬ string_decoder@1.1.1\r\n│ │ │ │ └── safe-buffer@5.1.2 deduped\r\n│ │ │ ├─┬ timers-browserify@2.0.11\r\n│ │ │ │ └── setimmediate@1.0.5\r\n│ │ │ ├── tty-browserify@0.0.0\r\n│ │ │ ├── url@0.11.0 deduped\r\n│ │ │ ├─┬ util@0.11.1\r\n│ │ │ │ └── inherits@2.0.3\r\n│ │ │ └── vm-browserify@1.1.2\r\n│ │ ├─┬ schema-utils@1.0.0\r\n│ │ │ ├── ajv@6.12.3 deduped\r\n│ │ │ ├── ajv-errors@1.0.1 deduped\r\n│ │ │ └── ajv-keywords@3.5.2 deduped\r\n│ │ ├── tapable@1.1.3\r\n│ │ ├─┬ terser-webpack-plugin@1.4.5\r\n│ │ │ ├─┬ cacache@12.0.4\r\n│ │ │ │ ├── bluebird@3.7.2 deduped\r\n│ │ │ │ ├── chownr@1.1.4\r\n│ │ │ │ ├── figgy-pudding@3.5.2 deduped\r\n│ │ │ │ ├── glob@7.1.6 deduped\r\n│ │ │ │ ├── graceful-fs@4.2.4 deduped\r\n│ │ │ │ ├── infer-owner@1.0.4 deduped\r\n│ │ │ │ ├── lru-cache@5.1.1 deduped\r\n│ │ │ │ ├── mississippi@3.0.0 deduped\r\n│ │ │ │ ├── mkdirp@0.5.5 deduped\r\n│ │ │ │ ├── move-concurrently@1.0.1 deduped\r\n│ │ │ │ ├── promise-inflight@1.0.1 deduped\r\n│ │ │ │ ├─┬ rimraf@2.7.1\r\n│ │ │ │ │ └── glob@7.1.6 deduped\r\n│ │ │ │ ├─┬ ssri@6.0.1\r\n│ │ │ │ │ └── figgy-pudding@3.5.2 deduped\r\n│ │ │ │ ├── unique-filename@1.1.1 deduped\r\n│ │ │ │ └── y18n@4.0.0 deduped\r\n│ │ │ ├─┬ find-cache-dir@2.1.0\r\n│ │ │ │ ├── commondir@1.0.1 deduped\r\n│ │ │ │ ├── make-dir@2.1.0 deduped\r\n│ │ │ │ └── pkg-dir@3.0.0 deduped\r\n│ │ │ ├── is-wsl@1.1.0\r\n│ │ │ ├── schema-utils@1.0.0 deduped\r\n│ │ │ ├── serialize-javascript@4.0.0 deduped\r\n│ │ │ ├── source-map@0.6.1\r\n│ │ │ ├── terser@4.7.0 deduped\r\n│ │ │ ├── webpack-sources@1.4.3 deduped\r\n│ │ │ └─┬ worker-farm@1.7.0\r\n│ │ │   └── errno@0.1.7 deduped\r\n│ │ ├─┬ watchpack@1.7.4\r\n│ │ │ ├── chokidar@3.4.2 deduped\r\n│ │ │ ├── graceful-fs@4.2.4 deduped\r\n│ │ │ ├── neo-async@2.6.2 deduped\r\n│ │ │ └─┬ watchpack-chokidar2@2.0.0\r\n│ │ │   └─┬ chokidar@2.1.8\r\n│ │ │     ├─┬ anymatch@2.0.0\r\n│ │ │     │ ├─┬ micromatch@3.1.10\r\n│ │ │     │ │ ├── arr-diff@4.0.0 deduped\r\n│ │ │     │ │ ├── array-unique@0.3.2 deduped\r\n│ │ │     │ │ ├── braces@2.3.2 deduped\r\n│ │ │     │ │ ├── define-property@2.0.2 deduped\r\n│ │ │     │ │ ├── extend-shallow@3.0.2 deduped\r\n│ │ │     │ │ ├── extglob@2.0.4 deduped\r\n│ │ │     │ │ ├── fragment-cache@0.2.1 deduped\r\n│ │ │     │ │ ├── kind-of@6.0.3 deduped\r\n│ │ │     │ │ ├── nanomatch@1.2.13 deduped\r\n│ │ │     │ │ ├── object.pick@1.3.0 deduped\r\n│ │ │     │ │ ├── regex-not@1.0.2 deduped\r\n│ │ │     │ │ ├── snapdragon@0.8.2 deduped\r\n│ │ │     │ │ └── to-regex@3.0.2 deduped\r\n│ │ │     │ └─┬ normalize-path@2.1.1\r\n│ │ │     │   └── remove-trailing-separator@1.1.0 deduped\r\n│ │ │     ├── async-each@1.0.3 deduped\r\n│ │ │     ├─┬ braces@2.3.2\r\n│ │ │     │ ├── arr-flatten@1.1.0 deduped\r\n│ │ │     │ ├── array-unique@0.3.2 deduped\r\n│ │ │     │ ├─┬ extend-shallow@2.0.1\r\n│ │ │     │ │ └── is-extendable@0.1.1 deduped\r\n│ │ │     │ ├─┬ fill-range@4.0.0\r\n│ │ │     │ │ ├─┬ extend-shallow@2.0.1\r\n│ │ │     │ │ │ └── is-extendable@0.1.1 deduped\r\n│ │ │     │ │ ├─┬ is-number@3.0.0\r\n│ │ │     │ │ │ └─┬ kind-of@3.2.2\r\n│ │ │     │ │ │   └── is-buffer@1.1.6\r\n│ │ │     │ │ ├── repeat-string@1.6.1 deduped\r\n│ │ │     │ │ └─┬ to-regex-range@2.1.1\r\n│ │ │     │ │   ├── is-number@3.0.0 deduped\r\n│ │ │     │ │   └── repeat-string@1.6.1 deduped\r\n│ │ │     │ ├── isobject@3.0.1 deduped\r\n│ │ │     │ ├── repeat-element@1.1.3 deduped\r\n│ │ │     │ ├── snapdragon@0.8.2 deduped\r\n│ │ │     │ ├── snapdragon-node@2.1.1 deduped\r\n│ │ │     │ ├── split-string@3.1.0 deduped\r\n│ │ │     │ └── to-regex@3.0.2 deduped\r\n│ │ │     ├── UNMET OPTIONAL DEPENDENCY fsevents@1.2.13\r\n│ │ │     ├─┬ glob-parent@3.1.0\r\n│ │ │     │ ├─┬ is-glob@3.1.0\r\n│ │ │     │ │ └── is-extglob@2.1.1 deduped\r\n│ │ │     │ └── path-dirname@1.0.2 deduped\r\n│ │ │     ├── inherits@2.0.4 deduped\r\n│ │ │     ├─┬ is-binary-path@1.0.1\r\n│ │ │     │ └── binary-extensions@1.13.1\r\n│ │ │     ├── is-glob@4.0.1 deduped\r\n│ │ │     ├── normalize-path@3.0.0 deduped\r\n│ │ │     ├── path-is-absolute@1.0.1 deduped\r\n│ │ │     ├─┬ readdirp@2.2.1\r\n│ │ │     │ ├── graceful-fs@4.2.4 deduped\r\n│ │ │     │ ├── micromatch@3.1.10 deduped\r\n│ │ │     │ └── readable-stream@2.3.7 deduped\r\n│ │ │     └── upath@1.2.0 deduped\r\n│ │ └── webpack-sources@1.4.3 deduped\r\n│ ├─┬ webpack-dev-middleware@3.7.2\r\n│ │ ├─┬ memory-fs@0.4.1\r\n│ │ │ ├── errno@0.1.7 deduped\r\n│ │ │ └── readable-stream@2.3.7 deduped\r\n│ │ ├── mime@2.4.6\r\n│ │ ├── mkdirp@0.5.5 deduped\r\n│ │ ├── range-parser@1.2.1 deduped\r\n│ │ └─┬ webpack-log@2.0.0\r\n│ │   ├── ansi-colors@3.2.4\r\n│ │   └── uuid@3.4.0\r\n│ ├─┬ webpack-dev-server@3.11.0\r\n│ │ ├── ansi-html@0.0.7\r\n│ │ ├─┬ bonjour@3.5.0\r\n│ │ │ ├── array-flatten@2.1.2\r\n│ │ │ ├─┬ deep-equal@1.1.1\r\n│ │ │ │ ├── is-arguments@1.0.4\r\n│ │ │ │ ├── is-date-object@1.0.2\r\n│ │ │ │ ├─┬ is-regex@1.1.1\r\n│ │ │ │ │ └── has-symbols@1.0.1 deduped\r\n│ │ │ │ ├─┬ object-is@1.1.3\r\n│ │ │ │ │ ├── define-properties@1.1.3 deduped\r\n│ │ │ │ │ └── es-abstract@1.18.0-next.1 deduped\r\n│ │ │ │ ├── object-keys@1.1.1\r\n│ │ │ │ └─┬ regexp.prototype.flags@1.3.0\r\n│ │ │ │   ├── define-properties@1.1.3 deduped\r\n│ │ │ │   └─┬ es-abstract@1.17.7\r\n│ │ │ │     ├── es-to-primitive@1.2.1 deduped\r\n│ │ │ │     ├── function-bind@1.1.1 deduped\r\n│ │ │ │     ├── has@1.0.3 deduped\r\n│ │ │ │     ├── has-symbols@1.0.1 deduped\r\n│ │ │ │     ├── is-callable@1.2.2 deduped\r\n│ │ │ │     ├── is-regex@1.1.1 deduped\r\n│ │ │ │     ├── object-inspect@1.8.0 deduped\r\n│ │ │ │     ├── object-keys@1.1.1 deduped\r\n│ │ │ │     ├── object.assign@4.1.1 deduped\r\n│ │ │ │     ├── string.prototype.trimend@1.0.1 deduped\r\n│ │ │ │     └── string.prototype.trimstart@1.0.1 deduped\r\n│ │ │ ├── dns-equal@1.0.0\r\n│ │ │ ├─┬ dns-txt@2.0.2\r\n│ │ │ │ └── buffer-indexof@1.1.1\r\n│ │ │ ├─┬ multicast-dns@6.2.3\r\n│ │ │ │ ├─┬ dns-packet@1.3.1\r\n│ │ │ │ │ ├── ip@1.1.5 deduped\r\n│ │ │ │ │ └── safe-buffer@5.1.2 deduped\r\n│ │ │ │ └── thunky@1.1.0\r\n│ │ │ └── multicast-dns-service-types@1.1.0\r\n│ │ ├─┬ chokidar@2.1.8\r\n│ │ │ ├─┬ anymatch@2.0.0\r\n│ │ │ │ ├─┬ micromatch@3.1.10\r\n│ │ │ │ │ ├── arr-diff@4.0.0 deduped\r\n│ │ │ │ │ ├── array-unique@0.3.2 deduped\r\n│ │ │ │ │ ├── braces@2.3.2 deduped\r\n│ │ │ │ │ ├── define-property@2.0.2 deduped\r\n│ │ │ │ │ ├── extend-shallow@3.0.2 deduped\r\n│ │ │ │ │ ├── extglob@2.0.4 deduped\r\n│ │ │ │ │ ├── fragment-cache@0.2.1 deduped\r\n│ │ │ │ │ ├── kind-of@6.0.3 deduped\r\n│ │ │ │ │ ├── nanomatch@1.2.13 deduped\r\n│ │ │ │ │ ├── object.pick@1.3.0 deduped\r\n│ │ │ │ │ ├── regex-not@1.0.2 deduped\r\n│ │ │ │ │ ├── snapdragon@0.8.2 deduped\r\n│ │ │ │ │ └── to-regex@3.0.2 deduped\r\n│ │ │ │ └─┬ normalize-path@2.1.1\r\n│ │ │ │   └── remove-trailing-separator@1.1.0\r\n│ │ │ ├── async-each@1.0.3\r\n│ │ │ ├─┬ braces@2.3.2\r\n│ │ │ │ ├── arr-flatten@1.1.0 deduped\r\n│ │ │ │ ├── array-unique@0.3.2 deduped\r\n│ │ │ │ ├─┬ extend-shallow@2.0.1\r\n│ │ │ │ │ └── is-extendable@0.1.1 deduped\r\n│ │ │ │ ├─┬ fill-range@4.0.0\r\n│ │ │ │ │ ├─┬ extend-shallow@2.0.1\r\n│ │ │ │ │ │ └── is-extendable@0.1.1 deduped\r\n│ │ │ │ │ ├─┬ is-number@3.0.0\r\n│ │ │ │ │ │ └─┬ kind-of@3.2.2\r\n│ │ │ │ │ │   └── is-buffer@1.1.6\r\n│ │ │ │ │ ├── repeat-string@1.6.1 deduped\r\n│ │ │ │ │ └─┬ to-regex-range@2.1.1\r\n│ │ │ │ │   ├── is-number@3.0.0 deduped\r\n│ │ │ │ │   └── repeat-string@1.6.1 deduped\r\n│ │ │ │ ├── isobject@3.0.1 deduped\r\n│ │ │ │ ├── repeat-element@1.1.3 deduped\r\n│ │ │ │ ├── snapdragon@0.8.2 deduped\r\n│ │ │ │ ├── snapdragon-node@2.1.1 deduped\r\n│ │ │ │ ├── split-string@3.1.0 deduped\r\n│ │ │ │ └── to-regex@3.0.2 deduped\r\n│ │ │ ├── UNMET OPTIONAL DEPENDENCY fsevents@1.2.13\r\n│ │ │ ├─┬ glob-parent@3.1.0\r\n│ │ │ │ ├─┬ is-glob@3.1.0\r\n│ │ │ │ │ └── is-extglob@2.1.1 deduped\r\n│ │ │ │ └── path-dirname@1.0.2\r\n│ │ │ ├── inherits@2.0.4 deduped\r\n│ │ │ ├─┬ is-binary-path@1.0.1\r\n│ │ │ │ └── binary-extensions@1.13.1\r\n│ │ │ ├── is-glob@4.0.1 deduped\r\n│ │ │ ├── normalize-path@3.0.0 deduped\r\n│ │ │ ├── path-is-absolute@1.0.1 deduped\r\n│ │ │ ├─┬ readdirp@2.2.1\r\n│ │ │ │ ├── graceful-fs@4.2.4 deduped\r\n│ │ │ │ ├── micromatch@3.1.10 deduped\r\n│ │ │ │ └── readable-stream@2.3.7 deduped\r\n│ │ │ └── upath@1.2.0\r\n│ │ ├─┬ compression@1.7.4\r\n│ │ │ ├─┬ accepts@1.3.7\r\n│ │ │ │ ├── mime-types@2.1.27 deduped\r\n│ │ │ │ └── negotiator@0.6.2\r\n│ │ │ ├── bytes@3.0.0\r\n│ │ │ ├─┬ compressible@2.0.18\r\n│ │ │ │ └── mime-db@1.44.0\r\n│ │ │ ├─┬ debug@2.6.9\r\n│ │ │ │ └── ms@2.0.0 deduped\r\n│ │ │ ├── on-headers@1.0.2\r\n│ │ │ ├── safe-buffer@5.1.2 deduped\r\n│ │ │ └── vary@1.1.2\r\n│ │ ├── connect-history-api-fallback@1.6.0\r\n│ │ ├─┬ debug@4.2.0\r\n│ │ │ └── ms@2.1.2\r\n│ │ ├─┬ del@4.1.1\r\n│ │ │ ├─┬ @types/glob@7.1.3\r\n│ │ │ │ ├── @types/minimatch@3.0.3\r\n│ │ │ │ └── @types/node@12.12.64 deduped\r\n│ │ │ ├─┬ globby@6.1.0\r\n│ │ │ │ ├─┬ array-union@1.0.2\r\n│ │ │ │ │ └── array-uniq@1.0.3\r\n│ │ │ │ ├── glob@7.1.6 deduped\r\n│ │ │ │ ├── object-assign@4.1.1 deduped\r\n│ │ │ │ ├── pify@2.3.0\r\n│ │ │ │ └── pinkie-promise@2.0.1 deduped\r\n│ │ │ ├── is-path-cwd@2.2.0\r\n│ │ │ ├─┬ is-path-in-cwd@2.1.0\r\n│ │ │ │ └─┬ is-path-inside@2.1.0\r\n│ │ │ │   └── path-is-inside@1.0.2\r\n│ │ │ ├── p-map@2.1.0\r\n│ │ │ ├── pify@4.0.1 deduped\r\n│ │ │ └─┬ rimraf@2.7.1\r\n│ │ │   └── glob@7.1.6 deduped\r\n│ │ ├─┬ express@4.17.1\r\n│ │ │ ├── accepts@1.3.7 deduped\r\n│ │ │ ├── array-flatten@1.1.1\r\n│ │ │ ├── body-parser@1.19.0 deduped\r\n│ │ │ ├─┬ content-disposition@0.5.3\r\n│ │ │ │ └── safe-buffer@5.1.2 deduped\r\n│ │ │ ├── content-type@1.0.4 deduped\r\n│ │ │ ├── cookie@0.4.0\r\n│ │ │ ├── cookie-signature@1.0.6\r\n│ │ │ ├─┬ debug@2.6.9\r\n│ │ │ │ └── ms@2.0.0 deduped\r\n│ │ │ ├── depd@1.1.2 deduped\r\n│ │ │ ├── encodeurl@1.0.2\r\n│ │ │ ├── escape-html@1.0.3\r\n│ │ │ ├── etag@1.8.1\r\n│ │ │ ├── finalhandler@1.1.2 deduped\r\n│ │ │ ├── fresh@0.5.2\r\n│ │ │ ├── merge-descriptors@1.0.1\r\n│ │ │ ├── methods@1.1.2\r\n│ │ │ ├── on-finished@2.3.0 deduped\r\n│ │ │ ├── parseurl@1.3.3 deduped\r\n│ │ │ ├── path-to-regexp@0.1.7\r\n│ │ │ ├─┬ proxy-addr@2.0.6\r\n│ │ │ │ ├── forwarded@0.1.2\r\n│ │ │ │ └── ipaddr.js@1.9.1 deduped\r\n│ │ │ ├── qs@6.7.0 deduped\r\n│ │ │ ├── range-parser@1.2.1 deduped\r\n│ │ │ ├── safe-buffer@5.1.2 deduped\r\n│ │ │ ├─┬ send@0.17.1\r\n│ │ │ │ ├─┬ debug@2.6.9\r\n│ │ │ │ │ └── ms@2.0.0\r\n│ │ │ │ ├── depd@1.1.2 deduped\r\n│ │ │ │ ├── destroy@1.0.4\r\n│ │ │ │ ├── encodeurl@1.0.2 deduped\r\n│ │ │ │ ├── escape-html@1.0.3 deduped\r\n│ │ │ │ ├── etag@1.8.1 deduped\r\n│ │ │ │ ├── fresh@0.5.2 deduped\r\n│ │ │ │ ├── http-errors@1.7.2 deduped\r\n│ │ │ │ ├── mime@1.6.0 deduped\r\n│ │ │ │ ├── ms@2.1.1\r\n│ │ │ │ ├── on-finished@2.3.0 deduped\r\n│ │ │ │ ├── range-parser@1.2.1 deduped\r\n│ │ │ │ └── statuses@1.5.0 deduped\r\n│ │ │ ├─┬ serve-static@1.14.1\r\n│ │ │ │ ├── encodeurl@1.0.2 deduped\r\n│ │ │ │ ├── escape-html@1.0.3 deduped\r\n│ │ │ │ ├── parseurl@1.3.3 deduped\r\n│ │ │ │ └── send@0.17.1 deduped\r\n│ │ │ ├── setprototypeof@1.1.1\r\n│ │ │ ├── statuses@1.5.0\r\n│ │ │ ├── type-is@1.6.18 deduped\r\n│ │ │ ├── utils-merge@1.0.1 deduped\r\n│ │ │ └── vary@1.1.2 deduped\r\n│ │ ├── html-entities@1.3.1\r\n│ │ ├─┬ http-proxy-middleware@0.19.1\r\n│ │ │ ├── http-proxy@1.18.1 deduped\r\n│ │ │ ├── is-glob@4.0.1 deduped\r\n│ │ │ ├── lodash@4.17.20 deduped\r\n│ │ │ └─┬ micromatch@3.1.10\r\n│ │ │   ├── arr-diff@4.0.0 deduped\r\n│ │ │   ├── array-unique@0.3.2 deduped\r\n│ │ │   ├─┬ braces@2.3.2\r\n│ │ │   │ ├── arr-flatten@1.1.0 deduped\r\n│ │ │   │ ├── array-unique@0.3.2 deduped\r\n│ │ │   │ ├─┬ extend-shallow@2.0.1\r\n│ │ │   │ │ └── is-extendable@0.1.1 deduped\r\n│ │ │   │ ├─┬ fill-range@4.0.0\r\n│ │ │   │ │ ├─┬ extend-shallow@2.0.1\r\n│ │ │   │ │ │ └── is-extendable@0.1.1 deduped\r\n│ │ │   │ │ ├─┬ is-number@3.0.0\r\n│ │ │   │ │ │ └─┬ kind-of@3.2.2\r\n│ │ │   │ │ │   └── is-buffer@1.1.6\r\n│ │ │   │ │ ├── repeat-string@1.6.1 deduped\r\n│ │ │   │ │ └─┬ to-regex-range@2.1.1\r\n│ │ │   │ │   ├── is-number@3.0.0 deduped\r\n│ │ │   │ │   └── repeat-string@1.6.1 deduped\r\n│ │ │   │ ├── isobject@3.0.1 deduped\r\n│ │ │   │ ├── repeat-element@1.1.3 deduped\r\n│ │ │   │ ├── snapdragon@0.8.2 deduped\r\n│ │ │   │ ├── snapdragon-node@2.1.1 deduped\r\n│ │ │   │ ├── split-string@3.1.0 deduped\r\n│ │ │   │ └── to-regex@3.0.2 deduped\r\n│ │ │   ├── define-property@2.0.2 deduped\r\n│ │ │   ├── extend-shallow@3.0.2 deduped\r\n│ │ │   ├── extglob@2.0.4 deduped\r\n│ │ │   ├── fragment-cache@0.2.1 deduped\r\n│ │ │   ├── kind-of@6.0.3 deduped\r\n│ │ │   ├── nanomatch@1.2.13 deduped\r\n│ │ │   ├── object.pick@1.3.0 deduped\r\n│ │ │   ├── regex-not@1.0.2 deduped\r\n│ │ │   ├── snapdragon@0.8.2 deduped\r\n│ │ │   └── to-regex@3.0.2 deduped\r\n│ │ ├─┬ import-local@2.0.0\r\n│ │ │ ├── pkg-dir@3.0.0 deduped\r\n│ │ │ └─┬ resolve-cwd@2.0.0\r\n│ │ │   └── resolve-from@3.0.0 deduped\r\n│ │ ├─┬ internal-ip@4.3.0\r\n│ │ │ ├─┬ default-gateway@4.2.0\r\n│ │ │ │ ├─┬ execa@1.0.0\r\n│ │ │ │ │ ├─┬ cross-spawn@6.0.5\r\n│ │ │ │ │ │ ├── nice-try@1.0.5\r\n│ │ │ │ │ │ ├── path-key@2.0.1\r\n│ │ │ │ │ │ ├── semver@5.7.1\r\n│ │ │ │ │ │ ├─┬ shebang-command@1.2.0\r\n│ │ │ │ │ │ │ └── shebang-regex@1.0.0\r\n│ │ │ │ │ │ └── which@1.3.1 deduped\r\n│ │ │ │ │ ├── get-stream@4.1.0 deduped\r\n│ │ │ │ │ ├── is-stream@1.1.0\r\n│ │ │ │ │ ├─┬ npm-run-path@2.0.2\r\n│ │ │ │ │ │ └── path-key@2.0.1 deduped\r\n│ │ │ │ │ ├── p-finally@1.0.0\r\n│ │ │ │ │ ├── signal-exit@3.0.3 deduped\r\n│ │ │ │ │ └── strip-eof@1.0.0\r\n│ │ │ │ └── ip-regex@2.1.0\r\n│ │ │ └── ipaddr.js@1.9.1\r\n│ │ ├── ip@1.1.5\r\n│ │ ├── is-absolute-url@3.0.3\r\n│ │ ├── killable@1.0.1\r\n│ │ ├── loglevel@1.7.0\r\n│ │ ├─┬ opn@5.5.0\r\n│ │ │ └── is-wsl@1.1.0\r\n│ │ ├─┬ p-retry@3.0.1\r\n│ │ │ └── retry@0.12.0\r\n│ │ ├─┬ portfinder@1.0.28\r\n│ │ │ ├─┬ async@2.6.3\r\n│ │ │ │ └── lodash@4.17.20 deduped\r\n│ │ │ ├─┬ debug@3.2.6\r\n│ │ │ │ └── ms@2.1.2\r\n│ │ │ └── mkdirp@0.5.5 deduped\r\n│ │ ├─┬ schema-utils@1.0.0\r\n│ │ │ ├── ajv@6.12.3 deduped\r\n│ │ │ ├── ajv-errors@1.0.1 deduped\r\n│ │ │ └── ajv-keywords@3.5.2 deduped\r\n│ │ ├─┬ selfsigned@1.10.8\r\n│ │ │ └── node-forge@0.10.0\r\n│ │ ├── semver@6.3.0\r\n│ │ ├─┬ serve-index@1.9.1\r\n│ │ │ ├── accepts@1.3.7 deduped\r\n│ │ │ ├── batch@0.6.1\r\n│ │ │ ├─┬ debug@2.6.9\r\n│ │ │ │ └── ms@2.0.0 deduped\r\n│ │ │ ├── escape-html@1.0.3 deduped\r\n│ │ │ ├─┬ http-errors@1.6.3\r\n│ │ │ │ ├── depd@1.1.2 deduped\r\n│ │ │ │ ├── inherits@2.0.3\r\n│ │ │ │ ├── setprototypeof@1.1.0\r\n│ │ │ │ └── statuses@1.5.0 deduped\r\n│ │ │ ├─┬ mime-types@2.1.27\r\n│ │ │ │ └── mime-db@1.44.0 deduped\r\n│ │ │ └── parseurl@1.3.3 deduped\r\n│ │ ├─┬ sockjs@0.3.20\r\n│ │ │ ├─┬ faye-websocket@0.10.0\r\n│ │ │ │ └── websocket-driver@0.6.5 deduped\r\n│ │ │ ├── uuid@3.4.0\r\n│ │ │ └─┬ websocket-driver@0.6.5\r\n│ │ │   └── websocket-extensions@0.1.4\r\n│ │ ├─┬ sockjs-client@1.4.0\r\n│ │ │ ├─┬ debug@3.2.6\r\n│ │ │ │ └── ms@2.1.2\r\n│ │ │ ├─┬ eventsource@1.0.7\r\n│ │ │ │ └─┬ original@1.0.2\r\n│ │ │ │   └── url-parse@1.4.7 deduped\r\n│ │ │ ├─┬ faye-websocket@0.11.3\r\n│ │ │ │ └── websocket-driver@0.6.5 deduped\r\n│ │ │ ├── inherits@2.0.4 deduped\r\n│ │ │ ├── json3@3.3.3\r\n│ │ │ └─┬ url-parse@1.4.7\r\n│ │ │   ├── querystringify@2.2.0\r\n│ │ │   └── requires-port@1.0.0 deduped\r\n│ │ ├─┬ spdy@4.0.2\r\n│ │ │ ├─┬ debug@4.2.0\r\n│ │ │ │ └── ms@2.1.2\r\n│ │ │ ├── handle-thing@2.0.1\r\n│ │ │ ├── http-deceiver@1.2.7\r\n│ │ │ ├── select-hose@2.0.0\r\n│ │ │ └─┬ spdy-transport@3.0.0\r\n│ │ │   ├─┬ debug@4.2.0\r\n│ │ │   │ └── ms@2.1.2\r\n│ │ │   ├── detect-node@2.0.4\r\n│ │ │   ├─┬ hpack.js@2.1.6\r\n│ │ │   │ ├── inherits@2.0.4 deduped\r\n│ │ │   │ ├── obuf@1.1.2 deduped\r\n│ │ │   │ ├── readable-stream@2.3.7 deduped\r\n│ │ │   │ └── wbuf@1.7.3 deduped\r\n│ │ │   ├── obuf@1.1.2\r\n│ │ │   ├─┬ readable-stream@3.6.0\r\n│ │ │   │ ├── inherits@2.0.4 deduped\r\n│ │ │   │ ├── string_decoder@1.1.1 deduped\r\n│ │ │   │ └── util-deprecate@1.0.2 deduped\r\n│ │ │   └─┬ wbuf@1.7.3\r\n│ │ │     └── minimalistic-assert@1.0.1\r\n│ │ ├─┬ strip-ansi@3.0.1\r\n│ │ │ └── ansi-regex@2.1.1\r\n│ │ ├─┬ supports-color@6.1.0\r\n│ │ │ └── has-flag@3.0.0 deduped\r\n│ │ ├─┬ url@0.11.0\r\n│ │ │ ├── punycode@1.3.2 deduped\r\n│ │ │ └── querystring@0.2.0\r\n│ │ ├── webpack-dev-middleware@3.7.2 deduped\r\n│ │ ├── webpack-log@2.0.0 deduped\r\n│ │ ├─┬ ws@6.2.1\r\n│ │ │ └── async-limiter@1.0.1\r\n│ │ └─┬ yargs@13.3.2\r\n│ │   ├─┬ cliui@5.0.0\r\n│ │   │ ├── string-width@3.1.0 deduped\r\n│ │   │ ├─┬ strip-ansi@5.2.0\r\n│ │   │ │ └── ansi-regex@4.1.0\r\n│ │   │ └─┬ wrap-ansi@5.1.0\r\n│ │   │   ├── ansi-styles@3.2.1 deduped\r\n│ │   │   ├── string-width@3.1.0 deduped\r\n│ │   │   └── strip-ansi@5.2.0 deduped\r\n│ │   ├─┬ find-up@3.0.0\r\n│ │   │ └─┬ locate-path@3.0.0\r\n│ │   │   ├─┬ p-locate@3.0.0\r\n│ │   │   │ └── p-limit@2.3.0 deduped\r\n│ │   │   └── path-exists@3.0.0\r\n│ │   ├── get-caller-file@2.0.5 deduped\r\n│ │   ├── require-directory@2.1.1 deduped\r\n│ │   ├── require-main-filename@2.0.0 deduped\r\n│ │   ├── set-blocking@2.0.0 deduped\r\n│ │   ├─┬ string-width@3.1.0\r\n│ │   │ ├── emoji-regex@7.0.3\r\n│ │   │ ├── is-fullwidth-code-point@2.0.0\r\n│ │   │ └── strip-ansi@5.2.0 deduped\r\n│ │   ├── which-module@2.0.0 deduped\r\n│ │   ├── y18n@4.0.0 deduped\r\n│ │   └─┬ yargs-parser@13.1.2\r\n│ │     ├── camelcase@5.3.1 deduped\r\n│ │     └── decamelize@1.2.0 deduped\r\n│ ├─┬ webpack-merge@4.2.2\r\n│ │ └── lodash@4.17.20 deduped\r\n│ ├─┬ webpack-sources@1.4.3\r\n│ │ ├── source-list-map@2.0.1\r\n│ │ └── source-map@0.6.1\r\n│ ├─┬ webpack-subresource-integrity@1.4.1\r\n│ │ └── webpack-sources@1.4.3 deduped\r\n│ └─┬ worker-plugin@4.0.3\r\n│   └─┬ loader-utils@1.4.0\r\n│     ├── big.js@5.2.2 deduped\r\n│     ├── emojis-list@3.0.0 deduped\r\n│     └─┬ json5@1.0.1\r\n│       └── minimist@1.2.5 deduped\r\n├─┬ @angular/animations@10.0.14\r\n│ └── tslib@2.0.1 deduped\r\n├─┬ @angular/cli@10.0.8\r\n│ ├── @angular-devkit/architect@0.1000.8 deduped\r\n│ ├── @angular-devkit/core@10.0.8 deduped\r\n│ ├─┬ @angular-devkit/schematics@10.0.8\r\n│ │ ├── @angular-devkit/core@10.0.8 deduped\r\n│ │ ├─┬ ora@4.0.4\r\n│ │ │ ├─┬ chalk@3.0.0\r\n│ │ │ │ ├─┬ ansi-styles@4.3.0\r\n│ │ │ │ │ └─┬ color-convert@2.0.1\r\n│ │ │ │ │   └── color-name@1.1.4\r\n│ │ │ │ └─┬ supports-color@7.2.0\r\n│ │ │ │   └── has-flag@4.0.0\r\n│ │ │ ├── cli-cursor@3.1.0 deduped\r\n│ │ │ ├── cli-spinners@2.4.0\r\n│ │ │ ├── is-interactive@1.0.0\r\n│ │ │ ├─┬ log-symbols@3.0.0\r\n│ │ │ │ └── chalk@2.4.2 deduped\r\n│ │ │ ├── mute-stream@0.0.8 deduped\r\n│ │ │ ├─┬ strip-ansi@6.0.0\r\n│ │ │ │ └── ansi-regex@5.0.0\r\n│ │ │ └─┬ wcwidth@1.0.1\r\n│ │ │   └─┬ defaults@1.0.3\r\n│ │ │     └── clone@1.0.4\r\n│ │ └── rxjs@6.5.5 deduped\r\n│ ├─┬ @schematics/angular@10.0.8\r\n│ │ ├── @angular-devkit/core@10.0.8 deduped\r\n│ │ └── @angular-devkit/schematics@10.0.8 deduped\r\n│ ├─┬ @schematics/update@0.1000.8\r\n│ │ ├── @angular-devkit/core@10.0.8 deduped\r\n│ │ ├── @angular-devkit/schematics@10.0.8 deduped\r\n│ │ ├── @yarnpkg/lockfile@1.1.0 deduped\r\n│ │ ├── ini@1.3.5 deduped\r\n│ │ ├── npm-package-arg@8.0.1 deduped\r\n│ │ ├── pacote@9.5.12 deduped\r\n│ │ ├── rxjs@6.5.5 deduped\r\n│ │ ├── semver@7.3.2 deduped\r\n│ │ └─┬ semver-intersect@1.4.0\r\n│ │   └── semver@5.7.1\r\n│ ├── @yarnpkg/lockfile@1.1.0\r\n│ ├── ansi-colors@4.1.1\r\n│ ├─┬ debug@4.1.1\r\n│ │ └── ms@2.1.2\r\n│ ├── ini@1.3.5\r\n│ ├─┬ inquirer@7.1.0\r\n│ │ ├─┬ ansi-escapes@4.3.1\r\n│ │ │ └── type-fest@0.11.0\r\n│ │ ├─┬ chalk@3.0.0\r\n│ │ │ ├─┬ ansi-styles@4.3.0\r\n│ │ │ │ └─┬ color-convert@2.0.1\r\n│ │ │ │   └── color-name@1.1.4\r\n│ │ │ └─┬ supports-color@7.2.0\r\n│ │ │   └── has-flag@4.0.0\r\n│ │ ├─┬ cli-cursor@3.1.0\r\n│ │ │ └─┬ restore-cursor@3.1.0\r\n│ │ │   ├─┬ onetime@5.1.2\r\n│ │ │   │ └── mimic-fn@2.1.0\r\n│ │ │   └── signal-exit@3.0.3\r\n│ │ ├── cli-width@2.2.1\r\n│ │ ├─┬ external-editor@3.1.0\r\n│ │ │ ├── chardet@0.7.0\r\n│ │ │ ├─┬ iconv-lite@0.4.24\r\n│ │ │ │ └── safer-buffer@2.1.2 deduped\r\n│ │ │ └─┬ tmp@0.0.33\r\n│ │ │   └── os-tmpdir@1.0.2 deduped\r\n│ │ ├─┬ figures@3.2.0\r\n│ │ │ └── escape-string-regexp@1.0.5 deduped\r\n│ │ ├── lodash@4.17.20 deduped\r\n│ │ ├── mute-stream@0.0.8\r\n│ │ ├── run-async@2.4.1\r\n│ │ ├── rxjs@6.5.5 deduped\r\n│ │ ├─┬ string-width@4.2.0\r\n│ │ │ ├── emoji-regex@8.0.0\r\n│ │ │ ├── is-fullwidth-code-point@3.0.0\r\n│ │ │ └── strip-ansi@6.0.0 deduped\r\n│ │ ├─┬ strip-ansi@6.0.0\r\n│ │ │ └── ansi-regex@5.0.0\r\n│ │ └── through@2.3.8\r\n│ ├─┬ npm-package-arg@8.0.1\r\n│ │ ├─┬ hosted-git-info@3.0.5\r\n│ │ │ └─┬ lru-cache@6.0.0\r\n│ │ │   └── yallist@4.0.0 deduped\r\n│ │ ├── semver@7.3.2 deduped\r\n│ │ └─┬ validate-npm-package-name@3.0.0\r\n│ │   └── builtins@1.0.3\r\n│ ├─┬ npm-pick-manifest@6.1.0\r\n│ │ ├─┬ npm-install-checks@4.0.0\r\n│ │ │ └── semver@7.3.2 deduped\r\n│ │ ├── npm-package-arg@8.0.1 deduped\r\n│ │ └── semver@7.3.2 deduped\r\n│ ├── open@7.0.4 deduped\r\n│ ├─┬ pacote@9.5.12\r\n│ │ ├── bluebird@3.7.2\r\n│ │ ├─┬ cacache@12.0.4\r\n│ │ │ ├── bluebird@3.7.2 deduped\r\n│ │ │ ├── chownr@1.1.4 deduped\r\n│ │ │ ├── figgy-pudding@3.5.2 deduped\r\n│ │ │ ├── glob@7.1.6 deduped\r\n│ │ │ ├── graceful-fs@4.2.4 deduped\r\n│ │ │ ├── infer-owner@1.0.4 deduped\r\n│ │ │ ├── lru-cache@5.1.1 deduped\r\n│ │ │ ├── mississippi@3.0.0 deduped\r\n│ │ │ ├── mkdirp@0.5.5 deduped\r\n│ │ │ ├─┬ move-concurrently@1.0.1\r\n│ │ │ │ ├── aproba@1.2.0\r\n│ │ │ │ ├─┬ copy-concurrently@1.0.5\r\n│ │ │ │ │ ├── aproba@1.2.0 deduped\r\n│ │ │ │ │ ├── fs-write-stream-atomic@1.0.10 deduped\r\n│ │ │ │ │ ├── iferr@0.1.5\r\n│ │ │ │ │ ├── mkdirp@0.5.5 deduped\r\n│ │ │ │ │ ├─┬ rimraf@2.7.1\r\n│ │ │ │ │ │ └── glob@7.1.6 deduped\r\n│ │ │ │ │ └── run-queue@1.0.3 deduped\r\n│ │ │ │ ├─┬ fs-write-stream-atomic@1.0.10\r\n│ │ │ │ │ ├── graceful-fs@4.2.4 deduped\r\n│ │ │ │ │ ├── iferr@0.1.5 deduped\r\n│ │ │ │ │ ├── imurmurhash@0.1.4 deduped\r\n│ │ │ │ │ └── readable-stream@2.3.7 deduped\r\n│ │ │ │ ├── mkdirp@0.5.5 deduped\r\n│ │ │ │ ├─┬ rimraf@2.7.1\r\n│ │ │ │ │ └── glob@7.1.6 deduped\r\n│ │ │ │ └─┬ run-queue@1.0.3\r\n│ │ │ │   └── aproba@1.2.0 deduped\r\n│ │ │ ├── promise-inflight@1.0.1 deduped\r\n│ │ │ ├── rimraf@2.7.1 deduped\r\n│ │ │ ├── ssri@6.0.1 deduped\r\n│ │ │ ├── unique-filename@1.1.1 deduped\r\n│ │ │ └── y18n@4.0.0 deduped\r\n│ │ ├── chownr@1.1.4\r\n│ │ ├── figgy-pudding@3.5.2\r\n│ │ ├─┬ get-stream@4.1.0\r\n│ │ │ └─┬ pump@3.0.0\r\n│ │ │   ├── end-of-stream@1.4.4 deduped\r\n│ │ │   └── once@1.4.0 deduped\r\n│ │ ├── glob@7.1.6 deduped\r\n│ │ ├── infer-owner@1.0.4 deduped\r\n│ │ ├── lru-cache@5.1.1 deduped\r\n│ │ ├─┬ make-fetch-happen@5.0.2\r\n│ │ │ ├─┬ agentkeepalive@3.5.2\r\n│ │ │ │ └─┬ humanize-ms@1.2.1\r\n│ │ │ │   └── ms@2.0.0 deduped\r\n│ │ │ ├─┬ cacache@12.0.4\r\n│ │ │ │ ├── bluebird@3.7.2 deduped\r\n│ │ │ │ ├── chownr@1.1.4\r\n│ │ │ │ ├── figgy-pudding@3.5.2 deduped\r\n│ │ │ │ ├── glob@7.1.6 deduped\r\n│ │ │ │ ├── graceful-fs@4.2.4 deduped\r\n│ │ │ │ ├── infer-owner@1.0.4 deduped\r\n│ │ │ │ ├── lru-cache@5.1.1 deduped\r\n│ │ │ │ ├── mississippi@3.0.0 deduped\r\n│ │ │ │ ├── mkdirp@0.5.5 deduped\r\n│ │ │ │ ├── move-concurrently@1.0.1 deduped\r\n│ │ │ │ ├── promise-inflight@1.0.1 deduped\r\n│ │ │ │ ├─┬ rimraf@2.7.1\r\n│ │ │ │ │ └── glob@7.1.6 deduped\r\n│ │ │ │ ├── ssri@6.0.1 deduped\r\n│ │ │ │ ├── unique-filename@1.1.1 deduped\r\n│ │ │ │ └── y18n@4.0.0 deduped\r\n│ │ │ ├── http-cache-semantics@3.8.1\r\n│ │ │ ├─┬ http-proxy-agent@2.1.0\r\n│ │ │ │ ├── agent-base@4.3.0 deduped\r\n│ │ │ │ └── debug@3.1.0 deduped\r\n│ │ │ ├── https-proxy-agent@2.2.4 deduped\r\n│ │ │ ├── lru-cache@5.1.1 deduped\r\n│ │ │ ├── mississippi@3.0.0 deduped\r\n│ │ │ ├─┬ node-fetch-npm@2.0.4\r\n│ │ │ │ ├─┬ encoding@0.1.13\r\n│ │ │ │ │ └─┬ iconv-lite@0.6.2\r\n│ │ │ │ │   └── safer-buffer@2.1.2 deduped\r\n│ │ │ │ ├── json-parse-better-errors@1.0.2 deduped\r\n│ │ │ │ └── safe-buffer@5.1.2 deduped\r\n│ │ │ ├── promise-retry@1.1.1 deduped\r\n│ │ │ ├─┬ socks-proxy-agent@4.0.2\r\n│ │ │ │ ├─┬ agent-base@4.2.1\r\n│ │ │ │ │ └── es6-promisify@5.0.0 deduped\r\n│ │ │ │ └─┬ socks@2.3.3\r\n│ │ │ │   ├── ip@1.1.5 deduped\r\n│ │ │ │   └── smart-buffer@4.1.0\r\n│ │ │ └─┬ ssri@6.0.1\r\n│ │ │   └── figgy-pudding@3.5.2 deduped\r\n│ │ ├── minimatch@3.0.4 deduped\r\n│ │ ├─┬ minipass@2.9.0\r\n│ │ │ ├── safe-buffer@5.1.2 deduped\r\n│ │ │ └── yallist@3.1.1\r\n│ │ ├─┬ mississippi@3.0.0\r\n│ │ │ ├─┬ concat-stream@1.6.2\r\n│ │ │ │ ├── buffer-from@1.1.1 deduped\r\n│ │ │ │ ├── inherits@2.0.4 deduped\r\n│ │ │ │ ├── readable-stream@2.3.7 deduped\r\n│ │ │ │ └── typedarray@0.0.6\r\n│ │ │ ├─┬ duplexify@3.7.1\r\n│ │ │ │ ├── end-of-stream@1.4.4 deduped\r\n│ │ │ │ ├── inherits@2.0.4 deduped\r\n│ │ │ │ ├── readable-stream@2.3.7 deduped\r\n│ │ │ │ └── stream-shift@1.0.1\r\n│ │ │ ├─┬ end-of-stream@1.4.4\r\n│ │ │ │ └── once@1.4.0 deduped\r\n│ │ │ ├─┬ flush-write-stream@1.1.1\r\n│ │ │ │ ├── inherits@2.0.4 deduped\r\n│ │ │ │ └── readable-stream@2.3.7 deduped\r\n│ │ │ ├─┬ from2@2.3.0\r\n│ │ │ │ ├── inherits@2.0.4 deduped\r\n│ │ │ │ └── readable-stream@2.3.7 deduped\r\n│ │ │ ├─┬ parallel-transform@1.2.0\r\n│ │ │ │ ├── cyclist@1.0.1\r\n│ │ │ │ ├── inherits@2.0.4 deduped\r\n│ │ │ │ └── readable-stream@2.3.7 deduped\r\n│ │ │ ├── pump@3.0.0 deduped\r\n│ │ │ ├─┬ pumpify@1.5.1\r\n│ │ │ │ ├── duplexify@3.7.1 deduped\r\n│ │ │ │ ├── inherits@2.0.4 deduped\r\n│ │ │ │ └─┬ pump@2.0.1\r\n│ │ │ │   ├── end-of-stream@1.4.4 deduped\r\n│ │ │ │   └── once@1.4.0 deduped\r\n│ │ │ ├─┬ stream-each@1.2.3\r\n│ │ │ │ ├── end-of-stream@1.4.4 deduped\r\n│ │ │ │ └── stream-shift@1.0.1 deduped\r\n│ │ │ └─┬ through2@2.0.5\r\n│ │ │   ├── readable-stream@2.3.7 deduped\r\n│ │ │   └── xtend@4.0.2 deduped\r\n│ │ ├── mkdirp@0.5.5 deduped\r\n│ │ ├─┬ normalize-package-data@2.5.0\r\n│ │ │ ├── hosted-git-info@2.8.8\r\n│ │ │ ├── resolve@1.17.0 deduped\r\n│ │ │ ├── semver@5.7.1\r\n│ │ │ └─┬ validate-npm-package-license@3.0.4\r\n│ │ │   ├─┬ spdx-correct@3.1.1\r\n│ │ │   │ ├── spdx-expression-parse@3.0.1 deduped\r\n│ │ │   │ └── spdx-license-ids@3.0.6\r\n│ │ │   └─┬ spdx-expression-parse@3.0.1\r\n│ │ │     ├── spdx-exceptions@2.3.0\r\n│ │ │     └── spdx-license-ids@3.0.6 deduped\r\n│ │ ├── npm-normalize-package-bin@1.0.1\r\n│ │ ├─┬ npm-package-arg@6.1.1\r\n│ │ │ ├── hosted-git-info@2.8.8\r\n│ │ │ ├── osenv@0.1.5 deduped\r\n│ │ │ ├── semver@5.7.1 deduped\r\n│ │ │ └── validate-npm-package-name@3.0.0 deduped\r\n│ │ ├─┬ npm-packlist@1.4.8\r\n│ │ │ ├─┬ ignore-walk@3.0.3\r\n│ │ │ │ └── minimatch@3.0.4 deduped\r\n│ │ │ ├─┬ npm-bundled@1.1.1\r\n│ │ │ │ └── npm-normalize-package-bin@1.0.1 deduped\r\n│ │ │ └── npm-normalize-package-bin@1.0.1 deduped\r\n│ │ ├─┬ npm-pick-manifest@3.0.2\r\n│ │ │ ├── figgy-pudding@3.5.2 deduped\r\n│ │ │ ├── npm-package-arg@6.1.1 deduped\r\n│ │ │ └── semver@5.7.1 deduped\r\n│ │ ├─┬ npm-registry-fetch@4.0.7\r\n│ │ │ ├── bluebird@3.7.2 deduped\r\n│ │ │ ├── figgy-pudding@3.5.2 deduped\r\n│ │ │ ├─┬ JSONStream@1.3.5\r\n│ │ │ │ ├── jsonparse@1.3.1\r\n│ │ │ │ └── through@2.3.8 deduped\r\n│ │ │ ├── lru-cache@5.1.1 deduped\r\n│ │ │ ├── make-fetch-happen@5.0.2 deduped\r\n│ │ │ ├─┬ npm-package-arg@6.1.1\r\n│ │ │ │ ├── hosted-git-info@2.8.8\r\n│ │ │ │ ├── osenv@0.1.5 deduped\r\n│ │ │ │ ├── semver@5.7.1\r\n│ │ │ │ └── validate-npm-package-name@3.0.0 deduped\r\n│ │ │ └── safe-buffer@5.2.1\r\n│ │ ├─┬ osenv@0.1.5\r\n│ │ │ ├── os-homedir@1.0.2\r\n│ │ │ └── os-tmpdir@1.0.2\r\n│ │ ├── promise-inflight@1.0.1 deduped\r\n│ │ ├─┬ promise-retry@1.1.1\r\n│ │ │ ├── err-code@1.1.2\r\n│ │ │ └── retry@0.10.1\r\n│ │ ├─┬ protoduck@5.0.1\r\n│ │ │ └── genfun@5.0.0\r\n│ │ ├─┬ rimraf@2.7.1\r\n│ │ │ └── glob@7.1.6 deduped\r\n│ │ ├── safe-buffer@5.1.2\r\n│ │ ├── semver@5.7.1\r\n│ │ ├─┬ ssri@6.0.1\r\n│ │ │ └── figgy-pudding@3.5.2 deduped\r\n│ │ ├─┬ tar@4.4.13\r\n│ │ │ ├── chownr@1.1.4 deduped\r\n│ │ │ ├─┬ fs-minipass@1.2.7\r\n│ │ │ │ └── minipass@2.9.0 deduped\r\n│ │ │ ├── minipass@2.9.0 deduped\r\n│ │ │ ├─┬ minizlib@1.3.3\r\n│ │ │ │ └── minipass@2.9.0 deduped\r\n│ │ │ ├── mkdirp@0.5.5 deduped\r\n│ │ │ ├── safe-buffer@5.1.2 deduped\r\n│ │ │ └── yallist@3.1.1 deduped\r\n│ │ ├── unique-filename@1.1.1 deduped\r\n│ │ └── which@1.3.1 deduped\r\n│ ├─┬ read-package-tree@5.3.1\r\n│ │ ├─┬ read-package-json@2.1.2\r\n│ │ │ ├── glob@7.1.6 deduped\r\n│ │ │ ├── json-parse-even-better-errors@2.3.1\r\n│ │ │ ├── normalize-package-data@2.5.0 deduped\r\n│ │ │ └── npm-normalize-package-bin@1.0.1 deduped\r\n│ │ ├─┬ readdir-scoped-modules@1.1.0\r\n│ │ │ ├── debuglog@1.0.1\r\n│ │ │ ├─┬ dezalgo@1.0.3\r\n│ │ │ │ ├── asap@2.0.6\r\n│ │ │ │ └── wrappy@1.0.2 deduped\r\n│ │ │ ├── graceful-fs@4.2.4 deduped\r\n│ │ │ └── once@1.4.0 deduped\r\n│ │ └─┬ util-promisify@2.1.0\r\n│ │   └─┬ object.getownpropertydescriptors@2.1.0\r\n│ │     ├─┬ define-properties@1.1.3\r\n│ │     │ └── object-keys@1.1.1 deduped\r\n│ │     └─┬ es-abstract@1.17.7\r\n│ │       ├─┬ es-to-primitive@1.2.1\r\n│ │       │ ├── is-callable@1.2.2 deduped\r\n│ │       │ ├── is-date-object@1.0.2 deduped\r\n│ │       │ └─┬ is-symbol@1.0.3\r\n│ │       │   └── has-symbols@1.0.1 deduped\r\n│ │       ├── function-bind@1.1.1 deduped\r\n│ │       ├── has@1.0.3 deduped\r\n│ │       ├── has-symbols@1.0.1 deduped\r\n│ │       ├── is-callable@1.2.2\r\n│ │       ├── is-regex@1.1.1 deduped\r\n│ │       ├── object-inspect@1.8.0\r\n│ │       ├── object-keys@1.1.1 deduped\r\n│ │       ├── object.assign@4.1.1 deduped\r\n│ │       ├─┬ string.prototype.trimend@1.0.1\r\n│ │       │ ├── define-properties@1.1.3 deduped\r\n│ │       │ └─┬ es-abstract@1.17.7\r\n│ │       │   ├── es-to-primitive@1.2.1 deduped\r\n│ │       │   ├── function-bind@1.1.1 deduped\r\n│ │       │   ├── has@1.0.3 deduped\r\n│ │       │   ├── has-symbols@1.0.1 deduped\r\n│ │       │   ├── is-callable@1.2.2 deduped\r\n│ │       │   ├── is-regex@1.1.1 deduped\r\n│ │       │   ├── object-inspect@1.8.0 deduped\r\n│ │       │   ├── object-keys@1.1.1 deduped\r\n│ │       │   ├── object.assign@4.1.1 deduped\r\n│ │       │   ├── string.prototype.trimend@1.0.1 deduped\r\n│ │       │   └── string.prototype.trimstart@1.0.1 deduped\r\n│ │       └─┬ string.prototype.trimstart@1.0.1\r\n│ │         ├── define-properties@1.1.3 deduped\r\n│ │         └─┬ es-abstract@1.17.7\r\n│ │           ├── es-to-primitive@1.2.1 deduped\r\n│ │           ├── function-bind@1.1.1 deduped\r\n│ │           ├── has@1.0.3 deduped\r\n│ │           ├── has-symbols@1.0.1 deduped\r\n│ │           ├── is-callable@1.2.2 deduped\r\n│ │           ├── is-regex@1.1.1 deduped\r\n│ │           ├── object-inspect@1.8.0 deduped\r\n│ │           ├── object-keys@1.1.1 deduped\r\n│ │           ├── object.assign@4.1.1 deduped\r\n│ │           ├── string.prototype.trimend@1.0.1 deduped\r\n│ │           └── string.prototype.trimstart@1.0.1 deduped\r\n│ ├── rimraf@3.0.2 deduped\r\n│ ├── semver@7.3.2 deduped\r\n│ ├── symbol-observable@1.2.0\r\n│ ├─┬ universal-analytics@0.4.20\r\n│ │ ├── debug@3.1.0 deduped\r\n│ │ ├─┬ request@2.88.2\r\n│ │ │ ├── aws-sign2@0.7.0\r\n│ │ │ ├── aws4@1.10.1\r\n│ │ │ ├── caseless@0.12.0\r\n│ │ │ ├─┬ combined-stream@1.0.8\r\n│ │ │ │ └── delayed-stream@1.0.0\r\n│ │ │ ├── extend@3.0.2 deduped\r\n│ │ │ ├── forever-agent@0.6.1\r\n│ │ │ ├─┬ form-data@2.3.3\r\n│ │ │ │ ├── asynckit@0.4.0\r\n│ │ │ │ ├── combined-stream@1.0.8 deduped\r\n│ │ │ │ └── mime-types@2.1.27 deduped\r\n│ │ │ ├─┬ har-validator@5.1.5\r\n│ │ │ │ ├── ajv@6.12.3 deduped\r\n│ │ │ │ └── har-schema@2.0.0\r\n│ │ │ ├─┬ http-signature@1.2.0\r\n│ │ │ │ ├── assert-plus@1.0.0\r\n│ │ │ │ ├─┬ jsprim@1.4.1\r\n│ │ │ │ │ ├── assert-plus@1.0.0 deduped\r\n│ │ │ │ │ ├── extsprintf@1.3.0\r\n│ │ │ │ │ ├── json-schema@0.2.3\r\n│ │ │ │ │ └─┬ verror@1.10.0\r\n│ │ │ │ │   ├── assert-plus@1.0.0 deduped\r\n│ │ │ │ │   ├── core-util-is@1.0.2 deduped\r\n│ │ │ │ │   └── extsprintf@1.3.0 deduped\r\n│ │ │ │ └─┬ sshpk@1.16.1\r\n│ │ │ │   ├─┬ asn1@0.2.4\r\n│ │ │ │   │ └── safer-buffer@2.1.2 deduped\r\n│ │ │ │   ├── assert-plus@1.0.0 deduped\r\n│ │ │ │   ├─┬ bcrypt-pbkdf@1.0.2\r\n│ │ │ │   │ └── tweetnacl@0.14.5 deduped\r\n│ │ │ │   ├─┬ dashdash@1.14.1\r\n│ │ │ │   │ └── assert-plus@1.0.0 deduped\r\n│ │ │ │   ├─┬ ecc-jsbn@0.1.2\r\n│ │ │ │   │ ├── jsbn@0.1.1 deduped\r\n│ │ │ │   │ └── safer-buffer@2.1.2 deduped\r\n│ │ │ │   ├─┬ getpass@0.1.7\r\n│ │ │ │   │ └── assert-plus@1.0.0 deduped\r\n│ │ │ │   ├── jsbn@0.1.1\r\n│ │ │ │   ├── safer-buffer@2.1.2 deduped\r\n│ │ │ │   └── tweetnacl@0.14.5\r\n│ │ │ ├── is-typedarray@1.0.0\r\n│ │ │ ├── isstream@0.1.2\r\n│ │ │ ├── json-stringify-safe@5.0.1\r\n│ │ │ ├── mime-types@2.1.27 deduped\r\n│ │ │ ├── oauth-sign@0.9.0\r\n│ │ │ ├── performance-now@2.1.0\r\n│ │ │ ├── qs@6.5.2\r\n│ │ │ ├── safe-buffer@5.1.2 deduped\r\n│ │ │ ├─┬ tough-cookie@2.5.0\r\n│ │ │ │ ├── psl@1.8.0\r\n│ │ │ │ └── punycode@2.1.1\r\n│ │ │ ├─┬ tunnel-agent@0.6.0\r\n│ │ │ │ └── safe-buffer@5.1.2 deduped\r\n│ │ │ └── uuid@3.4.0\r\n│ │ └── uuid@3.4.0\r\n│ └── uuid@8.1.0\r\n├─┬ @angular/common@10.0.14\r\n│ └── tslib@2.0.1 deduped\r\n├─┬ @angular/compiler@10.0.14\r\n│ └── tslib@2.0.1 deduped\r\n├─┬ @angular/compiler-cli@10.0.14\r\n│ ├── canonical-path@1.0.0\r\n│ ├─┬ chokidar@3.4.2\r\n│ │ ├─┬ anymatch@3.1.1\r\n│ │ │ ├── normalize-path@3.0.0 deduped\r\n│ │ │ └── picomatch@2.2.2 deduped\r\n│ │ ├── braces@3.0.2 deduped\r\n│ │ ├── UNMET OPTIONAL DEPENDENCY fsevents@2.1.3\r\n│ │ ├── glob-parent@5.1.1 deduped\r\n│ │ ├─┬ is-binary-path@2.1.0\r\n│ │ │ └── binary-extensions@2.1.0\r\n│ │ ├─┬ is-glob@4.0.1\r\n│ │ │ └── is-extglob@2.1.1\r\n│ │ ├── normalize-path@3.0.0 deduped\r\n│ │ └─┬ readdirp@3.4.0\r\n│ │   └── picomatch@2.2.2 deduped\r\n│ ├─┬ convert-source-map@1.7.0\r\n│ │ └── safe-buffer@5.1.2 deduped\r\n│ ├── dependency-graph@0.7.2\r\n│ ├─┬ fs-extra@4.0.2\r\n│ │ ├── graceful-fs@4.2.4 deduped\r\n│ │ ├─┬ jsonfile@4.0.0\r\n│ │ │ └── graceful-fs@4.2.4 deduped\r\n│ │ └── universalify@0.1.2\r\n│ ├─┬ magic-string@0.25.7\r\n│ │ └── sourcemap-codec@1.4.8 deduped\r\n│ ├── minimist@1.2.5\r\n│ ├── reflect-metadata@0.1.13\r\n│ ├── semver@6.3.0\r\n│ ├── source-map@0.6.1\r\n│ ├── sourcemap-codec@1.4.8\r\n│ ├── tslib@2.0.1 deduped\r\n│ └─┬ yargs@15.3.0\r\n│   ├─┬ cliui@6.0.0\r\n│   │ ├── string-width@4.2.0 deduped\r\n│   │ ├─┬ strip-ansi@6.0.0\r\n│   │ │ └── ansi-regex@5.0.0\r\n│   │ └─┬ wrap-ansi@6.2.0\r\n│   │   ├─┬ ansi-styles@4.3.0\r\n│   │   │ └─┬ color-convert@2.0.1\r\n│   │   │   └── color-name@1.1.4\r\n│   │   ├── string-width@4.2.0 deduped\r\n│   │   └── strip-ansi@6.0.0 deduped\r\n│   ├── decamelize@1.2.0\r\n│   ├─┬ find-up@4.1.0\r\n│   │ ├─┬ locate-path@5.0.0\r\n│   │ │ └─┬ p-locate@4.1.0\r\n│   │ │   └── p-limit@2.3.0 deduped\r\n│   │ └── path-exists@4.0.0\r\n│   ├── get-caller-file@2.0.5\r\n│   ├── require-directory@2.1.1\r\n│   ├── require-main-filename@2.0.0\r\n│   ├── set-blocking@2.0.0\r\n│   ├─┬ string-width@4.2.0\r\n│   │ ├── emoji-regex@8.0.0\r\n│   │ ├── is-fullwidth-code-point@3.0.0\r\n│   │ └── strip-ansi@6.0.0 deduped\r\n│   ├── which-module@2.0.0\r\n│   ├── y18n@4.0.0\r\n│   └─┬ yargs-parser@18.1.3\r\n│     ├── camelcase@5.3.1 deduped\r\n│     └── decamelize@1.2.0 deduped\r\n├─┬ @angular/core@10.0.14\r\n│ └── tslib@2.0.1 deduped\r\n├─┬ @angular/forms@10.0.14\r\n│ └── tslib@2.0.1 deduped\r\n├─┬ @angular/platform-browser@10.0.14\r\n│ └── tslib@2.0.1 deduped\r\n├─┬ @angular/platform-browser-dynamic@10.0.14\r\n│ └── tslib@2.0.1 deduped\r\n├─┬ @angular/router@10.0.14\r\n│ └── tslib@2.0.1 deduped\r\n├─┬ @aws-amplify/ui-angular@0.4.6\r\n│ └─┬ @aws-amplify/ui-components@0.8.6\r\n│   ├── @aws-amplify/auth@3.4.6 deduped\r\n│   ├── @aws-amplify/core@3.6.0 deduped\r\n│   ├── @aws-amplify/interactions@3.3.6 deduped\r\n│   ├── @aws-amplify/storage@3.3.6 deduped\r\n│   ├── @aws-amplify/xr@2.2.6 deduped\r\n│   ├─┬ qrcode@1.4.4\r\n│   │ ├─┬ buffer@5.6.0\r\n│   │ │ ├── base64-js@1.3.1 deduped\r\n│   │ │ └── ieee754@1.1.13 deduped\r\n│   │ ├─┬ buffer-alloc@1.2.0\r\n│   │ │ ├── buffer-alloc-unsafe@1.1.0\r\n│   │ │ └── buffer-fill@1.0.0\r\n│   │ ├── buffer-from@1.1.1 deduped\r\n│   │ ├── dijkstrajs@1.0.1\r\n│   │ ├── isarray@2.0.5\r\n│   │ ├── pngjs@3.4.0\r\n│   │ └── yargs@13.3.2 deduped\r\n│   └── uuid@8.3.1\r\n├── @types/jasmine@3.5.14\r\n├─┬ @types/jasminewd2@2.0.8\r\n│ └── @types/jasmine@3.5.14 deduped\r\n├── @types/node@12.12.64\r\n├─┬ aws-amplify@3.3.3\r\n│ ├─┬ @aws-amplify/analytics@3.3.6\r\n│ │ ├── @aws-amplify/cache@3.1.31 deduped\r\n│ │ ├── @aws-amplify/core@3.6.0 deduped\r\n│ │ ├─┬ @aws-sdk/client-firehose@1.0.0-gamma.8\r\n│ │ │ ├─┬ @aws-crypto/sha256-browser@1.0.0-alpha.0\r\n│ │ │ │ ├─┬ @aws-crypto/ie11-detection@1.0.0-alpha.0\r\n│ │ │ │ │ └── tslib@1.13.0\r\n│ │ │ │ ├── @aws-crypto/sha256-js@1.0.0-alpha.0 deduped\r\n│ │ │ │ ├─┬ @aws-crypto/supports-web-crypto@1.0.0-alpha.0\r\n│ │ │ │ │ └── tslib@1.13.0\r\n│ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ ├─┬ @aws-sdk/util-locate-window@1.0.0-gamma.6\r\n│ │ │ │ │ └── tslib@1.13.0\r\n│ │ │ │ ├── @aws-sdk/util-utf8-browser@1.0.0-gamma.6 deduped\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├── @aws-crypto/sha256-js@1.0.0-alpha.0 deduped\r\n│ │ │ ├─┬ @aws-sdk/config-resolver@1.0.0-gamma.7\r\n│ │ │ │ ├── @aws-sdk/signature-v4@1.0.0-gamma.7 deduped\r\n│ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├─┬ @aws-sdk/credential-provider-node@1.0.0-gamma.7\r\n│ │ │ │ ├─┬ @aws-sdk/credential-provider-env@1.0.0-gamma.7\r\n│ │ │ │ │ ├── @aws-sdk/property-provider@1.0.0-gamma.7 deduped\r\n│ │ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ │ └── tslib@1.13.0\r\n│ │ │ │ ├─┬ @aws-sdk/credential-provider-imds@1.0.0-gamma.7\r\n│ │ │ │ │ ├── @aws-sdk/property-provider@1.0.0-gamma.7 deduped\r\n│ │ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ │ └── tslib@1.13.0\r\n│ │ │ │ ├─┬ @aws-sdk/credential-provider-ini@1.0.0-gamma.7\r\n│ │ │ │ │ ├── @aws-sdk/property-provider@1.0.0-gamma.7 deduped\r\n│ │ │ │ │ ├── @aws-sdk/shared-ini-file-loader@1.0.0-gamma.6 deduped\r\n│ │ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ │ └── tslib@1.13.0\r\n│ │ │ │ ├─┬ @aws-sdk/credential-provider-process@1.0.0-gamma.7\r\n│ │ │ │ │ ├── @aws-sdk/credential-provider-ini@1.0.0-gamma.7 deduped\r\n│ │ │ │ │ ├── @aws-sdk/property-provider@1.0.0-gamma.7 deduped\r\n│ │ │ │ │ ├── @aws-sdk/shared-ini-file-loader@1.0.0-gamma.6 deduped\r\n│ │ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ │ └── tslib@1.13.0\r\n│ │ │ │ ├── @aws-sdk/property-provider@1.0.0-gamma.7 deduped\r\n│ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├─┬ @aws-sdk/fetch-http-handler@1.0.0-gamma.8\r\n│ │ │ │ ├── @aws-sdk/protocol-http@1.0.0-gamma.7 deduped\r\n│ │ │ │ ├── @aws-sdk/querystring-builder@1.0.0-gamma.7 deduped\r\n│ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ ├── @aws-sdk/util-base64-browser@1.0.0-gamma.6 deduped\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├─┬ @aws-sdk/hash-node@1.0.0-gamma.7\r\n│ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ ├── @aws-sdk/util-buffer-from@1.0.0-gamma.6 deduped\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├─┬ @aws-sdk/invalid-dependency@1.0.0-gamma.5\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├─┬ @aws-sdk/middleware-content-length@1.0.0-gamma.7\r\n│ │ │ │ ├── @aws-sdk/protocol-http@1.0.0-gamma.7 deduped\r\n│ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├─┬ @aws-sdk/middleware-host-header@1.0.0-gamma.7\r\n│ │ │ │ ├── @aws-sdk/protocol-http@1.0.0-gamma.7 deduped\r\n│ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├─┬ @aws-sdk/middleware-logger@1.0.0-gamma.1\r\n│ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├─┬ @aws-sdk/middleware-retry@1.0.0-gamma.7\r\n│ │ │ │ ├── @aws-sdk/protocol-http@1.0.0-gamma.7 deduped\r\n│ │ │ │ ├── @aws-sdk/service-error-classification@1.0.0-gamma.7\r\n│ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ ├── UNMET PEER DEPENDENCY react-native@>=0.56\r\n│ │ │ │ ├─┬ react-native-get-random-values@1.5.0\r\n│ │ │ │ │ └── fast-base64-decode@1.0.0\r\n│ │ │ │ ├── tslib@1.13.0\r\n│ │ │ │ └── uuid@3.4.0\r\n│ │ │ ├─┬ @aws-sdk/middleware-serde@1.0.0-gamma.6\r\n│ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├─┬ @aws-sdk/middleware-signing@1.0.0-gamma.7\r\n│ │ │ │ ├── @aws-sdk/protocol-http@1.0.0-gamma.7 deduped\r\n│ │ │ │ ├── @aws-sdk/signature-v4@1.0.0-gamma.7 deduped\r\n│ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├─┬ @aws-sdk/middleware-stack@1.0.0-gamma.7\r\n│ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├─┬ @aws-sdk/middleware-user-agent@1.0.0-gamma.7\r\n│ │ │ │ ├── @aws-sdk/protocol-http@1.0.0-gamma.7 deduped\r\n│ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├─┬ @aws-sdk/node-config-provider@1.0.0-gamma.2\r\n│ │ │ │ ├── @aws-sdk/property-provider@1.0.0-gamma.7 deduped\r\n│ │ │ │ ├─┬ @aws-sdk/shared-ini-file-loader@1.0.0-gamma.6\r\n│ │ │ │ │ └── tslib@1.13.0\r\n│ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├── @aws-sdk/node-http-handler@1.0.0-gamma.7 deduped\r\n│ │ │ ├─┬ @aws-sdk/protocol-http@1.0.0-gamma.7\r\n│ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├─┬ @aws-sdk/smithy-client@1.0.0-gamma.7\r\n│ │ │ │ ├── @aws-sdk/middleware-stack@1.0.0-gamma.7 deduped\r\n│ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ ├─┬ @aws-sdk/url-parser-browser@1.0.0-gamma.7\r\n│ │ │ │ ├─┬ @aws-sdk/querystring-parser@1.0.0-gamma.7\r\n│ │ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ │ └── tslib@1.13.0\r\n│ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├─┬ @aws-sdk/url-parser-node@1.0.0-gamma.7\r\n│ │ │ │ ├── @aws-sdk/querystring-parser@1.0.0-gamma.7 deduped\r\n│ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ ├── tslib@1.13.0\r\n│ │ │ │ └── url@0.11.0 deduped\r\n│ │ │ ├─┬ @aws-sdk/util-base64-browser@1.0.0-gamma.6\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├─┬ @aws-sdk/util-base64-node@1.0.0-gamma.6\r\n│ │ │ │ ├── @aws-sdk/util-buffer-from@1.0.0-gamma.6 deduped\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├─┬ @aws-sdk/util-body-length-browser@1.0.0-gamma.6\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├─┬ @aws-sdk/util-body-length-node@1.0.0-gamma.6\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├── @aws-sdk/util-user-agent-browser@1.0.0-gamma.7 deduped\r\n│ │ │ ├─┬ @aws-sdk/util-user-agent-node@1.0.0-gamma.7\r\n│ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├── @aws-sdk/util-utf8-browser@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-utf8-node@1.0.0-gamma.6 deduped\r\n│ │ │ └── tslib@2.0.1\r\n│ │ ├─┬ @aws-sdk/client-kinesis@1.0.0-gamma.8\r\n│ │ │ ├── @aws-crypto/sha256-browser@1.0.0-alpha.0 deduped\r\n│ │ │ ├── @aws-crypto/sha256-js@1.0.0-alpha.0 deduped\r\n│ │ │ ├── @aws-sdk/config-resolver@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/credential-provider-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├─┬ @aws-sdk/eventstream-serde-browser@1.0.0-gamma.7\r\n│ │ │ │ ├── @aws-sdk/eventstream-marshaller@1.0.0-gamma.7 deduped\r\n│ │ │ │ ├─┬ @aws-sdk/eventstream-serde-universal@1.0.0-gamma.6\r\n│ │ │ │ │ ├── @aws-sdk/eventstream-marshaller@1.0.0-gamma.7 deduped\r\n│ │ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ │ └── tslib@1.13.0\r\n│ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├─┬ @aws-sdk/eventstream-serde-config-resolver@1.0.0-gamma.6\r\n│ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├─┬ @aws-sdk/eventstream-serde-node@1.0.0-gamma.7\r\n│ │ │ │ ├── @aws-sdk/eventstream-marshaller@1.0.0-gamma.7 deduped\r\n│ │ │ │ ├── @aws-sdk/eventstream-serde-universal@1.0.0-gamma.6 deduped\r\n│ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├── @aws-sdk/fetch-http-handler@1.0.0-gamma.8 deduped\r\n│ │ │ ├── @aws-sdk/hash-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/invalid-dependency@1.0.0-gamma.5 deduped\r\n│ │ │ ├── @aws-sdk/middleware-content-length@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-host-header@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-logger@1.0.0-gamma.1 deduped\r\n│ │ │ ├── @aws-sdk/middleware-retry@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-serde@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/middleware-signing@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-stack@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-user-agent@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/node-config-provider@1.0.0-gamma.2 deduped\r\n│ │ │ ├── @aws-sdk/node-http-handler@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/protocol-http@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/smithy-client@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/url-parser-browser@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/url-parser-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/util-base64-browser@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-base64-node@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-body-length-browser@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-body-length-node@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-user-agent-browser@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/util-user-agent-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/util-utf8-browser@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-utf8-node@1.0.0-gamma.6 deduped\r\n│ │ │ └── tslib@2.0.1\r\n│ │ ├─┬ @aws-sdk/client-personalize-events@1.0.0-gamma.8\r\n│ │ │ ├── @aws-crypto/sha256-browser@1.0.0-alpha.0 deduped\r\n│ │ │ ├── @aws-crypto/sha256-js@1.0.0-alpha.0 deduped\r\n│ │ │ ├── @aws-sdk/config-resolver@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/credential-provider-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/fetch-http-handler@1.0.0-gamma.8 deduped\r\n│ │ │ ├── @aws-sdk/hash-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/invalid-dependency@1.0.0-gamma.5 deduped\r\n│ │ │ ├── @aws-sdk/middleware-content-length@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-host-header@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-logger@1.0.0-gamma.1 deduped\r\n│ │ │ ├── @aws-sdk/middleware-retry@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-serde@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/middleware-signing@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-stack@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-user-agent@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/node-config-provider@1.0.0-gamma.2 deduped\r\n│ │ │ ├── @aws-sdk/node-http-handler@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/protocol-http@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/smithy-client@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/url-parser-browser@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/url-parser-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/util-base64-browser@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-base64-node@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-body-length-browser@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-body-length-node@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-user-agent-browser@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/util-user-agent-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/util-utf8-browser@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-utf8-node@1.0.0-gamma.6 deduped\r\n│ │ │ └── tslib@2.0.1\r\n│ │ ├─┬ @aws-sdk/client-pinpoint@1.0.0-gamma.8\r\n│ │ │ ├── @aws-crypto/sha256-browser@1.0.0-alpha.0 deduped\r\n│ │ │ ├── @aws-crypto/sha256-js@1.0.0-alpha.0 deduped\r\n│ │ │ ├── @aws-sdk/config-resolver@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/credential-provider-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/fetch-http-handler@1.0.0-gamma.8 deduped\r\n│ │ │ ├── @aws-sdk/hash-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/invalid-dependency@1.0.0-gamma.5 deduped\r\n│ │ │ ├── @aws-sdk/middleware-content-length@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-host-header@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-logger@1.0.0-gamma.1 deduped\r\n│ │ │ ├── @aws-sdk/middleware-retry@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-serde@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/middleware-signing@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-stack@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-user-agent@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/node-config-provider@1.0.0-gamma.2 deduped\r\n│ │ │ ├── @aws-sdk/node-http-handler@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/protocol-http@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/smithy-client@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/url-parser-browser@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/url-parser-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/util-base64-browser@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-base64-node@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-body-length-browser@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-body-length-node@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-user-agent-browser@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/util-user-agent-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/util-utf8-browser@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-utf8-node@1.0.0-gamma.6 deduped\r\n│ │ │ └── tslib@2.0.1\r\n│ │ ├─┬ @aws-sdk/util-utf8-browser@1.0.0-gamma.6\r\n│ │ │ └── tslib@1.13.0\r\n│ │ ├── lodash@4.17.20 deduped\r\n│ │ └── uuid@3.4.0\r\n│ ├─┬ @aws-amplify/api@3.2.6\r\n│ │ ├─┬ @aws-amplify/api-graphql@1.2.6\r\n│ │ │ ├── @aws-amplify/api-rest@1.2.6 deduped\r\n│ │ │ ├── @aws-amplify/auth@3.4.6 deduped\r\n│ │ │ ├── @aws-amplify/cache@3.1.31 deduped\r\n│ │ │ ├── @aws-amplify/core@3.6.0 deduped\r\n│ │ │ ├── @aws-amplify/pubsub@3.2.4 deduped\r\n│ │ │ ├── graphql@14.0.0 deduped\r\n│ │ │ ├── uuid@3.4.0\r\n│ │ │ └── zen-observable-ts@0.8.19 deduped\r\n│ │ └─┬ @aws-amplify/api-rest@1.2.6\r\n│ │   ├── @aws-amplify/core@3.6.0 deduped\r\n│ │   └── axios@0.19.0 deduped\r\n│ ├─┬ @aws-amplify/auth@3.4.6\r\n│ │ ├── @aws-amplify/cache@3.1.31 deduped\r\n│ │ ├── @aws-amplify/core@3.6.0 deduped\r\n│ │ ├─┬ amazon-cognito-identity-js@4.4.0\r\n│ │ │ ├─┬ buffer@4.9.1\r\n│ │ │ │ ├── base64-js@1.3.1 deduped\r\n│ │ │ │ ├── ieee754@1.1.13 deduped\r\n│ │ │ │ └── isarray@1.0.0 deduped\r\n│ │ │ ├── crypto-js@3.3.0 deduped\r\n│ │ │ ├─┬ isomorphic-unfetch@3.1.0\r\n│ │ │ │ ├── node-fetch@2.6.1\r\n│ │ │ │ └── unfetch@4.2.0\r\n│ │ │ └── js-cookie@2.2.1\r\n│ │ └── crypto-js@3.3.0\r\n│ ├─┬ @aws-amplify/cache@3.1.31\r\n│ │ └── @aws-amplify/core@3.6.0 deduped\r\n│ ├─┬ @aws-amplify/core@3.6.0\r\n│ │ ├─┬ @aws-crypto/sha256-js@1.0.0-alpha.0\r\n│ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-utf8-browser@1.0.0-gamma.6 deduped\r\n│ │ │ └── tslib@1.13.0\r\n│ │ ├─┬ @aws-sdk/client-cognito-identity@1.0.0-gamma.8\r\n│ │ │ ├── @aws-crypto/sha256-browser@1.0.0-alpha.0 deduped\r\n│ │ │ ├── @aws-crypto/sha256-js@1.0.0-alpha.0 deduped\r\n│ │ │ ├── @aws-sdk/config-resolver@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/credential-provider-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/fetch-http-handler@1.0.0-gamma.8 deduped\r\n│ │ │ ├── @aws-sdk/hash-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/invalid-dependency@1.0.0-gamma.5 deduped\r\n│ │ │ ├── @aws-sdk/middleware-content-length@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-host-header@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-logger@1.0.0-gamma.1 deduped\r\n│ │ │ ├── @aws-sdk/middleware-retry@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-serde@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/middleware-signing@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-stack@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-user-agent@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/node-config-provider@1.0.0-gamma.2 deduped\r\n│ │ │ ├── @aws-sdk/node-http-handler@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/protocol-http@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/smithy-client@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/url-parser-browser@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/url-parser-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/util-base64-browser@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-base64-node@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-body-length-browser@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-body-length-node@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-user-agent-browser@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/util-user-agent-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/util-utf8-browser@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-utf8-node@1.0.0-gamma.6 deduped\r\n│ │ │ └── tslib@2.0.1\r\n│ │ ├─┬ @aws-sdk/credential-provider-cognito-identity@1.0.0-gamma.8\r\n│ │ │ ├── @aws-sdk/client-cognito-identity@1.0.0-gamma.8 deduped\r\n│ │ │ ├─┬ @aws-sdk/property-provider@1.0.0-gamma.7\r\n│ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ └── tslib@1.13.0\r\n│ │ ├─┬ @aws-sdk/node-http-handler@1.0.0-gamma.7\r\n│ │ │ ├─┬ @aws-sdk/abort-controller@1.0.0-gamma.7\r\n│ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├── @aws-sdk/protocol-http@1.0.0-gamma.7 deduped\r\n│ │ │ ├─┬ @aws-sdk/querystring-builder@1.0.0-gamma.7\r\n│ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ ├─┬ @aws-sdk/util-uri-escape@1.0.0-gamma.6\r\n│ │ │ │ │ └── tslib@1.13.0\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ └── tslib@1.13.0\r\n│ │ ├── @aws-sdk/types@1.0.0-gamma.6\r\n│ │ ├─┬ @aws-sdk/util-hex-encoding@1.0.0-gamma.6\r\n│ │ │ └── tslib@1.13.0\r\n│ │ ├─┬ @aws-sdk/util-user-agent-browser@1.0.0-gamma.7\r\n│ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ └── tslib@1.13.0\r\n│ │ ├─┬ universal-cookie@4.0.4\r\n│ │ │ ├── @types/cookie@0.3.3\r\n│ │ │ └── cookie@0.4.1\r\n│ │ ├── url@0.11.0 deduped\r\n│ │ └─┬ zen-observable-ts@0.8.19\r\n│ │   ├── tslib@1.13.0\r\n│ │   └── zen-observable@0.8.15\r\n│ ├─┬ @aws-amplify/datastore@2.6.0\r\n│ │ ├── @aws-amplify/api@3.2.6 deduped\r\n│ │ ├── @aws-amplify/core@3.6.0 deduped\r\n│ │ ├── @aws-amplify/pubsub@3.2.4 deduped\r\n│ │ ├── idb@5.0.2\r\n│ │ ├── immer@6.0.1\r\n│ │ ├── ulid@2.3.0\r\n│ │ ├── uuid@3.3.2\r\n│ │ ├── zen-observable-ts@0.8.19 deduped\r\n│ │ └─┬ zen-push@0.2.1\r\n│ │   └── zen-observable@0.7.1\r\n│ ├─┬ @aws-amplify/interactions@3.3.6\r\n│ │ ├── @aws-amplify/core@3.6.0 deduped\r\n│ │ └─┬ @aws-sdk/client-lex-runtime-service@1.0.0-gamma.8\r\n│ │   ├── @aws-crypto/sha256-browser@1.0.0-alpha.0 deduped\r\n│ │   ├── @aws-crypto/sha256-js@1.0.0-alpha.0 deduped\r\n│ │   ├── @aws-sdk/config-resolver@1.0.0-gamma.7 deduped\r\n│ │   ├── @aws-sdk/credential-provider-node@1.0.0-gamma.7 deduped\r\n│ │   ├── @aws-sdk/fetch-http-handler@1.0.0-gamma.8 deduped\r\n│ │   ├── @aws-sdk/hash-node@1.0.0-gamma.7 deduped\r\n│ │   ├── @aws-sdk/invalid-dependency@1.0.0-gamma.5 deduped\r\n│ │   ├── @aws-sdk/middleware-content-length@1.0.0-gamma.7 deduped\r\n│ │   ├── @aws-sdk/middleware-host-header@1.0.0-gamma.7 deduped\r\n│ │   ├── @aws-sdk/middleware-logger@1.0.0-gamma.1 deduped\r\n│ │   ├── @aws-sdk/middleware-retry@1.0.0-gamma.7 deduped\r\n│ │   ├── @aws-sdk/middleware-serde@1.0.0-gamma.6 deduped\r\n│ │   ├── @aws-sdk/middleware-signing@1.0.0-gamma.7 deduped\r\n│ │   ├── @aws-sdk/middleware-stack@1.0.0-gamma.7 deduped\r\n│ │   ├── @aws-sdk/middleware-user-agent@1.0.0-gamma.7 deduped\r\n│ │   ├── @aws-sdk/node-config-provider@1.0.0-gamma.2 deduped\r\n│ │   ├── @aws-sdk/node-http-handler@1.0.0-gamma.7 deduped\r\n│ │   ├── @aws-sdk/protocol-http@1.0.0-gamma.7 deduped\r\n│ │   ├── @aws-sdk/smithy-client@1.0.0-gamma.7 deduped\r\n│ │   ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │   ├── @aws-sdk/url-parser-browser@1.0.0-gamma.7 deduped\r\n│ │   ├── @aws-sdk/url-parser-node@1.0.0-gamma.7 deduped\r\n│ │   ├── @aws-sdk/util-base64-browser@1.0.0-gamma.6 deduped\r\n│ │   ├── @aws-sdk/util-base64-node@1.0.0-gamma.6 deduped\r\n│ │   ├── @aws-sdk/util-body-length-browser@1.0.0-gamma.6 deduped\r\n│ │   ├── @aws-sdk/util-body-length-node@1.0.0-gamma.6 deduped\r\n│ │   ├── @aws-sdk/util-user-agent-browser@1.0.0-gamma.7 deduped\r\n│ │   ├── @aws-sdk/util-user-agent-node@1.0.0-gamma.7 deduped\r\n│ │   ├── @aws-sdk/util-utf8-browser@1.0.0-gamma.6 deduped\r\n│ │   ├── @aws-sdk/util-utf8-node@1.0.0-gamma.6 deduped\r\n│ │   └── tslib@2.0.1\r\n│ ├─┬ @aws-amplify/predictions@3.2.6\r\n│ │ ├── @aws-amplify/core@3.6.0 deduped\r\n│ │ ├── @aws-amplify/storage@3.3.6 deduped\r\n│ │ ├─┬ @aws-sdk/client-comprehend@1.0.0-gamma.8\r\n│ │ │ ├── @aws-crypto/sha256-browser@1.0.0-alpha.0 deduped\r\n│ │ │ ├── @aws-crypto/sha256-js@1.0.0-alpha.0 deduped\r\n│ │ │ ├── @aws-sdk/config-resolver@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/credential-provider-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/fetch-http-handler@1.0.0-gamma.8 deduped\r\n│ │ │ ├── @aws-sdk/hash-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/invalid-dependency@1.0.0-gamma.5 deduped\r\n│ │ │ ├── @aws-sdk/middleware-content-length@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-host-header@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-logger@1.0.0-gamma.1 deduped\r\n│ │ │ ├── @aws-sdk/middleware-retry@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-serde@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/middleware-signing@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-stack@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-user-agent@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/node-config-provider@1.0.0-gamma.2 deduped\r\n│ │ │ ├── @aws-sdk/node-http-handler@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/protocol-http@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/smithy-client@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/url-parser-browser@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/url-parser-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/util-base64-browser@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-base64-node@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-body-length-browser@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-body-length-node@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-user-agent-browser@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/util-user-agent-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/util-utf8-browser@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-utf8-node@1.0.0-gamma.6 deduped\r\n│ │ │ ├── tslib@2.0.1\r\n│ │ │ └── uuid@3.4.0\r\n│ │ ├─┬ @aws-sdk/client-polly@1.0.0-gamma.8\r\n│ │ │ ├── @aws-crypto/sha256-browser@1.0.0-alpha.0 deduped\r\n│ │ │ ├── @aws-crypto/sha256-js@1.0.0-alpha.0 deduped\r\n│ │ │ ├── @aws-sdk/config-resolver@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/credential-provider-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/fetch-http-handler@1.0.0-gamma.8 deduped\r\n│ │ │ ├── @aws-sdk/hash-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/invalid-dependency@1.0.0-gamma.5 deduped\r\n│ │ │ ├── @aws-sdk/middleware-content-length@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-host-header@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-logger@1.0.0-gamma.1 deduped\r\n│ │ │ ├── @aws-sdk/middleware-retry@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-serde@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/middleware-signing@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-stack@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-user-agent@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/node-config-provider@1.0.0-gamma.2 deduped\r\n│ │ │ ├── @aws-sdk/node-http-handler@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/protocol-http@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/smithy-client@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/url-parser-browser@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/url-parser-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/util-base64-browser@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-base64-node@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-body-length-browser@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-body-length-node@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-user-agent-browser@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/util-user-agent-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/util-utf8-browser@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-utf8-node@1.0.0-gamma.6 deduped\r\n│ │ │ └── tslib@2.0.1\r\n│ │ ├─┬ @aws-sdk/client-rekognition@1.0.0-gamma.8\r\n│ │ │ ├── @aws-crypto/sha256-browser@1.0.0-alpha.0 deduped\r\n│ │ │ ├── @aws-crypto/sha256-js@1.0.0-alpha.0 deduped\r\n│ │ │ ├── @aws-sdk/config-resolver@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/credential-provider-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/fetch-http-handler@1.0.0-gamma.8 deduped\r\n│ │ │ ├── @aws-sdk/hash-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/invalid-dependency@1.0.0-gamma.5 deduped\r\n│ │ │ ├── @aws-sdk/middleware-content-length@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-host-header@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-logger@1.0.0-gamma.1 deduped\r\n│ │ │ ├── @aws-sdk/middleware-retry@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-serde@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/middleware-signing@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-stack@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-user-agent@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/node-config-provider@1.0.0-gamma.2 deduped\r\n│ │ │ ├── @aws-sdk/node-http-handler@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/protocol-http@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/smithy-client@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/url-parser-browser@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/url-parser-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/util-base64-browser@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-base64-node@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-body-length-browser@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-body-length-node@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-user-agent-browser@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/util-user-agent-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/util-utf8-browser@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-utf8-node@1.0.0-gamma.6 deduped\r\n│ │ │ └── tslib@2.0.1\r\n│ │ ├─┬ @aws-sdk/client-textract@1.0.0-gamma.8\r\n│ │ │ ├── @aws-crypto/sha256-browser@1.0.0-alpha.0 deduped\r\n│ │ │ ├── @aws-crypto/sha256-js@1.0.0-alpha.0 deduped\r\n│ │ │ ├── @aws-sdk/config-resolver@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/credential-provider-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/fetch-http-handler@1.0.0-gamma.8 deduped\r\n│ │ │ ├── @aws-sdk/hash-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/invalid-dependency@1.0.0-gamma.5 deduped\r\n│ │ │ ├── @aws-sdk/middleware-content-length@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-host-header@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-logger@1.0.0-gamma.1 deduped\r\n│ │ │ ├── @aws-sdk/middleware-retry@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-serde@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/middleware-signing@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-stack@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-user-agent@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/node-config-provider@1.0.0-gamma.2 deduped\r\n│ │ │ ├── @aws-sdk/node-http-handler@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/protocol-http@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/smithy-client@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/url-parser-browser@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/url-parser-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/util-base64-browser@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-base64-node@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-body-length-browser@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-body-length-node@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-user-agent-browser@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/util-user-agent-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/util-utf8-browser@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-utf8-node@1.0.0-gamma.6 deduped\r\n│ │ │ └── tslib@2.0.1\r\n│ │ ├─┬ @aws-sdk/client-translate@1.0.0-gamma.8\r\n│ │ │ ├── @aws-crypto/sha256-browser@1.0.0-alpha.0 deduped\r\n│ │ │ ├── @aws-crypto/sha256-js@1.0.0-alpha.0 deduped\r\n│ │ │ ├── @aws-sdk/config-resolver@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/credential-provider-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/fetch-http-handler@1.0.0-gamma.8 deduped\r\n│ │ │ ├── @aws-sdk/hash-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/invalid-dependency@1.0.0-gamma.5 deduped\r\n│ │ │ ├── @aws-sdk/middleware-content-length@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-host-header@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-logger@1.0.0-gamma.1 deduped\r\n│ │ │ ├── @aws-sdk/middleware-retry@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-serde@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/middleware-signing@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-stack@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-user-agent@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/node-config-provider@1.0.0-gamma.2 deduped\r\n│ │ │ ├── @aws-sdk/node-http-handler@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/protocol-http@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/smithy-client@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/url-parser-browser@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/url-parser-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/util-base64-browser@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-base64-node@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-body-length-browser@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-body-length-node@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-user-agent-browser@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/util-user-agent-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/util-utf8-browser@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-utf8-node@1.0.0-gamma.6 deduped\r\n│ │ │ ├── tslib@2.0.1\r\n│ │ │ └── uuid@3.4.0\r\n│ │ ├─┬ @aws-sdk/eventstream-marshaller@1.0.0-gamma.7\r\n│ │ │ ├─┬ @aws-crypto/crc32@1.0.0-alpha.0\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-hex-encoding@1.0.0-gamma.6 deduped\r\n│ │ │ └── tslib@1.13.0\r\n│ │ ├─┬ @aws-sdk/util-utf8-node@1.0.0-gamma.6\r\n│ │ │ ├─┬ @aws-sdk/util-buffer-from@1.0.0-gamma.6\r\n│ │ │ │ ├─┬ @aws-sdk/is-array-buffer@1.0.0-gamma.6\r\n│ │ │ │ │ └── tslib@1.13.0\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ └── tslib@1.13.0\r\n│ │ └── uuid@3.4.0\r\n│ ├─┬ @aws-amplify/pubsub@3.2.4\r\n│ │ ├── @aws-amplify/auth@3.4.6 deduped\r\n│ │ ├── @aws-amplify/cache@3.1.31 deduped\r\n│ │ ├── @aws-amplify/core@3.6.0 deduped\r\n│ │ ├─┬ graphql@14.0.0\r\n│ │ │ └── iterall@1.3.0\r\n│ │ ├── paho-mqtt@1.1.0\r\n│ │ ├── uuid@3.4.0\r\n│ │ └── zen-observable-ts@0.8.19 deduped\r\n│ ├─┬ @aws-amplify/storage@3.3.6\r\n│ │ ├── @aws-amplify/core@3.6.0 deduped\r\n│ │ ├─┬ @aws-sdk/client-s3@1.0.0-gamma.8\r\n│ │ │ ├── @aws-crypto/sha256-browser@1.0.0-alpha.0 deduped\r\n│ │ │ ├── @aws-crypto/sha256-js@1.0.0-alpha.0 deduped\r\n│ │ │ ├── @aws-sdk/config-resolver@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/credential-provider-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/eventstream-serde-browser@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/eventstream-serde-config-resolver@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/eventstream-serde-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/fetch-http-handler@1.0.0-gamma.8 deduped\r\n│ │ │ ├─┬ @aws-sdk/hash-blob-browser@1.0.0-gamma.7\r\n│ │ │ │ ├─┬ @aws-sdk/chunked-blob-reader@1.0.0-gamma.6\r\n│ │ │ │ │ └── tslib@1.13.0\r\n│ │ │ │ ├─┬ @aws-sdk/chunked-blob-reader-native@1.0.0-gamma.6\r\n│ │ │ │ │ ├── @aws-sdk/util-base64-browser@1.0.0-gamma.6 deduped\r\n│ │ │ │ │ └── tslib@1.13.0\r\n│ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├── @aws-sdk/hash-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├─┬ @aws-sdk/hash-stream-node@1.0.0-gamma.7\r\n│ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├── @aws-sdk/invalid-dependency@1.0.0-gamma.5 deduped\r\n│ │ │ ├─┬ @aws-sdk/md5-js@1.0.0-gamma.7\r\n│ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ ├── @aws-sdk/util-utf8-browser@1.0.0-gamma.6 deduped\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├─┬ @aws-sdk/middleware-apply-body-checksum@1.0.0-gamma.7\r\n│ │ │ │ ├── @aws-sdk/is-array-buffer@1.0.0-gamma.6 deduped\r\n│ │ │ │ ├── @aws-sdk/protocol-http@1.0.0-gamma.7 deduped\r\n│ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├─┬ @aws-sdk/middleware-bucket-endpoint@1.0.0-gamma.7\r\n│ │ │ │ ├── @aws-sdk/protocol-http@1.0.0-gamma.7 deduped\r\n│ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ ├─┬ @aws-sdk/util-arn-parser@1.0.0-gamma.3\r\n│ │ │ │ │ └── tslib@1.13.0\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├── @aws-sdk/middleware-content-length@1.0.0-gamma.7 deduped\r\n│ │ │ ├─┬ @aws-sdk/middleware-expect-continue@1.0.0-gamma.7\r\n│ │ │ │ ├─┬ @aws-sdk/middleware-header-default@1.0.0-gamma.7\r\n│ │ │ │ │ ├── @aws-sdk/protocol-http@1.0.0-gamma.7 deduped\r\n│ │ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ │ └── tslib@1.13.0\r\n│ │ │ │ ├── @aws-sdk/protocol-http@1.0.0-gamma.7 deduped\r\n│ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├── @aws-sdk/middleware-host-header@1.0.0-gamma.7 deduped\r\n│ │ │ ├─┬ @aws-sdk/middleware-location-constraint@1.0.0-gamma.7\r\n│ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├── @aws-sdk/middleware-logger@1.0.0-gamma.1 deduped\r\n│ │ │ ├── @aws-sdk/middleware-retry@1.0.0-gamma.7 deduped\r\n│ │ │ ├─┬ @aws-sdk/middleware-sdk-s3@1.0.0-gamma.7\r\n│ │ │ │ ├── @aws-sdk/util-arn-parser@1.0.0-gamma.3 deduped\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├── @aws-sdk/middleware-serde@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/middleware-signing@1.0.0-gamma.7 deduped\r\n│ │ │ ├─┬ @aws-sdk/middleware-ssec@1.0.0-gamma.7\r\n│ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├── @aws-sdk/middleware-stack@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/middleware-user-agent@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/node-config-provider@1.0.0-gamma.2 deduped\r\n│ │ │ ├── @aws-sdk/node-http-handler@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/protocol-http@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/smithy-client@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/url-parser-browser@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/url-parser-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/util-base64-browser@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-base64-node@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-body-length-browser@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-body-length-node@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-user-agent-browser@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/util-user-agent-node@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/util-utf8-browser@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-utf8-node@1.0.0-gamma.6 deduped\r\n│ │ │ ├─┬ @aws-sdk/xml-builder@1.0.0-gamma.6\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├── fast-xml-parser@3.17.4\r\n│ │ │ └── tslib@2.0.1\r\n│ │ ├─┬ @aws-sdk/s3-request-presigner@1.0.0-gamma.7\r\n│ │ │ ├── @aws-sdk/protocol-http@1.0.0-gamma.7 deduped\r\n│ │ │ ├─┬ @aws-sdk/signature-v4@1.0.0-gamma.7\r\n│ │ │ │ ├── @aws-sdk/is-array-buffer@1.0.0-gamma.6 deduped\r\n│ │ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ │ ├── @aws-sdk/util-hex-encoding@1.0.0-gamma.6 deduped\r\n│ │ │ │ ├── @aws-sdk/util-uri-escape@1.0.0-gamma.6 deduped\r\n│ │ │ │ └── tslib@1.13.0\r\n│ │ │ ├── @aws-sdk/smithy-client@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ ├── @aws-sdk/util-create-request@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/util-format-url@1.0.0-gamma.7 deduped\r\n│ │ │ └── tslib@1.13.0\r\n│ │ ├─┬ @aws-sdk/util-create-request@1.0.0-gamma.7\r\n│ │ │ ├── @aws-sdk/middleware-stack@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/smithy-client@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ └── tslib@1.13.0\r\n│ │ ├─┬ @aws-sdk/util-format-url@1.0.0-gamma.7\r\n│ │ │ ├── @aws-sdk/querystring-builder@1.0.0-gamma.7 deduped\r\n│ │ │ ├── @aws-sdk/types@1.0.0-gamma.6 deduped\r\n│ │ │ └── tslib@1.13.0\r\n│ │ ├─┬ axios@0.19.0\r\n│ │ │ ├── follow-redirects@1.5.10 deduped\r\n│ │ │ └── is-buffer@2.0.4\r\n│ │ ├── events@3.2.0\r\n│ │ └─┬ sinon@7.5.0\r\n│ │   ├─┬ @sinonjs/commons@1.8.1\r\n│ │   │ └── type-detect@4.0.8\r\n│ │   ├─┬ @sinonjs/formatio@3.2.2\r\n│ │   │ ├── @sinonjs/commons@1.8.1 deduped\r\n│ │   │ └── @sinonjs/samsam@3.3.3 deduped\r\n│ │   ├─┬ @sinonjs/samsam@3.3.3\r\n│ │   │ ├── @sinonjs/commons@1.8.1 deduped\r\n│ │   │ ├── array-from@2.1.1\r\n│ │   │ └── lodash@4.17.20 deduped\r\n│ │   ├── diff@3.5.0\r\n│ │   ├── lolex@4.2.0\r\n│ │   ├─┬ nise@1.5.3\r\n│ │   │ ├── @sinonjs/formatio@3.2.2 deduped\r\n│ │   │ ├── @sinonjs/text-encoding@0.7.1\r\n│ │   │ ├── just-extend@4.1.1\r\n│ │   │ ├─┬ lolex@5.1.2\r\n│ │   │ │ └── @sinonjs/commons@1.8.1 deduped\r\n│ │   │ └─┬ path-to-regexp@1.8.0\r\n│ │   │   └── isarray@0.0.1\r\n│ │   └── supports-color@5.5.0 deduped\r\n│ ├── @aws-amplify/ui@2.0.2\r\n│ ├─┬ @aws-amplify/xr@2.2.6\r\n│ │ └── @aws-amplify/core@3.6.0 deduped\r\n│ └── UNMET PEER DEPENDENCY @react-native-community/netinfo@^5.5.0\r\n├─┬ buffer@5.6.0\r\n│ ├── base64-js@1.3.1\r\n│ └── ieee754@1.1.13\r\n├─┬ codelyzer@6.0.1\r\n│ ├── @angular/compiler@9.0.0\r\n│ ├── @angular/core@9.0.0\r\n│ ├── app-root-path@3.0.0\r\n│ ├─┬ aria-query@3.0.0\r\n│ │ ├── ast-types-flow@0.0.7\r\n│ │ └── commander@2.20.3 deduped\r\n│ ├─┬ axobject-query@2.0.2\r\n│ │ └── ast-types-flow@0.0.7 deduped\r\n│ ├─┬ css-selector-tokenizer@0.7.3\r\n│ │ ├── cssesc@3.0.0 deduped\r\n│ │ └── fastparse@1.1.2\r\n│ ├─┬ cssauron@1.4.0\r\n│ │ └── through@2.3.8 deduped\r\n│ ├── damerau-levenshtein@1.0.6\r\n│ ├── rxjs@6.5.5 deduped\r\n│ ├─┬ semver-dsl@1.0.1\r\n│ │ └── semver@5.7.1\r\n│ ├── source-map@0.5.7\r\n│ ├── sprintf-js@1.1.2\r\n│ ├── tslib@1.13.0\r\n│ └── zone.js@0.10.3 deduped\r\n├── halfmoon@1.1.0\r\n├── jasmine-core@3.5.0\r\n├─┬ jasmine-spec-reporter@5.0.2\r\n│ └── colors@1.4.0\r\n├─┬ karma@5.0.9\r\n│ ├─┬ body-parser@1.19.0\r\n│ │ ├── bytes@3.1.0\r\n│ │ ├── content-type@1.0.4\r\n│ │ ├─┬ debug@2.6.9\r\n│ │ │ └── ms@2.0.0 deduped\r\n│ │ ├── depd@1.1.2\r\n│ │ ├─┬ http-errors@1.7.2\r\n│ │ │ ├── depd@1.1.2 deduped\r\n│ │ │ ├── inherits@2.0.3\r\n│ │ │ ├── setprototypeof@1.1.1 deduped\r\n│ │ │ ├── statuses@1.5.0 deduped\r\n│ │ │ └── toidentifier@1.0.0\r\n│ │ ├─┬ iconv-lite@0.4.24\r\n│ │ │ └── safer-buffer@2.1.2 deduped\r\n│ │ ├─┬ on-finished@2.3.0\r\n│ │ │ └── ee-first@1.1.1\r\n│ │ ├── qs@6.7.0\r\n│ │ ├─┬ raw-body@2.4.0\r\n│ │ │ ├── bytes@3.1.0\r\n│ │ │ ├── http-errors@1.7.2 deduped\r\n│ │ │ ├─┬ iconv-lite@0.4.24\r\n│ │ │ │ └── safer-buffer@2.1.2 deduped\r\n│ │ │ └── unpipe@1.0.0\r\n│ │ └─┬ type-is@1.6.18\r\n│ │   ├── media-typer@0.3.0\r\n│ │   └── mime-types@2.1.27 deduped\r\n│ ├─┬ braces@3.0.2\r\n│ │ └─┬ fill-range@7.0.1\r\n│ │   └─┬ to-regex-range@5.0.1\r\n│ │     └── is-number@7.0.0\r\n│ ├── chokidar@3.4.2 deduped\r\n│ ├── colors@1.4.0 deduped\r\n│ ├─┬ connect@3.7.0\r\n│ │ ├─┬ debug@2.6.9\r\n│ │ │ └── ms@2.0.0 deduped\r\n│ │ ├─┬ finalhandler@1.1.2\r\n│ │ │ ├─┬ debug@2.6.9\r\n│ │ │ │ └── ms@2.0.0 deduped\r\n│ │ │ ├── encodeurl@1.0.2 deduped\r\n│ │ │ ├── escape-html@1.0.3 deduped\r\n│ │ │ ├── on-finished@2.3.0 deduped\r\n│ │ │ ├── parseurl@1.3.3 deduped\r\n│ │ │ ├── statuses@1.5.0 deduped\r\n│ │ │ └── unpipe@1.0.0 deduped\r\n│ │ ├── parseurl@1.3.3\r\n│ │ └── utils-merge@1.0.1\r\n│ ├── di@0.0.1\r\n│ ├─┬ dom-serialize@2.2.1\r\n│ │ ├── custom-event@1.0.1\r\n│ │ ├── ent@2.2.0\r\n│ │ ├── extend@3.0.2\r\n│ │ └── void-elements@2.0.1\r\n│ ├── flatted@2.0.2\r\n│ ├── glob@7.1.6 deduped\r\n│ ├── graceful-fs@4.2.4\r\n│ ├─┬ http-proxy@1.18.1\r\n│ │ ├── eventemitter3@4.0.7\r\n│ │ ├─┬ follow-redirects@1.5.10\r\n│ │ │ └── debug@3.1.0 deduped\r\n│ │ └── requires-port@1.0.0\r\n│ ├── isbinaryfile@4.0.6\r\n│ ├── lodash@4.17.20\r\n│ ├─┬ log4js@6.3.0\r\n│ │ ├── date-format@3.0.0\r\n│ │ ├─┬ debug@4.2.0\r\n│ │ │ └── ms@2.1.2\r\n│ │ ├── flatted@2.0.2 deduped\r\n│ │ ├── rfdc@1.1.4\r\n│ │ └─┬ streamroller@2.2.4\r\n│ │   ├── date-format@2.1.0\r\n│ │   ├─┬ debug@4.2.0\r\n│ │   │ └── ms@2.1.2\r\n│ │   └─┬ fs-extra@8.1.0\r\n│ │     ├── graceful-fs@4.2.4 deduped\r\n│ │     ├── jsonfile@4.0.0 deduped\r\n│ │     └── universalify@0.1.2 deduped\r\n│ ├── mime@2.4.6\r\n│ ├── minimatch@3.0.4 deduped\r\n│ ├── qjobs@1.2.0\r\n│ ├── range-parser@1.2.1\r\n│ ├── rimraf@3.0.2 deduped\r\n│ ├─┬ socket.io@2.3.0\r\n│ │ ├─┬ debug@4.1.1\r\n│ │ │ └── ms@2.1.2\r\n│ │ ├─┬ engine.io@3.4.2\r\n│ │ │ ├── accepts@1.3.7 deduped\r\n│ │ │ ├── base64id@2.0.0\r\n│ │ │ ├── cookie@0.3.1\r\n│ │ │ ├─┬ debug@4.1.1\r\n│ │ │ │ └── ms@2.1.2\r\n│ │ │ ├─┬ engine.io-parser@2.2.1\r\n│ │ │ │ ├── after@0.8.2\r\n│ │ │ │ ├── arraybuffer.slice@0.0.7\r\n│ │ │ │ ├── base64-arraybuffer@0.1.4\r\n│ │ │ │ ├── blob@0.0.5\r\n│ │ │ │ └── has-binary2@1.0.3 deduped\r\n│ │ │ └── ws@7.3.1\r\n│ │ ├─┬ has-binary2@1.0.3\r\n│ │ │ └── isarray@2.0.1\r\n│ │ ├── socket.io-adapter@1.1.2\r\n│ │ ├─┬ socket.io-client@2.3.0\r\n│ │ │ ├── backo2@1.0.2\r\n│ │ │ ├── base64-arraybuffer@0.1.5\r\n│ │ │ ├── component-bind@1.0.0\r\n│ │ │ ├── component-emitter@1.2.1\r\n│ │ │ ├─┬ debug@4.1.1\r\n│ │ │ │ └── ms@2.1.2\r\n│ │ │ ├─┬ engine.io-client@3.4.4\r\n│ │ │ │ ├── component-emitter@1.3.0\r\n│ │ │ │ ├── component-inherit@0.0.3\r\n│ │ │ │ ├── debug@3.1.0 deduped\r\n│ │ │ │ ├── engine.io-parser@2.2.1 deduped\r\n│ │ │ │ ├── has-cors@1.1.0 deduped\r\n│ │ │ │ ├── indexof@0.0.1 deduped\r\n│ │ │ │ ├── parseqs@0.0.6\r\n│ │ │ │ ├── parseuri@0.0.6\r\n│ │ │ │ ├─┬ ws@6.1.4\r\n│ │ │ │ │ └── async-limiter@1.0.1 deduped\r\n│ │ │ │ ├── xmlhttprequest-ssl@1.5.5\r\n│ │ │ │ └── yeast@0.1.2\r\n│ │ │ ├── has-binary2@1.0.3 deduped\r\n│ │ │ ├── has-cors@1.1.0\r\n│ │ │ ├── indexof@0.0.1\r\n│ │ │ ├── object-component@0.0.3\r\n│ │ │ ├─┬ parseqs@0.0.5\r\n│ │ │ │ └─┬ better-assert@1.0.2\r\n│ │ │ │   └── callsite@1.0.0\r\n│ │ │ ├─┬ parseuri@0.0.5\r\n│ │ │ │ └── better-assert@1.0.2 deduped\r\n│ │ │ ├─┬ socket.io-parser@3.3.1\r\n│ │ │ │ ├── component-emitter@1.3.0\r\n│ │ │ │ ├─┬ debug@3.1.0\r\n│ │ │ │ │ └── ms@2.0.0\r\n│ │ │ │ └── isarray@2.0.1\r\n│ │ │ └── to-array@0.1.4\r\n│ │ └─┬ socket.io-parser@3.4.1\r\n│ │   ├── component-emitter@1.2.1\r\n│ │   ├─┬ debug@4.1.1\r\n│ │   │ └── ms@2.1.2\r\n│ │   └── isarray@2.0.1\r\n│ ├── source-map@0.6.1\r\n│ ├─┬ tmp@0.2.1\r\n│ │ └── rimraf@3.0.2 deduped\r\n│ ├── ua-parser-js@0.7.21\r\n│ └─┬ yargs@15.4.1\r\n│   ├─┬ cliui@6.0.0\r\n│   │ ├── string-width@4.2.0 deduped\r\n│   │ ├─┬ strip-ansi@6.0.0\r\n│   │ │ └── ansi-regex@5.0.0\r\n│   │ └─┬ wrap-ansi@6.2.0\r\n│   │   ├─┬ ansi-styles@4.3.0\r\n│   │   │ └─┬ color-convert@2.0.1\r\n│   │   │   └── color-name@1.1.4\r\n│   │   ├── string-width@4.2.0 deduped\r\n│   │   └── strip-ansi@6.0.0 deduped\r\n│   ├── decamelize@1.2.0 deduped\r\n│   ├─┬ find-up@4.1.0\r\n│   │ ├─┬ locate-path@5.0.0\r\n│   │ │ └─┬ p-locate@4.1.0\r\n│   │ │   └── p-limit@2.3.0 deduped\r\n│   │ └── path-exists@4.0.0\r\n│   ├── get-caller-file@2.0.5 deduped\r\n│   ├── require-directory@2.1.1 deduped\r\n│   ├── require-main-filename@2.0.0 deduped\r\n│   ├── set-blocking@2.0.0 deduped\r\n│   ├─┬ string-width@4.2.0\r\n│   │ ├── emoji-regex@8.0.0\r\n│   │ ├── is-fullwidth-code-point@3.0.0\r\n│   │ └── strip-ansi@6.0.0 deduped\r\n│   ├── which-module@2.0.0 deduped\r\n│   ├── y18n@4.0.0 deduped\r\n│   └─┬ yargs-parser@18.1.3\r\n│     ├── camelcase@5.3.1 deduped\r\n│     └── decamelize@1.2.0 deduped\r\n├─┬ karma-chrome-launcher@3.1.0\r\n│ └─┬ which@1.3.1\r\n│   └── isexe@2.0.0\r\n├─┬ karma-coverage-istanbul-reporter@3.0.3\r\n│ ├── istanbul-lib-coverage@3.0.0\r\n│ ├─┬ istanbul-lib-report@3.0.0\r\n│ │ ├── istanbul-lib-coverage@3.0.0 deduped\r\n│ │ ├─┬ make-dir@3.1.0\r\n│ │ │ └── semver@6.3.0\r\n│ │ └─┬ supports-color@7.2.0\r\n│ │   └── has-flag@4.0.0\r\n│ ├─┬ istanbul-lib-source-maps@3.0.6\r\n│ │ ├─┬ debug@4.2.0\r\n│ │ │ └── ms@2.1.2\r\n│ │ ├── istanbul-lib-coverage@2.0.5\r\n│ │ ├─┬ make-dir@2.1.0\r\n│ │ │ ├── pify@4.0.1 deduped\r\n│ │ │ └── semver@5.7.1\r\n│ │ ├─┬ rimraf@2.7.1\r\n│ │ │ └── glob@7.1.6 deduped\r\n│ │ └── source-map@0.6.1\r\n│ ├─┬ istanbul-reports@3.0.2\r\n│ │ ├── html-escaper@2.0.2\r\n│ │ └── istanbul-lib-report@3.0.0 deduped\r\n│ └── minimatch@3.0.4 deduped\r\n├─┬ karma-jasmine@3.3.1\r\n│ └── jasmine-core@3.5.0 deduped\r\n├── karma-jasmine-html-reporter@1.5.4\r\n├─┬ protractor@7.0.0\r\n│ ├── @types/q@0.0.32\r\n│ ├── @types/selenium-webdriver@3.0.17\r\n│ ├─┬ blocking-proxy@1.0.1\r\n│ │ └── minimist@1.2.5 deduped\r\n│ ├─┬ browserstack@1.6.0\r\n│ │ └─┬ https-proxy-agent@2.2.4\r\n│ │   ├─┬ agent-base@4.3.0\r\n│ │   │ └─┬ es6-promisify@5.0.0\r\n│ │   │   └── es6-promise@4.2.8\r\n│ │   └── debug@3.1.0 deduped\r\n│ ├─┬ chalk@1.1.3\r\n│ │ ├── ansi-styles@2.2.1\r\n│ │ ├── escape-string-regexp@1.0.5\r\n│ │ ├─┬ has-ansi@2.0.0\r\n│ │ │ └── ansi-regex@2.1.1\r\n│ │ ├─┬ strip-ansi@3.0.1\r\n│ │ │ └── ansi-regex@2.1.1\r\n│ │ └── supports-color@2.0.0\r\n│ ├── glob@7.1.6 deduped\r\n│ ├─┬ jasmine@2.8.0\r\n│ │ ├── exit@0.1.2\r\n│ │ ├── glob@7.1.6 deduped\r\n│ │ └── jasmine-core@2.8.0\r\n│ ├── jasminewd2@2.2.0\r\n│ ├── q@1.4.1\r\n│ ├─┬ saucelabs@1.5.0\r\n│ │ └── https-proxy-agent@2.2.4 deduped\r\n│ ├─┬ selenium-webdriver@3.6.0\r\n│ │ ├─┬ jszip@3.5.0\r\n│ │ │ ├─┬ lie@3.3.0\r\n│ │ │ │ └── immediate@3.0.6\r\n│ │ │ ├── pako@1.0.11\r\n│ │ │ ├── readable-stream@2.3.7 deduped\r\n│ │ │ └── set-immediate-shim@1.0.1\r\n│ │ ├─┬ rimraf@2.7.1\r\n│ │ │ └── glob@7.1.6 deduped\r\n│ │ ├─┬ tmp@0.0.30\r\n│ │ │ └── os-tmpdir@1.0.2 deduped\r\n│ │ └── xml2js@0.4.23 deduped\r\n│ ├─┬ source-map-support@0.4.18\r\n│ │ └── source-map@0.5.7\r\n│ ├─┬ webdriver-js-extender@2.1.0\r\n│ │ ├── @types/selenium-webdriver@3.0.17 deduped\r\n│ │ └── selenium-webdriver@3.6.0 deduped\r\n│ ├─┬ webdriver-manager@12.1.7\r\n│ │ ├── adm-zip@0.4.16\r\n│ │ ├── chalk@1.1.3 deduped\r\n│ │ ├─┬ del@2.2.2\r\n│ │ │ ├─┬ globby@5.0.0\r\n│ │ │ │ ├─┬ array-union@1.0.2\r\n│ │ │ │ │ └── array-uniq@1.0.3 deduped\r\n│ │ │ │ ├── arrify@1.0.1\r\n│ │ │ │ ├── glob@7.1.6 deduped\r\n│ │ │ │ ├── object-assign@4.1.1 deduped\r\n│ │ │ │ ├── pify@2.3.0 deduped\r\n│ │ │ │ └── pinkie-promise@2.0.1 deduped\r\n│ │ │ ├── is-path-cwd@1.0.0\r\n│ │ │ ├─┬ is-path-in-cwd@1.0.1\r\n│ │ │ │ └─┬ is-path-inside@1.0.1\r\n│ │ │ │   └── path-is-inside@1.0.2 deduped\r\n│ │ │ ├── object-assign@4.1.1 deduped\r\n│ │ │ ├── pify@2.3.0\r\n│ │ │ ├─┬ pinkie-promise@2.0.1\r\n│ │ │ │ └── pinkie@2.0.4\r\n│ │ │ └── rimraf@2.7.1 deduped\r\n│ │ ├── glob@7.1.6 deduped\r\n│ │ ├── ini@1.3.5 deduped\r\n│ │ ├── minimist@1.2.5 deduped\r\n│ │ ├── q@1.4.1 deduped\r\n│ │ ├── request@2.88.2 deduped\r\n│ │ ├─┬ rimraf@2.7.1\r\n│ │ │ └── glob@7.1.6 deduped\r\n│ │ ├── semver@5.7.1\r\n│ │ └─┬ xml2js@0.4.23\r\n│ │   ├── sax@1.2.4 deduped\r\n│ │   └── xmlbuilder@11.0.1\r\n│ └─┬ yargs@15.4.1\r\n│   ├─┬ cliui@6.0.0\r\n│   │ ├── string-width@4.2.0 deduped\r\n│   │ ├─┬ strip-ansi@6.0.0\r\n│   │ │ └── ansi-regex@5.0.0\r\n│   │ └─┬ wrap-ansi@6.2.0\r\n│   │   ├─┬ ansi-styles@4.3.0\r\n│   │   │ └─┬ color-convert@2.0.1\r\n│   │   │   └── color-name@1.1.4\r\n│   │   ├── string-width@4.2.0 deduped\r\n│   │   └─┬ strip-ansi@6.0.0\r\n│   │     └── ansi-regex@5.0.0\r\n│   ├── decamelize@1.2.0 deduped\r\n│   ├─┬ find-up@4.1.0\r\n│   │ ├─┬ locate-path@5.0.0\r\n│   │ │ └─┬ p-locate@4.1.0\r\n│   │ │   └── p-limit@2.3.0 deduped\r\n│   │ └── path-exists@4.0.0\r\n│   ├── get-caller-file@2.0.5 deduped\r\n│   ├── require-directory@2.1.1 deduped\r\n│   ├── require-main-filename@2.0.0 deduped\r\n│   ├── set-blocking@2.0.0 deduped\r\n│   ├─┬ string-width@4.2.0\r\n│   │ ├── emoji-regex@8.0.0\r\n│   │ ├── is-fullwidth-code-point@3.0.0\r\n│   │ └─┬ strip-ansi@6.0.0\r\n│   │   └── ansi-regex@5.0.0\r\n│   ├── which-module@2.0.0 deduped\r\n│   ├── y18n@4.0.0 deduped\r\n│   └─┬ yargs-parser@18.1.3\r\n│     ├── camelcase@5.3.1 deduped\r\n│     └── decamelize@1.2.0 deduped\r\n├─┬ rxjs@6.5.5\r\n│ └── tslib@1.13.0\r\n├─┬ ts-node@8.3.0\r\n│ ├── arg@4.1.3\r\n│ ├── diff@4.0.2\r\n│ ├── make-error@1.3.6\r\n│ ├── source-map-support@0.5.19 deduped\r\n│ └── yn@3.1.1\r\n├── tslib@2.0.1\r\n├─┬ tslint@6.1.3\r\n│ ├─┬ @babel/code-frame@7.10.4\r\n│ │ └─┬ @babel/highlight@7.10.4\r\n│ │   ├── @babel/helper-validator-identifier@7.10.4 deduped\r\n│ │   ├── chalk@2.4.2 deduped\r\n│ │   └── js-tokens@4.0.0\r\n│ ├── builtin-modules@1.1.1\r\n│ ├─┬ chalk@2.4.2\r\n│ │ ├─┬ ansi-styles@3.2.1\r\n│ │ │ └─┬ color-convert@1.9.3\r\n│ │ │   └── color-name@1.1.3\r\n│ │ ├── escape-string-regexp@1.0.5 deduped\r\n│ │ └─┬ supports-color@5.5.0\r\n│ │   └── has-flag@3.0.0 deduped\r\n│ ├── commander@2.20.3\r\n│ ├── diff@4.0.2\r\n│ ├── glob@7.1.6 deduped\r\n│ ├─┬ js-yaml@3.14.0\r\n│ │ ├─┬ argparse@1.0.10\r\n│ │ │ └── sprintf-js@1.0.3\r\n│ │ └── esprima@4.0.1\r\n│ ├── minimatch@3.0.4 deduped\r\n│ ├─┬ mkdirp@0.5.5\r\n│ │ └── minimist@1.2.5 deduped\r\n│ ├─┬ resolve@1.17.0\r\n│ │ └── path-parse@1.0.6\r\n│ ├── semver@5.7.1\r\n│ ├── tslib@1.13.0\r\n│ └─┬ tsutils@2.29.0\r\n│   └── tslib@1.13.0\r\n├── typescript@3.9.7\r\n├── uuid@8.3.1\r\n└── zone.js@0.10.3\r\n\r\n\r\n</details>\r\n\r\n\r\n"}},{"node":{"author":{"login":"ashika01"},"body":"Thanks. I tested in ang 8,9 its working. I am gonna work on testing in angular 10 today."}},{"node":{"author":{"login":"ashika01"},"body":"Okay, tested with angular `~10.1.4` and I dont have any problem with put. I think your policy setup might be causing this.\r\n\r\n![Screen Shot 2020-10-08 at 4 57 13 PM](https://user-images.githubusercontent.com/35131273/95524859-61bddd80-0987-11eb-914c-cc5ae79a084a.png)\r\n\r\n\r\nMy IAM policy config looks like,\r\n\r\n![Screen Shot 2020-10-08 at 5 00 58 PM](https://user-images.githubusercontent.com/35131273/95525160-443d4380-0988-11eb-8bc8-b09983edfb24.png)\r\n![Screen Shot 2020-10-08 at 5 00 12 PM](https://user-images.githubusercontent.com/35131273/95525162-47d0ca80-0988-11eb-9c27-8fad2a040252.png)\r\n\r\nFull read policy\r\n![Screen Shot 2020-10-08 at 5 02 26 PM](https://user-images.githubusercontent.com/35131273/95525218-659e2f80-0988-11eb-8671-c5da49bd0fbe.png)\r\n\r\n\r\nI use `Amplify add storage` to create this, I would suggest you cross check your permissions to this or roll out permissions using s3 bucket created thru Amplify CLI.\r\n\r\nMoving the issue to discussion since it is not a bug and continue further discussion with the community.\r\n"}},{"node":{"author":{"login":"edoardo849"},"body":"I think I understand what was causing the issue. But I think it's a bug. I had previously created, deleted and re-created a bucket using the Amplify CLI. The error came on the new bucket. Upon further inspection, the old bucket name was still present in `aws-exports.js`. In other words, when creating the new bucket, the CLI didn't modify `aws-exports.js`"}},{"node":{"author":{"login":"Nagasai97"},"body":"i am getting [ERROR] 19:34.60 axios-http-handler - Network Error, can anyone help me whether its configuration issue or anyother"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTM0MDc3","author":{"login":"advissor"},"title":"Is there way to programatically change between Authenticator UI states","body":"Hi, \r\n\r\nIs there way to programmatically change between Authenticator UI states? \r\n\r\nFor example, through TS code switch from Sign-in to Sign up, or from Signup to Confirm Sign up?\r\n\r\nI do see functions in API, but they require to pass the input info to submit to Auth API, not just for switching between page\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjg1NDk2","author":{"login":"oahmaro"},"title":"Is it possible to implement Google One tap sign up and sign in with AWS Amplify?","body":"I have seen this feature implemented on many sites like Linkedin.com, or Medium.com, and i would like to know if this is something possible to integrate with aws amplify?\r\n\r\nhere is a link for the documentation from google.\r\n[https://developers.google.com/identity/gsi/web](https://developers.google.com/identity/gsi/web)","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"jysung"},"body":"Did you find a solution? Is it possible?"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTMzOTE0","author":{"login":"advissor"},"title":"Angular amplify-authenticator  : How to restore the state of UI to the \"Email confirmation\" step","body":"HI, \r\nI am working on chrome extension and using amplify-authenticator with Angular \r\n\r\nThe issue I have right now is with the Email confirmation code\r\nAs, when you leave the focuses off the chrome extension popup, it is being closed\r\n\r\nSo, when you re-open again the pop-up, you have to again enter the email + password, to get back to email verification\r\n\r\nIs there a way to restore the UI to the state with email confirmation?\r\nLike that I can save that session in browser store & it it exist, load it back to UI to eliminate that extra repeatable step\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMTA4","author":{"login":"alexvdvalk"},"title":"Angular Amplify Service and new UI","body":"The new documentation suggests suggests that developers remove the amplify service when migrating to the new auth UI. Does this mean the amplifyservice is being deprecated, or can I continue to use it? Or what is the best practice? I've been using the $authStateChange observable in my app component which works really well, but I'm not sure if this is the best approach moving forward.\r\n\r\nAnyone got any code samples or suggestions?\r\n\r\nThe new authenticator UI also lacks some of the configuration options but I hope these will become available soon.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"lkowalski-smartbusiness"},"body":"I'm in the same boat as @alexvdvalk. Would love to test the newest modules but I'm stuck with the old logic that cannot be overridden yet.."}},{"node":{"author":{"login":"jordanranz"},"body":"Hey @alexvdvalk @lkowalski-smartbusiness\r\n\r\nI am working on a PR now to expose a callback prop on the `amplify-authenticator` component:\r\nhttps://github.com/aws-amplify/amplify-js/pull/5930\r\n\r\n`onAuthUIStateChange` should work as well but the preferred method will be the callback prop mentioned above.\r\n\r\nLooking to pull this out of draft soon. Also looking to add documentation around this asap."}},{"node":{"author":{"login":"alexvdvalk"},"body":"@lkowalski-smartbusiness thank you for sharing this. I'm on my second attempt at getting the new authenticator working. The changeDetenction is breaking when I add the \"onAuthUIStateChange\" into my app.component.ts. I've tried addedin it in the constructor and NgOnInit. \r\n\r\nDo you have any code snippets you can share with me around how you've implemented this?"}},{"node":{"author":{"login":"alkhwarizmix"},"body":"Hi, I am using Hub as described here https://github.com/aws-amplify/amplify-js/issues/5303\r\n\r\n```javascript\r\ninterface IAuthState {\r\n  state: string;\r\n  user: any;\r\n}\r\n\r\n  public ngOnInit() {\r\n    Hub.listen(\"auth\", data => {\r\n      this.authStateChange({\r\n        state: data.payload.event === \"signIn\" ? \"signedIn\" : data.payload.event,\r\n        user: data.payload.data\r\n      });\r\n    });\r\n  }\r\n\r\n  private authStateChange(authState: IAuthState) {\r\n    this.signedIn = authState.state === \"signedIn\";\r\n    if (this.signedIn) {\r\n      if (!authState.user) {\r\n        this.user = null;\r\n      } else {\r\n        this.user = authState.user;\r\n        this.greeting = \"Hello \" + this.user.username;\r\n        this.router.navigate([\"/tabs\"]);\r\n      }\r\n    }\r\n  }\r\n```"}},{"node":{"author":{"login":"lkowalski-smartbusiness"},"body":"@alexvdvalk I finally found the time to debug this some more, chatted a while with jordanranz too.\r\nHere's my take on the authorization for now (see the explanation in comment block):\r\nhttps://github.com/lkowalski-smartbusiness/amplify-tester/blob/8aa5314ecc40c8e1eecfe83a698883174694fe66/src/app/app.component.ts#L24\r\nBattle tested this one and so far it's working, tho I found other small glitches in the package\r\n\r\nI'm still leaning towards @alkhwarizmix solution as it seems less hacky (and aligns with what I used to do in the legacy component) but would need to test it through with my solution."}},{"node":{"author":{"login":"kewur"},"body":"So, it's unclear from the answers, is there an alternative now to the AmplifyService? "}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTMwNjU0","author":{"login":"hoan-pham-duy"},"title":"When call mutation update grapql, how to replace all array instead of append to array","body":"Hi everyone,\r\nCurrently, I met a problem related to call mutation graphql update.\r\nI **_want to replace all elements of the existed array_** with an input array but when I do the test, **_graphql seems to append the input array to existed array_**.\r\n\r\n**_Example:_**  \r\nThe input array is [3.3] and the existed array is [1.1,2.2]\r\n**_Query:_**\r\n<img width=\"528\" alt=\"image\" src=\"https://user-images.githubusercontent.com/14135094/130209000-21d04805-5fbd-4561-9666-36ec0d59ac64.png\">\r\n\r\n**_Result:_**\r\n<img width=\"497\" alt=\"image\" src=\"https://user-images.githubusercontent.com/14135094/130209178-20f14a4a-ed02-4814-9848-96bbb841d5a1.png\">\r\nI'm also considering is it a bug too? \r\nIs there any way that I can replace all the elements of the array with the input array?\r\nHope for your help!\r\nThanks and Best Regards,","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTI3NjM2","author":{"login":"phineas629"},"title":"DataStore integration for existing non-amplify project","body":"** Which Category is your question related to? **\r\nDataStore\r\n\r\n** What AWS Services are you utilizing? **\r\naws-amplify\r\napi gateway\r\ndynamodb\r\naws lambda (dynamodb is  provisioned with serverless framework and served through apoll-graphql-lambda)\r\n\r\n\r\n** Provide additional details e.g. code snippets **\r\nI am using aws-amplify libraries: auth and api. Works great!\r\nThe project is not created through amplify admin ui or amplify cli.\r\nWe're using config file to get the current setup working.\r\nBelow is my config file.\r\n\r\nI want to add the aws-amplify dataStore library and it's persistance feature for offline-first usage. \r\nIs it possible to get the syncing ability without me having to rebuild the project in amplify ui or amplify cli now? \r\nI see an old issue related to the problem I am encountering. \r\nhttps://github.com/aws-amplify/amplify-js/issues/4704\r\n\r\n\r\n`  import '@aws-amplify/ui-vue'\r\nimport Amplify, { Auth, API, graphqlOperation } from 'aws-amplify'\r\n\r\nexport default async ({ Vue }) => {\r\n  Amplify.configure({\r\n    Auth: {\r\n      ...process.env.AWS.Auth\r\n    },\r\n    API: {\r\n      ...process.env.AWS.API,\r\n      graphql_headers: async () => ({\r\n        Authorization: (await Auth.currentSession()).getIdToken().getJwtToken()\r\n      })\r\n    }\r\n  })\r\n  const $graphql = (query, variables) => API.graphql(graphqlOperation(query, variables))\r\n\r\n  Vue.$graphql = $graphql\r\n  Vue.prototype.$graphql = $graphql`\r\n\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNzI5OQ==","author":{"login":"bambbamnenim"},"title":"set cookie storage expires to 'session' not days","body":"````\r\nAuth.configure({\r\n  cookieStorage: {\r\n    domain: \"localhost\",\r\n    expires: 0 // <- i want to set this for 'session' \r\n    secure: false,\r\n  },\r\n});````\r\n\r\nbut the docs only talks about in days, so how do i do this?\r\n(doc i looked up : https://docs.amplify.aws/lib/auth/start/q/platform/js#re-use-existing-authentication-resource)","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"robixdf"},"body":"I believe \r\n```\r\nexpires: undefined\r\n```\r\nshould do the trick"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTIzOTE5","author":{"login":"Jun711"},"title":"Is there a note on Amplify limitation when used in a service worker?","body":"I am using Amplify in a web app and I notice that it uses local storage quite a bit. \r\nSince local storage is not accessible when in a service worker and possibly other limitations, I wonder which Amplify functions do not work when it is used in a service worker. \r\nIs there a note somewhere that I can check? Thanks","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTE2NzUw","author":{"login":"phineas629"},"title":"DataStore persistence for own rolled aws backend","body":"We are currently using amplify and want to add the datastore library.\r\nIs it possible to get DataStore persistence feature  if our  graphql and dynamodb is set up without using amplify cli?   We wrote our own schema for graphql, provisioned apollo graphql serverless in aws lambda, dynamodb is set up on out own also. We have got our infrastructure  configured and working with amplify. I know we can get DataStore but would really benefit from the persistence feature. How can we configure datastore to add persistence feature without amplify cli? \r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTEzMjQ1","author":{"login":"levelingup"},"title":"Auth.currentAuthenticatedUser returns The user is not authenticated in a dynamic route in next.js","body":"I'm getting `The user is not authenticated` when I run `await Auth.currentAuthenticatedUser();`\r\n\r\nIn my file **pages/activations/[id].js**\r\n\r\nI have this:\r\n\r\n```\r\nexport async function getStaticPaths({ req }) {\r\n  const { API, Auth } = withSSRContext({ req });\r\n  const user = await Auth.currentAuthenticatedUser();\r\n  console.log(\"static paths\");\r\n  const activationData = await API.graphql({\r\n    query: listActivations,\r\n  });\r\n  console.log(\"activationData\", user);\r\n  const paths = activationData.data.listActivations.items.map((activation) => ({\r\n    params: { id: activation.id },\r\n  }));\r\n  return {\r\n    paths,\r\n    fallback: true,\r\n  };\r\n}\r\n```\r\n\r\nI know that I'm already signed in because if I have similar code in other pages where I know I'm signed in, but I'm not sure if this is the issue because of dynamic routing?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTEzMDY3","author":{"login":"joejanho"},"title":"MFA - is it possible to change the issuer name in the authenticator instead of AWSCognito to show custom name","body":"After scanning the QR code, will it be possible to change 'AWSCognito' in the authenticator app to something else(custom)\r\nI am using react UI components ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xOTAwMg==","author":{"login":"filonik"},"title":"amplify-ui-components @aws-amplify/ui-vue How to sign in using custom submit button?","body":"I would like to disable the sign in button in some cases, so I thought I could use the `primary-footer-content` slot to override the default button. However, as soon as I do this, the sign in button stops working entirely. Can anybody help me out?\r\n\r\n```\r\n<template>\r\n  <div id=\"app\">\r\n    <amplify-authenticator>\r\n      <amplify-sign-in header-text=\"My Custom Sign In Header\" slot=\"sign-in\">\r\n        <div slot=\"primary-footer-content\">\r\n          <amplify-button type=\"submit\">Sign In</amplify-button>\r\n        </div>\r\n      </amplify-sign-in>\r\n      <HelloWorld msg=\"Welcome to Your Vue.js App\"/>\r\n      <amplify-sign-out></amplify-sign-out>\r\n    </amplify-authenticator>\r\n  </div>\r\n</template>\r\n```","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"filonik"},"body":"Anyone? Surely this can't be too difficult to accomplish..."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDc0NDE4","author":{"login":"ricardoribas"},"title":"Authentication with phone_number or email","body":"I am using a cognito application to authenticate users on the application i am helping to build. The old version was only allowing users to authenticate with the phone number. Happens that right now, we are going to allow users to authenticate through email. \r\n\r\nDo we need to have a special care on this topic. Old users have their username in a phone_number format (for instance +351XXXXXXXX) and have one of the attributes as email (for instance example@domain.com). If I try to login with the email for this kind of users, i get a **UserNotFoundException**. That might be returned as the property username is not the email. In order to solve this issue, i need to create a cognito trigger (pre-signin) that will try to get a user from cognito using email or phone_number?\r\n\r\nFor this particular topics, i might have two use cases:\r\n1 - A user signup with the phone_number and property email\r\n2 - A user signup with the email and property phone_number\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"evcodes"},"body":"Checkout this [link](https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-settings-attributes.html#:~:text=longer%20in%20use.-,Overview%20of%20Aliases,-You%20can%20allow) to set up custom aliases that will allow you to sign in with custom identifiers"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTEwOTg2","author":{"login":"azgorov"},"title":"@searchable data consistency","body":"This is more of a question if someone have a solution...\r\n\r\nFor example - create simple react app + amplify TODO example and make model searchable:\r\n\r\ntype Todo @model @searchable {\r\n  id: ID!\r\n  name: String!\r\n  description: String\r\n}\r\n\r\nThen just  add/delete and then search. For example: \r\n\r\n    const random = nanoid()\r\n    const newItem = await API.graphql(graphqlOperation(createTodo, {input: {id: random, description: random, name: random}}));\r\n    console.log(newItem);\r\n    const result1 = await API.graphql(graphqlOperation(searchTodos));\r\n    console.log(result1)\r\n    const deleteItem = await API.graphql(graphqlOperation(deleteTodo, {input: {id: random}}));\r\n    console.log(deleteItem);\r\n    const result2 = await API.graphql(graphqlOperation(searchTodos));\r\n    console.log(result2)\r\n\r\nResult2 data still contains deleted item.\r\nThis is normal as ddb stream waits 1 sec to send data to es and then es index refresh time is 1 second.\r\n\r\nHow you solve this possible 1-2 sec period between mutation and search?\r\n\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTA5MTc4","author":{"login":"martinmeinke"},"title":"Call \"amplify function\" via API interface?","body":"I am currently working on a vue.js + amplify project featuring.\r\n- Auth \r\n- API (graphql)\r\n- (free) Functions\r\n\r\n```\r\n| Category | Resource name    | Operation | Provider plugin   |\r\n| -------- | ---------------- | --------- | ----------------- |\r\n| Function | myapifunction    | No Change | awscloudformation |\r\n....\r\n```\r\n\r\nI have been trying to find some resources on calling the `Functions` via the \r\n`API` library like this:\r\n\r\n```\r\nimport { API } from \"aws-amplify\";\r\nAPI.get(\"myapifunction\", \"/\", {})\r\n```\r\n\r\nI have not been successful in getting it to work so far. (\"API myapifunction does not exist\")\r\nIs there some documentation available?\r\n\r\nI plan on using the Auth/GraphQL functionality from within the Lambda Functions.\r\n\r\nThank you very much for your support\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTA2MjM0","author":{"login":"cmaycumber"},"title":"Using the Location Search in the Geo service, can I filter by street addresses only?","body":"I'd like to filter by street addresses only and even more ideally, residential street addresses. Is this currently possible? It would be extremely helpful for our use case. ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTA2MTA2","author":{"login":"WarcraftYax"},"title":"Can the `next build` command be overriden?","body":"My repo has `package.json` at the root, but has a `cms` folder that contains the `pages` directory used for my Next.js app.\r\n\r\nI can build this fine by running `next build ./cms`.\r\n\r\nI have this specified in my `amplify.yml` like this:\r\n\r\n```yml\r\nversion: 1\r\nfrontend:\r\n  phases:\r\n    preBuild:\r\n      commands:\r\n        - npm install\r\n    build:\r\n      commands:\r\n        - npm run cms:build\r\n  artifacts:\r\n    baseDirectory: cms/.next\r\n    files:\r\n      - '**/*'\r\n  cache:\r\n    paths:\r\n      - node_modules/**/*\r\n```\r\n\r\nWhere `npm run cms:build` maps to `next build ./cms` in my `package.json`.\r\n\r\nHowever, when I try to build this app in Amplify, the `npm run cms:build` command succeeds fine, but then Amplify starts trying to do another SSR build (which fails because it expects `pages` to be at the root-level)? Am I right in assuming that Amplify magically injects a `next build` command into the build process? If so, can this command be customised so I can add the `./cms` parameter to it? I can't find any information about this in the docs, and it's not a setting that you can specify using `next.config.js`.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTA2MTAx","author":{"login":"marlonmarcello"},"title":"Is there a way to see server logs?","body":"Hi there!\r\nI am using NextJS with SSR on Amplify but I am getting a 500 Internal Server Error on all my routes.\r\nHow can I see what's going on? Where can I find the server logs?","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTA2MDQ5","author":{"login":"charlesloubao"},"title":"Why isn't the owner field explicitly passed when doing a graphql query?","body":"I have a graphql model like this\r\n\r\n```\r\ntype Thing @model @auth(rules: [{allow: owner}]) {\r\n  id: ID!\r\n  name: String!\r\n}\r\n```\r\n\r\nFrom what I understand, when doing a create/update/delete the owner field will be automatically added to the request for me. Why isn't it the case when subscribing or doing a get query? I have to pass the owner field myself every time.\r\n\r\n```\r\nAPI.graphql(graphqlOperation(subscriptions.onUpdateThing, {id, owner: user.attributes.sub }))\r\n    .subscribe((value => console.log(value)))\r\n```\r\n\r\nWithout it I get an **unauthorized error**\r\n```\r\nAPI.graphql(graphqlOperation(subscriptions.onUpdateThing, {id}))\r\n    .subscribe((value => console.log(value)))\r\n```\r\nError:\r\n```\r\nConnection failed: {\"errors\":[{\"errorType\":\"Unauthorized\",\"message\":\"Not Authorized to access onUpdatePet on type Subscription\"}]}\r\n```\r\n\r\n\r\nIs that normal or did I miss something in the docs?\r\nPS: I am new to GraphQL\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTA1ODk5","author":{"login":"jacksonHendric"},"title":"Amplify not including zip file inside React project","body":"Hi all,\r\n\r\nI use amplify for CI/CD, the react project has a amplify.yml file that is used to automatically build when pushed into releases/production.\r\nThis works great but if I use the leaflet library and have a .zip file that has map routing information, when the build is complete the routing information is missing. The zip file is essentially removed or not included in the build somehow.\r\n\r\nIf I manually build the project locally and upload the build directory into amplify that zip is all good and the routes can be seen on the map after deployment on amplify.\r\n\r\nIs there a way to allow the zip file to be included in my CI/CD?\r\n\r\n( zip file location in project --> src --> routes.zip )\r\n\r\nThanks","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTAzODYz","author":{"login":"matart15"},"title":"How admin to call `initiateAuth` or `adminInitiateAuth` from admin to another user","body":"I implemented passwordless sms login which is working fine with userside.\r\nhttps://aws.amazon.com/blogs/mobile/implementing-passwordless-email-authentication-with-amazon-cognito/\r\n\r\nBut when user changes phone number admin have top send SMS to his new phone number.\r\n\r\nFor that i have to call one of `initiateAuth` or `adminInitiateAuth`.\r\n\r\n1. if I call Auth.signIn on admin side my admin logs out and changes to user\r\n2. If i try to call adminInitiateAuth directly I cant find any instance of Cognito user from AdminQueries.getUser. \r\n\r\nhow do I call `CognitoUser.initiateAuth` ?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTAyNTc5","author":{"login":"wezside"},"title":"PinPoint Query Audience Data","body":"Is there no way currently to query data or more specifically event data which is recorded using Amplify's `Analytics.record` function? I have a use case where all I need to show is views for a specific page on a dashboard. ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTAxNTM1","author":{"login":"bmw46033"},"title":"Customer Provided SSE Key for Storage.Get not supported?","body":"A recent PR fixed the Storage.Put to properly set the SSE header values.  However, I am now encounter a similar problem with the Storage.Get.  Check the typescript code, there is no logic to handle adding SSE header values to the getObject request.  Is there a reason for this?  Just an omission?\r\n\r\nThe AWS-SDK specifications:\r\nhttps://docs.aws.amazon.com/AmazonS3/latest/API/API_GetObject.html#:~:text=If%20you%20encrypt,Provided%20Encryption%20Keys).\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTAwNjAz","author":{"login":"matart15"},"title":"How to setup AWS SNS on amplify","body":"followed this tutorial \r\n- https://techinscribed.com/passwordless-phone-number-authentication-using-aws-amplify-cognito/\r\n- https://github.com/mobilequickie/amplify-passwordless-sms-auth/blob/master/backend/lambda-triggers/create-auth-challenge/create-auth-challenge.js\r\n- https://gist.github.com/praveen001/57b0d8262e1a2ef0c539d0715a3649e1\r\n\r\namplify function calling AWS SNS gives \r\n - `Invalid parameter: TopicArn or TargetArn Reason: no value for required parameter` error\r\n\r\nmanually creating AWS SNS topic and adding `TopicArn` fixed it.\r\n```ts\r\nconst sns = new AWS.SNS({\r\n  apiVersion: '2010-03-31',\r\n  region: 'ap-northeast-1',\r\n  TopicArn: TOPIC_ARN,\r\n});\r\n```\r\n\r\nbut my question is why a lot of people wrote it without `TopicArn`. am I missing something?\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDkyNDAx","author":{"login":"StreetLamp05"},"title":"Customize signup form with signUpConfig parameter using withAuthenticator","body":"I followed the following instructions [here ](https://medium.com/@coryschimmoeller/customizing-the-authentication-experience-of-amplifys-withauthenticator-e6f2089ff469)but no effect. Any advice is welcome. \r\n\r\ncode: [https://prnt.sc/1hw3x57](https://prnt.sc/1hw3x57)\r\n\r\nexport default withAuthenticator(App, {\r\n  signUpConfig: {\r\n    hiddenDefaults: [\"phone_number\"],\r\n    signUpFields: [\r\n      {\r\n        label: \"First Name\",\r\n        key: \"given_name\",\r\n        required: true,\r\n        type: \"string\",\r\n      },\r\n      {\r\n        label: \"Last Name\",\r\n        key: \"family_name\",\r\n        required: true,\r\n        type: \"string\",\r\n      },\r\n    ],\r\n  },\r\n});\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDkyMTcz","author":{"login":"juliandm"},"title":"Creating Amplify project and assign repository through cloudformation","body":"Hello has anybody here found out how i can successfully assign a repository to an Amplify project with the following spec?\r\nhttps://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-amplify-app.html\r\n\r\nI tried both an S3 BucketName and a CodeCommit name and received the following error:\r\n```\r\nResource handler returned message: \"Invalid request provided: Repository provider not supported. (Service: Amplify, Status Code: 400, Request ID: a12af1b1-b7bd-4643-96af-3945de1a9fed, Extended Request ID: null)\" (RequestToken: dc1dc831-f742-cb7d-a59a-d5d9a93ebd2a, HandlerErrorCode: InvalidRequest)\r\n```\r\n\r\nUnfortunately it's not documented what this attribute requires exactly","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDkxOTgz","author":{"login":"marco910"},"title":"Check if user is authenticated on API route","body":"Hi there,\r\n\r\nI'm using Amplify with an existing Cognito backend on my Next.js app and try to check on an API route if a user is signed in or not.\r\n\r\nThat's the code for the route:\r\n```\r\nimport Amplify, { withSSRContext } from \"aws-amplify\";\r\nimport awsconfig from \"../../aws-exports.js\";\r\n\r\nAmplify.configure({ ...awsconfig, ssr: true });\r\n\r\nexport default async (req, res) => {\r\n  const { Auth } = withSSRContext({ req });\r\n\r\n  try {\r\n    const user = await Auth.currentAuthenticatedUser();\r\n    res.json({ user });\r\n  } catch (error) {\r\n    res.json({ error });\r\n  }\r\n};\r\n```\r\n\r\nI'm getting always an error that no user is signed in. Although, when a user is signed in. Where is the problem in my code/config?\r\n","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDkwMzQ5","author":{"login":"sourabpramanik"},"title":"Not getting the data upon querying in Appsync even though the data is persent in DynamoDB","body":"So I am building an e-commerce using Gatsby and AWS. So for the payment process and creating the sucessful order I am using Lambda functions using the pipeline re-solvers. Everything is working fine but when I query the listOrders in the Appsync I get the total of the order and the customer name but not the products even though I can see those products in my dynamoDB table. Actually the orders table and products table are having many-to-many relationship.  Below are the related code.\r\n\r\n**SCHEMA**\r\n\r\n```\r\ntype Orders @model \r\n  @auth(\r\n    rules: [\r\n      # only owner can see his orders\r\n      { allow: owner, identityClaim: \"email\", ownerField: \"customer\" }\r\n      # allow admins to view orders\r\n      # { allow: groups, groups: [\"Admin\"] }\r\n    ]\r\n  )\r\n  @key(name: \"byUser\", fields: [\"user\"]) \r\n{\r\n  id: ID!\r\n  user: String!\r\n  total: String\r\n  date: String\r\n  products: [OrdersProducts] @connection(keyName: \"byOrders\", fields: [\"id\"])\r\n}\r\n\r\ntype Products @model @auth(rules: [{allow: public}]) {\r\n  id: ID!\r\n  name: String!\r\n  image: String!\r\n  current_value: String!\r\n  original_value: String\r\n  category: [String]\r\n  orders: [OrdersProducts] @connection(keyName: \"byProducts\", fields: [\"id\"])\r\n}\r\n\r\ntype OrdersProducts \r\n  @model\r\n  @key(name: \"byProducts\", fields: [\"productsID\", \"ordersID\"]) \r\n  @key(name: \"byOrders\", fields: [\"ordersID\", \"productsID\"]) \r\n  @auth(\r\n    rules: [\r\n      # allow admins to create bookorders for customers by using customer email in lambda\r\n      { allow: owner, identityClaim: \"email\", ownerField: \"customer\" }\r\n      # { allow: groups, groups: [\"Admin\"] }\r\n    ]\r\n  ) \r\n  {\r\n    id: ID!\r\n    productsID: ID!\r\n    ordersID: ID!\r\n    products: Products! @connection(fields: [\"productsID\"])\r\n    orders: Orders! @connection(fields: [\"ordersID\"])\r\n    customer: String\r\n  }\r\n \r\nenum OrderStatus {\r\n  SUCCESS\r\n  FAILED\r\n}\r\n\r\ninput CartItem {\r\n  id: ID!\r\n  name: String\r\n  image: String\r\n  current_value: String\r\n  original_value: String\r\n  category: [String]\r\n  quantity:Int\r\n  updatedAt:String\r\n  _lastChangedAt:String\r\n  _deleted:String\r\n  createdAt:String\r\n  _version:String\r\n  \r\n}\r\n\r\ninput ProcessOrderInput {\r\n  id: ID!\r\n  cart: [CartItem]\r\n  total: Float!\r\n  name: String\r\n  token: String!\r\n  address: String\r\n}\r\ntype Mutation \r\n{\r\n  processOrder(input: ProcessOrderInput!): OrderStatus\r\n    @auth(rules: [{ allow: owner }])\r\n    @function(name: \"processPayment-${env}\")\r\n    @function(name: \"createOrder-${env}\")\r\n}\r\n```\r\n\r\n**QUERY FOR listOrders**\r\n\r\n```\r\nquery MyQuery {\r\n  listOrders {\r\n    items {\r\n      id\r\n      user\r\n      customer\r\n      products {\r\n        items {\r\n          id\r\n          ordersID\r\n          products {\r\n            id\r\n            image\r\n            name\r\n            current_value\r\n            category\r\n          }\r\n        }\r\n      }\r\n      total\r\n    }\r\n  }\r\n}\r\n```\r\n**QUERY RESULT**\r\n```\r\n{\r\n  \"data\": {\r\n    \"listOrders\": {\r\n      \"items\": [\r\n        {\r\n          \"id\": \"bb4927ee-c668-4e78-b5da-cd2321fedfe\",\r\n          \"user\": \"eb7d92bf-9d70-4c10-9aae-wre43244234\",\r\n          \"customer\": \"drekrode@gmail.com\",\r\n          \"products\": {\r\n            \"items\": []\r\n          },\r\n          \"total\": \"2799\"\r\n        },\r\n        {\r\n          \"id\": \"26d0b283-2912-450e-9adc-fffeww32423\",\r\n          \"user\": \"eb7d92bf-9d70-4c10-9aae-fewrer3242er32\",\r\n          \"customer\": \"drekrode@gmail.com\",\r\n          \"products\": {\r\n            \"items\": []\r\n          },\r\n          \"total\": \"3057\"\r\n        },\r\n        {\r\n          \"id\": \"83eaaaa6-df0c-4ec7-a038-fdwf41212\",\r\n          \"user\": \"eb7d92bf-9d70-4c10-9aae-cd32143dw\",\r\n          \"customer\": \"drekrode@gmail.com\",\r\n          \"products\": {\r\n            \"items\": []\r\n          },\r\n          \"total\": \"1900\"\r\n        }\r\n      ]\r\n    }\r\n  }\r\n}\r\n```\r\n**CREATE ORDER LAMBDA FUNCTION**\r\n\r\n```\r\nconst { v4: uuidv4 } = require(\"uuid\");\r\nconst AWS = require(\"aws-sdk\");\r\nconst documentClient = new AWS.DynamoDB.DocumentClient();\r\n\r\nconst ORDER_TABLE = \"Orders-xxxxxxxxxxxxxxxxxxxxx\";\r\nconst ORDER_TYPE = \"Orders\";\r\nconst PRODUCT_ORDER_TABLE = \"OrdersProducts-xxxxxxxxxxx\";\r\nconst PRODUCT_ORDER_TYPE = \"OrdersProducts\";\r\n\r\nconst createOrder = async (payload) => {\r\n  const { order_id, username, email, total } = payload;\r\n  var params = {\r\n    TableName: ORDER_TABLE,\r\n    Item: {\r\n      id: order_id,\r\n      __typename: ORDER_TYPE,\r\n      customer: email,\r\n      user: username,\r\n      total: total,\r\n      updatedAt: new Date().toISOString(),\r\n      createdAt: new Date().toISOString()\r\n    }\r\n  };\r\n  console.log(payload);\r\n  await documentClient.put(params).promise();\r\n};\r\n\r\nconst createProductOrder = async (payload) => {\r\n  let productOrders = [];\r\n  console.log(payload)\r\n  for (let i = 0; i < payload.cart.length; i++) {\r\n    const cartItem = payload.cart[i];\r\n    \r\n    productOrders.push({\r\n      PutRequest: {\r\n        Item: {\r\n          id: uuidv4(),\r\n          __typename: PRODUCT_ORDER_TYPE,\r\n          product_id: cartItem.id,\r\n          order_id: payload.order_id,\r\n          customer: payload.email,\r\n          createdAt: new Date().toISOString(),\r\n          updatedAt: new Date().toISOString()\r\n        }\r\n      }\r\n    });\r\n  }\r\n  let params = {\r\n    RequestItems: {}\r\n  };\r\n  params[\"RequestItems\"][PRODUCT_ORDER_TABLE] = productOrders;\r\n  \r\n  await documentClient.batchWrite(params).promise();\r\n};\r\n\r\n/*\r\n * Get order details from processPayment lambda\r\n * Create an order\r\n * Link products to the order - Users can see the past orders and admins can view orders by user\r\n * Email the invoice (Will be added later)\r\n */\r\nexports.handler = async (event) => {\r\n  try {\r\n    let payload = event.prev.result;\r\n    payload.order_id = uuidv4();\r\n\r\n    // create a new order\r\n    await createOrder(payload);\r\n\r\n    // links Products with the order\r\n    await createProductOrder(payload);\r\n\r\n    // Note - You may add another function to email the invoice to the user\r\n\r\n    return \"SUCCESS\";\r\n  } catch (err) {\r\n    console.log(err);\r\n    return new Error(err);\r\n  }\r\n};\r\n```","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"AndyW22"},"body":"the ownerField `customer` doesn't exist in your schema, when you are creating items they don't have an owner, so when you query them you're not going to get any results since the owner doesn't match. even though you added it into the dynamoDB table, the API doesn't know what the `customer` field is.  you can change the ownerField to `user` for example, and that should give results from the query for the owner.\r\n\r\nAlso, to test theres not another reason as to why they arent being returned, add `{allow: private, provider: iam}` and query using IAM from appsync console or a lambda function.\r\n\r\nnote: you have no operations rules, so anyone can delete products on your database and owners/admins can read, update, delete, and create orders"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDg4MzM5","author":{"login":"bob-lee"},"title":"My test cannot find a module in Lambda Layer","body":"After I moved my `helper.js` from lambda function to lambda layer `Dry`, my jest test for function is broken with error:\r\n\r\n>Cannot find module '/opt/helper' from 'backend.js'\r\n\r\nTried to add below path to `jest.config.js` didn't help:\r\n\r\n>modulePaths: [\r\n    \"<rootDir>/amplify/backend/function/Dry/lib/nodejs/node_modules/\",\r\n    \"<rootDir>/amplify/backend/function/Dry\"\r\n  ],\r\n\r\nAny idea?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"bob-lee"},"body":"Solved by `moduleNameMapper` in `jest.config.js` that looks like below now:\r\n```js\r\n  moduleNameMapper: {\r\n    '/opt/(.*)': '<rootDir>/amplify/backend/function/Dry/opt/$1'\r\n  },\r\n  modulePaths: [\r\n    \"<rootDir>/amplify/backend/function/Dry/lib/nodejs/node_modules/\"\r\n  ],\r\n\r\n```"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDg5NjIw","author":{"login":"vbbandeira"},"title":"Limited experience with Lambda Triggers and Destinations in AWS Amplify","body":"Hello everyone, I'm trying to set up a project within AWS Amplify to automate the creation of an Events framework based on Lambda functions, with the intention of deploying a backup of the event framework.\r\n\r\nIn the project, my goal is to add a trigger from the Alexa Skill Kit, to trigger a lambda function that targets the AmazonEvent Bridge.\r\n\r\nHowever, when I try to configure within AWS Amplify my settings for triggers are limited to the web application itself and in user-dependent situations like login authentication, email verification, and the like.\r\n\r\nDoes anyone know if it's possible to add extrinsic triggers to the application and if it's possible to add destinations for when a lambda function is executed because I couldn't identify this configuration option in any step within AWS Amplify? If so, which path should I follow to achieve this result?\r\n\r\nThis image below is how it was done in the original event-based project, I want to replicate something like this within Amplify.\r\n\r\n![printscreen](https://user-images.githubusercontent.com/25926739/127555073-2e171631-cb9f-4b10-bda0-b7f060ec81cf.png)\r\n\r\nThanks!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzMzNjAz","author":{"login":"countryst"},"title":"Remove \"Sign in with AWS\" but keep Facebook sign in button using @aws-amplify/ui-components","body":"I'm using \"@aws-amplify/ui-components\": \"^1.2.0\", quasar and Vue\r\nI'm following https://docs.amplify.aws/ui/auth/authenticator/q/framework/vue\r\n\r\nI want to remove \"\"Sign in with AWS\"\r\n![Screenshot](https://i.ibb.co/PQzTRTt/Screen-Shot-2021-04-22-at-3-06-30-PM.png)\r\n\r\nHere is my App.vue:\r\n\r\n```\r\n<template>\r\n  <div id=\"q-app\">\r\n    <div>\r\n      <div v-if=\"authState !== 'signedin'\">You are signed out.</div>\r\n      <amplify-authenticator :federated.prop=\"federatedIds\">\r\n        <div v-if=\"authState === 'signedin' && user\">\r\n          <div>Hello, {{user.username}}</div>\r\n        </div>\r\n        <amplify-sign-out></amplify-sign-out>\r\n      </amplify-authenticator>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script lang=\"ts\">\r\nimport { defineComponent } from '@vue/composition-api'\r\nimport { onAuthUIStateChange } from '@aws-amplify/ui-components'\r\n\r\nexport default defineComponent({\r\n  name: 'App',\r\n  created() {\r\n    this.unsubscribeAuth = onAuthUIStateChange((authState, authData) => {\r\n      this.authState = authState;\r\n      this.user = authData;\r\n    })\r\n  },\r\n  data() {\r\n    return {\r\n      user: undefined,\r\n      authState: undefined,\r\n      unsubscribeAuth: undefined,\r\n      federatedConfig: { provider: \"Facebook\" },\r\n      federatedIds: {\r\n        facebookAppId: \"****\"\r\n      },\r\n      formFields: [\r\n        {\r\n          type: \"email\",\r\n        },\r\n        {\r\n          type: \"password\",\r\n        },\r\n      ],\r\n    }\r\n  },\r\n  beforeUnmount() {\r\n    this.unsubscribeAuth();\r\n  }\r\n})\r\n</script>\r\n\r\n```\r\n\r\nI followed this https://github.com/aws-amplify/amplify-js/issues/6670#issuecomment-697768053 to remove federated buttons, but it removes the facebook button too., any suggestion for how to remove the \"Sign in with AWS\" but keep facebook button\r\n\r\n      <amplify-authenticator :federated.prop=\"federatedIds\">\r\n        <amplify-sign-in slot=\"sign-in\">\r\n          <div slot=\"federated-buttons\"></div>\r\n        </amplify-sign-in>\r\n        <div v-if=\"authState === 'signedin' && user\">\r\n          <div>Hello, {{user.username}}</div>\r\n        </div>\r\n        <amplify-sign-out></amplify-sign-out>\r\n      </amplify-authenticator>\r\n\r\n![Changed](https://i.ibb.co/9cYhcxg/Screen-Shot-2021-04-22-at-3-10-11-PM.png)","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"countryst"},"body":"Duplicate of https://github.com/aws-amplify/amplify-js/issues/7199\r\n\r\nI'm sure there is a better way of doing this, but here is what I'm using for now\r\n\r\n```\r\n  updated() {\r\n    setTimeout(() => {\r\n      document.querySelector(\"amplify-authenticator\")\r\n        .shadowRoot.querySelector(\"amplify-sign-in\")\r\n        .shadowRoot.querySelector(\"amplify-federated-buttons\")\r\n        .shadowRoot.querySelector(\"amplify-oauth-button\")\r\n        .style.display = \"none\";\r\n    }, 100);\r\n  },\r\n```"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzE0MQ==","author":{"login":"zsid"},"title":"Cannot get any scopes in Access Token","body":"**Describe the bug**\r\nWe are using `aws-amplify` to authorise with Cognito and need to get scopes i.e. `openid, profile, custom-scopes`. There are a lot of issues associated with this. For example, there is a very [similar one for custom scopes](https://github.com/aws-amplify/amplify-js/issues/5147) which has been closed. It seems like there has been [a release](https://github.com/aws-amplify/amplify-js/blob/master/packages/auth/CHANGELOG.md) as well but testing it out custom scopes or any other scope is not working at all\r\n\r\n\r\n**To Reproduce**\r\n\r\n* Set up the custom scopes in Cognito as well as `openid` one.\r\n* Add custom scope to amplify config\r\n* Make request\r\n* Expected behavior\r\n* The custom scope and openid one should be contained within the token\r\n \r\nVersion: ` \"aws-amplify\": \"^3.0.13\",`\r\nHere is my config\r\n```\r\n{\r\n    Auth: {\r\n      region: 'yourRegion',\r\n      userPoolId: 'userPoolId',\r\n      userPoolWebClientId: 'userPoolWebClientId',\r\n      oauth: {\r\n        domain: 'yourDomain',\r\n        scope: ['phone', 'email', 'profile', 'openid', 'aws.cognito.signin.user.admin', 'custom-scope-one', 'custom-scope-two'],\r\n        redirectSignIn: 'http://localhost:3000/',\r\n        redirectSignOut: 'http://localhost:3000/',\r\n        responseType: 'code',\r\n      },\r\n    },\r\n  }\r\n```\r\n\r\n\r\n**Expected behavior**\r\nThe custom scope and the other ones (i.e. `openid`, `profile`) should be within the token.\r\nThe custom scope should be contained within the token","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"elorzafe"},"body":"@zid\r\nAs I mentioned on the issue #5935 and #5921. Previous the change you mention the library was sending the query string param `scopes` instead of `scope` which is the correct param. The default behavior by Cognito when the scope param is missing is that it will return (as is mentioned on this [Authorization endpoint Cognito docs]()) all the scopes available.\r\n\r\nCan you check if the scope you have configured are present on AllowedOAuthScopes on your App client (clientId) settings. You can check those on Cognito console under App Integration>App client settings or using aws cli aws cognito-idp describe-user-pool-client --user-pool-id us-west-2_xxxxxxxxx --client-id xxxxxxxxxxxxxxxx\r\n\r\nWhat might happen in your case is that custom scopes on Cognito has a prefix with the resource server identifier. For example the resource server identifiers is `server-1` and I have a scope named `weather`. The custom scope should be `server-1/weather`.\r\n"}},{"node":{"author":{"login":"zid"},"body":"Looks like you meant to ping @zsid "}},{"node":{"author":{"login":"zsid"},"body":"@elorzafe This is still not working. The name for the custom scopes I am using is similar to what you have pointed out i.e. `https://examlpe.com/Hello` and it is selected in the app client settings.\r\n\r\nIn addition, I am also not getting `openid, profile, email` which are the rest as well. So coming back to your point, looks like they are not included at all and we are getting the default behaviour which is to return the admin.\r\n\r\nSome additional context that might be helpful is we are using the `Authenticator` from `aws-amplify-react` as a HOC for our login. We are not hitting the end points directly but the aws package is doing it for us.\r\n\r\n"}},{"node":{"author":{"login":"elorzafe"},"body":"> Looks like you meant to ping @zsid\r\n\r\nThanks @zid "}},{"node":{"author":{"login":"zsid"},"body":"@elorzafe, did you manage to replicate it? "}},{"node":{"author":{"login":"elorzafe"},"body":"@zsid `Authenticator` components doesn't use OAuth flow, OAuth flows are available using Cognito HostedUI and is the mechanism that Cognito returns custom scope on the access token."}},{"node":{"author":{"login":"zsid"},"body":"@elorzafe getting scopes (custom and standard ones) on the token via the `Authenticator` is a big requirement for us. \r\n\r\nWhat are the plans to get them outside the `HostedUI`? Speaking to fellow colleagues, only getting the scopes via `HostedUI` have pushed people to use other providers rather than `Cognito` and is seeing as big blocker. I am also getting in big arguments with other suppliers to move to other authentication solutions since we cannot get the scopes via  `Authenticator` which we are using in our applications"}},{"node":{"author":{"login":"kamce1999"},"body":"@elorzafe Do you have a response to @zsid?  I need the open id scope but don't want to use the hosted UI.  I'm trying to keep everything contained in AWS so I would prefer to use cognito.  We might have to look at other providers as well.  Is the fix on the road map?"}},{"node":{"author":{"login":"vmary2014"},"body":"Has there been any progress on this issue? We're having the same problem."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMTU0Mzky","author":{"login":"TPI79"},"title":"Guest access with temporary password or token","body":"Hello everyone, \r\nI have a general question about authentication and Guest access with temporary password or token. \r\n\r\nI am currently planning a app with multiple user roles. There should be registered users but also guests. \r\nRegistered users shouldn't be a problem with amplify, but what about guests?\r\n\r\nThere should be areas on the website that guests can enter, but with a temporary password or token (which a registered user has given to the guest)\r\nHowever, the guests should not have to register, but should simply be able to access the released area with the help of the password or token.\r\n\r\nIs such a scenario basically possible with the help of amplify and cognito?\r\nIf so, how would be the approach? Is there any helpful documentation how can this be done?\r\n\r\nThanks in advance\r\n","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"hyprstack"},"body":"Would like to know the same!"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDgxNjI0","author":{"login":"marcolino"},"title":"Wrong name in providers's federated signin screen","body":"Why the (Google in this case) provider's federated signin screen shows \"CHOOSE AN ACCOUNT to continue to **amazoncognito.com** ?\r\n\r\nI'd expect \"CHOOSE AN ACCOUNT to continue to **mydomain.com**\" ...\r\n\r\nA [screenshot](https://pasteboard.co/Kd8os9S.png) is worth a thousand words...","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDc3MzE5","author":{"login":"irfanelahidev"},"title":"Why does Amplify.Auth.signout() opens up the webbrowser on android when user logs out ?","body":"I've been using the globalSignout(true) option for my android app until now and it all seemed to work really well. However now that I needed to change this option and set the globalSignOut(false)  whenever I tend to logout from the app it opens the webbrowser with the webdomain url that is provided in the amplifyconfiguration.json files. \r\nHow can I avoid this behavior and logout the user safely without having to redirect to the webbrowser ?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDcwNzc5","author":{"login":"fabel84"},"title":"Customize MqttOverWSProvider into PubSub package","body":"I have to customize the behaviour of MqttOverWSProvider into PubSub package? Is possible to customize MqttOverWSProvider and is there a way to inject it in Amlify PubSub plugin?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"fabel84"},"body":"I've found by myself the response to these question, but maybe someone could be interested.\r\nThese are the steps:\r\n\r\n- Create a custom class that extend AWSIoTProvider, and in this class customize the methods that you want( in my case only publish method);\r\n\r\n\r\n```\r\nimport { AWSIoTProvider } from '@aws-amplify/pubsub';\r\n\r\nexport class MqttOverWSProviderCustom extends AWSIoTProvider {\r\n\r\n\tasync publish(topics: string[] | string, msg: any) {\r\n\t\tconst targetTopics = ([] as string[]).concat(topics);\r\n\t\tconst message = msg===''?'':JSON.stringify(msg);\r\n\t\tconst url = await this.endpoint;\r\n\t\tconst client = await this.connect(this.clientId, { url });\r\n\t\ttargetTopics.forEach(topic => client.send(topic, message));\r\n\t}\r\n}\r\n\r\n```\r\n- Replace the custom provider in main.ts;\r\n\r\n```\r\nAmplify.addPluggable(new MqttOverWSProviderCustom({\r\n    aws_pubsub_region: environment.aws.region,\r\n    aws_pubsub_endpoint: 'wss://'+environment.aws.iotEndpoint+'/mqtt',\r\n  }));\r\n```\r\n\r\n\r\n\r\n\r\nThat's all folks.\r\n\r\n"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMTU5NDIw","author":{"login":"gmreburn"},"title":"DataStore - Owner Relationship Authorization Issue","body":"How do you prevent users from posting on other user's blogs (and use DataStore)? Anyone can save a Post with blogID = somebody else's blog. I was hoping that this would have been handled by the server side resolver when @auth directive is used.\r\n\r\n```graphql\r\ntype Blog\r\n\t@model\r\n\t@auth(rules: [{ allow: owner, operations: [create, update, delete] }]) {\r\n\tid: ID!\r\n\ttitle: String!\r\n\tPosts: [Post] @connection(keyName: \"byBlog\", fields: [\"id\"])\r\n}\r\ntype Post\r\n\t@model\r\n\t@auth(rules: [{ allow: owner, operations: [create, update, delete] }])\r\n\t@key(name: \"byBlog\", fields: [\"blogID\"]) {\r\n\tid: ID!\r\n\ttitle: String!\r\n\tblogID: ID!\r\n\tBlog: Blog @connection\r\n}\r\n```\r\n\r\nLogin as user1:\r\n```javascript\r\nconst blog = await DataStore.save(\r\n    new Blog({\r\n\t\t\"title\": \"Lorem ipsum dolor sit amet\",\r\n\t})\r\n);\r\nconsole.log(blog.id); // 1d183105-6fe2-4525-9208-df589955b943\r\n```\r\n\r\nLogin as user2:\r\n```javascript\r\nconst post = await DataStore.save(\r\n    new Post({\r\n\t\t\"title\": \"Lorem ipsum dolor sit amet\",\r\n\t\tblogID: \"1d183105-6fe2-4525-9208-df589955b943\"\r\n\t})\r\n);\r\n```\r\n\r\n### My attempt:\r\nI tried requiring the owner field and using it in the `@key` but DataStore falls apart quickly because it does not appear to support setting the owner field. It sometimes returns owner: null from sync events which updates the local DS owner to null and then causes remote auth issues during future update requests.\r\n\r\n```graphql\r\ntype Blog\r\n\t@model\r\n\t@auth(rules: [{ allow: owner, operations: [create, update, delete] }]) {\r\n\tid: ID!\r\n\ttitle: String!\r\n\towner: String!\r\n\tPosts: [Post] @connection(keyName: \"byBlog\", fields: [\"owner\", \"id\"])\r\n}\r\ntype Post\r\n\t@model\r\n\t@auth(rules: [{ allow: owner, operations: [create, update, delete] }])\r\n\t@key(name: \"byBlog\", fields: [\"blogID\"]) {\r\n\tid: ID!\r\n\ttitle: String!\r\n\tblogID: ID!\r\n\tBlog: Blog @connection\r\n}\r\n```\r\n\r\n### DynamoDB Post  Table\r\nYou can see the same blogID twice, one for the owner of the blog and another from a different user.\r\nid (S) | __typename (S) | _lastChangedAt (N) | _version (N) | blogID (S) | createdAt (S) | owner (S) | postBlogId (NULL) | title (S) | updatedAt (S)\r\n-- | -- | -- | -- | -- | -- | -- | -- | -- | --\r\nb2ec27db-1bbb-42ae-955a-56e4b00325d5 | Post | 1.61E+12 | 1 | 5a2c03ce-514f-482a-8b55-f52101b01be3 | 2020-12-30T20:36:15.851Z | abf560bb-7c69-4fbc-b787-00df561ce4b8 | TRUE | Lorem ipsum dolor sit amet| 2020-12-30T20:36:15.851Z\r\nb85792a8-a6b1-41b4-b1d6-1c8aaf765078 | Post | 1.61E+12 | 1 | 5a2c03ce-514f-482a-8b55-f52101b01be3 | 2020-12-30T20:34:26.075Z | 90e134b7-b090-4981-b16a-ce93cf7b6de3 | TRUE | Lorem ipsum dolor sit amet| 2020-12-30T20:34:26.075Z\r\n\r\n@iartemiev","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"djbuch"},"body":"Hello, did you find any solution for your use case ?\r\n\r\nRegards"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDY2ODEw","author":{"login":"ShadabFaiz"},"title":"AWS Cognito User pool ID in forgotPassword","body":"AWS Cognito does not ask for cognito pool id for **forgotPassword** functionality. So how does aws knows which pool should it check or does it checks all the pool across the region?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDY2Mjc1","author":{"login":"IsitaB"},"title":"onCreate Subscription Works on AWS Console, Not Through React Native App -- Breaks Realtime Texting Functionality","body":"I am working on creating a react native frontend and aws amplify backend texting feature. The messaging part should update in realtime. The onCreateMessage subscription throws an error\r\n\r\nHere is my code:\r\n```\r\nuseEffect(() => {\r\n    console.log(\"subscription goes through\")\r\n    const subscription = API.graphql(\r\n      graphqlOperation(onCreateMessage)\r\n    ).subscribe({\r\n      error: err => console.log(\"error caught\", err),\r\n      next: (data) => {\r\n        if(data) {\r\n          console.log(data)\r\n          const newMessage = data.value.data.onCreateMessage;\r\n        } else {\r\n          console.log(\"failed\")\r\n        }\r\n        fetchMessages();\r\n      }});\r\n\r\n    return () => subscription.unsubscribe();\r\n  }, [])```\r\n\r\nHere is the error I get in my terminal whenever I create a message\r\n\r\n```\r\nerror caught Object {\r\n  \"error\": Object {\r\n    \"errors\": Array [\r\n      Object {\r\n        \"message\": \"AppSync Realtime subscription init error: undefined\",\r\n      },\r\n    ],\r\n  },\r\n  \"provider\": AWSAppSyncRealTimeProvider {\r\n    \"_config\": Object {},\r\n    \"keepAliveTimeout\": 300000,\r\n    \"promiseArray\": Array [],\r\n    \"socketStatus\": 0,\r\n    \"subscriptionObserverMap\": Map {\r\n      \"39e4e9fc-5057-4b1b-88e4-75e9ea0d5188\" => Object {\r\n        \"observer\": SubscriptionObserver {\r\n          \"_subscription\": Subscription {\r\n            \"_cleanup\": undefined,\r\n            \"_observer\": undefined,\r\n            \"_queue\": undefined,\r\n            \"_state\": \"closed\",\r\n          },\r\n        },\r\n        \"query\": \"subscription OnCreateMessage {\r\n```\r\n\r\nThe subscription works on AWS Appsync console\r\nI believe there might be a problem with the behind the scenes websocket connection since we got`\"AppSync Realtime subscription init error: undefined\"` but other sources say that there could be a mismatch between the return values of the create mutation and the subscription https://github.com/aws-amplify/amplify-js/issues/4832","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDY1OTc5","author":{"login":"jakobpack"},"title":"Can I use multiple apps with a single api?","body":"I currently have one app created, from which I created an API.\r\nI would like to create a second app, that makes use of the existing API.\r\n\r\nIs that possible?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"jakobpack"},"body":"Got it. Adding endpoints into config by hand as stated in the [documentation](https://docs.amplify.aws/lib/auth/start/q/platform/js#re-use-existing-authentication-resource) and using `amplify add codegen --appId XXXX` to get the GraphQL statements."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDQ5OTk2","author":{"login":"PeteDuncanson"},"title":"Can DataStore work as a proxy for types that use selectively sync'ed rules?","body":"Taking this for a spin https://docs.amplify.aws/lib/datastore/sync/q/platform/js#selectively-syncing-a-subset-of-your-data\r\n\r\nI wondered if we could exclude some types from being sync'ed up to save on bandwidth and start up times by using selective syncing rules to say exclude types with a status of \"Archieved\" or similar. I hoped that if I ask DataStore for some data and it doesn't have it locally it might still go and hit up GraphQL to see if it exists up there but in my limited testing that doesn't seem to be the case.\r\n\r\nIf I add a sync rule to exclude everything of one type, nothing of that comes down the wire and if I try querying it via DataStore it still doesn't go up to check it.\r\n\r\nIs there a way to opt in to getting DataStore to act like a proxy or local cache for types which have selective sync rules? As is my app is pulling down 80Mb of data on a cold start and is only going to grow!","upvoteCount":3,"comments":{"edges":[{"node":{"author":{"login":"PeteDuncanson"},"body":"Some discussion of this in the Discord channel which was interesting:\r\n\r\nhttps://discordapp.com/channels/705853757799399426/831604049928257556/863199506174181409 and https://discordapp.com/channels/705853757799399426/831604049928257556/863201312187613204\r\n\r\n@renebrandel makes the suggestion of a Predicate.NONE which wouldn't sync anything (I'm currently doing this with a function that does a comparison that can never be true). But what I'd really like it to have handy data my user is likely to need locally and then the big stuff kept on the cloud and only pulled down if needed/requested."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDU5MDM3","author":{"login":"opqpop"},"title":"How to check if email is confirmed without logging in?","body":"Is there a way to pass ONLY an email and check if that email is confirmed?\n\nI am trying to handle this case:\n- user creates account with email and does not verify, account remains unconfirmed\n- user forgets password and tries to reset password, but cognito doesn't send password code for unconfirmed account\n\nI would like to detect if the email is unconfirmed, and tell user to first verify the email before trying to reset the password.\n\nFrom browsing around, it seems like the only way to check if an email is confirmed is to also have the password to catch the UserNotConfirmedException during sign-in.","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDU3Njc0","author":{"login":"OmarHadidKaito"},"title":"how sign up with just phone number and password then SMS to user to verify his phone number","body":"i try sign in and sign up with phone number and password when i sign in the cognito don't send the SMS to my phone \r\ni wrote code like some that\r\n\r\n```\r\n  async function signUp() {\r\n    try {\r\n        await Auth.signUp({ username: phoneNumber, password, attributes: { phone_number: phoneNumber } });\r\n    } catch (err) {\r\n      console.log({ err });\r\n    }\r\n  }\r\n```\r\n\r\n```\r\n  async function signIn() {\r\n    try {\r\n        await Auth.signIn(phoneNumber, password);\r\n    } catch (err) {\r\n      console.log({ err });\r\n    }\r\n  }\r\n```","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDUzMTMz","author":{"login":"OSorokin"},"title":"styles customisation","body":"Hi,  i am trying to customise  **amplify-input** element styles to make it smaller, but it is not possible. **!important** rule is not working in my custom styles.  Changing css variables  do nothing. It seems like default componet styles have highest priority.\r\n \"@angular/core\": \"9.1.13\",\r\n \"@aws-amplify/ui-angular\": \"^1.0.10\",\r\n \"@aws-amplify/ui-components\": \"^1.3.2\",","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDUxMzE5","author":{"login":"gomesp"},"title":"Authenticator not displaying error messages","body":"I have noticed that the `AmplifyAuthenticator` does not display any error message on my app. Any message coming in the response header 'x-amzn-errormessage', e.g. Incorrect username or password, is silently ignored (although I can see the 400 response in the web developer console).\r\n\r\nAm I missing a configuration in the react component? I am using the following versions:\r\n```\r\n    \"@aws-amplify/ui-react\": \"^1.2.4\",\r\n    \"aws-amplify\": \"^4.1.2\",\r\n```\r\n\r\n```javascript\r\nconst LoginComponent = () => {\r\n  return (\r\n    <AmplifyAuthenticator initialAuthState=\"signup\" usernameAlias=\"email\">\r\n      <AmplifySignUp\r\n        slot=\"sign-up\"\r\n        usernameAlias=\"email\"\r\n        validationErrors=\"signupErrors\"\r\n        formFields={[\r\n          {\r\n            type: \"name\",\r\n            label: \"Full Name *\",\r\n            placeholder: \"Enter your full name\",\r\n            inputProps: { required: true, autocomplete: \"name\" },\r\n          },\r\n          {\r\n            type: \"email\",\r\n            inputProps: { required: true, autocomplete: \"username\" },\r\n          },\r\n          {\r\n            type: \"password\",\r\n            inputProps: { required: true, autocomplete: \"new-password\" },\r\n          },\r\n          {\r\n            type: \"phone_number\",\r\n            dialCode: \"+64\",\r\n          },\r\n        ]}\r\n      />\r\n      <AmplifySignIn slot=\"sign-in\" usernameAlias=\"email\" />\r\n    </AmplifyAuthenticator>\r\n  );\r\n};\r\nconst Login = () => {\r\n  const { isUserAuthenticated } = useAuth();\r\n  return isUserAuthenticated ? (\r\n    <Redirect to={{ pathname: \"/\" }} />\r\n  ) : (\r\n    <LoginComponent />\r\n  );\r\n};\r\n\r\nexport default Login;\r\n```","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"gomesp"},"body":"Moved to https://github.com/aws-amplify/amplify-js/issues/8560"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDUwMjgz","author":{"login":"iongion"},"title":"How to keep alive - when using Hosted UI and amplify-js","body":"I am using Hosted UI, then in my app I have\r\n\r\n```javascript\r\nconst AWS_CONFIG = {\r\n  Auth: {\r\n    region: AWS_REGION,\r\n    userPoolId: AWS_USER_POOL_ID,\r\n    userPoolWebClientId: AWS_USER_POOL_WEB_CLIENT_ID,\r\n    mandatorySignIn: false,\r\n    cookieStorage: {\r\n      domain: APP_DOMAIN,\r\n      path: '/',\r\n      expires: 365,\r\n      secure: true,\r\n    },\r\n  },\r\n};\r\nconst AWS_AUTH = {\r\n  domain: AWS_HOSTED_DOMAIN,\r\n  scope: AWS_OAUTH,\r\n  redirectSignIn: APP_DOMAIN_URL,\r\n  redirectSignOut: APP_DOMAIN_URL,\r\n  responseType: 'token',\r\n};\r\n```\r\n\r\nThe basic client is\r\n\r\n```javascript\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n  const { Amplify, Auth, Hub } = aws_amplify;\r\n  async function entryPoint() {\r\n    Amplify.configure(AWS_CONFIG);\r\n    Auth.configure({ oauth: AWS_AUTH });\r\n    try {\r\n      // listen for changes - see https://docs.amplify.aws/lib/auth/auth-events/q/platform/js\r\n      Hub.listen('auth', ({ payload: { event, data } }) => {\r\n        console.debug('Hub event', event);\r\n        switch (event) {\r\n          case 'signIn':\r\n          case 'cognitoHostedUI':\r\n            console.debug('Cognito sign-in', data);\r\n            break;\r\n          case 'signIn_failure':\r\n          case 'cognitoHostedUI_failure':\r\n            console.error('Sign in failure', data);\r\n            break;\r\n          case 'signOut':\r\n            console.debug('Signed out');\r\n            break;\r\n          case 'tokenRefresh':\r\n            console.debug('token refresh succeeded');\r\n            break;\r\n          case 'tokenRefresh_failure':\r\n            console.error('token refresh failed');\r\n            break;\r\n          case 'configured':\r\n            console.debug('the Auth module is configured');\r\n            break;\r\n          default:\r\n            break;\r\n        }\r\n      });\r\n      // start the flow\r\n      // const user = await Auth.currentAuthenticatedUser();\r\n      // const info = await Auth.currentUserInfo();\r\n      const session = await Auth.currentSession();\r\n      const appUserProfile = decodeProfile(session.idToken);\r\n      console.debug('Current profile', appUserProfile);\r\n      updateUI(null, appUserProfile);\r\n    } catch (error) {\r\n      console.error('Error during authentication flow', error);\r\n      updateUI(error);\r\n    }\r\n  }\r\n  function updateUI(error, profile) {\r\n    const isAnonymous = [\r\n      'No current user',\r\n      'The user is not authenticated',\r\n      'Error: Cannot retrieve a new session. Please authenticate.', // This happens\r\n    ].includes(error ? error.toString() : null);\r\n    if (isAnonymous) {\r\n      Auth.federatedSignIn();\r\n    } else {\r\n      console.debug('Hello', profile);\r\n      // keep alive\r\n      setInterval(() => {\r\n        console.debug('Refreshing token');\r\n        Auth.currentSession()\r\n          .then(() => {\r\n            console.debug('Token refreshed');\r\n          })\r\n          .catch((error) => {\r\n            console.error('Token refresh failure', error);\r\n          });\r\n      }, 5000);\r\n    }\r\n  }\r\n  entryPoint();\r\n});\r\n```\r\n\r\nI try to update the token every 5 seconds, but at a certain moment it does reach `Token refresh failure`\r\n\r\nI cannot understand why or what I am doing wrong.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"iongion"},"body":"To answer my own question, moved to `code` flow instead of `token` - this did it"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDUyNTI4","author":{"login":"nickyeung425"},"title":"Does aws amplify supports phone with google?","body":"Does aws amplify support phones without google? (I.e. huawei phones that are not shipped with google service?)\r\n\r\nI am working on a poc recently and build an apk with android studio. When i test on my phone everything is fine. But with test with my colleague's phone which is an huawei phone with no google shipped on it. His phone were unable to call and get the data while mine is working fine.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDQzMzU2","author":{"login":"rupam-kundu"},"title":"Unable to implement DataStore event listener and making edit functionality work","body":"I am trying to implement CRUD+L functionality in an application using AWS Amplify Admin UI. However, while trying to implement the edit functionality, my edit form is not displaying the existing record. I am suspecting there could be a delay in record fetching as it is an asynchronous process. I tried to listen for the \"ready\" event so that I could populate the form only when all the data is available. However, the listener is not getting invoked. Please help me implement the DataStore event listener correctly. The following is the code for staff.js where I am trying to implement the said listener function.\r\n\r\n```\r\nimport React, { useState, useEffect } from \"react\";\r\nimport Table from \"react-bootstrap/Table\";\r\nimport Form from \"react-bootstrap/Form\";\r\nimport Container from \"react-bootstrap/Container\";\r\nimport Row from \"react-bootstrap/Row\";\r\nimport Col from \"react-bootstrap/Col\";\r\nimport Button from \"react-bootstrap/Button\";\r\nimport Pagination from \"react-bootstrap/Pagination\";\r\nimport Alert from \"react-bootstrap/Alert\";\r\nimport Sidebar from \"./Sidebar\";\r\nimport { DataStore } from \"@aws-amplify/datastore\";\r\nimport { Hub } from \"aws-amplify\";\r\nimport { Staff } from \"../models\";\r\nimport { Users } from \"../models\";\r\n\r\nconst StaffManagement = ({ user }) => {\r\n  const [staff, setStaff] = useState([]);\r\n  const [staffMember, setStaffMember] = useState({\r\n    first_name: \"\",\r\n    middle_name: \"\",\r\n    last_name: \"\",\r\n    name: \"\",\r\n    email: \"\",\r\n    staff_id: \"\",\r\n    title: \"\",\r\n    phone: \"\",\r\n    active : \"Yes\",\r\n    comments : \"\",\r\n  });\r\n  \r\n  const initialFormState = {\r\n    firstName: staffMember ? staffMember.first_name : \"\",\r\n    middleName: staffMember ? staffMember.middle_name : \"\",\r\n    lastName: staffMember ? staffMember.last_name : \"\",\r\n    fullName: staffMember ? staffMember.name : \"\",\r\n    emailAddress: staffMember ? staffMember.email : \"\",\r\n    staffId: staffMember ? staffMember.staff_id : \"\",\r\n    title: staffMember ? staffMember.title : \"\",\r\n    countryCode: \"+1\",\r\n    areaCode: \"\",\r\n    phoneNumber: \"\",\r\n    active: staffMember ? staffMember.active : \"Yes\",\r\n    comments: staffMember ? staffMember.comments : \"\"\r\n  };\r\n  const [formData, setFormData] = useState(initialFormState);\r\n  const [validated, setValidated] = useState(false);\r\n  const [message, setMessage] = useState(\"\");\r\n  const [show, setShow] = useState(true);\r\n  let today = new Date().toISOString().split(\"T\")[0] + \"Z\";\r\n\r\n  useEffect(() => {\r\n    fetchStaff();\r\n  }, []);\r\n\r\n  async function fetchBusiness() {\r\n    try {\r\n      let userEmail = user.attributes.email;\r\n      const userModels = await DataStore.query(Users);\r\n      const userModel = userModels.filter((u) => u.email === userEmail);\r\n      let businessIDVal = JSON.stringify(userModel[0].businessID);\r\n      businessIDVal = businessIDVal.toString();\r\n      console.log(businessIDVal);\r\n      return businessIDVal;\r\n    } catch (e) {\r\n      console.log(e);\r\n    }\r\n  }\r\n\r\n  async function fetchStaff() {\r\n    const businessIDValue = await fetchBusiness();\r\n    console.log(businessIDValue);\r\n    let staffModels = await DataStore.query(Staff);\r\n    staffModels = staffModels.filter(\r\n      (staffModel) => staffModel.businessID === businessIDValue\r\n    );\r\n    console.log(staffModels);\r\n    setStaff(staffModels);\r\n  }\r\n\r\n  async function createStaff() {\r\n    await DataStore.save(\r\n      new Staff({\r\n        first_name: formData.firstName,\r\n        middle_name: formData.middleName,\r\n        last_name: formData.lastName,\r\n        name:\r\n          formData.firstName +\r\n          \" \" +\r\n          formData.middleName +\r\n          \" \" +\r\n          formData.lastName,\r\n        email: formData.emailAddress,\r\n        staff_id: formData.staffId,\r\n        title: formData.title,\r\n        phone:\r\n          formData.countryCode +\r\n          \" \" +\r\n          formData.areaCode +\r\n          \" \" +\r\n          formData.phoneNumber,\r\n        active: formData.active,\r\n        comments: formData.comments,\r\n        created_by: user.attributes.name,\r\n        created_date: today,\r\n        last_modified_by: user.attributes.name,\r\n        last_modified_date: today,\r\n        businessID: await fetchBusiness(),\r\n        AppointmentNotes: [],\r\n      })\r\n    );\r\n    setFormData(initialFormState);\r\n  }\r\n\r\nconst listener = id => {\r\n  Hub.listen(\"datastore\", async hubData => {\r\n    const  { event, data } = hubData.payload;\r\n    if (event === \"ready\") {\r\n      const modelToEdit = await DataStore.query(Staff, id);\r\n        console.log(modelToEdit);\r\n        setStaffMember(modelToEdit);\r\n        setFormData(modelToEdit);\r\n        console.log(staffMember);\r\n        console.log(initialFormState);\r\n        console.log(formData);    \r\n    }\r\n  });\r\n}\r\n\r\n  async function editStaff({ id }) {\r\n    console.log(id);\r\n    listener(id);\r\n  }\r\n\r\n  async function deleteStaff({ id }) {\r\n    const newStaffArray = staff.filter(staffMember => staffMember.id !== id);\r\n    setStaff(newStaffArray);\r\n    const modelToDelete = await DataStore.query(Staff, id);\r\n    DataStore.delete(modelToDelete);\r\n    setMessage(\"Staff member has been successfully deleted.\");\r\n    console.log(message);\r\n    if (!show) {\r\n      setShow(true);\r\n    }\r\n    window.scrollTo(0, 0);\r\n  }\r\n\r\n  const handleSubmit = (event) => {\r\n    const form = event.currentTarget;\r\n    if (form.checkValidity() === false) {\r\n      event.preventDefault();\r\n      event.stopPropagation();\r\n    }\r\n    setValidated(true);\r\n    console.log(formData);\r\n    createStaff();\r\n    setMessage(\"Staff member has been successfully added.\");\r\n    console.log(message);\r\n    if (!show) {\r\n      setShow(true);\r\n    }\r\n    window.scrollTo(0, 0);\r\n  };\r\n\r\n  const handleReset = (event) => {\r\n    setFormData(initialFormState);\r\n  };\r\n\r\n  return (\r\n    <>\r\n      <style type=\"text/css\">\r\n        {`\r\n                .btn {\r\n                  background-color: #4d0d73;\r\n                }\r\n              `}\r\n      </style>\r\n      <Container fluid>\r\n        <Row>\r\n          <Col sm={3}>\r\n            <Sidebar />\r\n          </Col>\r\n          <Col sm={9}>\r\n            <Row>\r\n              <Col>\r\n                <h1\r\n                  style={{\r\n                    textAlign: \"center\",\r\n                    marginTop: \"3%\",\r\n                    marginBottom: \"3%\",\r\n                  }}\r\n                >\r\n                  Manage your staff members\r\n                </h1>\r\n              </Col>\r\n            </Row>\r\n            <Row>\r\n              <Col>\r\n                <Form inline style={{ float: \"right\" }}>\r\n                  <Form.Label htmlFor=\"inlineFormSearch\" srOnly>\r\n                    Search\r\n                  </Form.Label>\r\n                  <Form.Control\r\n                    type=\"search\"\r\n                    className=\"mb-2 mr-sm-2\"\r\n                    id=\"inlineFormSearch\"\r\n                    placeholder=\"Search...\"\r\n                  />\r\n                  <Button type=\"submit\" className=\"mb-2\">\r\n                    Search\r\n                  </Button>\r\n                </Form>\r\n              </Col>\r\n            </Row>\r\n            {message && (\r\n              <Row>\r\n                <SuccessAlert message={message} show={show} setShow={setShow} />\r\n              </Row>\r\n            )}\r\n            <Row>\r\n              <Col>\r\n                <h3 style={{ textAlign: \"left\", marginTop: \"3%\" }}>\r\n                  Staff list\r\n                </h3>\r\n                <Table bordered hover responsive style={{ marginTop: \"1%\" }}>\r\n                  <thead style={{ backgroundColor: \"#cecede\" }}>\r\n                    <tr>\r\n                      <th>#</th>\r\n                      <th>First name</th>\r\n                      <th>Middle name</th>\r\n                      <th>Last name</th>\r\n                      <th>Full name</th>\r\n                      <th>Email address</th>\r\n                      <th>Staff Id</th>\r\n                      <th>Title</th>\r\n                      <th>Phone number</th>\r\n                      <th>Active</th>\r\n                      <th>Comments</th>\r\n                      <th></th>\r\n                      <th></th>\r\n                    </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                    {staff.map((staffMember, index) => (\r\n                      <tr key={staffMember.id}>\r\n                        <td>{index + 1}</td>\r\n                        <td>{staffMember.first_name}</td>\r\n                        <td>{staffMember.middle_name}</td>\r\n                        <td>{staffMember.last_name}</td>\r\n                        <td>{staffMember.name}</td>\r\n                        <td>{staffMember.email}</td>\r\n                        <td>{staffMember.staff_id}</td>\r\n                        <td>{staffMember.title}</td>\r\n                        <td>{staffMember.phone}</td>\r\n                        <td>{staffMember.active ? \"Yes\" : \"No\"}</td>\r\n                        <td>{staffMember.comments}</td>\r\n                        <td>\r\n                          <Button type=\"button\" onClick={() => editStaff(staffMember)}>Edit</Button>\r\n                        </td>\r\n                        <td>\r\n                          <Button type=\"button\" onClick={() => deleteStaff(staffMember)}>Delete</Button>\r\n                        </td>\r\n                      </tr>\r\n                    ))}\r\n                  </tbody>\r\n                </Table>\r\n              </Col>\r\n            </Row>\r\n            <Row style={{ marginTop: \"1%\" }}>\r\n              <Col>\r\n                <Pagination>\r\n                  <Pagination.First />\r\n                  <Pagination.Prev />\r\n                  <Pagination.Item active>{1}</Pagination.Item>\r\n                  <Pagination.Item>{2}</Pagination.Item>\r\n                  <Pagination.Item>{3}</Pagination.Item>\r\n                  <Pagination.Item>{4}</Pagination.Item>\r\n                  <Pagination.Item>{5}</Pagination.Item>\r\n                  <Pagination.Next />\r\n                  <Pagination.Last />\r\n                </Pagination>\r\n              </Col>\r\n            </Row>\r\n            <Row>\r\n              <Col>\r\n                <h3\r\n                  style={{\r\n                    textAlign: \"left\",\r\n                    marginTop: \"3%\",\r\n                    marginBottom: \"3%\",\r\n                  }}\r\n                >\r\n                  Add a staff member\r\n                </h3>\r\n                <Form\r\n                  noValidate\r\n                  validated={validated}\r\n                  onSubmit={handleSubmit}\r\n                  style={{ marginBottom: \"5%\" }}\r\n                >\r\n                  <Form.Group as={Row} controlId=\"FirstName\">\r\n                    <Form.Label column sm={2}>\r\n                      First name *\r\n                    </Form.Label>\r\n                    <Col sm={6}>\r\n                      <Form.Control\r\n                        required\r\n                        type=\"text\"\r\n                        onChange={(e) => {\r\n                          console.log(e.target.value);\r\n                          setFormData({\r\n                            ...formData,\r\n                            firstName: e.target.value,\r\n                          });\r\n                        }}\r\n                        value={formData.firstName}\r\n                      />\r\n                      <Form.Control.Feedback type=\"invalid\">\r\n                        First name is required.\r\n                      </Form.Control.Feedback>\r\n                    </Col>\r\n                  </Form.Group>\r\n                  <Form.Group as={Row} controlId=\"MiddleName\">\r\n                    <Form.Label column sm={2}>\r\n                      Middle name\r\n                    </Form.Label>\r\n                    <Col sm={6}>\r\n                      <Form.Control\r\n                        type=\"text\"\r\n                        onChange={(e) => {\r\n                          console.log(e.target.value);\r\n                          setFormData({\r\n                            ...formData,\r\n                            middleName: e.target.value,\r\n                          });\r\n                        }}\r\n                        value={formData.middleName}\r\n                      />\r\n                    </Col>\r\n                  </Form.Group>\r\n                  <Form.Group as={Row} controlId=\"LastName\">\r\n                    <Form.Label column sm={2}>\r\n                      Last name *\r\n                    </Form.Label>\r\n                    <Col sm={6}>\r\n                      <Form.Control\r\n                        required\r\n                        type=\"text\"\r\n                        onChange={(e) => {\r\n                          console.log(e.target.value);\r\n                          setFormData({\r\n                            ...formData,\r\n                            lastName: e.target.value,\r\n                          });\r\n                        }}\r\n                        value={formData.lastName}\r\n                      />\r\n                      <Form.Control.Feedback type=\"invalid\">\r\n                        Last name is required.\r\n                      </Form.Control.Feedback>\r\n                    </Col>\r\n                  </Form.Group>\r\n                  <Form.Group as={Row} controlId=\"EmailAddress\">\r\n                    <Form.Label column sm={2}>\r\n                      Email address *\r\n                    </Form.Label>\r\n                    <Col sm={6}>\r\n                      <Form.Control\r\n                        required\r\n                        type=\"email\"\r\n                        onChange={(e) => {\r\n                          console.log(e.target.value);\r\n                          setFormData({\r\n                            ...formData,\r\n                            emailAddress: e.target.value,\r\n                          });\r\n                        }}\r\n                        value={formData.emailAddress}\r\n                      />\r\n                      <Form.Control.Feedback type=\"invalid\">\r\n                        Email address is required.\r\n                      </Form.Control.Feedback>\r\n                    </Col>\r\n                  </Form.Group>\r\n                  <Form.Group as={Row} controlId=\"StaffId\">\r\n                    <Form.Label column sm={2}>\r\n                      Staff Id\r\n                    </Form.Label>\r\n                    <Col sm={6}>\r\n                      <Form.Control\r\n                        type=\"text\"\r\n                        onChange={(e) => {\r\n                          console.log(e.target.value);\r\n                          setFormData({ ...formData, staffId: e.target.value });\r\n                        }}\r\n                        value={formData.staffId}\r\n                      />\r\n                    </Col>\r\n                  </Form.Group>\r\n                  <Form.Group as={Row} controlId=\"Title\">\r\n                    <Form.Label column sm={2}>\r\n                      Title\r\n                    </Form.Label>\r\n                    <Col sm={6}>\r\n                      <Form.Control\r\n                        type=\"text\"\r\n                        onChange={(e) => {\r\n                          console.log(e.target.value);\r\n                          setFormData({ ...formData, title: e.target.value });\r\n                        }}\r\n                        value={formData.title}\r\n                      />\r\n                    </Col>\r\n                  </Form.Group>\r\n                  <Form.Group as={Row} controlId=\"PhoneNumber\">\r\n                    <Form.Label column sm={2}>\r\n                      Phone number\r\n                    </Form.Label>\r\n                    <Col sm=\"auto\">\r\n                      <Form.Control\r\n                        as=\"select\"\r\n                        custom\r\n                        onChange={null}\r\n                        value={formData.countryCode}\r\n                      >\r\n                        <option value=\"+1\">+1</option>\r\n                      </Form.Control>\r\n                    </Col>\r\n                    <Col sm={2}>\r\n                      <Form.Control\r\n                        type=\"tel\"\r\n                        pattern=\"[0-9]{3}\"\r\n                        placeholder=\"Area code\"\r\n                        onChange={(e) => {\r\n                          console.log(e.target.value);\r\n                          setFormData({\r\n                            ...formData,\r\n                            areaCode: e.target.value,\r\n                          });\r\n                        }}\r\n                        value={formData.areaCode}\r\n                      />\r\n                      <Form.Control.Feedback type=\"invalid\">\r\n                        Area code needs to be 3 digits long.\r\n                      </Form.Control.Feedback>\r\n                    </Col>\r\n                    <Col sm={3}>\r\n                      <Form.Control\r\n                        type=\"tel\"\r\n                        pattern=\"[0-9]{7}\"\r\n                        placeholder=\"Phone number\"\r\n                        onChange={(e) => {\r\n                          console.log(e.target.value);\r\n                          setFormData({\r\n                            ...formData,\r\n                            phoneNumber: e.target.value,\r\n                          });\r\n                        }}\r\n                        value={formData.phoneNumber}\r\n                      />\r\n                      <Form.Control.Feedback type=\"invalid\">\r\n                        Phone number needs to be 7 digits long.\r\n                      </Form.Control.Feedback>\r\n                    </Col>\r\n                  </Form.Group>\r\n                  <Form.Group as={Row} controlId=\"Active\">\r\n                    <Form.Label column sm={2}>\r\n                      Active\r\n                    </Form.Label>\r\n                    <Col sm={2}>\r\n                      <Form.Control\r\n                        as=\"select\"\r\n                        custom\r\n                        onChange={(e) => {\r\n                          console.log(e.target.value);\r\n                          setFormData({ ...staffMember, active: e.target.value });\r\n                        }}\r\n                        value={formData.active}\r\n                      >\r\n                        <option value=\"Yes\">Yes</option>\r\n                        <option value=\"No\">No</option>\r\n                      </Form.Control>\r\n                    </Col>\r\n                  </Form.Group>\r\n                  <Form.Group as={Row} controlId=\"Comments\">\r\n                    <Form.Label column sm={2}>\r\n                      Comments\r\n                    </Form.Label>\r\n                    <Col sm={6}>\r\n                      <Form.Control\r\n                        as=\"textarea\"\r\n                        rows={3}\r\n                        name=\"comments\"\r\n                        onChange={(e) => {\r\n                          console.log(e.target.value);\r\n                          setFormData({\r\n                            ...formData,\r\n                            comments: e.target.value,\r\n                          });\r\n                        }}\r\n                        value={formData.comments}\r\n                      />\r\n                    </Col>\r\n                  </Form.Group>\r\n                  <Form.Row>\r\n                    <Col\r\n                      sm={2}\r\n                      style={{\r\n                        display: \"flex\",\r\n                        justifyContent: \"center\",\r\n                        alignItems: \"center\",\r\n                      }}\r\n                    >\r\n                      <Button type=\"reset\" onClick={handleReset}>\r\n                        Reset\r\n                      </Button>\r\n                    </Col>\r\n                    <Col\r\n                      sm={6}\r\n                      style={{\r\n                        display: \"flex\",\r\n                        justifyContent: \"center\",\r\n                        alignItems: \"center\",\r\n                      }}\r\n                    >\r\n                      <Button type=\"submit\">Submit</Button>\r\n                    </Col>\r\n                  </Form.Row>\r\n                </Form>\r\n              </Col>\r\n            </Row>\r\n          </Col>\r\n        </Row>\r\n      </Container>\r\n    </>\r\n  );\r\n};\r\n\r\nconst SuccessAlert = ({ message, show, setShow }) => {\r\n  if (show) {\r\n    return (\r\n      <Alert\r\n        variant=\"success\"\r\n        style={{ marginLeft: \"25%\", marginRight: \"25%\" }}\r\n        onClose={() => setShow(false)}\r\n        dismissible\r\n      >\r\n        {message}\r\n      </Alert>\r\n    );\r\n  } else {\r\n    return null;\r\n  }\r\n};\r\n\r\nexport default StaffManagement;\r\n```\r\nPlease find below the contents of my package.json file.\r\n```\r\n{\r\n  \"name\": \"saasapp\",\r\n  \"version\": \"0.1.0\",\r\n  \"private\": true,\r\n  \"dependencies\": {\r\n    \"@aws-amplify/ui-react\": \"^1.0.7\",\r\n    \"@testing-library/jest-dom\": \"^5.11.8\",\r\n    \"@testing-library/react\": \"^11.2.2\",\r\n    \"@testing-library/user-event\": \"^12.6.0\",\r\n    \"aws-amplify\": \"^3.3.27\",\r\n    \"bootstrap\": \"^4.5.3\",\r\n    \"i18next\": \"^19.8.4\",\r\n    \"react\": \"^17.0.2\",\r\n    \"react-bootstrap\": \"^1.4.0\",\r\n    \"react-dom\": \"^17.0.1\",\r\n    \"react-i18next\": \"^11.8.5\",\r\n    \"react-router-dom\": \"^5.2.0\",\r\n    \"react-scripts\": \"4.0.1\",\r\n    \"web-vitals\": \"^0.2.4\"\r\n  },\r\n  \"scripts\": {\r\n    \"start\": \"react-scripts start\",\r\n    \"build\": \"react-scripts build\",\r\n    \"test\": \"react-scripts test\",\r\n    \"eject\": \"react-scripts eject\"\r\n  },\r\n  \"eslintConfig\": {\r\n    \"extends\": [\r\n      \"react-app\",\r\n      \"react-app/jest\"\r\n    ]\r\n  },\r\n  \"browserslist\": {\r\n    \"production\": [\r\n      \">0.2%\",\r\n      \"not dead\",\r\n      \"not op_mini all\"\r\n    ],\r\n    \"development\": [\r\n      \"last 1 chrome version\",\r\n      \"last 1 firefox version\",\r\n      \"last 1 safari version\"\r\n    ]\r\n  }\r\n}\r\n```\r\nPlease find below the console screenshot.\r\n\r\n![Console log](https://user-images.githubusercontent.com/56736881/124315028-f6f5a780-db90-11eb-83dd-2007daf3909b.png)\r\n\r\nWhat is also surprising is that when I click the \"Edit\" button the Edit form gets populated with only the \"Title\" field. Please find below the related screenshot.\r\n![image](https://user-images.githubusercontent.com/56736881/124961933-ae7c3500-e03b-11eb-95cc-6716bae34321.png)\r\n\r\nPlease note the warning in the console which says \"A component is changing a controlled input to be uncontrolled. This is likely caused by the value changing from a defined to undefined, which should not happen. Decide between using a controlled or uncontrolled input element for the lifetime of the component.\"\r\n\r\nPlease help me resolve the issue.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDQ4NjU0","author":{"login":"slikk66"},"title":"Possible to use Lambda creds for Amplify usage?","body":"Hi, I'm trying to use Amplify.graphql inside of a Lambda function.  I need my function (which is an AppSync resolver) to be allowed to query back the API to get information.\r\n\r\nI tried using Apollo and AWSAppSyncClient directly, but they both had problems with the fragments/interfaces, where straight Amplify does not:\r\n\r\n````\r\nconst AWS = require(\"aws-sdk\");\r\nconst API = require(\"aws-amplify\").API;\r\nconst Amplify = require(\"aws-amplify\").default;\r\n\r\nAmplify.configure({\r\n    aws_project_region: \"us-west-2\",\r\n    aws_appsync_graphqlEndpoint: \"https://AAAAAAAAAAAAAAAAA.appsync-api.us-west-2.amazonaws.com/graphql\",\r\n    aws_appsync_region: \"us-west-2\",\r\n    aws_appsync_authenticationType: \"AWS_IAM\",\r\n});\r\n\r\n....\r\n\r\nconst response = await API.graphql({\r\n    query: getTheQuery,\r\n    variables: { id: \"3ee9c69e-fca4-46c8-9083-ed9da850e859\" },\r\n});\r\n````\r\n\r\nWith above I get a \"no credentials\" error.  Locally, and on Lambda, there are environment variables with the session token, key etc.\r\n\r\nIf I change the auth type to `API_KEY` and supply the key, then it works, but with AWS_IAM type, it doesn't.  Is it not possible to allow the Amplify system to inherit the permissions of the Lambda function?  The function policy includes `appsync:*` so it should have ability to query the API.\r\n\r\nIs it possible to do what I'm asking so that I don't need to manually rotate the API KEY in my function?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNTM1Mg==","author":{"login":"atomdmac"},"title":"Using a Custom Endpoint for Cognito/Auth","body":"I'd like to be able to point the `Auth` module to a fake/mocked `Cognito` endpoint when developing locally.  \r\n\r\nUnder the hood, it looks like the `amazon-cognito-identity-js` library (which the `Auth` module uses [here](https://github.com/aws-amplify/amplify-js/blob/main/packages/auth/src/Auth.ts#L175))  accepts an [`endpoint` parameter](https://github.com/aws-amplify/amplify-js/blob/main/packages/amazon-cognito-identity-js/src/CognitoUserPool.js#L42).\r\n\r\nHowever, there doesn't seem to be an opportunity to pass an `endpoint` parameter through to the `CognitoUserPool` instance when using the `Auth` module (again, as seen [here](https://github.com/aws-amplify/amplify-js/blob/main/packages/auth/src/Auth.ts#L175)).\r\n\r\nPassing the `endpoint` param through the `Amplify.configure()` call seems trivial (and I'm happy to submit a PR for it) but I'm curious: **Is there another way to accomplish this that anyone else is aware of?**","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"atomdmac"},"body":"I found an (admittedly hacky) way to accomplish this.  I'm not sure if there are any side-effects to doing it this way but it seems to be working for my purposes.\r\n\r\n```javascript\r\nimport Amplify, { Auth } from 'aws-amplify';\r\nAmplify.configure({\r\n  ...your configuration\r\n});\r\nAuth.userPool.client.endpoint = 'http://localhost:9229';\r\n```"}},{"node":{"author":{"login":"dhutchison"},"body":"As of 3.2.0 this has been possible as part of the `Amplify.configure()` call by setting `Auth.endpoint` in the configuration object. \r\n\r\nConfirmed this worked with a mock cognito implementation a few days ago.\r\n\r\nThe feature was added in this commit: https://github.com/aws-amplify/amplify-js/commit/92d4fc16783fc232626350b57adfbcfed6a9d248 "}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDQ4Mjc1","author":{"login":"jackbh0120"},"title":"Amplify not importing proper oauth domain from aws-exports.js","body":"I am trying to remove an old auth and import a new one into an existing amplify environment, which is continuously linked to a BitBucket repository for deployment. I have been doing this through the Amplify CLI using amplify remove auth and then amplify import auth, and then an amplify push. When I import my auth and push it using my specified user pool from Cognito, my aws-exports.js file and awsmobile variable is populated with the proper information (as well as all my backend configuration files) for my newly specified user pool and the new oauth domain. Currently my frontend environment is set up for continuous redeployment on every commit to BitBucket. When I commit and push the updated aws-exports.js file to BitBucket for redeployment, the old user pool is still somehow being used despite the awsmobile variable in the aws-exports.js file containing the correct information (user pool id, oauth domain, app client id) for the new user pool I wish to use. If anybody has any insight into this issue I would greatly appreciate it. Thank you!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDQ3NTY4","author":{"login":"ixel1"},"title":"Errors when building on Ubuntu (e.g. via Docker) but not on Windows (e.g. via Webstorm)","body":"I've encountered a problem which I'm hoping someone can provide some insight into.\r\n\r\nI have a project in Angular which uses aws-amplify, and for a while it's been fine. Recently my colleague has discovered that it's no longer building via Docker (on Ubuntu). However, on my Windows system which uses Webstorm it's fine if I do yarn build:prod directly. If however I go via Docker again it fails.\r\n\r\nThese are the errors I get:\r\n> #31 73.41\r\n> #31 73.41\r\n> #31 73.41\r\n> #31 73.41 Error: node_modules/@aws-amplify/ui-components/dist/types/common/Translations.d.ts:126:35 - error TS2694: Namespace '\"/opt/enfluence/frontend/node_modules/@aws-amplify/auth/lib-esm/common/AuthErrorStrings\".AuthErrorStrings' has no exported member 'EMPTY_EMAIL'.\r\n> #31 73.41\r\n> #31 73.41 126     EMPTY_EMAIL: AuthErrorStrings.EMPTY_EMAIL;\r\n> #31 73.41                                       ~~~~~~~~~~~\r\n> #31 73.41\r\n> #31 73.41\r\n> #31 73.41 Error: node_modules/@aws-amplify/ui-components/dist/types/common/Translations.d.ts:127:35 - error TS2694: Namespace '\"/opt/enfluence/frontend/node_modules/@aws-amplify/auth/lib-esm/common/AuthErrorStrings\".AuthErrorStrings' has no exported member 'EMPTY_PHONE'.\r\n> #31 73.41\r\n> #31 73.41 127     EMPTY_PHONE: AuthErrorStrings.EMPTY_PHONE;\r\n> #31 73.41                                       ~~~~~~~~~~~\r\n> #31 73.41\r\n> #31 73.41\r\n> #31 73.41 Error: node_modules/@aws-amplify/ui-components/dist/types/common/Translations.d.ts:137:37 - error TS2694: Namespace '\"/opt/enfluence/frontend/node_modules/@aws-amplify/auth/lib-esm/common/AuthErrorStrings\".AuthErrorStrings' has no exported member 'NETWORK_ERROR'.\r\n> #31 73.41\r\n> #31 73.41 137     NETWORK_ERROR: AuthErrorStrings.NETWORK_ERROR;\r\n> #31 73.41                                         ~~~~~~~~~~~~~\r\n> #31 73.41\r\n> #31 73.41\r\n> #31 73.41 Error: node_modules/@aws-amplify/ui-components/dist/types/common/Translations.d.ts:138:37 - error TS2694: Namespace '\"/opt/enfluence/frontend/node_modules/@aws-amplify/auth/lib-esm/common/AuthErrorStrings\".AuthErrorStrings' has no exported member 'DEVICE_CONFIG'.\r\n> #31 73.41\r\n> #31 73.41 138     DEVICE_CONFIG: AuthErrorStrings.DEVICE_CONFIG;\r\n> #31 73.41                                         ~~~~~~~~~~~~~\r\n> #31 73.41\r\n> #31 73.41\r\n> #31 73.41 Error: node_modules/@aws-amplify/ui-components/dist/types/components.d.ts:17:10 - error TS2614: Module '\"../../../auth/lib-esm\"' has no exported member 'SignUpParams'. Did you mean to use 'import SignUpParams from \"../../../auth/lib-esm\"' instead?\r\n> #31 73.41\r\n> #31 73.41 17 import { SignUpParams } from \"@aws-amplify/auth\";\r\n\r\nMy colleague doesn't understand why this is happening and neither do I. We've also tried going back several commits to see if it was something we did unintentionally without knowing, however the same errors persist when building via Docker but not on Windows direct to yarn and not going via Docker.\r\n\r\nDoes anyone have any idea why this is happening? Let me know if there's something else you need me to post to help further analyse the cause of this. Thanks in advance.\r\n\r\nEDIT: Thought I posted this in the wrong repo but I can't find another one which seems suitable so maybe this is the right place.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"ixel1"},"body":"This has now been resolved, thanks anyway."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDQ2OTkx","author":{"login":"LuisPerez94"},"title":"It is posible to cancel a query operation in datastore?","body":"It is posible to cancel a query operation in datastore?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDQ0Nzg2","author":{"login":"annymosse"},"title":"aws-sdk-js doesn't support local dev","body":"Everything related to the FrontEnd side work well except when try to access the resources locally ,ex: if you upload a file with mocking amplify you can get it work to get/put/.. data of AppSync (dynamodb) or S3 also; Whenever trying to access these files/ database you can't get them since the SDK try to retrieve these resources from the cloud instead local dev and this end up with not found keys files/ items, Is there a way to get it work locally or i should submit a bug issue in aws-sdk-* (js) repository ?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDQ0NzAx","author":{"login":"furkangercek"},"title":"Unable to setup MFA, it gives Code Mismatch  and fail enable Software Token MFA","body":"I have a Cognito user pool that has MFA set to Optional with TOTP only.\r\n\r\nI'm trying to set up a page that enables MultiFactorAuthentication for the user for the first time following this  [AWS Documentation.](https://docs.amplify.aws/lib/auth/mfa/q/platform/js#setup-totp)\r\n\r\nAs my component mounts, I generate a QR code and show it on screen using qrcode.react\r\n\r\n```\r\n  useEffect(() => {\r\nAuth.currentAuthenticatedUser({ bypassCache: true }).then(user => {\r\n  setUser(user);\r\n  Auth.setupTOTP(user).then(code => {\r\n    const authCode = \"otpauth://totp/AWSCognito:\" + user.username + \"?secret=\" + code + \"&issuer=Invent\";\r\n    setQrCode(authCode);\r\n  });\r\n});\r\n}, []);\r\n```\r\n\r\n\r\nThen, when the user puts the input, I verify it and call the setPrefferredMFA. Now here, I checked if \"input\" is correctly passed and no issues there.\r\n\r\n```\r\nconst setupMFA = input => {\r\nAuth.setupTOTP(user).then(() => {\r\n  Auth.verifyTotpToken(user, input)\r\n    .then(() => {\r\n      Auth.setPreferredMFA(user, \"TOTP\").then(() => {\r\n        props.setShowModal(false);\r\n      });\r\n    })\r\n    .catch(e => {\r\n      // Token is not verified\r\n    });\r\n});\r\n};\r\n```\r\n\r\nI'm still getting Code mismatch and fail enable Software Token MFA error and failing to set a MFA to the user.","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"furkangercek"},"body":"I solved it.\r\n\r\nAuth.verifyTotpToken() is not supposed to be in the .then() block of setupTOTP.\r\n\r\nPfft. Removing the Auth.setupTOTP in the setupMFA function made it work."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDQxNTMw","author":{"login":"LuisPerez94"},"title":"Datastore several syncs in react capacitor native app","body":"I have an app made with reactjs and we use capacitor to make it a native app.   this app use the amplify authenticator component to protect paths inside the app. Once the user succesfully sign in I trigger a Datastore.start() function in order to get a full sync.  Until this point everything is ok. The problem comes when the application goes to second plane / background and then I come back to it, so several full syncs happens over and over and this make the app very slow. somebody knows if I am missing something? I would like the app makes only one full sync. this behaivor is in ios and android.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDQwNDg4","author":{"login":"ChapterSevenSeeds"},"title":"API Gateway cloudformation template - reference environment specific cognito userpool ARN","body":"Hello everyone. So, in the cloudformation template for a REST API gateway, there is a section called \"securityDefinitions\" where you can define a gateway authorizer (such as a cognito userpool). Given my sincere lack of familiarity of cloudformation intrinsics, I am seeking a way to add in a cognito authorizer for the gateway for a specific environment and region. This image shows the exported security definitions for the gateway in my dev environment:\r\n![asdf](https://user-images.githubusercontent.com/63123355/124141841-f6e99080-da46-11eb-9d58-aa56b573fe28.png)\r\n\r\nEssentially, I'm hoping to learn how to replace the providerARNs string literal with a reference to the cognito userpool based on the environment and region. I know that you can use cloudformation intrinsics to construct ARNs from references like the image below: \r\n![image](https://user-images.githubusercontent.com/63123355/124142331-60699f00-da47-11eb-8f69-99890ab070da.png)\r\n\r\nBut, I am unsure how to do this with a cognito userpool ARN. Does anybody have any ideas?\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDM5ODA3","author":{"login":"mattmeye"},"title":"DataStore How can i set some items of an Entity as public?","body":"Hello,\r\n\r\ni want to find a solution to the following problem:\r\n\r\n- Users can CRUD their own Notifications, also a property called \"public\".\r\n- If an entity is flagged as \"public\" - then all users should be able to read this notification (only read, not update nor delete).\r\n\r\n```\r\ntype Notification\r\n    @model\r\n    @auth(\r\n        rules: [\r\n            { allow: owner, operations: [read, update, delete, create] }\r\n            { allow: public, operations: [read], provider: iam } // <= this should only catch notifications with a property public.\r\n        ]\r\n    ) {\r\n    id: ID!\r\n    title: String!\r\n    public: Boolean! // <= \r\n}\r\n````\r\n\r\nWhat is the best solution for this? Maybe another Entity called \"PublicNotification\" and some business logic to copy these items?\r\n\r\nThanks.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDM4MDM4","author":{"login":"johnny-chivers"},"title":"How do I get the authentication-error toast lower on the screen? as it is currently hidden by my nav bar.","body":"Hi All, \r\n\r\nI have my webapp configured for a log in for certain parts of my site. \r\n\r\nAs such its laid out \r\n```\r\n<Nav/>\r\n<UserHome/>\r\n<footer/>\r\n```\r\n\r\nUserHome is wrapped like so  \r\n\r\n`export default withAuthenticator(HomeSignedIn, true);`\r\n\r\nand imported \r\n\r\n`import { withAuthenticator} from '@aws-amplify/ui-react';`\r\n\r\nHowever, the toast which display the error message when user types in an incorrect username or password is currently behind my nav bar and I can't figure out how to apply the style so it is displayed below the navbar - rather than behind it. I've attached a screen shot of the code when render, so you can see how it is set behind my Nav bar. \r\n<img width=\"1788\" alt=\"Screenshot 2021-06-30 at 10 43 23\" src=\"https://user-images.githubusercontent.com/64025427/123940075-baf3f400-d990-11eb-835d-412e2b9ebef5.png\">\r\n","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDM3Mzk1","author":{"login":"ravipula"},"title":"Cognito Implementation for Chrome Extension","body":"Hello,\r\n\r\nI am trying to implement Cognito Auth in a chrome extension. We are already using Cognito on our web app. So while implementing it in chrome extension the login with email and password works fine. However if i do try to SignUp/Login with a provider nothing happens and in the source it says `No resource with given URL found`. What does that actually mean and how i can get this up and running? Any help is appreciated. Thanks in Advance.","upvoteCount":5,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDM0NTQw","author":{"login":"gomesp"},"title":"AmplifyAuthenticator fails silently. How to surface the validation errors?","body":"I have a react app with the following snippet as a login component. When I try to register a user and the user registration details do not pass the validation I get a ```400 Bad request``` on the browser console, but no error messages are displayed on the page itself. \r\n\r\nThe documentation for the [sign up](https://docs.amplify.aws/ui/auth/authenticator/q/framework/react#sign-up) component mentions a validationErrors attribute, but no example is given and the description is quite vague. \r\n\r\nHas anyone been able to surface the validation errors to the page? Have I setup my ```AmplifyAuthenticator``` incorrectly?\r\n\r\nI am using the following package versions:\r\n```\r\n\"@aws-amplify/ui-react\": \"^1.2.4\",\r\n\"aws-amplify\": \"^4.1.2\",\r\n```\r\n\r\n```javascript\r\nconst LoginComponent = () => {\r\n  return (\r\n    <AmplifyAuthenticator initialAuthState=\"signup\" usernameAlias=\"email\">\r\n      <AmplifySignUp\r\n        slot=\"sign-up\"\r\n        usernameAlias=\"email\"\r\n        formFields={[\r\n          {\r\n            type: \"name\",\r\n            label: \"Full Name *\",\r\n            placeholder: \"Enter your full name\",\r\n            inputProps: { required: true, autocomplete: \"name\" },\r\n          },\r\n          {\r\n            type: \"email\",\r\n            inputProps: { required: true, autocomplete: \"username\" },\r\n          },\r\n          {\r\n            type: \"password\",\r\n            inputProps: { required: true, autocomplete: \"new-password\" },\r\n          },\r\n          {\r\n            type: \"phone_number\",\r\n            dialCode: \"+64\",\r\n          },\r\n        ]}\r\n      />\r\n      <AmplifySignIn slot=\"sign-in\" usernameAlias=\"email\" />\r\n    </AmplifyAuthenticator>\r\n  );\r\n};\r\n```","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yOTQ0MzEz","author":{"login":"eaddingtonwhite"},"title":"\"Getting Unregistered or Expired Token\" error/ \"BadDeviceToken  error when using Amplify + Pinpoint+Expo","body":"Hi 👋 \r\n\r\nI am trying to configure push notifications for my react native app built using Expo, AWS amplify, and Pinpoint.\r\n\r\nI was going off these guides \r\n* https://docs.expo.io/push-notifications/sending-notifications-custom/\r\n* https://docs.amplify.aws/lib/analytics/getting-started/q/platform/js#update-endpoint\r\n\r\n\r\nI have some code written in app like this for trying to configure AWS Pinpoint with the device token I have captured from expo-notification library\r\n\r\n```typescript\r\nimport * as Notifications from 'expo-notifications';\r\n\r\nconst bootstrapPushNotifcations = (u: User) => {\r\n    const { status: existingStatus } = await Notifications.getPermissionsAsync();\r\n    let finalStatus = existingStatus;\r\n    if (existingStatus !== 'granted') {\r\n      const { status } = await Notifications.requestPermissionsAsync();\r\n      finalStatus = status;\r\n    }\r\n    if (finalStatus !== 'granted') {\r\n      alert('Failed to get push token for push notification!');\r\n      return;\r\n    }\r\n    const token = (await Notifications.getDevicePushTokenAsync()).data;\r\n    await Analytics.updateEndpoint({\r\n        address: token,\r\n        channelType: 'APNS_SANDBOX',\r\n        userId: u.uid, // our apps userID\r\n        userAttributes: {\r\n            // CustomUserAttributes\r\n        },\r\n    });\r\n}\r\n```\r\n\r\nThis seems to be working and I can see the following details on pinpoint:\r\n\r\nMy APNS_Sandbox channel set up with auth (ive tried both using key and cert for auth this is example with key)\r\n```console\r\naws pinpoint get-apns-sandbox-channel --application-id XXXXXXX --region us-west-2 | jq .\r\n{\r\n  \"APNSSandboxChannelResponse\": {\r\n    \"ApplicationId\": \"XXXXXXX\",\r\n    \"CreationDate\": \"2021-02-03T18:57:11.845Z\",\r\n    \"DefaultAuthenticationMethod\": \"TOKEN\",\r\n    \"Enabled\": true,\r\n    \"HasCredential\": false,\r\n    \"HasTokenKey\": true,\r\n    \"Id\": \"apns_sandbox\",\r\n    \"IsArchived\": false,\r\n    \"LastModifiedDate\": \"2021-02-04T17:54:52.696Z\",\r\n    \"Platform\": \"APNS_SANDBOX\",\r\n    \"Version\": 5\r\n  }\r\n}\r\n```\r\n\r\nI can see this user endpoint  configured properly with stored device token I got from calling expo `await Notifications.getDevicePushTokenAsync()` \r\n\r\n```console\r\n aws pinpoint get-endpoint --application-id XXXX --endpoint-id XXX --region us-west-2\r\n{\r\n    \"EndpointResponse\": {\r\n        \"Address\": \"XXXX\", // Token from `getDevicePushTokenAsync`\r\n        \"ApplicationId\": \"XXXXX\",\r\n        \"Attributes\": {},\r\n        \"ChannelType\": \"APNS_SANDBOX\",\r\n        \"CohortId\": \"82\",\r\n        \"CreationDate\": \"2021-02-04T16:52:50.023Z\",\r\n        \"Demographic\": {\r\n            \"AppVersion\": \"ios/14.2.1\",\r\n            \"ModelVersion\": \"14.2.1\",\r\n            \"Platform\": \"ios\"\r\n        },\r\n        \"EffectiveDate\": \"2021-02-04T17:16:23.271Z\",\r\n        \"EndpointStatus\": \"ACTIVE\",\r\n        \"Id\": \"XXXXX\",\r\n        \"Location\": {},\r\n        \"Metrics\": {},\r\n        \"OptOut\": \"NONE\",\r\n        \"RequestId\": \"153d9ed1-6dd2-4472-8fc7-69514bc34ecc\",\r\n        \"User\": {\r\n            \"UserAttributes\": {\r\n                   //User Attributes here ......\r\n            },\r\n            \"UserId\": \"XXXX\"\r\n        }\r\n    }\r\n}\r\n```\r\n\r\nEvery time I try to send a push notification to that endpoint ID or devidToken I get the following error using AWS pinpoint send test notification page saying the device token is expired or not formatted correctly\r\n<img width=\"1602\" alt=\"BadDeviceTokenErrorRedacted\" src=\"https://user-images.githubusercontent.com/5491827/107126740-637cac80-6866-11eb-8264-7fd037f9a736.png\">\r\n\r\n\r\nMy question is has anyone else gotten set up this way working with AWS Amplify, Pinpoint, and Expo? I have not been able to work around this error. Is there a specific way to format the device token so that I can register it with pinpoint properly as address for users notifications? \r\n\r\nI have been looking online and cannot find anyone else doing like this yet exactly the way I'm doing yet but I feel like it should work and I am close. I have fallen back to using expo's hosted push notification service in mean time as stop gap but would much rather use pinpoint so I don't have to maintain back-end API to store expo push notification service token as well as so I can take advantage of Pinpoint managing push notifications and tying it all back together nicely with our analytics which were also currently sending to pinpoint.\r\n\r\nAny help/insight would be appreciated if someone else has gotten this working. 🙏 \r\n\r\nThanks!\r\n","upvoteCount":5,"comments":{"edges":[{"node":{"author":{"login":"magicmove"},"body":"Have the same problem and cant figure it out ! Did you found a solution ?"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDI4NTEz","author":{"login":"MedNabilEssefaihi"},"title":"Default FirebaseApp is not initialized in this process","body":"Dear network,\r\n\r\nI am try to use **push notification** with react native app\r\nI got this error when I tried to implement \r\n`import PushNotification from '@aws-amplify/pushnotification';`\r\n\r\nthis my code \r\n![3](https://user-images.githubusercontent.com/74948380/123259384-4df1e180-d4ec-11eb-809e-d8b0141c0773.png)\r\n\r\n\r\nthis is the error I got\r\n![Screenshot_20210624_130040_com nativerezervini](https://user-images.githubusercontent.com/74948380/123266206-b7c1b980-d4f3-11eb-9892-bb382362eb07.jpg)\r\n\r\n\r\n\r\n\r\n\r\nin this case I added\r\n\r\n```\r\n//connect to AWS\r\nAmplify.configure({...config, ...PushNotification._config}); \r\n```\r\n\r\nit works\r\nbut the problem is how to use it next to get a token and push notification ?\r\nin the documentation: https://docs.amplify.aws/lib/push-notifications/working-with-api/q/platform/js\r\n\r\nPushNotification has 3 functions, are onNotification, onRegister and onNotificationOpened \r\nbut in when I cheked the  PushNotification object, they did exist i find these:\r\n\r\n```\r\naddEventListenerForIOS: ƒ ()\r\nhandleNotificationOpened: ƒ ()\r\nhandleNotificationReceived: ƒ ()\r\nparseMessageData: ƒ (rawMessage)\r\nupdateEndpoint: ƒ ()\r\n_androidInitialized: true\r\n_checkIfOpenedByNotification: ƒ ()\r\n_config: {requestIOSPermissions: true, appId: \"xxxxxxxx\", aws_project_region: \"xxxxx\", aws_appsync_graphqlEndpoint: \"xxxxx\", aws_appsync_region: \"xxxx\", …}\r\n_currentState: \"active\"\r\n_iosInitialized: false\r\n_notificationOpenedHandlers: []\r\n__proto__: Object\r\n```","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDI3OTU2","author":{"login":"theJsTsGuy"},"title":"How to initialize amplify on gatsby ssr?","body":"Hi,\r\n\r\nI am currently trying to use aws-amplify with gatsby. The problem is when I initialize amplify on gatsby ssr file, I keep getting this error:\r\n\r\n![image](https://user-images.githubusercontent.com/40920737/123221092-01a4a280-d4e8-11eb-97e3-029f85f92fbe.png)\r\nIn terminal:\r\n![image](https://user-images.githubusercontent.com/40920737/123221332-46c8d480-d4e8-11eb-99b7-63d28769ae9b.png)\r\n\r\nI tried using hooks, checking `if typeof window !== \"undefined\"` but no success.\r\n\r\nHere is the link to the repo: https://github.com/theJsTsGuy/public-gatsby-issue-repo\r\n\r\nThanks in advance.\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMDExOA==","author":{"login":"Jahans3"},"title":"How to properly use TypeScript with DataStore query, observe, etc.?","body":"I'm having some issues using the provided type definitions for my DataStore models, happens using the models as generic arguments as well as using them explicitly.\r\n\r\nFor example, the below code produces the following errors: \r\n\r\n`TS2344: Type 'T' does not satisfy the constraint 'Readonly{ id: string; } & Record >'.`\r\n\r\n`TS2488: Type 'T' must have a '[Symbol.iterator]()' method that returns an iterator.`\r\n\r\n```ts\r\nexport function useModel<T>(\r\n  model: T,\r\n  predicate: string | ProducerModelPredicate<T> <--- Error TS2344\r\n): { data: T | Record<string, unknown>, loading: boolean, error: boolean } {\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(false);\r\n  const [data, setData] = useState({});\r\n\r\n  useEffect(() => {\r\n    const observable = DataStore.observe<T/* <--- Error TS2344 */>(model, predicate).subscribe(\r\n      (updatedModel) => {\r\n        setData(updatedModel.element ?? {});\r\n        setError(false);\r\n        setLoading(false);\r\n      }\r\n    );\r\n\r\n    DataStore.query<T/* <--- Error TS2344 */>(model, predicate)\r\n      .then(([queryResult]/* <--- Error TS2488 */) => {\r\n        setData(queryResult || {});\r\n        setError(false);\r\n        setLoading(false);\r\n      })\r\n      .catch(() => setError(true));\r\n\r\n    return () => observable.unsubscribe();\r\n  }, []);\r\n\r\n  return { data, loading, error };\r\n}\r\n```\r\n\r\nI get different errors if I use the models explicitly, like this:\r\n\r\n```ts\r\nconst observable = DataStore.observe<PersistentModelConstructor<User>/* <--- Error TS2344 */>(\r\n      model,\r\n      predicate\r\n    )\r\n```\r\n\r\nProduces: \r\n```\r\nTS2344: Type 'PersistentModelConstructor<User>' does not satisfy the constraint 'Readonly<{ id: string; } & Record<string, any>>'.   Property 'id' is missing in type 'PersistentModelConstructor<User>' but required in type 'Readonly<{ id: string; } & Record<string, any>>'.\r\n```\r\n\r\nAnd `query` using a model directly like this:\r\n\r\n```ts\r\nDataStore.query<User>(model/* <--- Error TS2769 */, predicate)\r\n```\r\n\r\nProduces this:\r\n```\r\nTS2769: No overload matches this call.   Overload 1 of 2, '(modelConstructor: PersistentModelConstructor<User>, id: string): Promise<User>', gave the following error.     Argument of type 'T' is not assignable to parameter of type 'PersistentModelConstructor<User>'.   Overload 2 of 2, '(modelConstructor: PersistentModelConstructor<User>, criteria?: typeof PredicateAll | ProducerModelPredicate<User> | undefined, pagination?: PaginationInput | undefined): Promise<...>', gave the following error.     Argument of type 'T' is not assignable to parameter of type 'PersistentModelConstructor<User>'.\r\n```\r\n\r\nAny tips would be really appreciated :)","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"gruckionvit"},"body":"Did you fix this?"}},{"node":{"author":{"login":"themse"},"body":"`TS2344: Type 'T' does not satisfy the constraint 'Readonly{ id: string; } & Record >'.` typescript will help you.  Discover error message.\r\nWith predicate typing, I also have type error and have temporary found workaround.\r\n```\r\nexport function useModel<T extends PersistentModel>(\r\n  model: PersistentModelConstructor<T>,\r\n  predicate?: ProducerModelPredicate<T>,\r\n  pagination?: ProducerPaginationInput<T>\r\n): { data: T | Record<string, unknown>, loading: boolean, error: boolean } {\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(false);\r\n  const [data, setData] = useState({});\r\n\r\n  useEffect(() => {\r\n    const observable = DataStore.observe<T>(model, predicate).subscribe(\r\n      (updatedModel) => {\r\n        setData(updatedModel.element ?? {});\r\n        setError(false);\r\n        setLoading(false);\r\n      }\r\n    );\r\n\r\n    DataStore.query<T>(model, predicate ?? Predicates.ALL, pagination)\r\n      .then(([queryResult]) => {\r\n        setData(queryResult || {});\r\n        setError(false);\r\n        setLoading(false);\r\n      })\r\n      .catch(() => setError(true));\r\n\r\n    return () => observable.unsubscribe();\r\n  }, []);\r\n\r\n  return { data, loading, error };\r\n}\r\n```\r\n\r\nLook up here for more details:\r\n`source code` - https://github.com/aws-amplify/amplify-js/blob/a047ce73/packages/datastore/src/datastore/datastore.ts#L802\r\n`data store api` - https://aws-amplify.github.io/amplify-js/api/classes/datastore.html"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDExOTcx","author":{"login":"ahouck"},"title":"TOTP MFA Setup not shown in AmplifyAuthenticator when set to Optional in Cognito","body":"If I create a pool where MFA is required (TOTP only) and insert a user via the AWS Console.  The first time that user logs in they are prompted with a QR Code to associate a device to their account.\r\n\r\nHowever if I do the same thing but configure the pool to have MFA `optional` there is nothing in the user's first time logging in to setup MFA.  Is there something I am missing?\r\n\r\nI'm using the `@aws-amplify/ui-react` package to interact with AWS Cognito.  The user pool has the below setup:\r\n\r\n1. MFA set to optional\r\n2. TOTP - enabled\r\n3. MFA via SMS - disabled\r\n4. Ability for users to sign themselves up - disabled\r\n\r\nAnd as the `AmplifyAuthenticator` setup is below.  \r\n\r\n\r\n```\r\nimport {\r\n  AmplifyAuthenticator,\r\n  AmplifySignIn,\r\n  AmplifySelectMfaType,\r\n} from '@aws-amplify/ui-react';\r\n\r\nconst RoutedApp = () => {\r\n  const { userSession } = useSession();\r\n\r\n  if (!userSession) {\r\n    return (\r\n      <Router>\r\n        <AmplifyAuthenticator>\r\n          <AmplifySignIn\r\n            slot=\"sign-in\"\r\n            hideSignUp\r\n            usernameAlias=\"email\"\r\n            formFields={[\r\n              {\r\n                type: 'email',\r\n                label: 'Email Address',\r\n                placeholder: 'Enter your email address',\r\n                required: true,\r\n                disabled: true,\r\n                value: cognito.email,\r\n              },\r\n              {\r\n                type: 'password',\r\n                label: 'Password',\r\n                placeholder: 'Enter your password',\r\n                required: true,\r\n              },\r\n            ]}\r\n          >\r\n            <AmplifySelectMfaType MFATypes={{ SMS: false, TOTP: true, Optional: true }} />\r\n          </AmplifySignIn>\r\n        </AmplifyAuthenticator>\r\n      </Router>\r\n    );\r\n  }\r\n  return <TopApplicationComponent />;\r\n};\r\n```","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"ahouck"},"body":"Should I file this as a bug?"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDI0MTg3","author":{"login":"MedNabilEssefaihi"},"title":"Does users device number have a limit to access to AWS Amplify project ?","body":"Dear network, \r\n\r\nI am using AWS Amplify with GraphQL API, cognito with auth and unauth users. I pass more than 150 users already. the problem is some of my users can't access to backend.\r\nDoes amplify have a limit of 100 subscriber ? if Yes. how to increase this number? if not, what's the problem of access ? \r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDE5Nzkx","author":{"login":"SKTest"},"title":"Angular app- AWS Amplify - Auth Error","body":"Hello all,\r\n\r\nI am new to amplify and went through this [tutorial ](https://docs.amplify.aws/start/getting-started/installation/q/integration/angular)to deploy a sample app. I am encountering the below error. I referred to multiple blogs and ensured that I do not have duplicates in node modules and that latest version of below are installed. Would appreciate any pointers on how to resolve this issue. Many Thanks!\r\n--- from package.json--\r\n\"@aws-amplify/ui-angular\": \"^1.0.12\",\r\n    \"aws-amplify\": \"^4.1.1\",\r\n    \"aws-amplify-angular\": \"^6.0.3\",\r\n--- \r\n\r\n[ERROR] 11:58.497 AuthError - \r\n            Error: Amplify has not been configured correctly. \r\n            The configuration object is missing required auth properties.\r\n            This error is typically caused by one of the following scenarios:\r\n\r\n            1. Did you run `amplify push` after adding auth via `amplify add auth`?\r\n                See https://aws-amplify.github.io/docs/js/authentication#amplify-project-setup for more information\r\n\r\n            2. This could also be caused by multiple conflicting versions of amplify packages, see (https://docs.amplify.aws/lib/troubleshooting/upgrading/q/platform/js) for help upgrading Amplify packages.\r\n\r\n\r\nRegards,\r\nSujith","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"SKTest"},"body":"Got a hint from another thread. Adding below to aws-exports.ts resolved the issue.  Though I am not sure how this would work if we are maintaining different pools for DEV, TEST and PROD. Should the exports file be modified every time before deploying to DEV/PROD.\r\n\r\n\"aws_cognito_region\": \"us-east-1\",\r\n    \"aws_user_pools_id\": \"us-east-1_<XXXXX>\",\r\n    \"aws_user_pools_web_client_id\": \"<xxxx>\"\r\n\r\nThanks,\r\nSujith."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDE3OTMy","author":{"login":"danielfdsilva"},"title":"Use ui-react without webpack","body":"Is it possible to use the ui-react package with another build system besides webpack?\r\n\r\nWhen I try to use the package (currently using Parcel) I get `Cannot find module './amplify-authenticator.cjs.entry.js'` when doing `import { AmplifyAuthenticator } from '@aws-amplify/ui-react';`\r\n\r\nFrom looking into the code this is happening because the components are lazy loaded using a dynamic require:\r\n\r\nFrom file: `@aws-amplify/ui-components/dist/cjs/index-6d44143a.js`\r\n![image](https://user-images.githubusercontent.com/1090606/122552005-a9742900-d02d-11eb-9fe6-c16bcedf7d89.png)\r\n\r\nThis seems to be the result of the way Stencil js is setup within Amplify, and I wasn't able to find a way to make this work\r\n\r\nIs there a way to load the components without using this dynamic require?\r\nHas anyone been through this?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDE1NDk5","author":{"login":"ChapterSevenSeeds"},"title":"Configuring a REST API with a Cognito authorizer and API Key","body":"Hello. In the Amplify CLI, is it possible to configure a REST API gateway to use both Cognito and an API Key for authorization? This image is what I'm looking to achieve: \r\n<img width=\"514\" alt=\"asdf2\" src=\"https://user-images.githubusercontent.com/63123355/122304879-2cc53b80-cec3-11eb-9802-19b72c723177.png\">\r\n\r\nNotice that the route that I screenshotted is using both Cognito as an authorizer and an API key is required. Is it possible to do this same thing in the Amplify CLI rather than in the AWS console? ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDEyMjc2","author":{"login":"ddurham2"},"title":"Is it possible to implement an additional authentication challenge with the prebuilt-UI","body":"I'm interested in protecting my SPA from bot's signing up.  Not wanting to require a phone number of my users, and not believing the email validation is a real protection, my first choice would be to initiate a re-captcha during authentication.\r\n\r\nThe word on the street is to use a lambda as the server side to receive and validate the challenge's response.  At some point in this flow you call Auth.signup/signin.  However, I'm using the prebuilt-UI for auth and that I'm never involved in such a call.\r\n\r\nSo, is it possible to insert a new challenge phase during authentication using the prebuilt UI?\r\n\r\nAre there alternatives, other than building all the UI myself and using the API?  Is doing a hybrid possible? i.e. signup involves a re-captcha, but signin, verify email, reset password, etc is still using the prebuilt UI?\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"ahouck"},"body":"You can also use TOTP MFA, this doesn't use a phone directly but some authenticator app like Authy or Google Authenticator.  If you mark it as required on your Cognito pool the setup is automatic and you don't have to do anything (assuming you are using the `@aws-amplify/ui-react` `AmplifyAuthenticator` component). However I am running into this issue (https://github.com/aws-amplify/amplify-js/discussions/8448) when trying to have it be optional.\r\n\r\nAs for captcha's directly. We implemented `react-google-recaptcha` (https://www.npmjs.com/package/react-google-recaptcha) its fairly straight forward plugging it into the `AmplifySignIn` component and overriding the `handleSubmit` to include the captcha info. "}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDEwMzk5","author":{"login":"gomesp"},"title":"withAuthenticator React HOC signupOptions vs. Authenticator formFields","body":"Hi team\r\n\r\nI am writing an app with a mix of public/protected content with Amplify (full public repo [here](https://github.com/gomesp/public-sample-app)). So, for that I have 2 sets of routes in my react-router:\r\n\r\n```javascript\r\nconst App = () => {\r\n  return (\r\n    <Router>\r\n      <Switch>\r\n        <Route path=\"/\" exact render={() => <Home />} />\r\n        <Route path=\"/dashboard\" render={() => <Dashboard />} />\r\n      </Switch>\r\n    </Router>\r\n  );\r\n};\r\n\r\nexport default App;\r\n```\r\n\r\nand\r\n\r\n```javascript\r\nconst Dashboard = () => {\r\n  return (\r\n    <>\r\n      <AmplifySignOut />\r\n      <h1>Dashboard</h1>\r\n      <hr />\r\n      <div>\r\n        <Switch>\r\n          <Route path=\"/dashboard\" exact render={() => <AdminDashboard />} />\r\n          <Route path=\"/dashboard/users\" exact render={() => <Users />} />\r\n        </Switch>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default withAuthenticator(Dashboard);\r\n```\r\n\r\nIn an app that is completely protected, I would usually make use of the ```AmplifyAuthenticator``` component instead of the ```withAuthenticator``` HOC, and here is where I don't know how to work out my issue.\r\n\r\nWhen using the ```AmplifyAuthenticator``` I can customise my signup fields however I like at ease. For example, bellow I added an additional field to the signup component and changed the default country code for the phone number field (following these [instructions](https://docs.amplify.aws/ui/auth/authenticator/q/framework/react#custom-form-fields)):\r\n\r\n```javascript\r\n<AmplifyAuthContainer>\r\n    <AmplifyAuthenticator usernameAlias=\"email\">\r\n    <AmplifySignUp\r\n        slot=\"sign-up\"\r\n        usernameAlias=\"email\"\r\n        formFields={[\r\n        {\r\n            type: \"name\",\r\n            label: \"Full Name *\",\r\n            placeholder: \"Enter your full name\",\r\n            inputProps: { required: true, autocomplete: \"name\" },\r\n        },\r\n        {\r\n            type: \"email\",\r\n            inputProps: { required: true, autocomplete: \"username\" },\r\n        },\r\n        {\r\n            type: \"password\",\r\n            inputProps: { required: true, autocomplete: \"new-password\" },\r\n        },\r\n        {\r\n            type: \"phone_number\",\r\n            dialCode: \"+64\",\r\n        },\r\n        ]}\r\n    />\r\n    <AmplifySignIn slot=\"sign-in\" usernameAlias=\"email\" />\r\n    <App />\r\n    </AmplifyAuthenticator>\r\n</AmplifyAuthContainer>\r\n```\r\n\r\nI cannot find a way in the documentation to do the same configuration using the ```withAuthenticator``` HOC. I have been trying to pass the ```signupConfig``` object as a parameter to it, but the [documentation](https://docs.amplify.aws/ui/auth/authenticator/q/framework/react#props-attr-amplify-authenticator) does not show me how to add fields or change attributes like the country dialCode like above? Am I missing something here?\r\n\r\nThanks!","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"gomesp"},"body":"It turns out that the ```withAuthenticator``` HOC had a bunch of attributes deprecated. I achieved the same outcome with the following code:\r\n\r\n```javascript\r\nconst SignedInDashboard = ({ username }) => {\r\n  return (\r\n    <>\r\n      <h1>Dashboard</h1>\r\n      <hr />\r\n      <div>\r\n        <div>Hello, {username}</div>\r\n        <AmplifySignOut />\r\n      </div>\r\n      <div>\r\n        <Switch>\r\n          <Route path=\"/dashboard\" exact render={() => <AdminDashboard />} />\r\n          <Route path=\"/dashboard/users\" exact render={() => <Users />} />\r\n        </Switch>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nconst SignedOutDashboard = () => {\r\n  return (\r\n    <AmplifyAuthenticator usernameAlias=\"email\">\r\n      <AmplifySignUp\r\n        slot=\"sign-up\"\r\n        usernameAlias=\"email\"\r\n        formFields={[\r\n          {\r\n            type: \"name\",\r\n            label: \"Full Name *\",\r\n            placeholder: \"Enter your full name\",\r\n            inputProps: { required: true, autocomplete: \"name\" },\r\n          },\r\n          {\r\n            type: \"email\",\r\n            inputProps: { required: true, autocomplete: \"username\" },\r\n          },\r\n          {\r\n            type: \"password\",\r\n            inputProps: { required: true, autocomplete: \"new-password\" },\r\n          },\r\n          {\r\n            type: \"phone_number\",\r\n            dialCode: \"+64\",\r\n          },\r\n        ]}\r\n      />\r\n      <AmplifySignIn slot=\"sign-in\" usernameAlias=\"email\" />\r\n    </AmplifyAuthenticator>\r\n  );\r\n};\r\n\r\nconst Dashboard = () => {\r\n  const [authState, setAuthState] = React.useState();\r\n  const [user, setUser] = React.useState();\r\n\r\n  React.useEffect(() => {\r\n    return onAuthUIStateChange((nextAuthState, authData) => {\r\n      setAuthState(nextAuthState);\r\n      setUser(authData);\r\n    });\r\n  }, []);\r\n\r\n  return authState === AuthState.SignedIn && user ? (\r\n    <SignedInDashboard username={user.username} />\r\n  ) : (\r\n    <SignedOutDashboard />\r\n  );\r\n};\r\n\r\nexport default Dashboard;\r\n```"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDEwOTUz","author":{"login":"rahulnainwal107"},"title":"Cannot convert undefined or null to object","body":"I am getting and error cannot convert undefined or null to object when i am trying to create Photo record using Photo modal in my project. All what i am trying to do is creating multiple record using promise.all getting this error.\r\nComplete error\r\nCannot convert undefined or null to object\r\n    at Function.getPrototypeOf (<anonymous>)\r\n    at storage.js:159\r\n    at Array.forEach (<anonymous>)\r\n    at StorageClass.<anonymous> (storage.js:143)\r\n    at step (tslib.js:141)\r\n    at Object.next (tslib.js:122)\r\n    at fulfilled (tslib.js:112)\r\n    at tryCallOne (core.js:37)\r\n    at core.js:123\r\n    at JSTimers.js:274\r\n    \r\n  What i am trying: I have an array of images on which i am using map\r\n  \r\n  const photosPromise = newPhotoData.map((item) =>\r\n          DataStore.save(new Photo(item)),\r\n        );\r\n        const newPhotos = await Promise.all(photosPromise);\r\n        \r\n        After that i am getting this error. I think issue is there DataStore.save(new Photo(item)).","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb245Mzc4","author":{"login":"shaungc-su"},"title":"Setting Default Country Code for Phone","body":"Hi guys, our team is trying to upgrade from `aws-amplify-react` to the latest `@aws-amplify/ui-react`. We are using the HOC `withAuthenticator()` for including the SignUp/Login/.. UI. However, I can't find a way to configure default country code for phone number in the new package `@aws-amplify/ui-react`.\r\n\r\nPreviously, `withAuthenticator()` from package `aws-amplify-react` will allow you to set the default country code via the 2nd argument `authenticatorProps` like this:\r\n\r\n```js\r\nconst signUpConfig = {\r\n  defaultCountryCode: '1' // set default country code for phone number \r\n}\r\nexport default withAuthenticator(Dashboard, { signUpConfig });\r\n```\r\n\r\nHowever, for the new `withAuthenticator()` in package `@aws-amplify/ui-react`, the field `signUpConfig` no longer exists on `authenticatorProps`, so I can't find a way to set the default country code.\r\n\r\nThe [doc contains some info about migration](https://docs.amplify.aws/ui/auth/authenticator/q/framework/react#migration) for `withAuthenticator()`, but it eventually just links to the new property spec for `withAuthenticator()` and does not contain info about how to deal with fields that are removed, what alternatives we should go for, etc. So I'm not even sure if there's an option for this somewhere in `ui-react` or not. \r\n\r\nDoes anyone know what is the way to set the default country code?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"gomesp"},"body":"Hi @shaungc-su did you get a solution for this?"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMDA3NzQy","author":{"login":"regenrek"},"title":"Amplify Auth SSR Cache  (with Nuxt.js)","body":"Hi,\r\n\r\n### Problem:\r\n\r\nIf `Cache-Control` for an application is enabled we experience shared User Logins. So user1 is logged in and a second stranger user2 is logged in with user1 account.\r\n\r\n```\r\n  res.setHeader('Cache-Control', 's-maxage=10, stale-while-revalidate')\r\n```\r\n\r\n### Demo for Reproduce:\r\n\r\nI've created a small boilerplate with two demo links:\r\n\r\nhttps://nuxt-aws-amplify-auth-bepxlqbvg.vercel.app/ (no cache)\r\nhttps://nuxt-aws-amplify-auth-o76ccy6cd.vercel.app/ (cache enabled -> stranger login problem)\r\n\r\n[Github Repo](https://github.com/regenrek/nuxt-aws-amplify-auth)\r\n\r\n1. Login with a user account.\r\n2. Open page in a new icognito tab and see how users are logged in.\r\n\r\n ### Code snippets.\r\n\r\nBasically nuxt has a `nuxtServerInit` function (only server-side) where we ask for a loggedin user.\r\n\r\n```js\r\n  async nuxtServerInit({ dispatch }, ctx) {\r\n    // check if user is logged in  \r\n    try {\r\n      const { Auth } = withSSRContext(ctx)\r\n      const cognitoUser = await Auth.currentAuthenticatedUser()\r\n      // save current user in store\r\n     } catch(e) {\r\n      console.error('No User found', error)\r\n     }\r\n  },\r\n```\r\n\r\n### Solutions\r\n\r\nI'm a bit lost at this point in how to solve this issue.\r\n\r\n1. Move everything to clientside and ignore Server Side authentication. This is probably the easiest approach but you will experience some delays with for example protected routes. For example, if you not loggedin and navigate to the route `/restricted` you will get redirected a few seconds later.\r\n\r\n2. Disable API Caching. Using `Cache-Control: Private` for API routes to avoid Caching a response. But I'm not sure how I can control this with amplify/cognito . Would appreciate some examples here. What I've done so far is excluding /auth routes from caching but this didn't work since you need auth state on every page. \r\n\r\n3. Using a service worker. Maybe the best approach but I couldn't find some suitable example for using a service worker with amplify in terms of auth. Firebase has some similar approach here https://firebase.nuxtjs.org/tutorials/ssr\r\n\r\n\r\nThank you in advance\r\nRegards!\r\n\r\n","upvoteCount":3,"comments":{"edges":[{"node":{"author":{"login":"shresthapradip"},"body":"Are you able to fix this issue? Having same issue"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDA0ODQ2","author":{"login":"bajcmartinez"},"title":"Getting 401 Access Denied when deploying Next.JS SSR app","body":"Hi all,\r\n\r\nI built a Next.JS app that works perfectly locally or when deployed to other providers, however, when adding hosting to amplify it does not recognize the app as SSR, and thus after successful deployment and visiting the website I get the following error:\r\n\r\n```\r\n<Error>\r\n<Code>AccessDenied</Code>\r\n<Message>Access Denied</Message>\r\n<RequestId>K5GXFGXAV81V53SN</RequestId>\r\n<HostId>K+w3b/dy/7tpI8zHcDzKeMmRQpzWKoSADXyn9t7c87skIyiFOqpBQY/CranewHI5/Qu8d8Nh/Uw=</HostId>\r\n</Error>\r\n```\r\n\r\nThe app is a mix of static pages, incremental site generation pages, and server-side rendered pages, with 2 API endpoints for now.\r\n\r\nHere is the build log:\r\n\r\n```\r\n2021-06-09T09:03:52.557Z [INFO]: # Starting phase: preBuild\r\n                                 # Executing command: npm ci\r\n2021-06-09T09:03:52.878Z [WARNING]: npm\r\n2021-06-09T09:03:52.879Z [WARNING]: WARN\r\n2021-06-09T09:03:52.879Z [WARNING]: prepare removing existing node_modules/ before installation\r\n2021-06-09T09:03:59.680Z [INFO]: > cypress@7.5.0 postinstall /codebuild/output/src512330736/src/jobs-app/node_modules/cypress\r\n                                 > node index.js --exec install\r\n2021-06-09T09:04:00.040Z [INFO]: \r\n2021-06-09T09:04:00.040Z [INFO]: Cypress 7.5.0 is installed in /root/.cache/Cypress/7.5.0\r\n2021-06-09T09:04:00.041Z [INFO]: \r\n2021-06-09T09:04:00.058Z [INFO]: added 919 packages in 7.205s\r\n2021-06-09T09:04:00.067Z [INFO]: # Completed phase: preBuild\r\n2021-06-09T09:04:00.068Z [INFO]: # Starting phase: build\r\n                                 # Executing command: npm run build\r\n2021-06-09T09:04:00.230Z [INFO]: > jobs-app@1.0.0 build /codebuild/output/src512330736/src/jobs-app\r\n                                 > next build\r\n2021-06-09T09:04:00.774Z [INFO]: info  - Using webpack 5. Reason: no custom webpack configuration in next.config.js https://nextjs.org/docs/messages/webpack5\r\n2021-06-09T09:04:00.881Z [WARNING]: warn  - Detected next.config.js, no exported configuration found. https://nextjs.org/docs/messages/empty-configuration\r\n2021-06-09T09:04:00.883Z [INFO]: warn  - No build cache found. Please configure build caching for faster rebuilds. Read more: https://nextjs.org/docs/messages/no-cache\r\n2021-06-09T09:04:00.916Z [INFO]: Attention: Next.js now collects completely anonymous telemetry regarding usage.\r\n2021-06-09T09:04:00.917Z [INFO]: This information is used to shape Next.js' roadmap and prioritize features.\r\n                                 You can learn more, including how to opt-out if you'd not like to participate in this anonymous program, by visiting the following URL:\r\n                                 https://nextjs.org/telemetry\r\n2021-06-09T09:04:00.950Z [INFO]: info  - Checking validity of types...\r\n2021-06-09T09:04:05.890Z [INFO]: info  - Creating an optimized production build...\r\n2021-06-09T09:04:36.519Z [INFO]: info  - Compiled successfully\r\n2021-06-09T09:04:36.521Z [INFO]: info  - Collecting page data...\r\n2021-06-09T09:04:37.776Z [INFO]: info  - Generating static pages (0/8)\r\n2021-06-09T09:04:38.770Z [INFO]: info  - Generating static pages (2/8)\r\n2021-06-09T09:04:38.828Z [INFO]: info  - Generating static pages (4/8)\r\n2021-06-09T09:04:38.889Z [INFO]: info  - Generating static pages (6/8)\r\n2021-06-09T09:04:39.157Z [INFO]: info  - Generating static pages (8/8)\r\n2021-06-09T09:04:39.157Z [INFO]: info  - Finalizing page optimization...\r\n2021-06-09T09:04:39.161Z [INFO]: \r\n2021-06-09T09:04:39.171Z [INFO]: Page                                Size     First Load JS\r\n                                 ┌ ● / (ISR: 60 Seconds)             7.22 kB         415 kB\r\n                                 ├   /_app                           0 B             367 kB\r\n                                 ├ ○ /404                            3.82 kB         371 kB\r\n                                 ├ ○ /about                          3.59 kB         371 kB\r\n                                 ├ λ /api/checkout                   0 B             367 kB\r\n                                 ├ λ /api/stripe-webhooks            0 B             367 kB\r\n                                 ├ λ /listings/[listingId]           3.5 kB          412 kB\r\n                                 ├ ● /post-job (ISR: 60 Seconds)     59.7 kB         468 kB\r\n                                 ├   └ css/33ad5f8d63222286290d.css  1.55 kB\r\n                                 ├ ○ /privacy-policy                 18.4 kB         385 kB\r\n                                 ├ ○ /terms-of-service               3.46 kB         406 kB\r\n                                 └ ○ /thanks                         4 kB            371 kB\r\n                                 + First Load JS shared by all       367 kB\r\n                                 ├ chunks/framework.2f6124.js      42.4 kB\r\n                                 ├ chunks/main.c8b51c.js           19.5 kB\r\n                                 ├ chunks/pages/_app.c0a762.js     304 kB\r\n                                 ├ chunks/webpack.277c75.js        1.04 kB\r\n                                 └ css/71656b30ed78cc000fee.css    6.29 kB\r\n2021-06-09T09:04:39.172Z [INFO]: λ  (Server)  server-side renders at runtime (uses getInitialProps or getServerSideProps)\r\n                                 ○  (Static)  automatically rendered as static HTML (uses no initial props)\r\n                                 ●  (SSG)     automatically generated as static HTML + JSON (uses getStaticProps)\r\n                                 (ISR)     incremental static regeneration (uses revalidate in getStaticProps)\r\n2021-06-09T09:04:39.391Z [INFO]: # Completed phase: build\r\n2021-06-09T09:04:39.392Z [INFO]: ## Build completed successfully\r\n2021-06-09T09:04:39.393Z [INFO]: # Starting caching...\r\n2021-06-09T09:04:39.483Z [INFO]: Creating cache artifact...\r\n2021-06-09T09:04:45.298Z [INFO]: # Cache artifact is: 389MB\r\n2021-06-09T09:04:45.448Z [INFO]: # Uploading cache artifact...\r\n```\r\n\r\nAnd the deployment log:\r\n\r\n```\r\n2021-06-09T09:05:39 [INFO]: Beginning deployment for application d3j1pf4ne60orh, branch:dev, buildId 0000000011\r\n2021-06-09T09:05:39 [INFO]: Got archive: 18030319 bytes\r\n2021-06-09T09:05:39 [INFO]: Archive unzipped: 61 files\r\n2021-06-09T09:05:42 [INFO]: Deployment complete\r\n```\r\n\r\nI believe the deployment log is already wrong, as it should be adding some information about lambdas@edge being deployed and it does not.\r\n\r\nLately, here is my build log:\r\n\r\n```\r\nversion: 1\r\nbackend:\r\n  phases:\r\n    build:\r\n      commands:\r\n        - '# Execute Amplify CLI with the helper script'\r\n        - amplifyPush --simple\r\nfrontend:\r\n  phases:\r\n    preBuild:\r\n      commands:\r\n        - npm ci\r\n    build:\r\n      commands:\r\n        - npm run build\r\n  artifacts:\r\n    baseDirectory: .next\r\n    files:\r\n      - '**/*'\r\n  cache:\r\n    paths:\r\n      - node_modules/**/*\r\ntest:\r\n  artifacts:\r\n    baseDirectory: cypress\r\n    configFilePath: \"**/mochawesome.json\"\r\n    files:\r\n      - \"**/*.png\"\r\n      - \"**/*.mp4\"\r\n  phases:\r\n    preTest:\r\n      commands:\r\n        - npm install\r\n        - npm install wait-on\r\n        - npm install mocha mochawesome mochawesome-merge mochawesome-report-generator\r\n        - \"npm start & npx wait-on http://127.0.0.1:3000\"\r\n    test:\r\n      commands:\r\n        - 'npx cypress run --reporter mochawesome --reporter-options \"reportDir=cypress/report/mochawesome-report,overwrite=false,html=false,json=true,timestamp=mmddyyyy_HHMMss\"'\r\n    postTest:\r\n      commands:\r\n        - npx mochawesome-merge@4 cypress/report/mochawesome-report/*.json > cypress/report/mochawesome.json\r\n```\r\n\r\nNot sure what to do, could be a bug on the Amplify side, but not sure how to register it. I generated a technical support ticket on AWS, but so far havent' heard anything.\r\n\r\nThanks","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDAzNDA2","author":{"login":"nomoreboredom"},"title":"how to use Content-MD5 when using S3.Put","body":"i would like to verify the integrity of the file, however cant seem to be able to attach Content-MD5 header to the request when calling s3.Put. Any ideas?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNDAwMTI3","author":{"login":"FrapperColin"},"title":"PreventUserExistenceErrors throw \"too\" generic error message","body":"Hello, \r\nI have a question when using API Auth with aws-amplify.\r\nI have an App client with the security configuration set to legacy, when I call the signIn API like this in your example with wrong user parameter\r\n```\r\nasync function signIn() {\r\n    try {\r\n        const user = await Auth.signIn(username, password);\r\n    } catch (error) {\r\n        console.log('error signing in', error);\r\n    }\r\n}\r\n```\r\nI get an error like this ;\r\n`{\r\n    \"code\": \"UserNotFoundException\",\r\n    \"name\": \"UserNotFoundException\",\r\n    \"message\": \"User does not exist.\"\r\n}`\r\nwhich is quite correct but in my opinion lead to security issue. I guess that is why there is another option inside security configuration which is PreventUserExistenceErrors, that's good when making the same call above we now got the classic \r\n```\r\n{\r\n  \"code\": \"NotAuthorizedException\",\r\n  \"name\": \"NotAuthorizedException\",\r\n  \"message\": \"Incorrect username or password.\"\r\n}\r\n```\r\nThe problem I got is whenever there is an user in FORCE_CHANGE_PASSWORD, the legacy security conf throw an error for those use case \r\n`// When user is in account status FORCE_CHANGE_PASSWORD but the code sent is expired\r\n{\r\n  \"code\": \"NotAuthorizedException\",\r\n  \"name\": \"NotAuthorizedException\",\r\n  \"message\": \"Temporary password has expired and must be reset by an administrator.\"\r\n}\r\n \r\n// when user is in account status RESET_REQUIRED => should design special message to tell him to use the forgot password flow\r\n{\r\n  \"code\": \"PasswordResetRequiredException\",\r\n  \"name\": \"PasswordResetRequiredException\",\r\n  \"message\": \"Password reset required for the user\"\r\n}\r\n `\r\nBut when setting PreventUserExistenceErrors option, it always throw the same message saying that Incorrect username or password which is quite terrible in terms of UI :/ do you have any advice about this ? \r\n\r\nI understand that security always come with a price in terms of UI but still, the fact that we cannot even say to the user that the temporary password has expired and should contact the support is quite hard\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzk3ODI2","author":{"login":"reberthkss"},"title":"Warning during 'npx amplify-app@lastest'","body":"I got the logging warning below, tried find something about but without success. Does someone know about it?\r\n\r\nnpm WARN invalid config only=\"dev\" set in command line options\r\nnpm WARN invalid config Must be one of: null, prod, production\r\n\r\n![image](https://user-images.githubusercontent.com/54030471/120891115-1f63a380-c5dd-11eb-8ea3-95990583a463.png)\r\n","upvoteCount":3,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzk1Njg3","author":{"login":"slimandslam"},"title":"Syntax for Amplify-JS REST call using temporary credentials?","body":"I've generated temp credentials for the UNauthenticated Cognito user. That required using three calls:\r\nGetIdCommand()\r\nGetOpenIdTokenCommand()\r\nAssumeRoleWithWebIdentityCommand()\r\nI had to use the Cognito UNauthenticated role ARN, as well as the Identity Pool ID. \r\n\r\nNow, I want to use Amplify-JS to make REST calls using these generated credentials:\r\nconst tempCredentials = {\r\n      accessKeyId: AccessKeyId,\r\n      secretAccessKey: SecretAccessKey,\r\n      sessionToken: SessionToken,\r\n    };\r\n\r\nWhat is the syntax for such a call?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzk0OTAy","author":{"login":"kannieWeesNie"},"title":"DataStore syncExpression change filter at runtime","body":"Hi\r\nI can successfully use a syncExpression and change the filter at runtime by changing the field value. So, in my case I have an Order model and use the customerId as the filter. I can then, at runtime switch between the different customers and get the relevant orders associated with that customer.\r\n\r\nI can do the same by using the merchantId as a filter and change it at runtime to get the orders associated with that particular merchant.\r\n\r\nwhat I would like to do and would appreciate some help here, is to switch at runtime between the customerId and merchantId filters. As the syncExpressions \"get evaluated whenever DataStore starts\" and there can only be one syncExpression per model, how do I swop between the two filters?\r\n\r\nI've tried this:\r\n\r\n`syncExpression(Order, () => {\r\n      if (this.stateCognitoGroup.isCustomer) {\r\n        return order => order.customerId('eq', customer_id)\r\n      } else if (this.stateCognitoGroup.isMerchant) {\r\n        return order => order.merchantId('eq', merchant_id)\r\n      }\r\n    })`\r\n\r\nwhich unsurprisingly does not work. How can I accomplish this?\r\n\r\nthanks","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzkzOTg5","author":{"login":"shaunhurley"},"title":"amazon-cognito-identity-js callback consistency...","body":"Hey folks,\r\n\r\nMainly curious about a design decision that appears to have been made around structure of callbacks in the amazon-cognito-identity-js library (and possibly elsewhere).\r\n\r\nThe majority of functions (and examples) use a pretty generic callback structure such as:\r\n```\r\nfunction(err, result) {\r\n\tif (err) {\r\n\t\talert(err.message || JSON.stringify(err));\r\n\t\treturn;\r\n\t}\r\n\tconsole.log('call result: ' + result);\r\n}\r\n```\r\nThen a couple of specific functions (I'm looking at you, authenicateUser!) go and pass in a collection of callbacks such as this:\r\n```\r\n{\r\n\tonSuccess: function(result) {\r\n\t\tconsole.log('call result: ' + result);\r\n\t},\r\n\tonFailure: function(err) {\r\n\t\talert(err.message || JSON.stringify(err));\r\n\t},\r\n}\r\n```\r\nDoes anyone have the time to explain why the variation?  Why authenticateUser couldn't be adequately served by a function(err, result){} call for consistency?\r\n\r\nCheers!\r\n\r\nShaun","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNzY0OA==","author":{"login":"ramakrishnan"},"title":"Pagination in Datastore sync","body":"Datastore can be configured to take `maxRecordsToSync`\r\nConsider `maxRecordsToSync` is set to `1000` and there are `10000` documents in the model to get synced to local IndexedDB.\r\nWhen a sync happens DataStore will only fetch `1000` as per `maxRecordsToSync` and sets a `mextToken` value.\r\n\r\nCan I know how to use the nextToken and perform the remaining sync to get all the `10000` documents to local.\r\n\r\nOn a side note does the pagination follow any order? (ie) the documents should be sorted in an order to maintain uniqueness across each paginated set. ","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"mcshiz"},"body":"Does datastore automatically fetch all 10,000 records by using the nextToken? Or is the client code responsible for using the next token to fetch all records?"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzkwMzE1","author":{"login":"abdulqudoos"},"title":"Unable to query many to many relationship as mentioned in amplify datastore docs.","body":"\r\ntype Company\r\n  @model\r\n  @auth(rules: [{ allow: owner }, { allow: groups, groupsField: \"invites\" }]) {\r\n  id: ID!\r\n  name: String\r\n  users: [UserCompany] @connection(keyName: \"byCompany\", fields: [\"id\"])\r\n  reference: String\r\n  description: String\r\n  location: String\r\n}\r\n\r\n\r\n\r\n\r\ntype UserCompany\r\n  @model\r\n  @key(name: \"byOwner\", fields: [\"owner\"])\r\n  @key(name: \"byUser\", fields: [\"userID\", \"companyID\"])\r\n  @key(name: \"byCompany\", fields: [\"companyID\", \"userID\"])\r\n  @auth(\r\n    rules: [{ allow: owner }, { allow: groups, groupsField: \"accessors\" }]\r\n  ) {\r\n  id: ID!\r\n  userID: ID\r\n  companyID: ID\r\n  user: User! @connection(fields: [\"userID\"])\r\n  company: Company! @connection(fields: [\"companyID\"])\r\n  owner: String\r\n  accessors: [String]\r\n}\r\n\r\ntype User\r\n  @model\r\n  @aws_api_key\r\n  @aws_cognito_user_pools\r\n  @auth(\r\n    rules: [\r\n      { allow: public, provider: apiKey }\r\n      { allow: owner }\r\n      { allow: groups, groupsField: \"user_group\" }\r\n      { allow: groups, groupsField: \"tenant_group\" }\r\n      { allow: groups, groups: [\"SuperAdmin\"] }\r\n    ]\r\n  ) {\r\n  id: ID!\r\n  company_name: String\r\n  company_address: String\r\n  contact_name: String\r\n  profile_image: String\r\n  email: String\r\n  phone: String  \r\n  UserCompanys: [UserCompany]\r\n    @connection(keyName: \"byUser\", fields: [\"id\"])  \r\n  owner: String\r\n  tenant_group: [String]\r\n  user_group: String\r\n  createdAt: AWSDateTime\r\n  updatedAt: AWSDateTime\r\n};\r\n\r\n\r\n\r\nI was getting UserCompany like this\r\n\r\nthis.users = (await DataStore.query(UserCompany)).filter(\r\n      (item) => item.user.id === id\r\n    );\r\n    \r\n    \r\n    and it was working fine\r\n    but from last Friday suddenly I am facing this error.\r\n    \r\n    \r\n    core.js:6140 ERROR Error: Uncaught (in promise): Error: Field user is required\r\nError: Field user is required\r\n    at datastore.js:219\r\n    at datastore.js:276\r\n    at Array.forEach (<anonymous>)\r\n    at initializeInstance (datastore.js:274)\r\n    at datastore.js:284\r\n    at e.i.produce (immer.esm.js:1)\r\n    at new UserCompany (datastore.js:283)\r\n    at IndexedDBAdapter.modelInstanceCreator (datastore.js:211)\r\n    at IndexedDBAdapter.js:516\r\n    at Array.map (<anonymous>)\r\n    at resolvePromise (zone-evergreen.js:798)\r\n    at zone-evergreen.js:705\r\n    at rejected (tslib.es6.js:74)\r\n    at ZoneDelegate.invoke (zone-evergreen.js:364)\r\n    at Object.onInvoke (core.js:28513)\r\n    at ZoneDelegate.invoke (zone-evergreen.js:363)\r\n    at Zone.run (zone-evergreen.js:123)\r\n    at zone-evergreen.js:857\r\n    at ZoneDelegate.invokeTask (zone-evergreen.js:399)\r\n    at Object.onInvokeTask (core.js:28500)\r\n    \r\nAfter this error system is unable to run other functions.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"abdulqudoos"},"body":"> type Company\r\n> @model\r\n> @auth(rules: [{ allow: owner }, { allow: groups, groupsField: \"invites\" }]) {\r\n> id: ID!\r\n> name: String\r\n> users: [UserCompany] @connection(keyName: \"byCompany\", fields: [\"id\"])\r\n> reference: String\r\n> description: String\r\n> location: String\r\n> }\r\n> \r\n> type UserCompany\r\n> @model\r\n> @key(name: \"byOwner\", fields: [\"owner\"])\r\n> @key(name: \"byUser\", fields: [\"userID\", \"companyID\"])\r\n> @key(name: \"byCompany\", fields: [\"companyID\", \"userID\"])\r\n> @auth(\r\n> rules: [{ allow: owner }, { allow: groups, groupsField: \"accessors\" }]\r\n> ) {\r\n> id: ID!\r\n> userID: ID\r\n> companyID: ID\r\n> user: User! @connection(fields: [\"userID\"])\r\n> company: Company! @connection(fields: [\"companyID\"])\r\n> owner: String\r\n> accessors: [String]\r\n> }\r\n> \r\n> type User\r\n> @model\r\n> @aws_api_key\r\n> @aws_cognito_user_pools\r\n> @auth(\r\n> rules: [\r\n> { allow: public, provider: apiKey }\r\n> { allow: owner }\r\n> { allow: groups, groupsField: \"user_group\" }\r\n> { allow: groups, groupsField: \"tenant_group\" }\r\n> { allow: groups, groups: [\"SuperAdmin\"] }\r\n> ]\r\n> ) {\r\n> id: ID!\r\n> company_name: String\r\n> company_address: String\r\n> contact_name: String\r\n> profile_image: String\r\n> email: String\r\n> phone: String\r\n> UserCompanys: [UserCompany]\r\n> @connection(keyName: \"byUser\", fields: [\"id\"])\r\n> owner: String\r\n> tenant_group: [String]\r\n> user_group: String\r\n> createdAt: AWSDateTime\r\n> updatedAt: AWSDateTime\r\n> };\r\n> \r\n> I was getting UserCompany like this\r\n> \r\n> this.users = (await DataStore.query(UserCompany)).filter(\r\n> (item) => item.user.id === id\r\n> );\r\n> \r\n> ```\r\n> and it was working fine\r\n> but from last Friday suddenly I am facing this error.\r\n> \r\n> \r\n> core.js:6140 ERROR Error: Uncaught (in promise): Error: Field user is required\r\n> ```\r\n> \r\n> Error: Field user is required\r\n> at datastore.js:219\r\n> at datastore.js:276\r\n> at Array.forEach ()\r\n> at initializeInstance (datastore.js:274)\r\n> at datastore.js:284\r\n> at e.i.produce (immer.esm.js:1)\r\n> at new UserCompany (datastore.js:283)\r\n> at IndexedDBAdapter.modelInstanceCreator (datastore.js:211)\r\n> at IndexedDBAdapter.js:516\r\n> at Array.map ()\r\n> at resolvePromise (zone-evergreen.js:798)\r\n> at zone-evergreen.js:705\r\n> at rejected (tslib.es6.js:74)\r\n> at ZoneDelegate.invoke (zone-evergreen.js:364)\r\n> at Object.onInvoke (core.js:28513)\r\n> at ZoneDelegate.invoke (zone-evergreen.js:363)\r\n> at Zone.run (zone-evergreen.js:123)\r\n> at zone-evergreen.js:857\r\n> at ZoneDelegate.invokeTask (zone-evergreen.js:399)\r\n> at Object.onInvokeTask (core.js:28500)\r\n> \r\n> After this error system is unable to run other functions.\r\n\r\nIssue solved"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzkxNTQ0","author":{"login":"Sandeepbadri"},"title":"How to logout when refresh token has expired","body":"I am using react and react-router for my project. I am able to observe that when refresh token has expired and I am making an API call using amplify, I'm getting Network error as response every time. I know why this is happening. It's because whenever refresh token expires, all tokens in local storage are deleted hence when an API call is made without any tokens I get Network error. But I have implemented amplify in react-native but there I would get response with status code 403 so I could handle it there easily. Do I have any other way to detect whether refresh token has expired or not and logout the user from the app? Please help me with this  ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzkxNDE0","author":{"login":"Anupamchap"},"title":"[ERROR] 18:14.429 OAuth - Error handling auth response. [TypeError: Network request failed]","body":"On react-native application, We are trying to implement social sign-in. For IOS it's working fine, but for android after Google or Facebook sign in, I am getting below error and application is getting crashed. Please let me know what mistake I am doing.\r\n\r\n```\r\n[Tue Jun 01 2021 16:18:11.689]  LOG      cognito parsingCallbackUrl {\"url\": null}\r\n[Tue Jun 01 2021 16:18:11.690]  LOG      parsingCallbackUrl {\"url\": null}\r\n[Tue Jun 01 2021 16:18:13.581]  LOG      URLS https://myappf2077acb-f2077acb-dev.auth.ap-southeast-1.amazoncognito.com/oauth2/authorize?redirect_uri=myapp%3A%2F%2F&response_type=code&client_id=7kpeug5cf2tdb7ri3n1tceubrb&identity_provider=Google&scope=phone%20email%20openid%20profile%20aws.cognito.signin.user.admin&state=eXavpAJAD7x8RhGY5HQQGuHV1BMjOrfS&code_challenge=9jig9ys6LEqbuWlcHKbFoaGvnBISoFqYHN7VICSwwPo&code_challenge_method=S256 Redirect myapp://\r\n[Tue Jun 01 2021 16:18:14.793]  LOG      cognito parsingCallbackUrl {\"url\": \"myapp://?code=210db3a4-1e90-4a64-b16d-1bb4c45d2760&state=eXavpAJAD7x8RhGY5HQQGuHV1BMjOrfS\"}\r\n[Tue Jun 01 2021 16:18:14.794]  LOG      parsingCallbackUrl {\"url\": \"myapp://?code=210db3a4-1e90-4a64-b16d-1bb4c45d2760&state=eXavpAJAD7x8RhGY5HQQGuHV1BMjOrfS\"}\r\n[Tue Jun 01 2021 16:18:14.797]  LOG      cognito codeFlow {}\r\n[Tue Jun 01 2021 16:18:14.803]  LOG      codeFlow {}\r\n[Tue Jun 01 2021 16:18:15.320]  ERROR    [ERROR] 18:14.429 OAuth - Error handling auth response. [TypeError: Network request failed]\r\n[Tue Jun 01 2021 16:18:15.407]  LOG      cognito signIn_failure [TypeError: Network request failed]\r\n[Tue Jun 01 2021 16:18:15.408]  LOG      signIn_failure [TypeError: Network request failed]\r\n[Tue Jun 01 2021 16:18:15.441]  LOG      cognito cognitoHostedUI_failure [TypeError: Network request failed]\r\n[Tue Jun 01 2021 16:18:15.442]  LOG      Sign in failed [TypeError: Network request failed]\r\n[Tue Jun 01 2021 16:18:15.443]  LOG      cognito customState_failure [TypeError: Network request failed]\r\n[Tue Jun 01 2021 16:18:15.445]  LOG      customState_failure [TypeError: Network request failed]\r\n```\r\n\r\nPFB my config details\r\n```\r\nconst awsmobile = {\r\n  aws_project_region: 'XXXXXXXX',\r\n  aws_cognito_identity_pool_id:\r\n    'XXXXXXXX',\r\n  aws_cognito_region: 'XXXXXXXX',\r\n  aws_user_pools_id: 'XXXXXXXX',\r\n  aws_user_pools_web_client_id: 'XXXXXXXX',\r\n  oauth: {\r\n    domain: 'XXXXXXXX-southeast-1.amazoncognito.com',\r\n    scope: [\r\n      'phone',\r\n      'email',\r\n      'openid',\r\n      'profile',\r\n      'aws.cognito.signin.user.admin',\r\n    ],\r\n    redirectSignIn: 'myapp://',\r\n    redirectSignOut: 'myapp://',\r\n    responseType: 'code',\r\n  },\r\n  federationTarget: 'COGNITO_USER_POOLS',\r\n};\r\n\r\nexport default awsmobile;\r\n```\r\n\r\n","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNjEyOA==","author":{"login":"jana247"},"title":"Can Amplify cache the S3 images that are retrieved via Amplify Storage and use it while the app goes offline","body":"Want to know if Amplify can cache the images it downloaded from S3 bucket via Amplify Storage and when the app goes offline instead of calling the S3 bucket again can it retrieve from offline cache ? \r\n\r\nI have not seen any discussion around this particular scenario. Can any one explain if this is possible in Amplify ?","upvoteCount":4,"comments":{"edges":[{"node":{"author":{"login":"monscamus"},"body":"Yep, I'd also like to see this. At the moment you have to avoid all use of Storage.get when you go offline and write wrapper code around file interactions to use either the WebAPI Cache or IndexDB to locally store files for offline use. It strikes me that this would be an easy thing for Storage to handle or at least allow hooks for. At the moment, when offline, you can't use Storage.get to tell you the URL it would have used to get a file which would be nice to retrieve the fetch response from Cache."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb242NTYy","author":{"login":"maximelebastard"},"title":"Hub event triggered on API.graphql","body":"Hello,\r\n\r\nI'd like to do a little circuit breaker for my React app.\r\nHow can I listen to all api calls made on the app ? Is there any Hub event triggered ?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"jeremydrichardson"},"body":"Hi there,\r\n\r\nI'm wondering if you ever figured this out.\r\n\r\nFrom what I can tell there are at least no event triggered on the \"api\" channel for GET requests. Not sure about other requests.\r\n\r\nI tried sending my own events on the \"api\" channel but got warnings that it could result in unintended consequences. I ended up just creating my own channel and sending my own custom events. \r\n\r\nIt would be nice if this was better documented and we could see all the potential events on the protected channels.\r\n\r\n"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzgxODA5","author":{"login":"dmcd2"},"title":"DataStore subscriptions and model sync","body":"Hi,\r\n\r\nIn our React DataStore application I have noticed that when a background model sync happens (some time after the initial sync),  subscriptions are triggered for all the items in the models. This is having a performance impact on our application as various caches are being updated using additional queries based on the subscription. Due to the number of records in our models it takes a while for all the subscriptions to clear after the sync.\r\n\r\nQuestions:\r\n* Should I expect a model sync, full or delta to trigger subscription events? \r\n* If the data hasn't changed after the sync why is is propagated up as a subscription event?\r\n* What is the frequency of the model syncs? Is there any user control over this?\r\n* Is there any way of knowing when a sync is about to start so I could disable my subscription handling until the sync has completed?\r\n\r\nWe are using aws-amplify 3.3.14\r\n\r\nThanks.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzI0Mjg0","author":{"login":"PeteDuncanson"},"title":"DataStore: How to handle a partial sync up to AppSync?","body":"I've run into a bit of a problem and I don't know enough about DataStore to know how to fix it. In short how should I handle a partial sync from DataStore to AppSync when only half of a relation has been pushed up?\r\n\r\nLast week our whole app (its an internal CRM tool) just died after you logged in. On investigation it seems that an entity (Address in this case) had a reference to another entity (Customer) that didn't exist. The Address had the Customer ID but in DynamoDB there wasn't an Customer record to match. \r\n\r\nChecking the timestamps we saw something odd, we store a \"signUpDateTime\" field that we set ourselves in our code, this was for the day before the create time timestamp that AppSync adds in for us! Logically what we think happened is that when someone entered a Customer and Address via the App it saved it all locally via DataStore and then got stopped from syncing half way through, so it synced the Address but was prevented from syncing the Customer (our guess is laptop got shut as it was at the end of the work day).\r\n\r\nCome the next morning everyone logs in and starts syncing down from AppSync in their browsers, DataStore hits the broken relation and gets stuck on retrying it which blocked the whole app.\r\n\r\nIt blocked the app as we wait until DataStore has finished syncing before we let the users loose (via a \"please wait\" modal), we did this as we had issues with half views or other errors if data was initially missing when new users logged in so we went the brute force option of just stopping them doing anything until DataStore hub tells us its ready.\r\n\r\nTo fix the issue quickly we created a new Customer with the missing ID via AppSync UI which got unstuck and then we had to do some digging to try to piece together missing contract details for the customer.\r\n\r\n**Possible solutions/ideas that I could do**\r\n\r\nI could remove that pop up that blocks any interactions and just let DataStore keep retrying under the hood, this would make the app responsive at least. However in that instance we have had a data lose. That Customer doesn't exist and we currently wouldn't have any way to know that they are missing, how would I catch that data lose and flag it up some how?\r\n\r\nI could try to catch the error and handle it some how, seems dangerous though to be trying to guess or patch what DataStore would have done?\r\n\r\nOther than that I'm out of ideas. I'm hoping this is a known \"thing\" and there is a pattern or advice on how to handle it gracefully, hence this issue! :)\r\n\r\n**Which Category is your question related to?**\r\n\r\nDataStore\r\n\r\n\r\n**Amplify CLI Version** \r\n\r\nv4.46.1\r\n\r\n**What AWS Services are you utilizing?**\r\n\r\nAppSync, ElasticSearch\r\n\r\n**Provide additional details e.g. code snippets**\r\n\r\nError syncing:\r\n![image](https://user-images.githubusercontent.com/1674590/114544342-6757f100-9c52-11eb-87ac-389d48a8d4bd.png)\r\n\r\n\r\nTimestamps:\r\n![image](https://user-images.githubusercontent.com/1674590/114544442-8787b000-9c52-11eb-8e38-86b55a049967.png)\r\n\r\n\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"PeteDuncanson"},"body":"One idea, we don't do much error trapping or retries when it comes to DataStore, we treat it currently as fire and forget assuming that its doing a lot of the smart retry stuff under the hood. Should we be adding in more error catching to try to catch a missed/bad sync and retrying? I don't think so, seems a bit of a duplication but I could be wrong. That raises a whole other question about best practise usage of DataStore with error handling, I might put that in another issue though."}},{"node":{"author":{"login":"chrisbonifacio"},"body":"Hey 👋 Thanks for raising this! After reading over this issue, it appears to be more of a general question or topic for discussion and will be labeled as such. This is to differentiate it from the other types of issues and make sure it receives the attention it deserves. \r\n\r\nI have also asked a member of the team that, to my knowledge, is focused on this area of Amplify to take a look and give their feedback when/if they can.\r\n\r\nI hope that helps!"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzc4NTQ2","author":{"login":"jmarshall9120"},"title":"Hosted UI returns tokens, but Hub and onAuthUIStateChange continue to give login error.","body":"This maybe a bug, but I'm starting here.\r\n\r\nI have successfully authenticated against the Hosted UI with both a Username & Password and a SAML federated login.  However both the the given library API's for accepting the tokens returned in the URL do not seem to work. \r\n\r\nI'm using Vue and have a vue component with the following:\r\n\r\n```\r\n<script>\r\nimport { Auth, Hub, Cache } from 'aws-amplify'\r\nimport { onAuthUIStateChange } from '@aws-amplify/ui-components';\r\n\r\n//.... removed boiler plate code here....\r\n data: () => {\r\n    signedIn: false as boolean,\r\n    username: null as any,\r\n}\r\ncreated () {\r\n    this.unsubscribeAuth = onAuthUIStateChange((authState, authData) => {\r\n      console.log(authState);\r\n      console.log(authData);\r\n    })\r\n  },\r\n\r\n  mounted () {\r\n    console.log(\"HelloWorld mounted()\");\r\n    Hub.listen(\"auth\", ({ payload: { event, data } }) => {\r\n      console.log(`Auth event: ${event}`);\r\n      switch (event) {\r\n        case \"signIn\":\r\n          console.log(\"signIn data: \" + JSON.stringify(data));\r\n          this.signedIn = true;\r\n          this.username = data.username;\r\n          break;\r\n        case \"signOut\":\r\n          this.signedIn = false;\r\n          this.username = null;\r\n          break;\r\n      }\r\n    });\r\n    Auth.currentAuthenticatedUser()\r\n      .then(user => {\r\n        console.log(\"Username: \" + user.username);\r\n        console.log(\"Refreshing access and id tokens\");\r\n        Auth.currentSession()\r\n          .then(data => console.log(data))\r\n          .catch(err => console.log(\"Error refreshing tokens: \" + err));\r\n        this.signedIn = true;\r\n        this.username = user.username;\r\n      })\r\n      .catch(err => console.log(\"Auth.currentAuthenticatedUser(): \" + err));\r\n  }\r\n```\r\n\r\nI get this as a result:\r\n\r\n![CognitoFailLogin](https://user-images.githubusercontent.com/30184747/119273131-51790c80-bbbe-11eb-9552-6be1795b8f01.png)\r\n\r\nI've probably spent two days doing nothing but troubleshooting this, so its getting quite frustrating.  I don't think I'll be able to move forward till I can get better diagnostic strategies.  Anyone know how to run this down and determine the cause of the failure events? \r\n\r\n###EDIT 1###\r\n\r\nThose failed calls in the source that came up 400 had this error message:\r\n\r\n```\r\n1 validation error detected: Value '{cognito-idp.us-west-2.amazonaws.com/us-west-2_c3c3ZULfA=}' at 'logins' failed to satisfy constraint: Map value must satisfy constraint: [Member must have length less than or equal to 50000, Member must have length greater than or equal to 1]\r\n```\r\n\r\nNot sure what to make of that yet. \r\n\r\n##EDIT 2##\r\nStarting to think the malformed URL (missing a '?' after the path) might be involved.  There have been other such issues on the Issue tracker such as [#7468](https://github.com/aws-amplify/amplify-js/issues/7468)\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzc3OTE2","author":{"login":"saurabh53"},"title":"AWS Appsync Batch Resolver returns null","body":"Custom BatchGetItem Resolver in AWS Amplify returns null value\r\n\r\nMy Table Posts has 1-1 relation with Bookmark Table. I want to get all Posts based on Bookmark Id.\r\n\r\nTried changing postsBookmarkId in req.vtl to id but still the code returns\r\n\r\nreq.vtl file\r\n\r\n```\r\n```\r\n #set($ids = [])\r\n#foreach($id in ${ctx.args.ids})\r\n    #set($map = {})\r\n    $util.qr($map.put(\"postsBookmarkId\", $util.dynamodb.toString($id)))\r\n    $util.qr($ids.add($map))\r\n#end\r\n```\r\n\r\n{\r\n    \"version\" : \"2018-05-29\",\r\n    \"operation\" : \"BatchGetItem\",\r\n    \"tables\" : {\r\n        \"Posts\": {\r\n            \"keys\": $util.toJson($ids),\r\n            \"consistentRead\": true\r\n        }\r\n    }\r\n}\r\n```\r\nres.vtl file (response mapping )\r\n\r\n`$utils.toJson($ctx.result.data.Posts)`\r\n\r\nCustom Resources.json\r\n\r\n```\r\n\"BatchGetResolver\": {\r\n      \"Type\": \"AWS::AppSync::Resolver\",\r\n      \"Properties\": {\r\n        \"ApiId\": {\r\n          \"Ref\": \"AppSyncApiId\"\r\n        },\r\n        \"DataSourceName\": \"PostsTable\",\r\n        \"TypeName\": \"Query\",\r\n        \"FieldName\": \"batchGet\",\r\n        \"RequestMappingTemplateS3Location\": {\r\n          \"Fn::Sub\": [\r\n            \"s3://${S3DeploymentBucket}/${S3DeploymentRootKey}/resolvers/Query.batchGet.req.vtl\",\r\n            {\r\n              \"S3DeploymentBucket\": {\r\n                \"Ref\": \"S3DeploymentBucket\"\r\n              },\r\n              \"S3DeploymentRootKey\": {\r\n                \"Ref\": \"S3DeploymentRootKey\"\r\n              }\r\n            }\r\n          ]\r\n        },\r\n        \"ResponseMappingTemplateS3Location\": {\r\n          \"Fn::Sub\": [\r\n            \"s3://${S3DeploymentBucket}/${S3DeploymentRootKey}/resolvers/Query.batchGet.res.vtl\",\r\n            {\r\n              \"S3DeploymentBucket\": {\r\n                \"Ref\": \"S3DeploymentBucket\"\r\n              },\r\n              \"S3DeploymentRootKey\": {\r\n                \"Ref\": \"S3DeploymentRootKey\"\r\n              }\r\n            }\r\n          ]\r\n        }\r\n      }\r\n    }\r\n```\r\nSchema\r\n\r\n```\r\ntype Posts {\r\n  id: ID!\r\n  Post: String!\r\n  Bookmark: Bookmark @connection\r\n  More: String\r\n}\r\n\r\n```\r\n```\r\ntype Query {\r\n    batchGet(ids: [ID]): [Posts]\r\n}\r\n```\r\nEvery time it returns the below response without any error\r\n\r\n```\r\n{\r\n  \"data\": {\r\n    \"batchGet\": null\r\n  }\r\n}\r\n```\r\nGraphQl query\r\n\r\n```\r\nconst batchGet = /* GraphQL */ `\r\n  query BatchGet($ids: [ID]) {\r\n    batchGet(ids: $ids) {\r\n      id\r\n      Post\r\n      Bookmark {\r\n        id\r\n        bookmark\r\n        \r\n      }\r\n    }\r\n  }\r\n`;\r\n```","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzc1MDQ1","author":{"login":"kldeb"},"title":"Identity token vs Access token","body":"We are using a pre token generation lambda and we noticed that the data we're adding that are needed to grant access are not being used by `API.graphql` function because it uses the access token. \r\n\r\nSo we added an API `graphql_headers` to override the header with a `session.getIdToken().getJwtToken()` instead of the default used by `amplify-js`: `session.getAccessToken().getJwtToken()`\r\n\r\nWe do this because access token doesn't contain the information we need added to the id token. Is this correct? \r\n\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzczMjcz","author":{"login":"Blockchainforcommons"},"title":"Datastore failed to handle hash and range key","body":"I wrote a simple scheme that would create a DynamoDB table with id (hash) and sort (range) keys : \r\n\r\ntype FieldData @model \r\n  @key(fields: [\"id\",\"sort\"]) {  \r\n  id: ID!\r\n  sort: String!\r\n  type: String\r\n} \r\n\r\nI then have a python lambda function that writes to the table, and included the fields: \r\n* _lastChangedAt, \r\n* _version, \r\n* _deleted, \r\n* createdAt, \r\n* updatedAt\r\n\r\nHowever, calling:   \r\n\r\nconst analysis = await DataStore.query(FieldData)\r\nconsole.log(analysis) \r\n\r\n**will result in 12 items, 1 item per available HASH key, not the entire table (107 items).** \r\n\r\nmodelSynced:  \r\nObject\r\ncounts: {new: 0, updated: 107, deleted: 0}\r\nisDeltaSync: false\r\nisFullSync: true\r\nmodel: ƒ Model(init)\r\n__proto__: Object\r\n\r\nWhat am i missing here, they are clearly locally, how can i retrieve them? \r\nconst analysis = (await DataStore.query(FieldData, (a) => a.sort(\"eq\", 'PROP'))) doesnt work.\r\n\r\nThanks\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"sammartinez"},"body":"@iartemiev Any feedback on this? "}},{"node":{"author":{"login":"iartemiev"},"body":"@Blockchainforcommons, we don't fully support customized primary indexes with DataStore at the moment (i.e., anything other than the default `id` with no sort key). We are working on adding compatibility for this, and I'll make sure to post an update here once we do.\r\n\r\nCould you please share your use case with us? We'll try to suggest a workaround for the time being."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzY4Nzk4","author":{"login":"Valarzzzzzz"},"title":"Upload file to AWS S3 bucket using cognito temporary credentials","body":"I can directly use ‘aws_access_key_id’ and ‘aws_secret_access_key’ to access s3, but CognitoIdentityCredentials does not work. \r\nUpload file to AWS S3 bucket using temporary credentials then occur following problem:\r\n\r\nThere was an error uploading your file:  CredentialsError: Missing credentials in config, if using AWS_CONFIG_FILE, set AWS_SDK_LOAD_CONFIG=1\r\n    at Request.extractError (http://localhost:4200/vendor.js:41530:27  )\r\n    at Request.callListeners (http://localhost:4200/vendor.js:166781:20  )\r\n    at Request.emit (http://localhost:4200/vendor.js:166753:10  )\r\n    at Request.emit (http://localhost:4200/vendor.js:208037:14  )\r\n    at Request.transition (http://localhost:4200/vendor.js:207371:10  )\r\n    at AcceptorStateMachine.runTo (http://localhost:4200/vendor.js:32250:12  )\r\n    at http://localhost:4200/vendor.js:32262:10  \r\n    at Request.<anonymous> (http://localhost:4200/vendor.js:207387:9  )\r\n    at Request.<anonymous> (http://localhost:4200/vendor.js:208039:12  )\r\n    at Request.callListeners (http://localhost:4200/vendor.js:166791:18  )\r\n\r\n\r\nThe source code:\r\n AWSService.config.update({\r\n        region: \"us-east-2\",\r\n        credentials: new AWS.CognitoIdentityCredentials({\r\n                RoleArn: \"arn:aws:iam::950759593847:role/Cognito_FrontV2IDPoolAuth_Role\",\r\n                IdentityPoolId: \"us-east-2:76ccbc67-3d47-493e-9399-da263e7e4fb8\",\r\n                LoginId: 'songzhou96@163.com',\r\n                Logins: {\r\n                  'cognito-idp.us-east-2.amazonaws.com/us-east-2_Oi3rGr6yP': window.localStorage.idtoken,\r\n                  },\r\n                RoleSessionName: 'web',\r\n        })\r\n    });\r\n    \r\n    const bucket = new AWSService.S3({\r\n        apiVersion: '2012-10-17',\r\n        params: { Bucket: 'housingdocuments'}\r\n    });\r\n    const params = {\r\n        Bucket: 'housingdocuments',\r\n        Key: \"transactiondocs/\"+file.name,   \r\n        Body: file,\r\n        ACL: 'private',\r\n        ContentType: contentType\r\n    };  \r\n    bucket.upload(params, function (err, data) {\r\n        if (err) {\r\n            console.log('There was an error uploading your file: ', err);\r\n            return false;\r\n        }\r\n        console.log('Successfully uploaded file.', data);\r\n        alert(\"Successfully uploaded file.\");\r\n        return true;\r\n    });\r\n}\r\n![test screenshot](https://user-images.githubusercontent.com/74666765/118449436-bb5c6680-b725-11eb-826b-0571c9a75391.jpeg)\r\n\r\nThe IAM policy is as follows: {\r\n    \"Version\": \"2012-10-17\",\r\n    \"Statement\": [\r\n        {\r\n            \"Effect\": \"Allow\",\r\n            \"Action\": [\r\n                \"mobileanalytics:PutEvents\",\r\n                \"cognito-sync:*\",\r\n                \"cognito-identity:*\"\r\n            ],\r\n            \"Resource\": [\r\n                \"*\"\r\n            ]\r\n        },\r\n        {\r\n            \"Sid\": \"ReadWriteDoc\",\r\n            \"Effect\": \"Allow\",\r\n            \"Action\": [\r\n                \"s3:GetObject\",\r\n                \"s3:PutObject\"\r\n            ],\r\n            \"Resource\": [\r\n                \"arn:aws:s3:::housingdocuments/*\"\r\n            ]\r\n        }\r\n    ]\r\n}\r\n\r\n\r\n\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"reesscot"},"body":"Hi @Valarzzzzzz,\r\nHave you tried using the Amplify Storage module? \r\nhttps://docs.amplify.aws/lib/storage/getting-started/q/platform/js\r\nhttps://docs.amplify.aws/lib/storage/upload/q/platform/js"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzcxMTQ2","author":{"login":"prafullatandel"},"title":"syncexpression how to Load related model","body":"Which Category is your question related to?\r\nDatastore\r\n\r\nWhat AWS Services are you utilizing?\r\nAppsync\r\nDatastore\r\n\r\nProvide additional details e.g. code snippets\r\nIn DataStore syncExpression is it possible to get the related model.\r\n\r\nSay for example\r\n\r\ntype induction @model @key(name: \"byInduction\", fields: [\"id\", \"name\"])  {\r\n  id: ID!\r\n  name: String!\r\n  description: String!\r\n  ... other properties\r\n}\r\n\r\ntype UserInduction @model {\r\n  id: ID!\r\n  inductionId: ID!\r\n  userId: String! \r\n  enrollDateTime: AWSDateTime\r\n  completionDateTime: AWSDateTime\r\n  Induction: [Induction] @connection(keyName: \"byInduction\", fields: [\"inductionId\"])\r\n}\r\n\r\nSo now I know i can have sync expression for userIduction on userId\r\n\r\nDataStore.configure({\r\n  syncExpressions: [\r\n    syncExpression(UserInduction, () => {\r\n\t\treturn UserInduction => UserInduction.userId('eq',( user !== undefined ? user.username : ''));\r\n    }),\r\n  ],\r\n})\r\n\r\nthe index.ts has the model as\r\n\r\n export declare class UserInduction {\r\n  readonly id: string;\r\n  readonly inductionId: string;\r\n  readonly userId: string;\r\n  readonly enrollDateTime?: string;\r\n  readonly completionDateTime?: string;\r\n  readonly Induction?: (Induction | null)[];\r\n  constructor(init: ModelInit<UserInduction>);\r\n  static copyOf(source: UserInduction, mutator: (draft: MutableModel<UserInduction>) => MutableModel<UserInduction> | void): UserInduction;\r\n}\r\n\r\nthen Induction field in the above model is never loaded in the Datastore.query(UserInduction)\r\n\r\nam i missing any expression which can load the Induction array object inside the userInduction class ?\r\nJust the induction object on the inductionid present in the Userinduction .","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzcwODcw","author":{"login":"emanuelcsm"},"title":"cant import aws-amplify","body":"Hi, I'm starting to learn how to use aws amplify with my node js projects, and I created a simple project using amplify init, then I added an api using amplify add api.\r\nFor this api I dont't use any resources, ant it does not need authentication.\r\nThen I added authentication using amplify add auth\r\n\r\nIn the lamda function created for the api mentioned before I simply add the line import Auth from ('aws-amplfy') and when I send a request I get the message \"Internal Server Error\", removing this line I receive the defoult \"Hello from lambda\".\r\n\r\nI tried to run npm install aws-amplify in the root directory of my project as well as in the src directory of my function, and the same error keeps happening... \r\n\r\nThis error occurs for all libraries and frameworks that I tested, the import only works for files inside the src folder.\r\n\r\nWhat can I do to import a library, more especific Auth from aws-amplify?\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzY0NjA3","author":{"login":"mauerbac"},"title":"5/13/2021 Discord Office Hours","body":"Notes for our Office Hours","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"warrenmcquinn"},"body":"- Amplify CLI changelogs: who makes them, and how often are they updated? \r\n- Does anyone have any multi-region architecture / failover solutions for CLI environments? "}},{"node":{"author":{"login":"billygerhard"},"body":"Is there any easy way to add custom oauth providers? I added an issue https://github.com/aws-amplify/amplify-adminui/issues/166 to add more natively, but the questions comes up quite often because the default list is very limited especially on major social platforms. There is basically Google, and Facebook. Not even Twitter or Instagram which are huge. Let alone Twitch which Amazon owns."}},{"node":{"author":{"login":"rupam-kundu"},"body":"Is it possible to develop multi-tenant SaaS applications using AWS Amplify? Is there any reference multi-tenant SaaS application built using AWS Amplify?"}},{"node":{"author":{"login":"warrenmcquinn"},"body":"Clock skew causing 403 errors for Amplify API requests: just want to confirm that clock skew has a tolerance of ~5 mins now?"}},{"node":{"author":{"login":"paddlefish"},"body":"Is there any plan to add support for graphql subscriptions that return a stream (Observable) in Amplify API (much like Apollo graphql client)?  For changing data, a simple promise API is not sufficient."}},{"node":{"author":{"login":"n10000k"},"body":"Options to have multiple API's, last thing you want is a big application and just one appsync graphql api that the schema is 10k lines long, you might want to segment out services to certain teams etc"}},{"node":{"author":{"login":"paddlefish"},"body":"If you have time for another question ...  is it supported to sync down via DataStore an objects using the graphql API (e.g. via AppSync console).  Right now I get this error:\r\n\r\n```\r\nDataStore - Skipping incoming subscription. Messages: Cannot return null for non-nullable type <numerous different fields>\r\n```\r\n\r\nfor any object created directly by graphql.  OTOH if I create it via DataStore.save() then it syncs to peers without error.\r\n\r\nThis has been asked three times that I can find in the discord history, fwiw.\r\n"}},{"node":{"author":{"login":"NikolaBo"},"body":"Not sure if this is intended sort of question, but I'll ask anyway (I feel pretty new here).\r\n\r\nI'm running into a technical issue with my Auth setup where I am signing in with provider (google) and getting an `invalid-grant` response when requesting the token from Cognito. I'm not sure where to find useful explanations of this error [this](https://docs.aws.amazon.com/cognito/latest/developerguide/token-endpoint.html) describes invalid-grant but I'm not sure how it applies. Federated sign in still works normally locally and in other hosted branches, but has stopped functioning when I pushed to production with custom domain?\r\n\r\nAny resource I can look at?"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzY0NTc5","author":{"login":"raghavgoel1994"},"title":"How can I edit a phone number of a user after user is confirmed and before the user is authenticated?","body":"Steps to replicate the issue:\r\n\r\n1. User enters details on the signup page in UI (First and last name, Email, Phone Number and Password (Wrong phone number by mistake))\r\n2. AWS send OTP confirmation code to email\r\n3. The user enters OTP in the UI, the email field is verified and the user is **confirmed**\r\n4. The user tries to log in and AWS tries to send OTP to the user's phone number (MFA Enabled)\r\n\r\nBut the user will never get the OTP in his phone number because the user entered the wrong number on the signup page.\r\nSo I ask the user to update the number, but when I tried to update it in AWS, they returned the exception \"the user is not authentic\". How can I update the number to the correct number after the user just signup(confirmed) and still not authenticated?\r\n\r\nDevelopment URL -\r\n\r\ndev-webapp.myhomey.io","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzU4MDIw","author":{"login":"CarlJoven"},"title":"Amplify graphql custom type in models","body":"# I am wondering if this is possible?\r\n```graphql\r\ntype Person @model {\r\n id: ID!\r\n userInfo: PersonInfo\r\n}\r\n\r\ntype PersonInfo {\r\n name: String!\r\n age: Int!\r\n}\r\n```\r\n\r\nThanks in advance!","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"apoorvmote"},"body":"Use has one connection\r\n\r\n```graphql\r\ntype Person @model {\r\n  id: ID!\r\n  userInfo: PersonInfo @connection\r\n}\r\n\r\ntype PersonInfo @model {\r\n  id: ID!\r\n  name: String!\r\n  age: Int!\r\n}\r\n```\r\nFor more information visit the documentation\r\nhttps://docs.amplify.aws/cli/graphql-transformer/connection#has-one"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzYxOTQ4","author":{"login":"apoorvmote"},"title":"Is `api-graphql` smaller than `api` package?","body":"I don't need SSR so I only install packages that I need. \r\n\r\nFor example instead of `aws-amplify` I only install `@aws-amplify/core`, `@aws-amplify/auth` and `@aws-amplify/api`.\r\n\r\nI only use graphql api and don't use rest api. Also I don't mutate with graphql only run queries with graphql.\r\n\r\nAnd today I found out about `@aws-amplify/api-graphql` package. \r\n\r\nMy question is can I replace `@aws-amplify/api` with `@aws-amplify/api-graphql` for graphql queries?\r\n\r\nIs there benefit of reduced package size?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzQ4ODc1","author":{"login":"seantcoyote"},"title":"AmplifyAuthenticator doesn't display UI message for \"incorrect username or password\" error","body":"After much searching, I've found no definitive answer: Should AmplifyAuthenticator (@aws-amplify/ui-react version 1.0.7 and aws-amplify 3.3.27) display an error message in the UI when Cognito returns `{\"__type\":\"NotAuthorizedException\", \"message\":\"Incorrect username or password.\"}`?\r\n\r\nLogin works as expected for a signin with valid user credentials, but incorrect username or password  fails silently for the end user. I've seen indications in online discussions suggesting both, either that we need to build UI error messaging ourselves, or that it should be included out-of-the-box. If the former, I haven't found documentation for adding UI error messaging without having to build the entire auth flow from scratch. If the latter, is this a bug or am I missing some configuration?\r\n\r\nMy code:\r\n\r\n```\r\nimport React from 'react';\r\nimport {AmplifyAuthenticator, AmplifySignIn} from '@aws-amplify/ui-react';\r\n\r\n<AmplifyAuthenticator usernameAlias=\"email\">\r\n    <AmplifySignIn headerText=\"Sign In\" slot=\"sign-in\" hideSignUp></AmplifySignIn>\r\n</AmplifyAuthenticator>\r\n```","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"amhinson"},"body":"There should be a toast component that shows at the top of the screen when a failed login occurs. Do you not see that in your application? I copied your code and this is what I get when attempting to login with an incorrect password:\r\n\r\n![image](https://user-images.githubusercontent.com/17091790/117475191-9b9c9580-af10-11eb-810f-e6e4ced834cd.png)\r\n"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzU0OTMy","author":{"login":"pisaacs"},"title":"What's the behavior of Amplify Analytics when mobile native app is offline (React Native iOS)?","body":"I am trying to understand how Amplify Analytics works for React Native iOS app while offline..\r\n1) are events queued, saved in storage and sent when there's network connectivity?\r\n2) Is there a period limit, limit on queue size?\r\n3) are there specific API options for controlling the behavior?  ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzUzMjE2","author":{"login":"AyazAI"},"title":"How to filter nested tables using API in aws-amplify (AppSync)","body":"\r\nI am able to filter out one table which is top-level table (SpUser) using\r\n\r\n### Appsync console\r\n![image](https://user-images.githubusercontent.com/45338553/117255647-53736980-ae63-11eb-8c3a-2f4e418672d5.png)\r\n\r\n### aws-amplify\r\n```\r\nlet filter = {\r\n      first_name: {\r\n        eq: \"Mo\",\r\n      },\r\n };\r\n```\r\n\r\n```\r\nawait API.graphql({\r\n        query: queries.listSpUsers,\r\n        variables: {\r\n          filter: filter,\r\n     },\r\n});\r\n```\r\n\r\nwhere schema is\r\n\r\n```\r\n\r\ntype SpUser @model @key(name: \"byCompany\", fields: [\"companyID\"]) {\r\n  id: ID!\r\n  services: [SpAssignedService] @connection(keyName: \"bySpUser\", fields: [\"id\"])\r\n}\r\n\r\ntype SpAssignedService @model @key(name: \"bySpUser\", fields: [\"sID\"]) {\r\n  id: ID!\r\n  sID: ID\r\n  category: String\r\n}\r\n\r\n```\r\n\r\n**The question is how can I filter out nested data, which is of **SpAssignedService****\r\n\r\n### Appsync console (Working)\r\n![image](https://user-images.githubusercontent.com/45338553/117255883-9fbea980-ae63-11eb-9083-eb7587d8c546.png)\r\n\r\n### aws-amplify (Not Working)\r\n\r\n```\r\nlet filter = {\r\n      items: {\r\n        services: {\r\n          filter: { category: { eq: \"Scaling\" } },\r\n        },\r\n    },\r\n};\r\n\r\nlet response = await API.graphql({\r\n        query: queries.listSpUsers,\r\n        variables: {\r\n          filter: filter,\r\n        },\r\n });\r\n```\r\nFor nested filter:\r\nWell the **Appsync** is returning results but **aws-amplify** is not returning any results\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzUyNzgx","author":{"login":"billycolley"},"title":"Add New User Pool and Custom Policies","body":"We have a need to add a new user pool, as well as a custom policy for each user pool. Currently our workflow is:\r\nrun `amplify update auth`\r\nChoose `Create or update Cognito user pool groups`\r\nJust hit enter without selecting anything to delete.\r\nWhen it asks if you want to add another user pool group type `y` and hit enter.\r\nName the new pool and hit enter.\r\nChoose `N` when it asks if you want to add another user group, unless you do.\r\n\r\nThat successfully adds a new user pool group. Good so far. Now to add the custom policy.\r\n\r\nNavigate to user-pool-group-precedence.json and find the new pool you just added in the above steps. Add a custom policy with the below template:\r\n```\r\n{\r\n        \"groupName\": \"testGroup\",\r\n        \"precedence\": 2,\r\n        \"customPolicies\": [\r\n            {\r\n                \"PolicyName\": \"testName\",\r\n                \"PolicyDocument\": {\r\n                    \"Version\": \"2012-10-17\",\r\n                    \"Statement\": [\r\n                        {\r\n                            \"Action\": [\r\n                                \"s3:PutObject\",\r\n                                \"s3:GetObject\",\r\n                                \"s3:ListBucket\",\r\n                                \"s3:DeleteObject\"\r\n                            ],\r\n                            \"Resource\": [\r\n                                \"arn:aws:s3:::bucket-name/*\"\r\n                            ],\r\n                            \"Effect\": \"Allow\"\r\n                        },\r\n                        {\r\n                            \"Action\": \"s3:ListBucket\",\r\n                            \"Resource\": [\r\n                                \"arn:aws:s3:::bucket-name\"\r\n                            ],\r\n                            \"Effect\": \"Allow\"\r\n                        }\r\n                    ]\r\n                }\r\n            }\r\n        ]\r\n    },\r\n```\r\nThen, after the code is pushed, we run `amplify push/publish`. This correctly creates the new user pool, and attaches the policy to it. Good so far. Then another developer uses `amplify pull` to sync their local environment. Still good. Finally the user runs `amplify update auth` again to add a new user pool group, but the custom policy is removed from the user-pool-group-precedence.json file for all user pool groups. \r\n\r\nWhat is the correct process for doing this? Are we missing a step? Do we add the policy to the user-pool-group-precedence.json file the first time, which then adds it to the template.json file, and we don't need it in the precedence file anymore?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzQ3ODA5","author":{"login":"cytrix86"},"title":"Multiple Authorization methods GraphQL (Cognito and IAM) Angular","body":"Hello everyone,\r\n\r\nI am trying to use IAM for unauthenticated and Cognito User Pools for authenticated users in an Angular app.\r\nCognito is configured as my primary source of authentication in AppSync and IAM is added as my secondary source.\r\nIn the AppSync Queries Interface everything works as expected. \r\n\r\nWhen I try to list from my Angular app when the user is not authenticated via Cognito I get **No current user**.\r\n\r\nI was able to solve the issue with the following workaround:\r\n```javascript\r\n if (this.auth.isAuthenticated) {\r\n        Amplify.configure({\r\n          aws_appsync_authenticationType: 'AMAZON_COGNITO_USER_POOLS',\r\n        });\r\n        console.log('changed to Congnito');\r\n      } else {\r\n        Amplify.configure({\r\n          aws_appsync_authenticationType: 'AWS_IAM',\r\n        });\r\n        console.log('changed to IAM');\r\n      };\r\n```\r\nbefore I qurey.\r\n\r\nMy modal looks like this:\r\n\r\n```qraphql\r\ntype Test\r\n  @model(timestamps: { createdAt: \"createdOn\", updatedAt: \"updatedOn\" })\r\n  @auth(\r\n    rules: [\r\n      { allow: public, provider: iam, operations: [read] }\r\n      { allow: owner, ownerField: \"owner\" }\r\n      { allow: groups, groups: [\"Admins\"] }\r\n    ]\r\n  ) {\r\n  id: ID\r\n  title: String\r\n  views: Int @aws_iam\r\n  owner: String\r\n}\r\n```\r\n\r\nUpdating the views field on this object works in the AppSync interface but not from Angular. \r\nAs soon as i am authenticated everything works as expected.\r\n\r\nMy APIService is created by the Amplify CLI code generator. \r\n\r\nI am thankful for any suggestions. \r\n\r\nAngular: 11.2.10\r\nAmplify CLI: 4.50.0\r\naws-amplify: 3.3.27","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzQ1OTY5","author":{"login":"MMay1992"},"title":"I need to add client_secret ?","body":"I need to add client_secret in OAuth.prototype._handleCodeFlow\r\nExample:\r\nCalling token endpoint: https://cpalloidc.auth.ap-southeast-1.amazoncognito.com/oauth2/token with \r\nclient_id: \"\"\r\n**### client_secret: \"\" // It can't add /// Help me pls.**\r\ncode: \"\"\r\ncode_verifier: \"\"\r\ngrant_type: \"\"\r\nredirect_uri: \"\"\r\n\r\nIn this file.\r\nhttps://github.com/aws-amplify/amplify-js/blob/main/packages/auth/src/OAuth/OAuth.ts","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzM4MzUy","author":{"login":"xenowits"},"title":"How to add identityPoolId in config of Auth.federatedSignIn","body":"Hi all. I am trying to use firebase as IdP for cognito Identity pools. I need to add cognito IdentityPoolId in the federatedSignIn function of Auth. If I don't add the id, i get an error saying `Error: Federation requires either a User Pool or Identity Pool in config`. How to place it and where is my concern?\r\nAny help is very much appreciated!\r\n\r\n```\r\nAuth.federatedSignIn(\r\n    {\r\n       domain: \"securetoken.google.com/{PROJECT_ID}\",\r\n   //   identityPoolId: \"AWS_REGION:POOL_ID\",\r\n    {\r\n      token: token,\r\n      expires_at: expiresIn * 1000 + new Date().getTime(),\r\n    },\r\n    user\r\n  )\r\n    .then((cred) => {\r\n      // If success, you will get the AWS credentials\r\n      console.log(cred);\r\n      return Auth.currentAuthenticatedUser();\r\n    })\r\n    .then((user) => {\r\n      // If success, the user object you passed in Auth.federatedSignIn\r\n      console.log(user);\r\n    })\r\n    .catch((e) => {\r\n      console.log(e);\r\n    });\r\n```","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"xenowits"},"body":"https://kumar-abhishek111b.medium.com/configuring-federated-signin-in-amplify-9b06ec20ab8"}},{"node":{"author":{"login":"xenowits"},"body":"This discussion is closed. I hv written a small article on this. Restart the discussion if it still isn't working for u!"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzM5Mzcx","author":{"login":"hf-qin"},"title":"How to add oidc to CognitoHostedUIIdentityProvider","body":"I'm trying to add azure ad OIDC to Cognito and want to develop a federated sign-in using Amplify. But it seems that CognitoHostedUIIdentityProvider only supports Facebook, Google, and LWA. \r\n\r\nHad anyone tried providing \"Login in with Microsoft\" using Amplify + Cognito?\r\n\r\nAny hints will be appreciated!\r\n\r\nThanks\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzM5MjE0","author":{"login":"CarlJoven"},"title":"AWS Amplify DataStore 100 hard limit of subscriptions","body":"# Problem\r\nI am about to reach the limit set by the Appsync and I am worried because the web app that I am developing may still require additional features. It means additional models and datastore always require that the model must be sync in order for it to work so I cannot disable the subscriptions. \r\n\r\n# Things that I have done\r\n- Turn the subscriptions param of the model directive into null of models which I don't need subscriptions but it does not work and it is not syncing because like I mentioned before datastore relies on subscriptions in order for the syncing to work.\r\n- Tried to go to the support center but It is not listed as one of the options in the service limit increase. So my only option is to upgrade my plan in the support center but before I do that I have a question. Will my issue be resolved? Because based on issue #6260  which is the continuation of issue #5050 it is not possible.\r\n\r\n**Please help and guide me I am really worried right now**","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzM3MDI0","author":{"login":"MedNabilEssefaihi"},"title":"How to increment field by 1 from DynamoDB using AWS Amplify with GraphQL","body":"Hello there!\r\n\r\nI am building a **react native** application with **AWS Amplify** fro backend, I want to increment a value by 1 in **Table of Posts**.\r\nin graphQL there's a simple way by suing operator call **_inc: {valueToIncrement: 1}**\r\n\r\n### the solution exists:\r\n\r\n```\r\nmutation update_post{\r\n  update_post(\r\nwhere:{id : {_eq: xxxxxxxxxx}},\r\n_inc: {valueToIncrement: 1}\r\n){\r\n // returns\r\n}\r\n\r\n}\r\n```\r\n\r\n**My need** \r\nI am looking for the same method with **AWS Amplify with GraphQL**","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzM2NzY1","author":{"login":"kenchoong"},"title":"Unable to make Many-to-Many Relationship in DataStore","body":"I have this 2 model, `Product` and `Order`. \r\nI want it have Many-to-Many Relationship. \r\nSo `Product` in many `Order` \r\n`Order` will have many `Product` like in this picture \r\n\r\n![115989227-fb7d6d00-a5ef-11eb-8527-dbb2b329f852](https://user-images.githubusercontent.com/8010129/115996962-ec101b00-a613-11eb-80ff-ff3d810a3ebd.png)\r\n\r\nSo I click \"Add relationship\" in `Order `model like this: \r\n\r\n![115989267-2bc50b80-a5f0-11eb-84e4-77cbe4275027](https://user-images.githubusercontent.com/8010129/115997005-13ff7e80-a614-11eb-9f3e-d07b2a81dc45.png)\r\n\r\nThen what I got is this, it only create as 1:m relationship: \r\n![115989318-5ca54080-a5f0-11eb-9fd9-5380b78e99c4](https://user-images.githubusercontent.com/8010129/115997017-237ec780-a614-11eb-9b67-9731db237e93.png)\r\n\r\nI also unable to selete M:n relationship in the dropdown menu \r\n![115989378-9aa26480-a5f0-11eb-9637-0596adad7390](https://user-images.githubusercontent.com/8010129/115997048-35606a80-a614-11eb-959e-6eb56eac3804.png)\r\n\r\nSo now I unable to make M:n relationship in my data model. \r\n\r\nThen I try to make the same order and relationship in a[ Amplify sandbox ](https://sandbox.amplifyapp.com/schema-design/f6c23bfd-9d98-41b5-9649-d6ce68bd411c)\r\n![115989429-e5bc7780-a5f0-11eb-8c0a-48bb06611130](https://user-images.githubusercontent.com/8010129/115997123-853f3180-a614-11eb-8d29-d86f43147006.png)\r\n\r\nAs you can see, both `Order` and `Product` is having the relationship for each other, but I unable to do that in my Amplify Admin UI. \r\n\r\nThen I try to edit the `schema.graphql` in my local file by following [this example in amplify docs](https://docs.amplify.aws/lib/datastore/relational/q/platform/js#many-to-many)\r\n\r\nI also not able to create the relationship, which I create this issue 5 days ago here: https://github.com/aws-amplify/amplify-js/issues/8139\r\n\r\n**My goal is**\r\n1.  Create the Many to many relationship for `Product` and `Order` \r\n2.  Able to get all ProductId given a OrderID\r\n\r\nBut I unable to do that, and I not sure why is this happen\r\n\r\nFor more information, please refer: \r\n1. [Amplify UI issue](https://github.com/aws-amplify/amplify-adminui/issues/188)\r\n2. [Amplify js issue](https://github.com/aws-amplify/amplify-js/issues/8139)\r\n3. [SO question](https://stackoverflow.com/questions/67201435/unable-to-query-many-to-many-relationship-in-amplify-datastore)\r\n4. [Amplify discord discussion for attempt to solve this](https://discord.com/channels/705853757799399426/831604049928257556/834434325889679440)\r\n\r\nI hope this clear, please provide any possible help. If still need any information please let me know. \r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNTAxNzQ4","author":{"login":"ericclemmons"},"title":"Remove shadow DOM from UI Components","body":"\r\n## Summary\r\n\r\n`@aws-amplify/ui-components` are Web Components, built by StencilJS with bindings for frameworks (e.g. `@aws-amplify/ui-react`).\r\n\r\nMany of these components use the Shadow DOM for encapsulation, but that's **needlessly restrictive**, preventing customers from styling their components via normal CSS selectors.\r\n\r\nhttps://github.com/aws-amplify/amplify-js/blob/06bfecbd32751dee61d5abb6d5be9430ecaeca5a/packages/amplify-ui-components/src/components/amplify-sign-in/amplify-sign-in.tsx#L31-L35\r\n\r\n## Motivation\r\n\r\n1. Shadow DOM is helpful for encapsulating 3rd party widgets (e.g. a Disqus chat box) so that on-page styles don't cascade to the 3rd party widget.\r\n\r\n2. Amplify UI Components **are not intended to be fully sandboxed**, but rather a 1st Class component in your application that _looks_ like your app.\r\n\r\nAmplify has attempted to solve #2 via CSS Variables, but ultimately leveraging CSS' built-in specificity is the best way to override styles.  Using CSS Variables + Shadow DOM as the only external API to override styles makes the customization experience frustrating and, in some cases, impossible.\r\n\r\n## Proposal\r\n\r\nRemove `shadow: true` references. This should allow `amplify-sign-in form-section { width: 100% }` to work as expected.  CSS Variables will also continue to work as before.\r\n\r\n## Drawbacks\r\n\r\nThis would be a breaking change, as any customers using `:host` or piercing selectors will have to update their styles.\r\n\r\nThe good news is that UI Components aren't v1 yet, so there's an opportunity to bump to v1 with any other breaking changes.\r\n\r\nThe biggest drawback is that, like any other UI framework, **the markup becomes an implicit API contract that can break between releases**.  For example, wrapping a `<button>` inside of a `<div>` to fix a layout issue would break custom `form > button` selectors:\r\n> ![workflow](https://user-images.githubusercontent.com/15182/104044430-28695980-5192-11eb-9466-2e1bd31d30dd.png)\r\n> – https://xkcd.com/1172/\r\n\r\n\r\n## Adoption Strategy\r\n\r\nThis would require _less_ documentation & support (e.g. Discord, GitHub), because CSS would \"just work\".\r\n\r\n## Related Issues\r\n\r\n- https://discord.com/channels/705853757799399426/708383821401161738/794346824633679872\r\n- https://github.com/aws-amplify/amplify-js/discussions/6984\r\n- https://github.com/aws-amplify/amplify-js/discussions/6891\r\n- https://github.com/aws-amplify/amplify-js/discussions/6200\r\n- https://github.com/aws-amplify/amplify-js/discussions/5536\r\n- https://github.com/aws-amplify/amplify-js/discussions/6047\r\n- https://codesandbox.io/s/amplify-ui-cant-hide-toast-5h4my?file=/styles.css\r\n\r\n","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"tjleing"},"body":"I'd also like to toss #7199 into the pile -- looking forward to the discussion!"}},{"node":{"author":{"login":"ericclemmons"},"body":"Let's get this done with https://github.com/aws-amplify/amplify-js/milestone/32"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzMzNTk0","author":{"login":"countryst"},"title":"Facebook login results in \"No Cognito Federated Identity pool provided\" using @aws-amplify/ui-components","body":"I'm using \"@aws-amplify/ui-components\": \"^1.2.0\", quasar and Vue\r\nI'm following https://docs.amplify.aws/ui/auth/authenticator/q/framework/vue\r\nWhen I click on \"Sign in with facebook\", nothing changes on UI, but I see following error in console log:\r\n`Uncaught (in promise) No Cognito Federated Identity pool provided`\r\n\r\nThe issue might be that Amplify is setting the redirect uri to `localhost`\r\n`https://www.facebook.com/v5.0/dialog/oauth?app_id=237235604209826&cbt=1619122407853&channel_url=https%3A%2F%2Fstaticxx.facebook.com%2Fx%2Fconnect%2Fxd_arbiter%2F%3Fversion%3D46%23cb%3Df333aef24e397e%26domain%3Dlocalhost%26origin%3Dhttps%253A%252F%252Flocalhost%253A8080%252Ff1ff362458255c8%26relation%3Dopener&client_id=237235604209826&display=popup&domain=localhost&e2e=%7B%7D&fallback_redirect_uri=https%3A%2F%2Flocalhost%3A8080%2F%23%2F&locale=en_US&logger_id=f3b39c68cff96d8&origin=1&redirect_uri=https%3A%2F%2Fstaticxx.facebook.com%2Fx%2Fconnect%2Fxd_arbiter%2F%3Fversion%3D46%23cb%3Df1d22f64a476e88%26domain%3Dlocalhost%26origin%3Dhttps%253A%252F%252Flocalhost%253A8080%252Ff1ff362458255c8%26relation%3Dopener%26frame%3Df3e7e88ce452e44&response_type=token%2Csigned_request%2Cgraph_domain&scope=public_profile%2Cemail&sdk=joey&version=v5.0`\r\nI assume it should redirect to `https://<your-user-pool-domain>/oauth2/idpresponse` so Cognito can handle this properly\r\n\r\nI found this that talks about HOC, but it using react https://github.com/aws-amplify/amplify-js/issues/5528\r\n\r\nHere is my App.vue:\r\n\r\n```\r\n<template>\r\n  <div id=\"q-app\">\r\n    <div>\r\n      <div v-if=\"authState !== 'signedin'\">You are signed out.</div>\r\n      <amplify-authenticator :federated.prop=\"federatedIds\">\r\n        <div v-if=\"authState === 'signedin' && user\">\r\n          <div>Hello, {{user.username}}</div>\r\n        </div>\r\n        <amplify-sign-out></amplify-sign-out>\r\n      </amplify-authenticator>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script lang=\"ts\">\r\nimport { defineComponent } from '@vue/composition-api'\r\nimport { onAuthUIStateChange } from '@aws-amplify/ui-components'\r\n\r\nexport default defineComponent({\r\n  name: 'App',\r\n  created() {\r\n    this.unsubscribeAuth = onAuthUIStateChange((authState, authData) => {\r\n      this.authState = authState;\r\n      this.user = authData;\r\n    })\r\n  },\r\n  data() {\r\n    return {\r\n      user: undefined,\r\n      authState: undefined,\r\n      unsubscribeAuth: undefined,\r\n      federatedConfig: { provider: \"Facebook\" },\r\n      federatedIds: {\r\n        facebookAppId: \"****\"\r\n      },\r\n      formFields: [\r\n        {\r\n          type: \"email\",\r\n        },\r\n        {\r\n          type: \"password\",\r\n        },\r\n      ],\r\n    }\r\n  },\r\n  beforeUnmount() {\r\n    this.unsubscribeAuth();\r\n  }\r\n})\r\n</script>\r\n\r\n```\r\n\r\nHere is my boot file:\r\n\r\n```\r\nimport Amplify from 'aws-amplify';\r\nimport awsconfig from '../aws-exports';\r\nimport {\r\n  applyPolyfills,\r\n  defineCustomElements,\r\n} from '@aws-amplify/ui-components/loader';\r\n\r\napplyPolyfills().then(() => {\r\n  defineCustomElements(window);\r\n});\r\nAmplify.configure(awsconfig);\r\n```\r\n\r\nHere is my amplify-meta.json file:\r\n\r\n```\r\n{\r\n  \"providers\": {\r\n    \"awscloudformation\": {\r\n      \"AuthRoleName\": \"*******\",\r\n      \"UnauthRoleArn\": \"*******\",\r\n      \"AuthRoleArn\": \"*******\",\r\n      \"Region\": \"*******\",\r\n      \"DeploymentBucketName\": \"*******\",\r\n      \"UnauthRoleName\": \"*******\",\r\n      \"StackName\": \"*******\",\r\n      \"StackId\": \"*******\",\r\n      \"AmplifyAppId\": \"*******\"\r\n    }\r\n  },\r\n  \"auth\": {\r\n    \"media70a63f67\": {\r\n      \"service\": \"Cognito\",\r\n      \"serviceType\": \"imported\",\r\n      \"providerPlugin\": \"awscloudformation\",\r\n      \"dependsOn\": [],\r\n      \"customAuth\": false,\r\n      \"output\": {\r\n        \"UserPoolId\": \"*******\",\r\n        \"UserPoolName\": \"*******\",\r\n        \"AppClientID\": \"*******\",\r\n        \"AppClientIDWeb\": \"*******\",\r\n        \"HostedUIDomain\": \"*******\",\r\n        \"OAuthMetadata\": \"*******\"\r\n      },\r\n      \"lastPushTimeStamp\": \"*******\"\r\n    }\r\n  }\r\n}\r\n```","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"countryst"},"body":"The issue is that corrent library doesn't support this feature, here is related feature request https://github.com/aws-amplify/amplify-js/issues/8171"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zOTUxNA==","author":{"login":"malcomm"},"title":"DynamoDB:ApiCallTimeoutException how to replicate","body":"I am using AWS Amplify and Angular. I will get a DynamoDB:ApiCallTimeoutException from time to time and I'm having trouble replicating this so that I can handle the errors properly. \r\n\r\nMy question is: is there a way I can throw something similar so that I can properly handle these types of errors and test it?\r\n\r\nHere's an example error message:\r\n\r\n```\r\nError: Uncaught (in promise): Object:\r\n{\r\n  \"data\": {\r\n    \"getFoo\": {\r\n      \"__typename\": \"Foo\",\r\n      \"id\": \"8df58cab-81de-402d-bd77-1e72300e8b2\",\r\n      \"updatedAt\": \"2020-09-24T22:43:20.236Z\",\r\n      ....\r\n    }\r\n  },\r\n  \"errors\": [\r\n    {\r\n      \"path\": [\r\n        \"getFoo\",\r\n        ....\r\n      ],\r\n      \"data\": null,\r\n      \"errorType\": \"DynamoDB:ApiCallTimeoutException\",\r\n      \"errorInfo\": null,\r\n      \"locations\": [\r\n        {\r\n          \"line\": 726,\r\n          \"column\": 11,\r\n          \"sourceName\": null\r\n        }\r\n      ],\r\n      \"message\": \"Client execution did not complete before the specified timeout configuration: 10000 millis\"\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\nThanks!","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"warrenmcquinn"},"body":"I am actively encountering this error - it is causing havoc on my production workload. I've contacted AWS Support for any information about a fix."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzI4MTk0","author":{"login":"swapnil0545"},"title":"Add a hidden custom attribute during signup","body":"Hi,\r\n\r\nI have some custom attribute in the signup process which needs to be filled in eg. custom:role, custom:tenant_id.\r\nI am using angular and amplify sdk.\r\n` {\r\n      type: \"custom:role\",\r\n      value: \"user\",\r\n      required: true,\r\n      disabled: true,\r\n      inputProps: { name: \"role\" },\r\n    }`\r\n\r\nbut when I use type : hidden, then the signup doesnt work as the key name is taken as 'hidden'.\r\nThere is no property named 'key' entertained by the function.\r\n\r\nAny help regarding how I can solve this will be greatful.\r\n\r\nThanks,\r\nSwapnil","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"swapnil0545"},"body":"Bump anyone?"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzM0NDg5","author":{"login":"joebernard"},"title":"Does Amplify automatically refresh security tokens in React Native?","body":"https://docs.amplify.aws/lib/auth/manageusers/q/platform/js#managing-security-tokens\r\n\r\nI noticed the docs now seem to indicate that Amplify will automatically handle refreshing security tokens for React Native. Previously React Native apps had to handle refreshing manually. I'm trying to track down which version of Amplify this was introduced in.\r\n\r\nhttps://github.com/aws-amplify/amplify-js/pull/7288\r\nThis PR seems to have touched on it which was introduced in 3.4.15. Is that when it was changed?\r\n\r\nI need to know if I can safely pull out all our manual token refresh logic once I upgrade.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzI1Mzcx","author":{"login":"epratik"},"title":"Incorrect username and password exception during CUSTOM_AUTH","body":"I am trying to do a username/password login with custom email OTP using CUSTOM_AUTH.\r\nBelow are the steps -\r\n1.Auth.signIn(username, password)\r\n2.This executes the first 2 cases of define auth challange lambda trigger\r\n3.The input json to define auth challange lambda looks like this -\r\n{\r\nchallengeName: 'SRP_A',\r\nchallengeResult: true,\r\nchallengeMetadata: null\r\n},\r\n{\r\nchallengeName: 'PASSWORD_VERIFIER',\r\nchallengeResult: true,\r\nchallengeMetadata: null\r\n}\r\n4.Its clear that password is validated.\r\n5.It now sets the challange to CUSTOM_CHALLANGE.\r\n6.At this point the client fails with NotAuthorizedException instead of asking for the challange answer.\r\n\r\nMy define auth challange lambda is like this -\r\n\r\nexports.handler = async (event, context) => {\r\nconsole.log(event.request.session)\r\nif (event.request.session.length == 1 && event.request.session[0].challengeName == 'SRP_A') {\r\nevent.response.issueTokens = false;\r\nevent.response.failAuthentication = false;\r\nevent.response.challengeName = 'PASSWORD_VERIFIER';\r\n}\r\nelse if (event.request.session.length == 2 && event.request.session[1].challengeName == 'PASSWORD_VERIFIER' && event.request.session[1].challengeResult == true) {\r\nevent.response.issueTokens = false;\r\nevent.response.failAuthentication = false;\r\nevent.response.challengeName = 'CUSTOM_CHALLENGE';\r\n}\r\nelse if (event.request.session.length == 3 && event.request.session[2].challengeName == 'CUSTOM_CHALLENGE' && event.request.session[2].challengeResult == true) {\r\nevent.response.issueTokens = true;\r\nevent.response.failAuthentication = false;\r\n}\r\nelse {\r\nconsole.log('Failing Authentication')\r\nevent.response.issueTokens = false;\r\nevent.response.failAuthentication = true;\r\n}\r\ncontext.done(null, event);\r\n}\r\n\r\nIs this supported by amplify?\r\nDocumentation referred - https://docs.amplify.aws/lib/auth/switch-auth/q/platform/js#custom_auth-flow\r\nThis suggests you to not provide a password but that does not work either.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"epratik"},"body":"I found the issue. My create auth lambda was wrong. The if statement in my lambda was\r\nif (!event.request.session || event.request.session.length === 0) {\r\n\r\nbut should be\r\n\r\nif (event.request.session.length === 2 && event.request.challengeName === 'CUSTOM_CHALLENGE') {\r\n\r\nI had a console.log(event) inside the create auth lambda before the if statement but that was not writing log to cloud watch which led me to believe that the lambda was not getting fired. I created a new lambda function which fixed the logging issue."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzMzMTc5","author":{"login":"countryst"},"title":"AWS Cognito UI configured using Amplify in quasar/Vue3 doesn't show Facebook login button","body":"I'm using amplify to add auth UIs for AWS Cognito to my quasar/Vue3 website. Facebook login button is not displayed.\r\n\r\n![Screenshot](https://i.ibb.co/LgSyxcx/Screen-Shot-2021-04-22-at-9-35-38-AM.png)\r\n\r\n\r\nI used ```amplify import auth``` since I already have Cognito userpool configured sepratly.\r\n\r\nHere is my sample App.vue\r\n\r\n    <template>\r\n      <div id=\"q-app\">\r\n        <div>\r\n          <div v-if=\"authState !== 'signedin'\">You are signed out.</div>\r\n          <amplify-authenticator :federated=\"federatedIds\">\r\n            <div v-if=\"authState === 'signedin' && user\">\r\n              <div>Hello, {{user.username}}</div>\r\n            </div>\r\n            <amplify-sign-out></amplify-sign-out>\r\n          </amplify-authenticator>\r\n        </div>\r\n      </div>\r\n    </template>\r\n\r\n    <script lang=\"ts\">\r\n    import { defineComponent } from '@vue/composition-api'\r\n    import { onAuthUIStateChange } from '@aws-amplify/ui-components'\r\n    \r\n    export default defineComponent({\r\n      name: 'App',\r\n      created() {\r\n        this.unsubscribeAuth = onAuthUIStateChange((authState, authData) => {\r\n          this.authState = authState;\r\n          this.user = authData;\r\n        })\r\n      },\r\n      data() {\r\n        return {\r\n          user: undefined,\r\n          authState: undefined,\r\n          unsubscribeAuth: undefined,\r\n          federatedConfig: { provider: \"Facebook\" },\r\n          federatedIds: {\r\n            facebookAppId: \"*******\"\r\n          }\r\n        }\r\n      },\r\n      beforeUnmount() {\r\n        this.unsubscribeAuth();\r\n      }\r\n    })\r\n    </script>\r\n\r\nHere is my boot file:\r\n\r\n    import Amplify from 'aws-amplify';\r\n    import awsconfig from '../aws-exports';\r\n    import {\r\n      applyPolyfills,\r\n      defineCustomElements,\r\n    } from '@aws-amplify/ui-components/loader';\r\n    \r\n    applyPolyfills().then(() => {\r\n      defineCustomElements(window);\r\n    });\r\n    Amplify.configure(awsconfig);\r\n\r\nHere is my amplify-meta.json file:\r\n\r\n```\r\n{\r\n  \"providers\": {\r\n    \"awscloudformation\": {\r\n      \"AuthRoleName\": \"*******\",\r\n      \"UnauthRoleArn\": \"*******\",\r\n      \"AuthRoleArn\": \"*******\",\r\n      \"Region\": \"*******\",\r\n      \"DeploymentBucketName\": \"*******\",\r\n      \"UnauthRoleName\": \"*******\",\r\n      \"StackName\": \"*******\",\r\n      \"StackId\": \"*******\",\r\n      \"AmplifyAppId\": \"*******\"\r\n    }\r\n  },\r\n  \"auth\": {\r\n    \"media70a63f67\": {\r\n      \"service\": \"Cognito\",\r\n      \"serviceType\": \"imported\",\r\n      \"providerPlugin\": \"awscloudformation\",\r\n      \"dependsOn\": [],\r\n      \"customAuth\": false,\r\n      \"output\": {\r\n        \"UserPoolId\": \"*******\",\r\n        \"UserPoolName\": \"*******\",\r\n        \"AppClientID\": \"*******\",\r\n        \"AppClientIDWeb\": \"*******\",\r\n        \"HostedUIDomain\": \"*******\",\r\n        \"OAuthMetadata\": \"*******\"\r\n      },\r\n      \"lastPushTimeStamp\": \"*******\"\r\n    }\r\n  }\r\n}\r\n```\r\n\r\nI have spent hours looking for a solution, here are a few links\r\n* https://www.npmjs.com/package/@aws-amplify/ui-components#vue\r\n* https://github.com/aws-amplify/amplify-js/issues/3818\r\n* https://stackoverflow.com/questions/65818865/amplify-federated-buttons-not-showing-up\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"countryst"},"body":"In case someone faces similar issue, you need to add `.prop` for amplify's properties:\r\n\r\n`<amplify-authenticator :federated=\"federatedIds\">` has to change to `<amplify-authenticator :federated.prop=\"federatedIds\">`\r\n\r\nI had to do the same thing for\r\n```\r\n<amplify-sign-up slot=\"sign-up\" username-alias=\"email\" :form-fields.prop=\"formFields\">\r\n</amplify-sign-up>\r\n```\r\n\r\nReference: https://github.com/aws-amplify/amplify-js/issues/5298#issuecomment-621124576"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzMzMjUy","author":{"login":"DeniferSantiago"},"title":"Is it possible to change the username?","body":"I don't think it is possible to change username when creating amplify userpool by choosing to login with username.\r\n![image](https://user-images.githubusercontent.com/41799285/115755183-12f7f400-a36b-11eb-8604-4e0fa92101fb.png)\r\n\r\nAs seen in the image the option \"Also allow sign in with preferred username (a username that your users can change)\" is disabled and there is no way to activate any of these options from amplify cli, it is not clear how I can use the class Auth to change username so maybe it's a problem for amplify-cli and amplify-js.\r\n\r\nI will create this as a discussion in amplify-js and as a issue in amplify-cli","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzMyNzY4","author":{"login":"kalek"},"title":"How not display notification when app is in foreground","body":"I'm using lambda function to send push notification with type alert and in ReactNative app I always see notify even app is in foreground mode, How can I don't display notify when app is active ?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzMyNzEy","author":{"login":"renanbronchart"},"title":"How to query a model sort by many to many relation","body":"Hi everybody, \r\nI have this schema : \r\n```\r\n\r\ntype Brand @model\r\n  @key(name: \"ByName\", fields: [\"name\"])\r\n  @searchable\r\n{\r\n  id: ID!\r\n  name: String!\r\n  link: String\r\n  image: String\r\n  bio: String\r\n  votes: [Vote] @connection(keyName: \"byBrand\", fields: [\"id\"])\r\n}\r\n\r\n\r\ntype Vote @model\r\n  @key(name: \"byUser\", fields: [\"userID\"]) ## BelongsTo User. Index by userId\r\n  @key(name: \"byBrand\", fields: [\"brandID\", \"userID\"], queryField: \"voteByBrand\")\r\n  @searchable\r\n{\r\n  id: ID!\r\n  userID: String!\r\n  userPhone: String!\r\n  brandID: ID!\r\n  # productTypeID: ID!\r\n  image: String\r\n  comment: String\r\n  # BelongTo User\r\n  user: User! @connection(fields: [\"userID\"])\r\n  # BelongTo Brand\r\n  brand: Brand! @connection(fields: [\"brandID\"])\r\n}\r\n```\r\n\r\n\r\nI want to query all Brand and sort by Brand which have the most votes.\r\n\r\nBrand 1 -> 20 votes ; Brand 2 -> 15 votes ; Brand 3 -> 8 votes ; Brand 4 -> 5 votes ; \r\n\r\nOn appSync, it seems not possible. Can you help me for that?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzMyMjI2","author":{"login":"windupurnomo"},"title":"Determine Email Address (Gmail) used By Google SignUp/Login","body":"I have web app using Reactjs that have two method of login: using email-password and Google.\r\n\r\nAttempts:\r\n\r\n1. User (with email foo@gmail.com) signin/signup by Google\r\n2. User Sign Out\r\n3. User login again by email foo@gmail.com and random password\r\n\r\nNormal behavior: In the 3rd attempt, user will get an error UserNotFoundException\r\nExpected response: my web will inform user, that he should login by google\r\nIs there mechanism to check email address availability that used by federated sign in (Google)?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzMxOTU2","author":{"login":"ApollonSeven"},"title":"Problems accessing storage from Lambda function","body":"## What I want to do?\r\nI want to create REST API that returns data from my DynamoDB table which is being created by GraphQL model.\r\n\r\n## What I've done\r\n\r\n1. Create GraphQL model\r\n```graphql\r\ntype Public @model {\r\n  id: ID!\r\n  name: String!\r\n}\r\n```\r\n\r\n2. Create REST API with Lambda Function with access to my `PublicTable`\r\n```sh\r\n$ amplify add api\r\n? Please select from one of the below mentioned services: REST\r\n? Provide a friendly name for your resource to be used as a label for this category in the project: rest\r\n? Provide a path (e.g., /book/{isbn}): /items\r\n? Choose a Lambda source Create a new Lambda function\r\n? Provide an AWS Lambda function name: listPublic\r\n? Choose the runtime that you want to use: NodeJS\r\n? Choose the function template that you want to use: Hello World\r\n\r\nAvailable advanced settings:\r\n- Resource access permissions\r\n- Scheduled recurring invocation\r\n- Lambda layers configuration\r\n\r\n? Do you want to configure advanced settings? Yes\r\n? Do you want to access other resources in this project from your Lambda function? Yes\r\n? Select the category storage\r\n? Storage has 8 resources in this project. Select the one you would like your Lambda to access Public:@model(appsync)\r\n? Select the operations you want to permit for Public:@model(appsync) create, read, update, delete\r\n\r\nYou can access the following resource attributes as environment variables from your Lambda function\r\n        API_MYPROJECT_GRAPHQLAPIIDOUTPUT\r\n        API_MYPROJECT_PUBLICTABLE_ARN\r\n        API_MYPROJECT_PUBLICTABLE_NAME\r\n        ENV\r\n        REGION\r\n? Do you want to invoke this function on a recurring schedule? No\r\n? Do you want to configure Lambda layers for this function? No\r\n? Do you want to edit the local lambda function now? No\r\nSuccessfully added resource listPublic locally.\r\n\r\nNext steps:\r\nCheck out sample function code generated in <project-dir>/amplify/backend/function/listPublic/src\r\n\"amplify function build\" builds all of your functions currently in the project\r\n\"amplify mock function <functionName>\" runs your function locally\r\n\"amplify push\" builds all of your local backend resources and provisions them in the cloud\r\n\"amplify publish\" builds all of your local backend and front-end resources (if you added hosting category) and provisions them in the cloud\r\nSuccesfully added the Lambda function locally\r\n? Restrict API access No\r\n? Do you want to add another path? No\r\nSuccessfully added resource rest locally\r\n```\r\n\r\n4. Edit my Lambda function\r\n```javascript\r\n/* Amplify Params - DO NOT EDIT\r\n\tAPI_MYPROJECT_GRAPHQLAPIIDOUTPUT\r\n\tAPI_MYPROJECT_PUBLICTABLE_ARN\r\n\tAPI_MYPROJECT_PUBLICTABLE_NAME\r\n\tENV\r\n\tREGION\r\nAmplify Params - DO NOT EDIT */\r\n\r\nconst AWS = require(\"aws-sdk\");\r\nconst region = process.env.REGION\r\n\r\nAWS.config.update({ region });\r\n\r\nconst docClient = new AWS.DynamoDB.DocumentClient();\r\n\r\nconst params = {\r\n    TableName: \"PublicTable\"\r\n}\r\n\r\nasync function listItems(){\r\n    try {\r\n      const data = await docClient.scan(params).promise()\r\n      return data\r\n    } catch (err) {\r\n      return err\r\n    }\r\n}\r\n\r\nexports.handler = async (event) => {\r\n    try {\r\n        const data = await listItems()\r\n        return { body: JSON.stringify(data) }\r\n      } catch (err) {\r\n        return { error: err }\r\n    }\r\n};\r\n```\r\n\r\n4. Push my updates\r\n\r\n```sh\r\n$ amplify push\r\n```\r\n5. Open my REST API endpoint `/items`\r\n```json\r\n{\r\n  \"message\": \"User: arn:aws:sts::829736458236:assumed-role/myprojectLambdaRolef4f571b-dev/listPublic-dev is not authorized to perform: dynamodb:Scan on resource: arn:aws:dynamodb:us-east-1:8297345848236:table/Public-ssrh52tnjvcdrp5h7evy3zdldsd-dev\",\r\n  \"code\": \"AccessDeniedException\",\r\n  \"time\": \"2021-04-21T21:21:32.778Z\",\r\n  \"requestId\": \"JOA5KO3GVS3QG7RQ2V824NGFVV4KQNSO5AEMVJF66Q9ASUAAJG\",\r\n  \"statusCode\": 400,\r\n  \"retryable\": false,\r\n  \"retryDelay\": 28.689093010346657\r\n}\r\n```\r\n## Problems\r\n\r\n1. What I did wrong?\r\n2. How do I access my table and why I didn't get it when I created it?\r\n3. Why `API_MYPROJECT_PUBLICTABLE_NAME` and other constants are needed?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"ApollonSeven"},"body":"## Decision\r\nThe problem turned out to be either the `NodeJS` version or the `amplify-cli` version. After updating `amplify-cli` and installing the node on the `14.16.0` version, everything worked.\r\nI also changed the name of the table to what Amplify creates for us, although this code did not work before. The code became like this:\r\n\r\n```javascript\r\n/* Amplify Params - DO NOT EDIT\r\n\tAPI_MYPROJECT_GRAPHQLAPIIDOUTPUT\r\n\tAPI_MYPROJECT_PUBLICTABLE_ARN\r\n\tAPI_MYPROJECT_PUBLICTABLE_NAME\r\n\tENV\r\n\tREGION\r\nAmplify Params - DO NOT EDIT */\r\n\r\nconst AWS = require(\"aws-sdk\");\r\nconst region = process.env.REGION\r\nconst tableName = process.env.API_MYPROJECT_PUBLICTABLE_NAME\r\n\r\nAWS.config.update({ region });\r\n\r\nconst docClient = new AWS.DynamoDB.DocumentClient();\r\n\r\nconst params = {\r\n    TableName: tableName\r\n}\r\n\r\nasync function listItems(){\r\n    try {\r\n      const data = await docClient.scan(params).promise()\r\n      return data\r\n    } catch (err) {\r\n      return err\r\n    }\r\n}\r\n\r\nexports.handler = async (event) => {\r\n    try {\r\n        const data = await listItems()\r\n        return { body: JSON.stringify(data) }\r\n      } catch (err) {\r\n        return { error: err }\r\n    }\r\n};\r\n```"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjk2NTc4","author":{"login":"Stvad"},"title":"How to initialize Amplify JS from the saved user tokens?","body":"### What I want to do\r\n\r\nI want to be able to delegate auth state to an additional client application (js extension running within https://roamresearch.com/ app). Where I'd like to use Amplify JS library to call my API's & access S3 storage.\r\n\r\n**How I think it should/can work:**\r\n- Configure my appclient refresh token to have a long expiration time. (Maybe create a dedicated app client for this, but that can lead to somewhat awkward UX)\r\n- Give users a JS snippet to run\r\n- That snippet would include the relevant keys (including a long-lasting refresh key)\r\n- An instance of the extension makes use of that snippet, initializes Amplify library and can access my app backend resources.\r\n\r\n### The question\r\nMy question is how to accomplish the last step in this scenario - that is - how does one go about initializing Amplify current user state from a set of known tokens (vs having it automagically retrieve things from localstorage & such)\r\n\r\nOne Idea I had is to provide a custom implementation of the [storage](https://docs.amplify.aws/lib/auth/manageusers/q/platform/js#managing-user-attributes) that would return the saved tokens when queried. But that seems like a convoluted/complicated solution. So I was wondering if there is a better way?\r\n\r\n### Should I be doing this?\r\nWhile writing this it occurred to me that maybe I should just embed my amplify app settings into the extension and just let users go through the Auth flow in the context of the extension. Which can probably be an option, but I'd prefer to make the flow described above work first if it's possible :) ","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"ET-CS"},"body":"+1\r\n\r\n@Stvad Did you found how to authenticate to Amplify using token?"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzI5NjM4","author":{"login":"vomc"},"title":"Is it possible to add a 'show password' button to reveal the password in plain text?","body":"We want to provide our users a way to see the password that they are typing when they sign up. Our app uses the React Amplify Cognito components. Searching the docs I was not able to find anything related to this. \r\n\r\nIs there any documentation (or links) available that someone could point me to in terms of how we could implement this. Essentially it would be a little button as commonly found in many websites where a user can see the password in plain text as they are typing it.\r\n\r\nThank you!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzI4OTE4","author":{"login":"SaileshKumar"},"title":"Client State Management for Amplify AppSync WebApp","body":"Hi all,\r\n\r\nI have built an app using Amplify/AppSync/Cognito  for React JS. I'm looking to add a library that can handle state management. Specific use cases would be something like:\r\n\r\nIf on the same page, I have a list of objects queried from graphql, and then I click a button that adds an object to that same list via a mutation, I want to see the object without having to refresh the page. I know I can do it manually, but when I worked with React last I used Relay and it took care of this caching and management automatically.\r\n\r\nIs there anything like this I can use? I was reading about Apollo too, but it doesn't look like it plays well with AppSync. If I want to scale this project is AppSync even the right way to go, or should I switch off to a better management service while it's not too heavy?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzI4ODE5","author":{"login":"SaileshKumar"},"title":"Looking for help on AWS AppSync GraphQL Schema design","body":"Hi! I'm trying to uplevel my AppSync skills with Schema design, and am having issues with this model I want to create.\r\n\r\nI'm building a basic twitch clone for fun, but am having trouble with the user privacy of streamers vs users. I want to do something like this where any user can watch and subscribe to streams, but only streamers can have profiles, and be publicly scrollable. \r\n\r\nCurrently I have something like this:\r\n\r\ntype User @model {\r\n  id: ID!\r\n  name: String!\r\n  last_name: String!\r\n  profile_picture: String\r\n  subscribed_streams: [Stream] @connection\r\n  streamer_info: TeacherInfo\r\n  streams: [Streams] @connection(keyName: \"byStreamer\", fields: [\"id\"])\r\n}\r\n\r\ntype StreamerInfo {\r\n  instagram_url: String\r\n  bio: String\r\n}\r\n\r\ntype Stream @model @key(name: \"byStreamer\", fields: [\"streamerID\"]) {\r\n  id: ID!\r\n  title: String!\r\n  teacherID: ID!\r\n  description: String!\r\n  streamer: User @connection(fields: [\"streamerID\"]) \r\n}\r\n\r\nI wanted to have a separate type for \"Streamer\", so that only Streamers would be publicly accessible, and only Streamers could have the @connection for streams (as in their OWN streams), but I couldn't figure out how to do that without making it its own model with its own ID. I want only Streamers to be able to create Streams, but also be able to watch streams as normal users. I also want public users (not logged in) to be able to execute a query for all Streamers, but NOT for all Users.\r\n\r\nIs there a way to have Streamers still be Users, but with \"elevated\" privileges? That way I could use Cognito User Groups to elevate users to \"Streamer\" when they are that status.\r\n\r\nThank you in advance!\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzI3Mzgx","author":{"login":"aj120426394"},"title":"Amplify not working after upgrade from 3.3.14 to 3.3.27","body":"We try to upgrade the version of `aws-amplify` then the Auth seems not working. \r\n\r\nOur current setup use Cognito user poll for auth role and IAM for unauth role. Everything is working at `amplify: 3.3.14`\r\n\r\nAfter the audit result says there is a high risk vulnerability at `3.3.14`. We ran `npm audit fix` and it upgrade `amplify` to `3.3.27` which is the latest version. Then all the graphql connection is not working. We have tried only upgrade `amplfy` to `3.3.27` without using `npm audit fix`, and it still not working.\r\n\r\nWe do have the below code at `index.ts`\r\n```\r\nimport Amplify, { Auth } from 'aws-amplify'\r\nimport awsconfig from './aws-exports'\r\n\r\nAmplify.configure(awsconfig)\r\n```\r\nFew error message we can see at Query:\r\n```\r\n18:11.837 GraphQLAPI - ensure credentials error No Cognito Identity pool provided for unauthenticated access\r\nGraphQLAPI.ts:138 Uncaught (in promise) Error: No credentials\r\n    at GraphQLAPIClass.<anonymous> (GraphQLAPI.ts:138)\r\n    at step (v4.js:29)\r\n    at Object.next (v4.js:29)\r\n    at fulfilled (v4.js:29)\r\n```\r\nat Subscribe:\r\n```\r\nSubscribe only available for AWS AppSync endpoint\r\n```\r\n\r\nAlready stuck on this for a while, any idea?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzI1ODg3","author":{"login":"Pazago"},"title":"Auth with vanilla js - How?","body":"Hi everyone,\r\n\r\ncurrently I want to setup a website with vanilla js and later on with some bootstrap. But I'm not able to SignUp/SignIn a user over Cognito. I tried it multible time from scratch with the offical documentation (https://docs.amplify.aws/lib/auth/getting-started/q/platform/js). But I'm always getting different kinds on errors:\r\n\r\n- ![grafik](https://user-images.githubusercontent.com/32204316/115120511-293e3280-9fae-11eb-84bb-5733d88d0350.png)\r\n\r\n-![grafik](https://user-images.githubusercontent.com/32204316/115120520-378c4e80-9fae-11eb-9282-fbe253609e0b.png)\r\n\r\nThose are the most common once depending wether I make the src import with \"module\" or without.\r\n\r\nHere is the code for the login.html:\r\n\r\n<!-- === Login form === -->\r\n        <section class=\"form-wrap\">\r\n          <h1>Sign In</h1>\r\n          <form id=\"signinForm\" onSubmit=\"return signIn()\">\r\n            <input type=\"username\" id=\"usernameInputSignin\" placeholder=\"username\" required>\r\n            <input type=\"password\" id=\"passwordInputSignin\" placeholder=\"Password\" pattern=\".*\" required>\r\n        \r\n            <input type=\"submit\" value=\"SignIn\">\r\n        \r\n          </form>\r\n        </section>\r\n               \r\n        \r\n        <!-- === SignUp form === -->\r\n        <section class=\"form-wrap\">\r\n          <h1>Sign Up</h1>\r\n          <form action=\"javascript:signUp()\" id=\"signupForm\">\r\n            <input type=\"username\" id=\"usernameInputSignup\" placeholder=\"username\" required>\r\n            <input type=\"password\" id=\"passwordInputSignup\" placeholder=\"Password\" pattern=\".*\" required>\r\n        \r\n            <input type=\"submit\" value=\"SignUp\">\r\n        \r\n          </form>\r\n        </section>\r\n\r\n    <script src=\"dist/main.bundle.js\"></script>\r\n    <script src=\"src/app.js\"></script>\r\n\r\n\r\nHere is the relevant code from the app.js:\r\nimport Amplify, { API, graphqlOperation, Auth } from \"aws-amplify\";\r\n\r\n import awsconfig from \"./aws-exports\";\r\n import { createTodo } from \"./graphql/mutations\";\r\n import { listTodos } from \"./graphql/queries\";\r\n import { onCreateTodo } from \"./graphql/subscriptions\";\r\n\r\n Amplify.configure(awsconfig);\r\n\r\nexport async function signUp() {\r\n    try {\r\n        const { user } = await Auth.signUp({\r\n            username,\r\n            password,\r\n            attributes: {\r\n                email,          // optional\r\n                phone_number,   // optional - E.164 number convention\r\n                // other custom attributes \r\n            }\r\n        });\r\n        console.log(user);\r\n    } catch (error) {\r\n        console.log('error signing up:', error);\r\n    }\r\n} \r\n \r\n async function signIn() {\r\n    try {\r\n        const user = await Auth.signIn(username, password);\r\n    } catch (error) {\r\n        console.log('error signing in', error);\r\n    }\r\n}\r\n \r\n async function signOut() {\r\n    try {\r\n        await Auth.signOut();\r\n    } catch (error) {\r\n        console.log('error signing out: ', error);\r\n    }\r\n}\r\n\r\nIf you need anything else don't hesitate to ask. Can also share my testing file but I think it will be to much input for the start.\r\nThanks a lot in advance\r\n~paz","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzI0NjQ5","author":{"login":"franklt69"},"title":"amplify-confirm-sign-up don't show up toast (angular)?","body":"Hi, I have this code in the sign-up process, but the toast does not appear when validation fails. Could someone give me a hint on how to show the toast when an error occurs?\r\n\r\n```\r\n onSignUpSubmit =  async event => {\r\n        event.preventDefault();\r\n        try {\r\n            const formData = {\r\n                username: this.userEmail,\r\n                password: this.userPassword,\r\n                attributes: {\r\n                    profile: this.globalService.issuer,\r\n                    phone_number: this.userPhoneNumber ? this.userDialCode + this.userPhoneNumber : null\r\n                }\r\n            }\r\n            const data = await Auth.signUp(formData);\r\n           \r\n            Hub.dispatch(UI_AUTH_CHANNEL, {\r\n                event: AUTH_STATE_CHANGE_EVENT,\r\n                message: AuthState.ConfirmSignUp,\r\n                data: {\r\n                    ...data.user,\r\n                    signUpAttrs: formData\r\n                }\r\n            });\r\n        }\r\n        catch (e) {\r\n            console.log(e); //==>  **Here I need to show up the error in the amplify toast (like default behavior), but I don't find documentation about it.**\r\n        }\r\n    }\r\n```\r\n\r\nThanks\r\nFrank\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"franklt69"},"body":"Thanks,  Looking in the source code of amplify I found this solution.\r\n\r\n```\r\n onSignUpSubmit =  async event => {\r\n        event.preventDefault();\r\n        try {\r\n            const formData = {\r\n                username: this.userEmail,\r\n                password: this.userPassword,\r\n                attributes: {\r\n                    profile: this.globalService.issuer,\r\n                    phone_number: this.userPhoneNumber ? this.userDialCode + this.userPhoneNumber : null\r\n                }\r\n            }\r\n            const data = await Auth.signUp(formData);\r\n\r\n            Hub.dispatch(UI_AUTH_CHANNEL, {\r\n                event: AUTH_STATE_CHANGE_EVENT,\r\n                message: AuthState.ConfirmSignUp,\r\n                data: {\r\n                    ...data.user,\r\n                    signUpAttrs: formData\r\n                }\r\n            });\r\n        }\r\n        catch (error) {\r\n            Hub.dispatch(UI_AUTH_CHANNEL, {\r\n                event: TOAST_AUTH_ERROR_EVENT,\r\n                message: error.message,\r\n            });\r\n        }\r\n    }\r\n```\r\n\r\nThanks\r\nFrank"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzE1Nzkw","author":{"login":"flo-mair"},"title":"Use custom components to navigate Cognito UI","body":"I want to use custom React Components within <AmplifyAuthenticator> (replacing SignIn and SignUp). How do i navigate between the slots, when i set AuthState the UI does not change.\r\n\r\n```import {AmplifyAuthenticator, AmplifySignIn,} from \"@aws-amplify/ui-react\";\r\nimport React, {useState} from \"react\";\r\nimport { AuthState } from '@aws-amplify/ui-components';\r\n\r\n\r\nconst Login = () =>{\r\n\r\n    const [authState, setAuthState] = React.useState();\r\n\r\n    const moveToSignUp = (e) => {\r\n        e.preventDefault()\r\n        setAuthState(AuthState.SignUp)\r\n    }\r\n\r\n    return (\r\n        <AmplifyAuthenticator>\r\n            <div slot=\"sign-in\"><button onClick={ e => moveToSignUp(e)} >Move to signUp</button></div>\r\n            <div slot=\"sign-up\">Test SignUp</div>\r\n        </AmplifyAuthenticator>\r\n    );\r\n}\r\n\r\nexport default Login```","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzExNjg1","author":{"login":"Mortuie"},"title":"Running NextJS with Amplify","body":"Current Setup:\r\n- Client Side Rendering with Create React App\r\n- ReactJS\r\n- Hooks \r\n- Redux\r\n- AWS Serverless / Amplify / AppSync / Cognito Pools\r\n\r\nObviously client side rendering is much nicer but I have now encountered a use case, where good/dynamic SEO is required for the next phase of development for our product.\r\n\r\nThus I have started doing some experimentation with Nextjs and Amplify (which is my backend stack) and now I have encountered some questions:\r\n- For every new page I render let's say /profile -> There are three use cases (the persons own profile needs to be able to edit - one case), someone else's a profile (whether or not your logged in - so 2 different cases)\r\n- Per request to this `/profile` page do I need to \r\n```javascript\r\nexport async function getServerSideProps({ req }) {\r\n  const SSR = withSSRContext({ req });\r\n\r\n  let user = await SSR.Auth.currentAuthenticatedUser();\r\n  user = user.signInUserSession.idToken.payload[\"cognito:username\"];\r\n```\r\n\r\nJust to get the user info i.e. cognitoid then if I want to get the details for that specific user I would have to send another request to the server with `getUserProfile(cognitoid)`\r\n\r\nQ1: Does the userid/cognito id not get stored in a cookie/parameter as part of `getServerSideProps(req)` this just adds so much overhead to each new page load that I would assume that it is really slow as you end up doing many more requests that required (in this example 2 instead of 1).\r\n\r\n\r\nQ2: Does anyone have experience running Auth.federatedSignIn with Nextjs.\r\nAs this redirects to facebook/google within the page and the Listener.hub module is used to listen for successful/non successful auth.\r\n\r\nWhat is a common pattern of setting that up with SSR as I assume it is going to be different to the CSR usecase?\r\n ","upvoteCount":3,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzExMDgz","author":{"login":"MaxmaxmaximusAWS"},"title":"Where i can get default directives SDL? My IDE show error @model directive not exists","body":"![image](https://user-images.githubusercontent.com/69426460/113976277-8ff27c00-9849-11eb-939a-29845fae773b.png)\r\n\r\n![image](https://user-images.githubusercontent.com/69426460/113976249-80733300-9849-11eb-8860-4e4a6f578e07.png)","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"MaxmaxmaximusAWS"},"body":"Answe, in this page https://docs.amplify.aws/cli/graphql-transformer/directives we can click any directive and get definition."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzA5NDI3","author":{"login":"ionutmiftode"},"title":"refreshHandlers for react native","body":"Hello community,\r\n\r\nDoes someone have an example of refreshHandlers functions for a react-native app for Google, Facebook and Apple sign in?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzA5MTEw","author":{"login":"midohree"},"title":"How can I upload large video file to S3 using amplify?","body":"I am trying to upload a video to s3 using amplify in Reactjs.\r\nUploading small files is okay. (The test file size is 1.4MB)\r\nBut I want to upload a large size video. (About 60MB to 1GB).\r\nBut at the end of the file upload, an upload failure and an two error messages popped up.\r\nI searched the official documentation, but there is no answer to this.\r\nCan you give me a solution? \r\nAre there any more options I need to add?\r\n\r\n```\r\n[ERROR] 54:32.190 axios-http-handler Error: Request failed with status code 400\r\n\r\n[ERROR] 54:32.195 AWSS3ProviderManagedUpload - error happened while finishing the upload. Cancelling the multipart upload Error: Request failed with status code 400\r\n```\r\n\r\n```javascript\r\nimport React, { useEffect, useState } from \"react\";\r\nimport { useDropzone } from \"react-dropzone\";\r\nimport Amplify, { Storage } from \"aws-amplify\";\r\nimport awsExports from \"./aws-exports\";\r\n\r\nAmplify.configure(awsExports);\r\n\r\nconst App = () => {\r\n  const [imageUrl, setImageUrl] = useState(null);\r\n  const [isLoading, setLoading] = useState(false);\r\n  const [file, setFile] = useState(null);\r\n\r\n  const {\r\n    getRootProps,\r\n    getInputProps,\r\n    isDragAccept,\r\n    isDragActive,\r\n    isDragReject,\r\n  } = useDropzone({\r\n    accept: \"video/*\",\r\n    onDrop: (files) => {\r\n      console.log(files)\r\n      setFile(files[0]);\r\n    },\r\n  });\r\n\r\n  useEffect(() => {\r\n    if (file) {\r\n    (async function () {\r\n      try {\r\n        setLoading(true);\r\n\r\n        await Storage.put(file.name, file, {\r\n          contentType: file.type,\r\n          progressCallback(progress) {\r\n            console.log(`Uploaded: ${progress.loaded}/${progress.total}`);\r\n          },\r\n        });\r\n\r\n        const url = await Storage.get(file.name);\r\n\r\n        setImageUrl(url);\r\n        setLoading(false);\r\n      } catch (err) {\r\n        console.log(err);\r\n      }\r\n    })();\r\n  }\r\n  }, [file]);\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <h1> Upload an Image </h1>\r\n      {isLoading ? (\r\n        <h3>Uploading...</h3>\r\n      ) : (\r\n        <Container\r\n          {...getRootProps({ isDragAccept, isDragActive, isDragReject })}\r\n        >\r\n          <input {...getInputProps()} />\r\n          <p>Drag 'n' drop some files here, or click to select files</p>\r\n        </Container>\r\n      )}\r\n      <div>\r\n        {imageUrl ? (\r\n          <img style={{ width: \"30rem\" }} src={imageUrl} alt=\"preview\" />\r\n        ) : (\r\n          <span />\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default App;\r\n\r\n```\r\n","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzA4MTE0","author":{"login":"Max161"},"title":"Angular - Interceptor not workign with Amplify","body":"Dear all, \r\n\r\ncurrently, I'm trying to use Cognito authentication with my web app. \r\nI have integrated the amplify correctly in my web app and I'm able to use the sign-up, sign-in and all the other functions in my web app. \r\nHowever, I have a spinner interceptor that is showing a loading bar while any of the HTTP requests are ongoing, but it's not intercepting any of the Amplify requests. \r\n\r\nDo you have any idea why it's not working?  All the other requests are correctly intercepted. \r\n ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzA1Nzk4","author":{"login":"shyamsohane"},"title":"Can we add scope in ID token from pre generation lamda script?","body":"Can we add Scope in ID token from pre generation lamda script? Has anyone modified it?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzA1NzIz","author":{"login":"shaharkazaz"},"title":"Auth | Hub | Federated signUp event","body":"Hey,\r\n\r\nI need to know when a user uses a provider (google in my case) to perform sign-up/log-in what action took place.\r\nI tried listening to the Hub events but looking at [the source code](https://github.com/aws-amplify/amplify-js/blob/df95ea3724eb6406f64b03f25086cd3e8644cb5f/packages/auth/src/Auth.ts#L2064) looks like the federated response handler only emits `signIn` events and doesn't distinguish between log-in and sign-up.\r\n\r\nI have seen in several places a suggestion to use the lambda trigger and in fact, we are using them, but the UI needs to redirect to one place in the case of `signIn` and to another in case of `signUp` and as far as I could see there is no way I can pass parameters from the triggers back to the client.\r\n\r\nAny way I can achieve that using Cognito? maybe pass some custom response from the lambda trigger? or any other option? or do I have to implement something myself? \r\n\r\nI **really** need help on this one 🙏 \r\n\r\nThanks in advance for any response!","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzAzNTY2","author":{"login":"agoldis"},"title":"Custom attributes for IAM role policy","body":"There're plenty of AWS source describing the use of custom attributes for role polices. \r\n\r\nThat seems to be working only for 3rd part auth providers, but not with Cognito User Pool custom attributes.\r\n\r\nEvent though they are customizable in Cognito Identity Pool console:\r\n\r\n<img width=\"1198\" alt=\"Screen Shot 2021-04-02 at 12 57 14 AM\" src=\"https://user-images.githubusercontent.com/1637928/113395383-9c10a200-934e-11eb-84ce-f9c38802e47a.png\">\r\n\r\n\r\nI am trying to use `${aws:PrincipalTag/orgId}` in a policy without any success.\r\n\r\n```json\r\n...\r\n\r\n            \"Condition\": {\r\n                \"StringLike\": {\r\n                    \"s3:prefix\": [\r\n                        \"${cognito-identity.amazonaws.com:sub}/*\",\r\n                        \"${aws:PrincipalTag/orgId}/*\",\r\n                    ]\r\n                }\r\n            }\r\n```\r\n\r\n- Is it actually available? \r\n- How can I troubleshot access to S3 and / or see the principal tags issues by STS? \r\n\r\nReference: https://docs.aws.amazon.com/cognito/latest/developerguide/using-attributes-for-access-control-policy-example.html\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzAyOTMz","author":{"login":"shahbour"},"title":"pubsub clean session and QoS","body":"Hello \r\n\r\nI am trying to use amplify pubsub to connect to aws iot , but i need to set clean_session= false , to persist the messages and also i need to set the qos of messages to at least 1 .\r\n\r\nAny idea how we can do this using amplify library .\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzAyNDEw","author":{"login":"gruckionvit"},"title":"Attempt limit exceeded, please try after some time.","body":"When writing code and littering on a feature I am getting blocked by `LimitExceededException` which is slowing down my development effort. I have to park that task go to something else and come back to it later and hope I get it solved without submitting as much next time.\r\n\r\nThis isn't ideal, is there a way to extend this limit for staging environments?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjkyMjAx","author":{"login":"myfairshare"},"title":"DataStore query a model with predicates 'contains'...","body":"Hello,\r\n\r\n    I have a model called Tenancy that looks like..\r\n\r\ntype Tenancy @model {\r\n  id: ID!\r\n invitedEmails: [String]\r\n}\r\n\r\nSo lets say I want to find the instance with 'jim@gmail.com' is in invitedEmails\r\n\r\nMy understanding is I can search DataStore using the 'contains' predicate like below..\r\n\r\n```\r\nconst inviteCheck = await DataStore.query(Tenancy, (t) =>\r\n        t.invitedEmails('contains', 'jim@gmail.com')\r\n      )\r\n      console.log(inviteCheck)\r\n```\r\nI expect to receive back an array of 1 object because it found this email address in one instance.\r\n\r\nBy data is synching to dynamodb and local database...\r\n\r\nBut I get the error..\r\n\r\nTypeError: Cannot read property 'indexOf' of null\r\n    at validatePredicateField (util.ts:103)\r\n    at util.ts:65\r\n    at Array.every (<anonymous>)\r\n    at validatePredicate (util.ts:60)\r\n    at IndexedDBAdapter.ts:404\r\n    at Array.filter (<anonymous>)\r\n    at IndexedDBAdapter.<anonymous> (IndexedDBAdapter.ts:403)\r\n    at step (InMemoryStore.ts:41)\r\n    at Object.next (InMemoryStore.ts:41)\r\n    at fulfilled (InMemoryStore.ts:41)\r\n\r\nAm I making a silly mistake or misunderstanding something, thanks for any tips!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjkxNjQ2","author":{"login":"sakihayashi"},"title":"Code splitting wih Amplify","body":"Hi everyone,\r\nI have an app using React and MongoDB SDK.\r\nI use Amplify only hosting the app so do not use any SDK for auth. I use SSR with Amplify.\r\n\r\nBut, my lighthouse speed score is 3 out of 100 although it does not look that bad. The first contentful paint takes more than 8 secs for mobile.\r\n\r\nThe biggest issue is chunk.js is like over 800kb on every page and I tried to reduce it by using the lodable-component.\r\nBut it does not really work. \r\n\r\nDoes anyone have experience in reducing the size?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjcyMjM5","author":{"login":"j4nos"},"title":"Module not found: Can't resolve '../src/aws-exports'","body":"Do I need to run `amplify configure` to be able to support SSR in my Next.js Amplify app? \r\n\r\nOr how can I avoid this error? I would run Next.js with SSR support. Do I really need IAM to run my app?\r\n\r\n```\r\nModule not found: Can't resolve '../src/aws-exports'\r\n```","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"sammartinez"},"body":"Hello, @j4nos. You are correct that you will need to run the above command `amplify configure` in order to use SSR with Next.js"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjg4OTgy","author":{"login":"sbganesh"},"title":"Access Denied or Too Many Redirects when trying to open a page in a new tab using React Link","body":"Hi All,\r\n\r\nI'm developing a React application hosted in Amplify platform. I wanted to have a page opened in a separate tab, so I used \r\n\r\n\"<Link to={`/newPage/${rowData.id}`} target=\"_blank\">\", \r\n\r\nI have the rewrite configured and without target \"blank\" it works well by opening the page in the same window. When I use the \"blank\" option I'm getting too many redirects, removing the rewrite is giving the access denied issue. \r\n\r\nKindly let me know how I can open a page in a new tab for the react application hosted in Amplify. ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjg0OTYx","author":{"login":"MachariaK"},"title":"Admin UI login credentials","body":"Which credentials should I use to log in to the Admin UI? The console and other user credentials do not work.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjg0NTA2","author":{"login":"SanderKnape"},"title":"How to set the active state","body":"I can't figure out how to set the active state that Amplify should show. For example, when my users navigate to `/signup` they should see the SignUp page. Right now the only way I'm able to view this page is by clicking the \"Sign up\" link on the Sign in page.\r\n\r\nHow do I associate a page/URL with an active state? The same goes for states like forgotpassword, settingMFA and others.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjgyMjgz","author":{"login":"rally25rs"},"title":"Handling grant code in Authorization Code Grant + PKCE in JS API? (infinite redirects)","body":"Trying to use the Cognito hosted UI in an oauth2 \"Authorization Code Grant + PKCE\" manor (with react and react-router).\r\n\r\nIt seems that calling `Auth.federatedSignIn()` ends up redirecting the browser to `{redirectSignIn}?code=...`\r\n\r\nIn other words, if you made a react view (and assume this is part of the `localhost:3000/` view)\r\n\r\n```\r\nimport React from 'react';\r\nimport Amplify, {Auth} from 'aws-amplify';\r\n\r\nexport default function LoginTest() {\r\n  const signin = React.useCallback(async () => {\r\n    const response = await Auth.federatedSignIn();\r\n  }, []);\r\n\r\n  React.useEffect(() => {\r\n    Amplify.configure({\r\n      aws_project_region: 'us-east-2',\r\n      aws_cognito_identity_pool_id: 'us-east-2:...',\r\n      aws_cognito_region: 'us-east-2',\r\n      aws_user_pools_id: '...',\r\n      aws_user_pools_web_client_id: '...',\r\n      Auth: {\r\n        oauth: {\r\n          redirectSignIn: 'http://localhost:3000/',\r\n          redirectSignOut: 'http://localhost:3000/',\r\n          scope: ['email', 'profile', 'openid'],\r\n          domain: '....us-east-2.amazoncognito.com,\r\n          responseType: 'code',\r\n        },\r\n      },\r\n    });\r\n\r\n    signin();\r\n  }, []);\r\n\r\n  return (\r\n    <div>\r\n      <h1>Test</h1>\r\n    </div>\r\n  );\r\n}\r\n```\r\n\r\nit just infinite refresh loops hosted cognito ui => `localhost:3000/?code=...` => hosted cognito ui => `localhost:3000/?code=...` => ...etc\r\n\r\n#3005 makes it sound like the \"Authorization Code Grant + PKCE\" cycle of validating the `code` should be handled magically somehow. 🤔 I'm not sure if it's my fault, or an Amplify issue, or a variation of issue #3391 , or what.\r\n\r\nAny advice would be greatly appreciated.\r\n\r\n(aws-amplify v3.3.25)\r\n\r\n-----\r\n\r\n_Edit 1:_\r\n\r\nMade some progress by making sure my app does not re-invoke `federatedSignIn` if there is a `code=` on my URL (oops).\r\n\r\nNow Amplify seems to make a `POST  https://cognito-identity.us-east-2.amazonaws.com/` passing an `IdentityId` and `Logins` which ends up returning\r\n\r\n> Invalid identity pool configuration. Check assigned IAM roles for this pool.\r\n\r\nThe docs around any of this are real vague but I was under the impression that Amplify `federatedSignIn` would attempt an \"Authorization Code Grant\" login flow, which I expected to just taken the `code` off the URL and then called `POST https://....amazoncognito.com/oauth2/token?code=...&...` \r\ni.e. exchange the auth code using the oauth2 token endpoint https://docs.aws.amazon.com/cognito/latest/developerguide/token-endpoint.html\r\n\r\nIs there a way to make it just do that instead of ... whatever this `https://cognito-identity.us-east-2.amazonaws.com` thing is?\r\n\r\n-----\r\n\r\n_Edit 2:_\r\n\r\nOK so I had copy/pasted config settings from another post, and defining `aws_cognito_identity_pool_id` in the config makes it try to POST to `https://cognito-identity.us-east-2.amazonaws.com` (to the identity pool) instead of POST to the expected `oauth2/token` endpoint (to the user pool).\r\n\r\nPhwew. Crisis averted. Maybe this will help someone else in the future 🤷 ","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"rally25rs"},"body":"_Posting my own solution so that I can mark this as \"answered\"..._\r\n\r\nCalling `await Auth.currentSession();` got me the result of the decoded token from the auth flow which I could then use to decide whether or not to call `federatedSignIn()`\r\n\r\nOriginally I was trying to call `currentCredentials()` which was getting an Identity Pool error. I guess that call is only if you are using id pools.\r\n\r\n```\r\nimport {React} from '@vht/react-components/libs';\r\nimport Amplify, {Auth} from 'aws-amplify';\r\n\r\nexport default function LoginTest() {\r\n  const [claims, setClaims] = React.useState();\r\n\r\n  const signin = React.useCallback(async () => {\r\n    const currentSession = await Auth.currentSession();\r\n    if (currentSession) {\r\n      setClaims(currentSession.getIdToken().decodePayload());\r\n    } else {\r\n      await Auth.federatedSignIn();\r\n    }\r\n  }, []);\r\n\r\n  React.useEffect(() => {\r\n    Amplify.configure({\r\n      aws_project_region: 'us-east-2',\r\n      aws_cognito_region: 'us-east-2',\r\n      aws_user_pools_id: 'us-east-2_...',\r\n      aws_user_pools_web_client_id: '...,\r\n      Auth: {\r\n        oauth: {\r\n          redirectSignIn: `${window.location.origin}/`,\r\n          redirectSignOut: `${window.location.origin}/`,\r\n          scope: ['email', 'profile', 'openid'],\r\n          domain: '...',\r\n          responseType: 'code',\r\n        },\r\n      },\r\n    });\r\n\r\n    signin();\r\n  }, []);\r\n\r\n  return (\r\n    <div>\r\n      <h1>Test</h1>\r\n      {claims && (\r\n        <code>\r\n          <pre>{JSON.stringify(claims, null, 2)}</pre>\r\n        </code>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n```"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjgxNjUz","author":{"login":"davidbiller"},"title":"Dynamic Group Authorization - best way for Dashboard SAAS Accounts?","body":"https://docs.amplify.aws/cli/graphql-transformer/auth#dynamic-group-authorization\r\n\r\n\r\nI have a dashboard where partners can log in. Here they can see users who have signed up through their link on the platform. \r\n\r\nSo that not only one user can see this, but several users of the partner, I wanted to use the groups @auth option. \r\n\r\nSo I would create a separate group in Cognito for each partner. Then, when the partner invites their employees, I would assign the accounts to the group. \r\n\r\nNow I have seen that there is a maximum of 10k groups. It will be a long time before we get to that amount of partners, but is that the way to go? \r\n\r\n\r\n\r\n","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMjE2MTMx","author":{"login":"gyurobenjamin"},"title":"Parameter Store from Lambda","body":"Trying to use SM Parameter Store, but with amplify this would be a custom resource.\r\n\r\nI have a lambda function inside the amplify that needs to access a manually configured Parameter Store.\r\nCan anyone tell me what is the right was to setup the roles? Could this IAM config be in amplify codebase?\r\n\r\nThanks in advance!","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"jncheung"},"body":"It depends on how do you want the lambda to get value from the SSM.\r\n\r\nOne of the ways that I did is to edit the cloudformation-template.json and reference the SSM parameters dynamically using this syntax: `{{resolve:ssm:<your-ssm-nameor-its-path>:<version>}}` \r\n\r\n\r\nFor example, if I have a SSM parameter named `/a/b/c/d/e` and i wish to using the third version of it to be the lambda environment variable.  I can do it in this way:\r\n\r\n```javascript\r\n{ \r\n ... //in your lambda-fns-cloudformation-template.json\r\n   \"Environment\": {\r\n        \"Variables\": {\r\n            \"ABDCEFG\":  \"{{resolve:ssm:/a/b/c/d/e/f/g:3}}\",\r\n        }\r\n    }\r\n    ...\r\n}\r\n```\r\n\r\nIn this way, you do not require to set any IAM or anything as long as both amplify and SSM are set with in the same account and same region."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xODcy","author":{"login":"Jun711"},"title":"Is Cognito / AWS forum actively managed?","body":"Hi, \r\n\r\nI know some issues are caused by Cognito but not Amplify but a lot of posts in Cognito forum get no replies / answers after months or years. \r\n\r\nShould we post Amplify and Cognito related questions here as well? ","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"undefobj"},"body":"For official tracking by the Cognito team please post service related questions in the AWS Cognito forum. This repo is for Amplify library questions."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjY0MTA4","author":{"login":"marco-streng"},"title":"next.js | Requests from server-side are many times slower than from the client-side","body":"Currently I'm developing an app which uses AWS Cognito for authentication and AWS AppSync as a GraphQL server.\r\n\r\nI like to protect routes on the server side, so I implement a quite simple call to AWS Cognito using the Amplify package (like shown in the AWS tutorials)\r\n\r\n\r\n```javascript\r\nimport { withSSRContext } from 'aws-amplify'\r\n\r\nexport async function getServerSideProps ({ req }) {\r\n  const { Auth } = withSSRContext({ req })\r\n\r\n  try {\r\n    const user = await Auth.currentAuthenticatedUser()\r\n\r\n    return {\r\n      props: {\r\n        authenticated: true,\r\n        user: user.username\r\n      }\r\n    }\r\n  } catch (err) {\r\n    return {\r\n      redirect: {\r\n        destination: '/login'\r\n      }\r\n    }\r\n  }\r\n}\r\n```\r\n\r\n\r\n\r\n**The Problem**\r\n\r\nI've deployed the app to Vercel (production mode) and wondered about the slow performance (high FCP). After some research I found out, that this request takes about **400-500ms** on server-side.\r\nBut the same request done on the client-side run's in less than **15ms**.\r\n\r\nThe same difference appears when I want to fetch data from the AppSync endpoint (ServerSide: ~**900ms**, ClientSide: ~**150ms**)\r\n\r\nAt first I thought on a geographical distance Issue. But my AWS recources are all deployed in eu-central-1 (Frankfurt, Germany) and the Vercel functions in eu-west-3 (Paris, France). In other words: There is no atlantic ocean in between.\r\n\r\nThe duration is measured by comparing the unix timestamp right before and after the request runs.\r\n\r\nMaybe someone has got an idea or made a similar experience?\r\nThanks a lot!\r\n\r\n","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjU1OTgz","author":{"login":"ZalgirisKaunas"},"title":"error 304 - incompleteSignatureException when passing Cognito headers to Amplify Rest Api","body":"I really need to access the user group names of the user pool in the rest API lambda functions but I'm not sure how to do that. I've tried to pass the JWT token in the authorization header like that:\r\n\r\n```\r\nconst user = await Auth.currentAuthenticatedUser();\r\nconst token = user.signInUserSession.idToken.jwtToken;\r\n\r\nconst result = await API.get(data.apiName, data.dbPath, {\r\n  headers: {\r\n    Authorization: token,\r\n  },\r\n});\r\n```\r\n\r\nbut it returned incompleteSignatureException from cloudfront. \r\n\r\nI've also tried\r\n\r\n```\r\n      headers: { \r\n        Authorization: `Bearer ${(await Auth.currentSession()).getIdToken().getJwtToken()}`,\r\n      },\r\n```\r\n\r\nand without  `Bearer ` but error is always the same. \r\nIt is also interesting that passing the authorization header to Admin Queries API works fine and it's possible to get group names from the request context in there.\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjU1NTY1","author":{"login":"kristianjabilles-ms"},"title":"SSR: ReferenceError: window is not defined","body":"I am posting it here first as we are not sure if this is a bug or we might just be missing something in our approach.\r\n\r\n### SSR: ReferenceError: window is not defined\r\n\r\n```\r\nReferenceError: window is not defined\r\n    at UniversalStorage.setUniversalItem (/node_modules/@aws-amplify/core/lib/UniversalStorage/index.js:88:21)\r\n    at UniversalStorage.setItem (/node_modules/@aws-amplify/core/lib/UniversalStorage/index.js:69:22)\r\n    at CognitoUser.cacheTokens (/node_modules/amazon-cognito-identity-js/lib/CognitoUser.js:1412:18)\r\n    at /node_modules/amazon-cognito-identity-js/lib/CognitoUser.js:1391:17\r\n    at /node_modules/amazon-cognito-identity-js/lib/Client.js:127:31\r\n```\r\n\r\nWe have created a wrapper library for `aws-amplify` that can be used within multiple applications.\r\n- We have an `identity provider application` that  that let the user logs in and \r\n- Redirects them to the `dashboard application`.\r\n- The session is shared across the applications that is using the wrapper library, one of that application is a server side rendered product listing app that shows the users info in the header.\r\n\r\nThe issue occurs when the `refresh token` is triggered and attempts to update the `tokens` which are in the cookie.\r\n\r\n\r\n### Steps to reproduce the behavior:\r\n\r\n1. Login\r\n2. Visit the SSR listing app (The token is still valid in this moment, so we can still see the logged in user's info in the header)\r\n3. Close the SSR listing app and wait for the token expriy (In our case it is 1 hr)\r\n4. Visit the SSR listing app again (This is the stage that the error is thrown)\r\n\r\n\r\nIs anyone experiencing the same issue like this?","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjUyNjAy","author":{"login":"kannieWeesNie"},"title":"DataStore NotAuthorizedException","body":"In an amplify project (using Vue) I have auth and dataStore api installed. I have set up the api to use an api key for authentication and the auth category to allow users to sign in to my app.\r\n\r\nI do not have @auth in my data models but when I try and sync the datastore when not logged in, I get \"Unauthenticated access is not supported for this identity pool\". Why is this and what do I need to do to make sync work for unauthenticated users?\r\n\r\nmuch appreciated","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjUxOTk2","author":{"login":"ncyaodi"},"title":"Amplify to S3 \"Uncaught (in promise) No credentials\"","body":"Hi,\r\n\r\nI am connecting Amplify to S3 using unauthenticated access.\r\n\r\nI pretty much follow [the procedure here](https://aws.amazon.com/blogs/mobile/use-an-existing-s3-bucket-for-your-amplify-project/),  the difference is I built it for my own website by static generation. (using Next.js)\r\n\r\nI am getting warnings and errors \r\n\r\n![image](https://user-images.githubusercontent.com/12124635/110231297-c300c300-7ecb-11eb-8c02-348e99fc2e1c.png)\r\n\r\nCould you suggest how I can tackle this issue?\r\n\r\nThanks,\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjUxNDQ1","author":{"login":"Ama-dou"},"title":"How to find out the automatically assigned ID of an object created by a datastore.save operation","body":"Am working on a react app and i have table name user with some informations\r\nI have form and when the user filled the form it creates a new model in my table.\r\nBut i want to check if the user existe and update the existinf user else create a new one.\r\n) I have no idea how to get the ID. I can see that an ID is generated by Amplify (looks to be a UUID or similar), but when I do use DataStore.save, there's no response as far as I can tell that says 'here's a value' that I can use to query for the item in the future using this query in the docs:\r\n`const original = await DataStore.query(Post, \"123\");\r\n\r\nawait DataStore.save(\r\n  Post.copyOf(original, updated => {\r\n    updated.title = `title ${Date.now()}`;\r\n    updated.status =\r\n      updated.status === PostStatus.ACTIVE\r\n        ? PostStatus.INACTIVE\r\n        : PostStatus.ACTIVE;\r\n  })\r\n);`\r\nIn this code block from the docs, you have \"123\" on the first line, which is the ID? And that's where I'm stuck.\r\n\r\n\r\nthis is my submit function\r\n\r\n`  handleSubmit = async () => {\r\n    const CURRENT_USER = await DataStore.query(User, Predicates.ALL);\r\n\r\n    await DataStore.save(\r\n      User.copyOf(CURRENT_USER, user => {\r\n        user.nom = this.state.nom;\r\n        user.discipline = this.state.discipline;\r\n        user.date_de_creation = this.state.date_de_creation;\r\n        user.Statut_juridique_du_club = this.state.Statut_juridique_du_club;\r\n        user.budget = this.state.budget;\r\n        user.part_allouee_a_la_formation = this.state.part_allouee_a_la_formation;\r\n        user.nb_total_salarie = this.state.nb_total_salarie;\r\n      })\r\n    );\r\n}\r\n   `\r\n\r\nthis is my shema\r\n\r\n`\r\ntype User @model @auth(rules: [{allow: public}]) {\r\n  id: ID!\r\n  nom: String!\r\n  discipline: String\r\n  date_de_creation: String\r\n  Statut_juridique_du_club: String\r\n  budget: String\r\n  part_allouee_a_la_formation: String\r\n  nb_total_salarie: String\r\n}\r\n`","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjUxMTA0","author":{"login":"doron-mil"},"title":"After verifyTotpToken - using setPreferredMFA will lead to NotAuthorizedException in all actions afterwards","body":"I have an application that is using totp setup.\r\nAll is working except for the initial sign-in with totp setup.\r\nIf the user logout and re-login everything is working as well.\r\n\r\nThe problem arrises only on the first sign in.\r\nI have the code :\r\n`Auth.verifyTotpToken(user,  totp).then(() => {`\r\n         ` Auth.setPreferredMFA(user, 'TOTP')`\r\n`....`\r\n`});`\r\n\r\nEvery action that I'm doing afterwards using Auth will result in NotAuthorizedException.\r\nThe Amplify Hub doesn't indicate sign-out, but it does indicate tokenRefresh_failure events.\r\n\r\nI've tried to not use the setPreferredMFA, because the MFA is already set as needed (checked) - but then, if the user tries something like Auth.updateUserAttributes, the same problem arises and user is cut from possible way to retain Auth.currentAuthenticatedUser()\r\n\r\nDoes anyone know where is all this coming from ? Maybe a configuration problem in AWS ?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjUwODY2","author":{"login":"casendler"},"title":"How to utilize Analytics.record for CLI created Kinesis Stream?","body":"I am currently using Pinpoint for in app analytics for my project. However, I recently added a kinesis stream for my project using the Amplify CLI. Looking through the [docs](https://docs.amplify.aws/lib/analytics/getting-started/q/platform/js) and [API reference](https://aws-amplify.github.io/amplify-js/api/classes/analyticsclass.html) the Analytics category only seems to deal with Pinpoint? I there currently a way to use the `Analytics.record()` method to send data to a stream from the client? \r\n\r\nI saw in the [legacy docs](https://haverchuck.github.io/docs/js/analytics#using-amazon-kinesis) (?) that this used to be achieved via pluggable? \r\n\r\nThanks!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjUwMTI4","author":{"login":"Neuroforge"},"title":"Get/Update GraphQL request from Lambda not working","body":"Hello,\r\n\r\nI am using https://docs.amplify.aws/guides/functions/graphql-from-lambda/q/platform/ios as a guide on how to call GraphQL from a lambda. And it seems to work great for List Queries and Create Mutations. It does not seem to work from GetQuery and UpdateMutations\r\n\r\nHowever, when i tried to use UpdateDirectory and GetDirectory I get the following error. It appears to be the same error for both the operations. I am using the graphQL queries generated by Amplify from client side model declarations.\r\n\r\nHere is my generic method that works fine for CreateMutations but not UpdateMutations GetQueries operations...\r\n\r\n`const executeAppSyncQuery = async (operationName, query, item) => {\r\n    const req = new AWS.HttpRequest(appsyncUrl, region);\r\n\r\n    req.method = 'POST';\r\n    req.path = '/graphql';\r\n    req.headers.host = endpoint;\r\n    req.headers['Content-Type'] = 'application/json';\r\n\r\n    req.body = JSON.stringify({\r\n        query: query,\r\n        operationName: operationName,\r\n        variables: item,\r\n    });\r\n\r\n    const signer = new AWS.Signers.V4(req, 'appsync', true);\r\n    signer.addAuthorization(AWS.config.credentials, AWS.util.date.getDate());\r\n\r\n    const data = await new Promise((resolve, reject) => {\r\n        const httpRequest = https.request({ ...req, host: endpoint }, (result) => {\r\n            result.on('data', (data) => {\r\n                resolve(JSON.parse(data.toString()));\r\n            });\r\n        });\r\n        httpRequest.write(req.body);\r\n        httpRequest.end();\r\n    });\r\n    return data;\r\n};`\r\n\r\nThe item with id exists in DynamoDB and was created from a GraphQL Mutation below using the above code.\r\n\r\n`query {\r\n      getDirectory(id: \"${id}\") {\r\n        id\r\n        directoryName\r\n        _version\r\n        _deleted\r\n        _lastChangedAt\r\n        createdAt\r\n        updatedAt\r\n      }\r\n    }`\r\n`\r\nWhen using this new payload to update the directory name.\r\n\r\n`            const item = {\r\n                input: {\r\n                    id: directoryId,\r\n                    directoryName: \"Updated Directory Name\"\r\n                }\r\n            };`\r\n`\r\n\r\nThis is the mutation query that does not seem to perform correctly.\r\n\r\n`\r\n `mutation UpdateDirectory(\r\n        $input: UpdateDirectoryInput!\r\n        $condition: ModelDirectoryConditionInput\r\n      ) {\r\n        updateDirectory(input: $input, condition: $condition) {\r\n          id\r\n          directoryName\r\n          _version\r\n          _deleted\r\n          _lastChangedAt\r\n          createdAt\r\n          updatedAt\r\n        }\r\n      }\r\n    `,\r\n`\r\n\r\nThe lambda throws an error when using an update mutation. I \r\n\r\n2021-03-05T02:39:27.646Z\t6b25d092-994a-49eb-a600-bb019b9602ea\tERROR\tUncaught Exception \t{\"errorType\":\"SyntaxError\",\"errorMessage\":\"Unexpected end of JSON input\",\"stack\":[\"SyntaxError: Unexpected end of JSON input\",\"    at JSON.parse (<anonymous>)\",\"    at IncomingMessage.<anonymous> (/var/task/index.js:31:30)\",\"    at IncomingMessage.emit (events.js:314:20)\",\"    at IncomingMessage.EventEmitter.emit (domain.js:483:12)\",\"    at IncomingMessage.Readable.read (_stream_readable.js:507:10)\",\"    at flow (_stream_readable.js:1007:34)\",\"    at resume_ (_stream_readable.js:988:3)\",\"    at processTicksAndRejections (internal/process/task_queues.js:84:21)\"]}\r\nEND RequestId: 6b25d092-994a-49eb-a600-bb019b9602ea\r\n\r\nOther people seem to have issues like this, but the solutions do not seem to work well.\r\n\r\nhttps://stackoverflow.com/questions/55400909/graphql-axios-variables-injection\r\nhttps://stackoverflow.com/questions/53168160/graphql-apollo-client-issue-network-error-syntaxerror-unexpected-end-of-js\r\n\r\nAny advice on where to look would be most appreciated.\r\n\r\nKind regards,","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"Neuroforge"},"body":"Appears to be a limitation in node https."}},{"node":{"author":{"login":"Neuroforge"},"body":"Ok. Appears response is coming back in chunks.\r\n\r\nSolution... \r\n\r\n`\r\n    const data = await new Promise((resolve, reject) => {\r\n        const httpRequest = https.request({ ...req, host: endpoint }, (response) => {\r\n            let data = '';\r\n            response.on('data', (chunk) => {\r\n                data += chunk;\r\n            });\r\n            response.on('end', () => {\r\n                const body = JSON.parse(data);\r\n                console.log(body);\r\n            });\r\n        });\r\n        httpRequest.write(req.body);\r\n        httpRequest.end();\r\n    });\r\n`"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjQ5ODQ5","author":{"login":"BrianMagus"},"title":"How to get Unauth Role working for IAM: Appsync Api.","body":"There really isn't enough documentation on this either in the AWS docs or in the Github, so hopefully someone here has tackled a similar issue.\r\n\r\nI have a react app with backend api hosted on AWS, using appsync, dynamoDB, and cognito-user-pools. My IAM policies are set up to allow unauth users read-only permission to some public tables. I tried the public api key but that didn't do anything. I'm trying to get the IAM unauth role permissions set up but even when I experimentally added literally every service and every action to the unauth role, I still get \"no current user\" when attempting to make the API call without logging in. \r\n\r\nUse case is for public author pages, where information about an author along with their currently available books is listed. Users should not have to sign in to see this page, an author should be able to drop a link to the page to anyone, whether they have a login for the app or not. \r\n\r\nThis is my graphql schema for the relevant types, it gets no errors:\r\n```\r\ntype PublicBook @model @auth(rules: [{ allow: owner, operations: [create, update, delete], provider: userPools },\r\n{allow: public, operations: [read], provider: iam}])\r\n@key(name:\"byPublicWorld\", fields: [\"publicWorldId\", \"indexOrder\"])\r\n@key(name:\"byPublicSeries\", fields: [\"publicSeriesId\", \"indexOrder\"]){\r\n  id: ID!\r\n  publicWorldId: ID\r\n  publicSeriesId: ID\r\n  indexOrder: Int!\r\n  cover: FileObject @connection \r\n  description: String \r\n  amazon: String\r\n  ibooks: String\r\n  smashwords: String \r\n  kobo: String \r\n  goodreads: String \r\n  audible: String \r\n  barnesnoble: String \r\n  sample: String\r\n}\r\ntype PublicSeries @model @auth(rules: [{ allow: owner, operations: [create, update, delete], provider: userPools },\r\n{allow: public, operations: [read], provider: iam}])\r\n@key(name:\"byPublicWorld\", fields: [\"publicWorldId\", \"indexOrder\"]){\r\n  id: ID!\r\n  publicWorldId: ID!\r\n  indexOrder: Int!\r\n  logo: FileObject @connection \r\n  description: String\r\n  genre: String\r\n  books: [PublicBook]@connection(keyName:\"byPublicSeries\", fields: [\"id\"])\r\n}\r\ntype PublicWorld @model @auth(rules: [{ allow: owner, operations: [create, update, delete], provider: userPools },\r\n{allow: public, operations: [read], provider: iam}])\r\n@key(name:\"byAuthorPage\", fields: [\"authorPageId\", \"indexOrder\"]){\r\n  id: ID!\r\n  authorPageId: ID!\r\n  logo: FileObject @connection\r\n  description: String\r\n  genre: String \r\n  indexOrder: Int!\r\n  series: [PublicSeries]@connection(keyName:\"byPublicWorld\", fields: [\"id\"])\r\n  books: [PublicBook]@connection(keyName:\"byPublicWorld\", fields: [\"id\"])\r\n}\r\ntype AuthorPage @model @auth(rules: [{ allow: owner, operations: [create, update, delete], provider: userPools },\r\n{allow: public, operations: [read], provider: iam}])\r\n@key(name:\"byPenName\", fields: [\"penId\"])\r\n@key(name:\"byPenDisplayName\", fields: [\"penDisplayName\"], queryField: \"authorPageByPen\"){\r\n  id: ID!\r\n  authorName: String \r\n  penDisplayName: String\r\n  penId: ID!\r\n  bio: String \r\n  photo: FileObject @connection \r\n  logo: FileObject @connection\r\n  penFBProfile: String\r\n  penFBGroup: String\r\n  penFBPage: String\r\n  penTwitter: String\r\n  penInstagram: String\r\n  penAmazon: String\r\n  penWebsite: String\r\n  penNewsletter: String\r\n  penGoodreads: String\r\n  penPatreon: String\r\n  posts: [AuthorPost]@connection(keyName:\"byAuthorPage\", fields: [\"id\"])\r\n  worlds: [PublicWorld]@connection(keyName:\"byAuthorPage\", fields: [\"id\"])\r\n}\r\ntype AuthorPost @model @auth(rules: [{ allow: owner, operations: [create, update, delete], provider: userPools },\r\n{allow: public, operations: [read], provider: iam}])\r\n@key(name:\"byAuthorPage\", fields: [\"authorPageId\", \"timeCreated\"]){\r\n  id: ID!\r\n  authorPageId: ID!\r\n  timeCreated: AWSTimestamp!\r\n  content: String!\r\n  title: String!\r\n  subtitle: String\r\n  type: PostType!\r\n}\r\n```\r\nEach of these types is set to owner/cognito permissions for creating, updating, and deleting, and then there is a public auth using iam to read. Seems straight forward enough. \r\n\r\nThe main type here is Author page, and I have the query set up to pull all the connected relevant cascading information. When logged in, this works fine and shows an author page with all the bits and bobs:\r\n```\r\nexport const authorPageByPen = /* GraphQL */ `\r\n  query AuthorPageByPen(\r\n    $penDisplayName: String\r\n    $sortDirection: ModelSortDirection\r\n    $filter: ModelAuthorPageFilterInput\r\n    $limit: Int\r\n    $nextToken: String\r\n  ) {\r\n    authorPageByPen(\r\n      penDisplayName: $penDisplayName\r\n      sortDirection: $sortDirection\r\n      filter: $filter\r\n      limit: $limit\r\n      nextToken: $nextToken\r\n    ) {\r\n      items {\r\n        id\r\n        authorName\r\n        penDisplayName\r\n        penId\r\n        bio\r\n        photo {\r\n          location\r\n        }\r\n        logo {\r\n          location\r\n        }\r\n        penFBProfile\r\n        penFBGroup\r\n        penFBPage\r\n        penTwitter\r\n        penInstagram\r\n        penAmazon\r\n        penWebsite\r\n        penNewsletter\r\n        penGoodreads\r\n        penPatreon\r\n        posts {\r\n          nextToken\r\n          startedAt\r\n        }\r\n        worlds {\r\n          nextToken\r\n          startedAt\r\n        }\r\n        _version\r\n        _deleted\r\n        _lastChangedAt\r\n        createdAt\r\n        updatedAt\r\n        owner\r\n      }\r\n      nextToken\r\n      startedAt\r\n    }\r\n  }\r\n`;\r\n```\r\nOn the page itself (although in production this just happens at app.js and persists throughout the app), I'm pulling current credentials and logging them to make sure that some kind of IAM identity is being created, and it appears to be:\r\n```\r\naccessKeyId: \"BUNCHANUMBERSKEY\"\r\nauthenticated: false\r\nexpiration: Thu Mar 04 2021 13:18:04 GMT-0700 (Mountain Standard Time) {}\r\nidentityId: \"us-west-2:48cd766c-4854-4cc6-811a-f82127670041\"\r\nsecretAccessKey: \"SecretKeyBunchanumbers\"\r\nsessionToken:\"xxxxxbunchanumbers\"\r\n```\r\nThat ```identityId``` on line 4 is present in my identity pool as an unauth identity, so it *is* getting back to the pool, which seems to be what's supposed to happen. \r\n\r\nSo, this identity pool has two roles associated with it, which is standard: auth and unauth, and my Unauthenticated Identities Setting has the box for ```Enable Access to Unauthenticated Identities``` checked. \r\n\r\nIn my unauth role, I've got the following as the inline policy json:\r\n```\r\n{\r\n    \"Version\": \"2012-10-17\",\r\n    \"Statement\": [\r\n        {\r\n            \"Effect\": \"Allow\",\r\n            \"Action\": [\r\n                \"appsync:GraphQL\"\r\n            ],\r\n            \"Resource\": [\r\n                \"arn:aws:appsync:us-west-2:MyAccountID:apis/MyAppsyncApiId/types/Mutation/fields/authorPageByPen\"\r\n            ]\r\n        }\r\n    ]\r\n}\r\n```\r\nI wasn't sure if this needed to be mutation, or query, or what, so I've tried them all. I tried them in combination with 'fields' and with 'index', I've tried writing the JSON, and adding the policies from the inline editor, which gives me the following which also does not work:\r\n```\r\n{\r\n    \"Version\": \"2012-10-17\",\r\n    \"Statement\": [\r\n        {\r\n            \"Sid\": \"VisualEditor0\",\r\n            \"Effect\": \"Allow\",\r\n            \"Action\": [\r\n                \"appsync:GraphQL\",\r\n                \"dynamodb:GetItem\",\r\n                \"dynamodb:Query\"\r\n            ],\r\n            \"Resource\": [\r\n                \"arn:aws:dynamodb:us-west-2:MyAccountID:table/AuthorPage-bunchanumbers-dev\",\r\n                \"arn:aws:dynamodb:us-west-2:MyAccountID:table/AuthorPage-bunchanumbers-dev/index/byPenDisplayName\",\r\n                \"arn:aws:appsync:us-west-2:852511622901:apis/APIID/types/AuthorPage/fields/authorPageByPen\",\r\n                \"arn:aws:appsync:us-west-2:MyAccountID:apis/APIID/types/FileObject/fields/*\",\r\n                \"arn:aws:appsync:us-west-2:MyAccountID:apis/APIID/types/AuthorPost/fields/*\",\r\n                \"arn:aws:appsync:us-west-2:MyAccountID:apis/APIID/types/PublicWorld/fields/*\",\r\n                \"arn:aws:appsync:us-west-2:MyAccountID:apis/APIID/types/PublicSeries/fields/*\",\r\n                \"arn:aws:appsync:us-west-2:MyAccountID:apis/APIID/types/PublicBook/fields/*\",\r\n                \"arn:aws:appsync:us-west-2:MyAccountID:apis/APIID\"\r\n            ]\r\n        }\r\n    ]\r\n}\r\n```\r\nAccount ID and API ID replaced in the above. What bit am I missing here? I could understand getting some error about not being allowed to access a resource, but the only error that logs is ```No Current User```, and that happens immediately after the log *showing* the user. ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjQ1OTcy","author":{"login":"PeteDuncanson"},"title":"Mutations via AppSync have to include all fields otherwise DataStore records are incomplete","body":"I'm still digging into this one but thought I would raise it.\r\n\r\nIf you have to update a record via AppSync (in a Lambda for instance). You have to return every field for the model in the mutation results otherwise the data in DataStore seems to only get back the fields you requested. This seems to be the case for updates and creations.\r\n\r\nThis seems counter intuitive (and also I can't find it documented anywhere).\r\n\r\nGuessing that the subscription event is just passed the fields from the mutation and DataStore is taking them at face value. I think it should really though just update the fields that changed rather than just the ones returned. I can understand that that is tricky to know which fields to include.\r\n\r\nThis also leads to some tech debt and bear traps in the future, if my schema changes I have to remember to go find all my AppSync mutations and update them to include the new field otherwise DataStore won't see it. Tricky.\r\n\r\nWhat is the best way around this? Is this the right way? Could it be done better?\r\n\r\nCould a subscription just include the whole record by default? Could it trigger a refetch of that record in whole?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"nubpro"},"body":" > If you have to update a record via AppSync (in a Lambda for instance). You have to return every field for the model in the mutation results otherwise the data in DataStore seems to only get back the fields you requested. This seems to be the case for updates and creations.\r\n\r\nI think the doc should be improved to include this CRUCIAL information where all fields must be included when making mutations otherwise subscription will return `null` for excluded fields.\r\n\r\nMaybe on these parts of the docs:\r\nhttps://docs.amplify.aws/lib/graphqlapi/mutate-data/q/platform/js\r\nhttps://docs.amplify.aws/lib/graphqlapi/subscribe-data/q/platform/js\r\n"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjQ3MTQx","author":{"login":"sc0ttdav3y"},"title":"Confusion over packages — should we install '@amplify-aws/core' or 'aws-amplify'","body":"Hi,\r\n\r\nI'm confused. Sorry if this is a braindead question.\r\n\r\nSome docs say to use non-namespaced NPM packages whereas others say to use packages namespaced with the `@aws-amplify` namespace. \r\n\r\nAs a result, I've got a project that has a mix of both, and I'm concerned I'm not doing it right.\r\n\r\nFor example, the [GitHub README for aws-amplify](https://github.com/aws-amplify/amplify-js/blob/main/README.md#installation) says this about getting started with React:\r\n\r\n```\r\nnpm install aws-amplify --save\r\nnpm install aws-amplify-react --save\r\n``` \r\n\r\nBut the [Amplify Docs site](https://docs.amplify.aws/ui/q/framework/react) says to do this:\r\n\r\n```\r\nyarn add aws-amplify @aws-amplify/ui-react\r\n```\r\n\r\nAnd the getting started section in the same docs says to do this, hinting that the namespaced package approach is the way to go:\r\n\r\n```\r\nnpm install -g @aws-amplify/cli\r\n```\r\n\r\nAnd [this popular blogger](https://medium.com/@dabit3/modular-imports-with-aws-amplify-daeb387b6985) says the NPM package `aws-amplify` includes all the `@aws-amplify/*` modules.\r\n\r\nI'm trying to make sense of it all.\r\n\r\nFor example, is [@aws-amplify/ui-react](https://www.npmjs.com/package/@aws-amplify/ui-react) the same as [aws-amplify-react](https://www.npmjs.com/package/aws-amplify-react)?  \r\n\r\nIf so, why are the version numbers different? And if not, what is the difference between the two?\r\n\r\nIs there some documentation that explains all this and gives us a directory of the packages?\r\n\r\nThanks!","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"sammartinez"},"body":"Hello @sc0ttdav3y,\r\n\r\nThanks for this feedback and you are right that it is confusing from our README to our documentation site. We recommend installing Amplify JavaScript as directed within our documentation site. For correction to the confusion, I have created an [issue](https://github.com/aws-amplify/amplify-js/issues/7868) to resolve the confusion we have within our README and to provide consistency between our documentation site and here. \r\n\r\nAs for the callout related to `@aws-amplify/ui-react`, last year we released our second version of our UI Components with writing the implementations in Web Components format. The `@aws-amplify/ui-react` is the second version of our UI Components and what we currently maintain. `aws-amplify-react` is our first version of our UI Components and are looking to place deprecation warnings on this later this year. Our recommendation is to use the `@aws-amplify/ui-react` for your application. \r\n\r\nPlease let me know if you have questions about the above or anything else I can clarify. Thanks!"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjQ4MzIz","author":{"login":"pieterbergmans"},"title":"Auth custom storage","body":"Hi...I've implemented Amplify Auth and it's currently storing tokens in localStorage, which I know is not a best practice from a security standpoint. I read in the Amplify docs that you can create your own custom storage. Since cookies has inherent flaws as well, I was wondering if storing tokens in my app's memory, like redux, is a good solution?  \r\n\r\nI noticed the docs stub out some code (below) but, to be honest, I really don't know a good starting point.  I've googled extensively but I can find any examples that will help me implement this.  Any suggestions from anyone who's done this?  \r\n\r\nThis is the code from the Amplify docs...\r\n\r\n```\r\nclass MyStorage {\r\n  // get item with the key\r\n  static getItem(key: string): string;\r\n  // remove item with the key\r\n  static removeItem(key: string): void;\r\n  // clear out the storage\r\n  static clear(): void;\r\n  // If the storage operations are async(i.e AsyncStorage)\r\n  // Then you need to sync those items into the memory in this method\r\n  static sync(): Promise<void>;\r\n}\r\n```\r\n\r\n```\r\nAuth.configure({\r\n  region: region,\r\n  userPoolId: userPoolId,\r\n  userPoolWebClientId: appClientId,\r\n  storage: MyStorage\r\n});\r\n```","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjQ1NzYx","author":{"login":"FrancescoMussi"},"title":"How to customize the Authenticator in Vue?","body":"I need to customize the component, but I am not really able to do it, besides changing few variables.\r\n\r\nAll I managed to do so far is this:\r\n\r\n```css\r\n:root {\r\n  --amplify-background-color: transparent;\r\n  --amplify-secondary-color: white;\r\n  --amplify-primary-contrast: white;\r\n  --amplify-primary-color: #E00C1D;\r\n}\r\n```\r\n\r\n<img width=\"290\" alt=\"Screenshot 2021-03-02 at 10 44 48\" src=\"https://user-images.githubusercontent.com/5312907/109622049-580a6180-7b44-11eb-9668-c402d69b7647.png\">\r\n\r\n\r\n\r\nBut by setting `--amplify-secondary-color` to white, then the input text is also white.\r\nI am trying to change the font of the input text, but it seems not possible.\r\n\r\nI need to change other things, such as the `amplify-toast`.\r\n\r\nI see that the input has a `.input` class, and the toast has a `.toast` class, but I am not able to target them.\r\n\r\nDo you know how can I do that?\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"CharlieDigital"},"body":"I recently fought the same battle and gave up; I ended up writing a custom UI and honestly it did not take more than a day and maybe 20-30 lines of code and 30-40 lines of markup.  The main API calls are all built into `Auth` already so there's not nearly as much value in bashing your head against this as you might think.\r\n\r\nHere's the whole implementation for signup and login including federation with FB, Office 365, and Google:\r\n\r\n```javascript\r\n        // https://docs.amplify.aws/lib/auth/emailpassword/q/platform/js#sign-up\r\n        async function createAccount() {\r\n            // Check if it's valid.\r\n            const isValid = await registrationForm.value?.validate() || false\r\n\r\n            if (!isValid) {\r\n                return\r\n            }\r\n\r\n            registering.value = true\r\n            errorMessage.value = ''\r\n\r\n            try {\r\n                await Auth.signUp({\r\n                    username: email.value,\r\n                    password: password.value,\r\n                    attributes: {\r\n                        email: email.value,\r\n                        name: `${firstName.value} ${lastName.value}`,\r\n                        given_name: firstName.value,\r\n                        family_name: lastName.value\r\n                    }\r\n                })\r\n\r\n                registering.value = false\r\n                registered.value = true\r\n            }\r\n            catch (error) {\r\n                console.log(error)\r\n\r\n                errorMessage.value = error.message\r\n            }\r\n        }\r\n\r\n        // https://docs.amplify.aws/lib/auth/emailpassword/q/platform/js#sign-up\r\n        async function loginAccount() {\r\n            authenticating.value = true\r\n            errorMessage.value = ''\r\n\r\n            try {\r\n                await Auth.signIn(email.value, password.value)\r\n\r\n                authenticating.value = false\r\n\r\n                await root.$router.push({ name: 'Home' })\r\n            }\r\n            catch (error) {\r\n                authenticating.value = false\r\n\r\n                console.log(error)\r\n\r\n                errorMessage.value = error.message\r\n            }\r\n        }\r\n\r\n        // https://docs.amplify.aws/lib/auth/social/q/platform/js#setup-frontend\r\n        // https://github.com/aws-amplify/amplify-js/issues/3611#issuecomment-509735881\r\n        async function continueWithGoogle() {\r\n            await Auth.federatedSignIn({ provider: CognitoHostedUIIdentityProvider.Google, customState: invitationId.value })\r\n        }\r\n\r\n        // https://docs.amplify.aws/lib/auth/social/q/platform/js#setup-frontend\r\n        // https://github.com/aws-amplify/amplify-js/issues/3611#issuecomment-509735881\r\n        async function continueWithFacebook() {\r\n            await Auth.federatedSignIn({ provider: CognitoHostedUIIdentityProvider.Facebook, customState: invitationId.value })\r\n        }\r\n\r\n        // https://docs.amplify.aws/lib/auth/social/q/platform/js#setup-frontend\r\n        // https://github.com/aws-amplify/amplify-js/issues/3611#issuecomment-509735881\r\n        async function continueWithMicrosoft() {\r\n            await Auth.federatedSignIn({ customProvider: 'Office365', customState: invitationId.value })\r\n        }\r\n\r\n        const passwordsMatch = computed(() => {\r\n            return password.value === confirmPassword.value\r\n        })\r\n```\r\n\r\nObviously a lot of stuff specific to my app, but it's very straight forward.\r\n\r\nRegistering and login with the federated providers both use the same exact call `Auth.federatedSignIn`.  If you need to create a profile for your user in your application space after registration, you can hook into Lambda triggers on Cognito (specifically, the [post confirmation trigger](https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-lambda-post-confirmation.html))\r\n\r\nBecause the backend calls will do the validation anyways (e.g. invalid email address), you don't necessarily even need to implement the front-end validation (though I did as you can see by that last `computed`).  It is honestly a great library and featureset, but lacking in straight forward, practical examples at the moment.  Good news is that rolling your own using the `Auth` APIs is not that big of a leap.\r\n\r\nI put it this way: in the time it takes you to figure out the workarounds and limitations of the pre-built Vue UI components, you could have easily solved the issue using the API instead and end up with a UI that better matches the rest of your application."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjQyOTM2","author":{"login":"mgoral2"},"title":"Contributions Workflow what branch do I submit pull request to?","body":"Hi.  I am interested in contributing to this project and am very excited about Amplify.  I was wondering, I have a year of experience working in software and when I submitted a pull request for my company it was always to the QA1 branch.  There were several QA branches and as the software went along it would get checked.  If I worked on some of the good first issue problems, where do I submit my pull request to?  Is it the main branch or some other branch or does it differ for each issue?  Thanks!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjQxNjA5","author":{"login":"berenddeboer"},"title":"Enable rtl in withAuthenticator to display Arabic login","body":"Is Arabic supported with withAuthenticator? If so how?\r\n\r\nHere's how I initialise my app:\r\n\r\n```\r\nI18n.setLanguage(\"ar\")\r\nI18n.putVocabularies(authScreenLabels)\r\n\r\nexport default withAuthenticator(App, false, [\r\n    <SignIn/>,\r\n    <RequireNewPassword/>,\r\n    <ForgotPassword/>,\r\n    <AuthLoading/>\r\n])\r\n```\r\n\r\ni.e. I'm just wrapping my app. But the form should be rtl.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjQwNTQ4","author":{"login":"Stf-F"},"title":"Google Federated auth: Token is not from a supported provider of this identity pool","body":"Hi, \r\n\r\nI have spent countless hours already trying to figure this out myself before posting here and I have also looked at the numerous very similar posts on SO but no luck so far. \r\n\r\nSo here we go, what I am trying to do:\r\n- In a Vue 3 app, use the  `<amplify-google-button>` ([link](https://github.com/aws-amplify/amplify-js/tree/main/packages/amplify-ui-components/src/components/amplify-google-button)) component to trigger the Google sign-in federated authentication flow. I _do not want_ to use the hosted UI and am using Amplify Auth as an abstraction layer above the native Cognito SDK to speed up my implementation. Last thing, I am not using amplify to bootstrap my services but rather using an existing backend.\r\n\r\nThe problem:\r\n- I am consistently getting the following error in the console:  `NotAuthorizedException: Token is not from a supported provider of this identity pool`\r\n\r\nAccording to the [results on SO](https://stackoverflow.com/search?q=Token+is+not+from+a+supported+provider+of+this+identity+pool&s=c06066af-0e63-4f29-a23b-66c2c48ef23c&s=02e3267d-db91-4cbb-9544-9edc0da8a48c), this problem usually comes from a mismatch between the IDs or references to the User Pool used in the Federated Identity pool or lack of configuration of _a_ Federated Identity pool. This is not my case, the Federated Identity pool is setup and referencing correctly the User Pool.\r\n\r\n2 things to mention at this point:\r\nThe hosted UI flow works\r\nThe regular email / password flow works \r\n\r\nMy understanding:\r\n- By setting up the federated identities in the User Pool, Cognito will manage the creation of users and their authentication and retrieval of profile information.\r\nThe identity pool needs to be setup to use Cognito as an Authentication provider to access the other AWS resources. I **should not have to setup Google+ (deprecated) or OpenID as Authentication providers** in the Federated Identities section as the users' tokens will be issued by Cognito. Is this correct?  Some posts [say otherwise and suggest creating an Identity Provider in IAM first](https://stackoverflow.com/a/45120365). Confusing.  \r\n\r\nNow, my configuration:\r\n- main.js\r\n\r\n``` javascript\r\nimport { applyPolyfills, defineCustomElements } from '@aws-amplify/ui-components/loader'\r\nimport Amplify from 'aws-amplify'\r\nimport { createApp } from 'vue'\r\nimport App from './App.vue'\r\nimport config from './aws-exports'\r\nimport './registerServiceWorker'\r\n\r\nAmplify.configure(config)\r\n\r\napplyPolyfills().then(() => {\r\n  defineCustomElements(window)\r\n})\r\n\r\nconst app = createApp(App)\r\n\r\napp.config.isCustomElement = (tag) => tag.startsWith('amplify-')\r\napp.mount('#app')\r\n\r\n```\r\n\r\n- aws-exports.js\r\n\r\n``` javascript\r\nconst config = {\r\n  Auth: {\r\n    identityPoolId: 'eu-west-1:5f3fe010-6127-4XX4-XXXX-XXXXXXXXX605', \r\n    region: 'eu-west-1',\r\n    userPoolId: 'eu-west-1_XXXXXz8TS',\r\n    userPoolWebClientId: '21dXXXXXXXXXXXXh948egXXdk6',\r\n    oauth: {\r\n      domain: '<domain>.auth.eu-west-1.amazoncognito.com',\r\n      scope: ['phone', 'email', 'profile', 'openid', 'aws.cognito.signin.user.admin'],\r\n      redirectSignIn: 'https://<domain>.co.uk/',\r\n      redirectSignOut: 'https://<domain>.co.uk/',\r\n      responseType: 'code',\r\n    },\r\n  },\r\n  federationTarget: 'COGNITO_USER_POOLS',\r\n}\r\n\r\nexport default config\r\n```\r\n- My overly simplified App.vue test file:\r\n\r\n``` javascript\r\n<template>\r\n  <div>\r\n    <div v-if=\"authState !== 'signedin'\">You are signed out.</div>\r\n \r\n    <amplify-google-button client-id=\"946795XXXXXX-4fXX9XXXXXXXXXXXXXXXXXXXXXXXXXXX.apps.googleusercontent.com\">Hello</amplify-google-button>\r\n \r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { onAuthUIStateChange } from '@aws-amplify/ui-components'\r\nexport default {\r\n  name: 'AuthStateApp',\r\n  created() {\r\n    this.unsubscribeAuth = onAuthUIStateChange((authState, authData) => {\r\n      this.authState = authState;\r\n      this.user = authData;\r\n    })\r\n  },\r\n  data() {\r\n    return {\r\n      user: undefined,\r\n      authState: undefined,\r\n      unsubscribeAuth: undefined\r\n    }\r\n  },\r\n  beforeUnmount() {\r\n    this.unsubscribeAuth();\r\n  }\r\n}\r\n</script>\r\n```\r\n- My User Pool and Identity Pool configs:\r\n<img width=\"978\" alt=\"Pasted_Image_25_02_2021__02_02\" src=\"https://user-images.githubusercontent.com/52630104/109092006-ba5efe80-770d-11eb-9e77-c39fda995ecd.png\">\r\n\r\n<img width=\"985\" alt=\"Pasted_Image_25_02_2021__02_04\" src=\"https://user-images.githubusercontent.com/52630104/109092191-01e58a80-770e-11eb-8d82-e2b3564e73eb.png\">\r\n\r\n<img width=\"1071\" alt=\"Pasted_Image_25_02_2021__02_07\" src=\"https://user-images.githubusercontent.com/52630104/109092411-5f79d700-770e-11eb-8a7f-194223be777d.png\">\r\n\r\n- My Google config:\r\n<img width=\"1310\" alt=\"Pasted_Image_25_02_2021__02_14\" src=\"https://user-images.githubusercontent.com/52630104/109092916-59d0c100-770f-11eb-897c-a320024b53c8.png\">\r\n\r\nI would appreciate any idea on the above as I am starting to no longer see any option.\r\n\r\nThanks,\r\n\r\nStephane\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjQwMDcz","author":{"login":"tnorlund"},"title":"API Gateway CORS issue only using SDK","body":"I've currently deployed an API Gateway that works with the browser and Postman. When I attempt to run it using the Amplify JS SDK, I get a CORS error. I've added the Lambda function, but I'm not sure how to use the SDK with this POST endpoint. What do I need to add to get this to work? \r\n\r\n```js\r\nconst { User, updateUserName, addTOSToUser } = require( `/opt/nodejs/index` )\r\n\r\n/**\r\n * Getting the basic blog details.\r\n *\r\n * This is called to get the basics of the blog's details. This returns the\r\n * number of users and posts.\r\n */\r\nexports.handler = async ( event, context ) => {\r\n  if (\r\n    !event.body\r\n  ) return {\r\n    statusCode: 500, \r\n    headers: { 'Access-Control-Allow-Origin' : '*' }, \r\n    body: `Must give the slug and the title in the body.`,\r\n    isBase64Encoded: false\r\n  } \r\n  try {\r\n    const parsedBody = JSON.parse( event.body )\r\n  } catch( error ) {\r\n    return {\r\n      statusCode: 500, \r\n      headers: {\r\n        \"Access-Control-Allow-Headers\": \"Content-Type,X-Amz-Date,X-Amz-Security-Token,Authorization,X-Api-Key,X-Requested-With,Accept,Access-Control-Allow-Methods,Access-Control-Allow-Origin,Access-Control-Allow-Headers\",\r\n      \"Access-Control-Allow-Origin\": \"*\",\r\n      \"Access-Control-Allow-Methods\": \"DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT\",\r\n      \"X-Requested-With\": \"*\",\r\n      \"Access-Control-Allow-Credentials\" : true\r\n      }, \r\n      body: `Body must be JSON formatted.`,\r\n      isBase64Encoded: false\r\n    }\r\n  }\r\n  if (\r\n    typeof parsedBody.username == `undefined` ||\r\n    typeof parsedBody.name == `undefined` ||\r\n    typeof parsedBody.email == `undefined` ||\r\n    typeof parsedBody.version == `undefined`\r\n  ) return {\r\n    statusCode: 500, \r\n    headers: { \r\n      \"Access-Control-Allow-Headers\": \"Content-Type,X-Amz-Date,X-Amz-Security-Token,Authorization,X-Api-Key,X-Requested-With,Accept,Access-Control-Allow-Methods,Access-Control-Allow-Origin,Access-Control-Allow-Headers\",\r\n      \"Access-Control-Allow-Origin\": \"*\",\r\n      \"Access-Control-Allow-Methods\": \"DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT\",\r\n      \"X-Requested-With\": \"*\",\r\n      \"Access-Control-Allow-Credentials\" : true\r\n      \r\n    }, \r\n    body: `Must give the user's number, name, email, and terms of service version in the body.`,\r\n    isBase64Encoded: false\r\n  }\r\n  const { tos, error } = await addTOSToUser( \r\n    process.env.TABLE_NAME, \r\n    new User( {\r\n      name: parsedBody.name,\r\n      email: parsedBody.email,\r\n      username: parsedBody.username\r\n    } ),\r\n    parsedBody.version\r\n  ) \r\n  if ( error ) return { \r\n    statusCode: 500, \r\n    headers: { \r\n      \"Access-Control-Allow-Headers\": \"Content-Type,X-Amz-Date,X-Amz-Security-Token,Authorization,X-Api-Key,X-Requested-With,Accept,Access-Control-Allow-Methods,Access-Control-Allow-Origin,Access-Control-Allow-Headers\",\r\n      \"Access-Control-Allow-Origin\": \"*\",\r\n      \"Access-Control-Allow-Methods\": \"DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT\",\r\n      \"X-Requested-With\": \"*\", \r\n      \"Access-Control-Allow-Credentials\" : true\r\n    }, \r\n    body: JSON.stringify( error ), \r\n    isBase64Encoded: false\r\n  }\r\n  return { \r\n    statusCode: 200, \r\n    headers: { \r\n      \"Access-Control-Allow-Headers\": \"Content-Type,X-Amz-Date,X-Amz-Security-Token,Authorization,X-Api-Key,X-Requested-With,Accept,Access-Control-Allow-Methods,Access-Control-Allow-Origin,Access-Control-Allow-Headers\",\r\n      \"Access-Control-Allow-Origin\": \"*\",\r\n      \"Access-Control-Allow-Methods\": \"DELETE,GET,HEAD,OPTIONS,PATCH,POST,PUT\",\r\n      \"X-Requested-With\": \"*\", \r\n      \"Access-Control-Allow-Credentials\" : true\r\n    }, \r\n    body: JSON.stringify( tos ), \r\n    isBase64Encoded: false\r\n  }\r\n};\r\n\r\n```","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yOTE2NTY2","author":{"login":"padzikm"},"title":"PKCE in ui-react AmplifyAuthenticator","body":"Hi, I'd like to know if AmplifyAuthenticator in ui-react package is using pkce extension to code flow. There is no clear answer in issues here - I don't use cognito's hosted ui and I configured cognito's app client to only allow code flow (implicit flow is not allowed). My amplify configuration is as follows:\r\n```\r\nAmplify.configure({\r\n          Auth: {\r\n            region,\r\n            userPoolId,\r\n            userPoolWebClientId,\r\n            mandatorySignIn: true,\r\n            storage: sessionStorage\r\n          }\r\n        })\r\n```\r\nand I render ui as:\r\n```\r\n<AmplifyAuthenticator>\r\n   <My-content />\r\n</AmplifyAuthenticator>\r\n```","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"padzikm"},"body":"Up"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjM2OTcw","author":{"login":"omer-to"},"title":"Phone number verification not sent","body":"Hello,\r\n\r\nI'm using `aws-amplify` for my React Native project. I want to sign users with phone number and send SMS immediately after they sign up. I tried to do that using `eu-central-1 (Frankfurt)`, `us-east-1 (N. Virginia)`, and `eu-west-2 (London)`. Although I see that the user is created successfully, I was not able to send even one SMS at all. After searching for similar questions, though I have never sent SMS, I did request for SMS quota increase. I was not able to find the problem, and hence I'm literally describing all the steps:\r\n\r\n## amplify add auth\r\n\r\nHere's are the answers to the questions asked after issuing `amplify add auth`:\r\n\r\n> Do you want to use the default authentication and security configuration? (Use arrow keys)\r\n> ❯ Default configuration\r\n\r\n> How do you want users to be able to sign in? (Use arrow keys)\r\n> ❯ Phone Number\r\n\r\n> Do you want to configure advanced settings? (Use arrow keys)\r\n> ❯ Yes, I want to make some additional changes.\r\n\r\n> What attributes are required for signing up?\r\n> ❯ Family Name, Give Name, Phone Number\r\n\r\n> Do you want to enable any of the following capabilities?\r\n> ❯ I choose none\r\n\r\n## AWS Cognito Console\r\n\r\nAnd the process completes after that last question. Then I push the local resources and provision it in the cloud by running `amplify push`. Afterwards, I get on Cognito console, and choose the User Pool that I just created.\r\nFrom **General Setting** ❯ **MFA and verifications**, I make the following changes:\r\n\r\n> **Do you want to enable Multi-Factor Authentication (MFA)?**\r\n> Optional\r\n\r\n> **Which attributes do you want to verify?**\r\n> Phone Number\r\n\r\nand save the changes.\r\n\r\n---\r\n\r\nHere is the code for signing up:\r\n\r\n```typescript\r\nasync function signUp(phoneNumber: string, password: string, firstName: string, lastName: string) {\r\n        try {\r\n                const response = await Auth.signUp({\r\n                        username: phoneNumber,\r\n                        password,\r\n                        attributes: {\r\n                                family_name: lastName,\r\n                                given_name: firstName,\r\n                                phone_number: phoneNumber\r\n                        }\r\n                })\r\n        } catch (error) { }\r\n}\r\n```\r\n\r\nWhat I expect is that after the user is created, the phone number receives the code for phone number verification. I also tried to resend it by executing `Auth.resendSignUp`, but I have never received the code.\r\n\r\nI do not have any issue with signal strength, and tried it with other phones and AWS regions as well.\r\n\r\nI cannot figure out why it is not working as expected, and I need suggestion.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjM0MTY5","author":{"login":"huydiff"},"title":"Amplify Subscription Observable return type for Typescript","body":"```typescript\r\n    const subscription = (API.graphql({\r\n      query: onClassroomRegister,\r\n      variables: {\r\n        id: classroom.id,\r\n      },\r\n    }) as Observable<object>).subscribe({\r\n      next: (response => {\r\n        console.log(response);\r\n      }),\r\n    });\r\n```\r\n\r\nI have a Typescript project and I am getting linting errors because the `response` argument in `next` is not typed. What is the correct return type for this?\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjMzOTM0","author":{"login":"omenking"},"title":"Does Auth.signUp allow me to signup without an email?","body":"I choose to create a Cognito User Pool without a username. (I think that is actually the default in the Admin UI)\r\n\r\n<img width=\"983\" alt=\"Screen Shot 2021-02-22 at 10 31 17 PM\" src=\"https://user-images.githubusercontent.com/7776/108799379-2a2e8700-755e-11eb-9e4c-e5d70a11d658.png\">\r\n\r\nIt expects a username, I tried to omit it and it complained.\r\n\r\n```js\r\nAuth.signUp({\r\n    username,\r\n    password,\r\n    attributes: {\r\n        email,\r\n        'custom:favorite_flavor': 'Cookie Dough'  // custom attribute, not standard\r\n    }\r\n})\r\n```\r\n\r\nDoes the Auth.signUp not support signup without username?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"omenking"},"body":"Well this explains it.\r\n\r\n```\r\nerror signing up: {code: \"InvalidParameterException\", name: \"InvalidParameterException\", message: \"Username should be an email.\"}\r\n```\r\n\r\nI think the documentation needs to be updated"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjI5OTI5","author":{"login":"Kiddinglife"},"title":"Import Amplify reports error","body":"Puerts: Error: (0x00000206226C5490) D:\\EpicEngineProjects\\puerts_unreal_demo\\Content\\JavaScript\\node_modules\\aws-**amplify\\dist\\aws-amplify.js:201341: ReferenceError: self is not defined**\r\nmodule.exports = self.fetch || (self.fetch = __webpack_require__(/*! unfetch */ \"../../node_modules/unfetch/dist/unfetch.module.js\").default || __webpack_require__(/*! unfetch */ \"../../node_modules/unfetch/dist/unfetch.module.js\"));\r\n                 ^\r\nReferenceError: self is not defined\r\n    at Object.../../node_modules/isomorphic-unfetch/browser.js (D:\\EpicEngineProjects\\puerts_unreal_demo\\Content\\JavaScript\\node_modules\\aws-amplify\\dist\\aws-amplify.js:201341:18)\r\n    at __webpack_require__ (D:\\EpicEngineProjects\\puerts_unreal_demo\\Content\\JavaScript\\node_modules\\aws-amplify\\dist\\aws-amplify.js:30:30)\r\n    at Module.../amazon-cognito-identity-js/es/Client.js (D:\\EpicEngineProjects\\puerts_unreal_demo\\Content\\JavaScript\\node_modules\\aws-amplify\\dist\\aws-amplify.js:220229:76)\r\n    at __webpack_require__ (D:\\EpicEngineProjects\\puerts_unreal_demo\\Content\\JavaScript\\node_modules\\aws-amplify\\dist\\aws-amplify.js:30:30)\r\n    at Module.../amazon-cognito-identity-js/es/CognitoUserPool.js (D:\\EpicEngineProjects\\puerts_unreal_demo\\Content\\JavaScript\\node_modules\\aws-amplify\\dist\\aws-amplify.js:222917:65)\r\n    at __webpack_require__ (D:\\EpicEngineProjects\\puerts_unreal_demo\\Content\\JavaScript\\node_modules\\aws-amplify\\dist\\aws-amplify.js:30:30)\r\n    at Module.../amazon-cognito-identity-js/es/index.js (D:\\EpicEngineProjects\\puerts_unreal_demo\\Content\\JavaScript\\node_modules\\aws-amplify\\dist\\aws-amplify.js:223634:74)\r\n    at __webpack_require__ (D:\\EpicEngineProjects\\puerts_unreal_demo\\Content\\JavaScript\\node_modules\\aws-amplify\\dist\\aws-amplify.js:30:30)\r\n    at Module.../auth/lib-esm/Auth.js (D:\\EpicEngineProjects\\puerts_unreal_demo\\Content\\JavaScript\\node_modules\\aws-amplify\\dist\\aws-amplify.js:231906:84)\r\n    at","upvoteCount":4,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjI5MDU3","author":{"login":"kevin-mitchell"},"title":"Options for reducing bundle size (Angular, Cognito, GraphQL)?","body":"I am looking at a super basic Ampilfy + Angular project and the bundle size / deployed javascript is pretty huge - basically a MB. the large majority of this appears to be Amplify. I am using Cognito, GraphQL (but don't need the mqtt stuff for AppSync as I don't care about real time updates and such).... I know these are super full featured / \"enterprise\" level services, but it still seems like a LOT of code to ship. I'm wondering if there are any obvious optimizations around bundle size that I should be looking at?\r\n\r\nThis screenshot shows the bundle sizes in my project so far, without much really being added.\r\n\r\n![Screen Shot 2021-02-18 at 6 03 48 PM](https://user-images.githubusercontent.com/21270844/108584207-4c24d100-72f4-11eb-972f-3b5f182891c8.png)\r\n\r\nThanks for any tips / best practices!\n\nEdit: I didn't notice before but there was an issue opened for this a while ago that has side been closed: https://github.com/aws-amplify/amplify-js/issues/122\n\nI'm going to take a look at targeting specific libraries and see if that helps much. Would still value any input here!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMjY0OQ==","author":{"login":"philmerrell"},"title":"Is it possible to use 'authMode' in a multi-auth Angular project","body":"I'm trying to get a multi-auth, public / private scenario working using Angular. I would like the update/delete/create of my models to be allowed only by a group in my user pool named 'Admins'. I would like to grant public read access to guests and unauthenticated users. This pain point has been fairly well documented and I believe I understand my options.\r\n\r\nI have established a Cognito User Pool as my primary means of authentication to the api. I have configured additional auth using an API key, which I have generated in the AppSync console. I understand in non-Angular environments, we can pass in an optional authMode attribute like so:\r\n\r\n```js\r\nconst createdTodo = await API.graphql({\r\n  query: queries.createTodo,\r\n  variables: {input: todoDetails},\r\n  authMode: 'API_KEY'\r\n});\r\n```\r\n\r\nIt is not clear to me how this `authMode` param is passed in the context of the generated `API.service.ts` (the prescribed approach for interacting with our models in the context of Angular). I'm not sure if this is a simple usage question, a feature request, or a bug. Ideally we would be able to pass in the optional `authMode` param through our `API.service.ts` methods. Something like:\r\n\r\n```js\r\n// Optional argument to set the authMode param.\r\nListTodos(filter?: ModelTodoFilterInput, limit?: number, nextToken?: string, authMode?: string): Promise<ListTodosQuery>\r\n```\r\n\r\nI apologize in advance if this can be accomplished currently, but I can't find an example of it.","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"philmerrell"},"body":"If anyone can give some guidance here, it would be much appreciated. Should I try and write a custom angular service that structures the GraphQL operations in a more vanilla way (i.e., sans generated Angular service)?\r\n\r\nIs this a feature request for the Angular Amplify library? Would a pull request be accepted if I decided to dig in and create one?"}},{"node":{"author":{"login":"kevin-mitchell"},"body":"Same question here.\r\n\r\nThere is a LOT (it's sort of scary as you mentioned @philmerrell !) that is magically setup for you, but in my situation I setup a GraphQL API \"category\" with Amplify. I was following a tutorial I think and used the \"API Key\" authentication to start. Which was probably a mistake, maybe. Anyway, there is some code that was generated, `API.service.ts`, and from what I can tell it is setup to use the default authMode. \r\n\r\nSo I've found that I can do what I want to do by manually modifying or otherwise copying the `API.service.ts`, and changing\r\n\r\n```\r\n...\r\nconst response = (await API.graphql(\r\n      graphqlOperation(statement, gqlAPIServiceArguments)\r\n    )) as any;\r\n    return <UpdateBlogPostMutation>response.data.updateBlogPost;\r\n...\r\n```\r\n\r\nto\r\n\r\n\r\n```\r\n...\r\nconst response = (await API.graphql(\r\n      {\r\n        query: statement, \r\n        variables: gqlAPIServiceArguments,\r\n        authMode: GRAPHQL_AUTH_MODE.AMAZON_COGNITO_USER_POOLS\r\n      }\r\n    )) as any;\r\n    return <UpdateBlogPostMutation>response.data.updateBlogPost;\r\n...\r\n```\r\n\r\nBasically manually specifying that I want to use the `AMAZON_COGNITO_USER_POOLS` auth method. BUT, I feel like I shouldn't have to do this manually. Or if I should have to do this manually, then it shoul be clearly spelled out somewhere (and maybe it is... there is just so much, I'm never sure when I'm looking at outdated documentation or half-baked features vs magically amazing Amplify stuff)"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMzE1MQ==","author":{"login":"dorontal"},"title":"Best GraphQL schema for public / private entries in a collaboration use case?","body":"**What is the better GraphQL schema** for efficiently and properly handling the following use case, involving public or private user \"entries\" in a collaborative app?\r\n\r\n#### Background\r\n* Users can contribute an **entry**\r\n* Users can make their entries public or private\r\n* Users can **list all** entries, in which case they would see:\r\n  * All users' public entries\r\n  * Their own private entries\r\n* No user has access to any aspect of another user's private entry - they can't even know it exists\r\n* Users have just read access to the other users' public entries\r\n\r\nHow do we set up an `Entry` type in a GraphQL schema for this use case?\r\n\r\nOne way may be to separate entries into two types: `PrivateEntry` and `PublicEntry`, giving them different `@auth` directives; then, for the **list all** operation, perform two GraphQL queries - one for`PrivateEntry`, another for `PublicEntry`:\r\n```graphql\r\ntype PrivateEntry\r\n  @auth(rules: [{ allow: owner } ])\r\n{\r\n  ...\r\n}\r\n\r\ntype PublicEntry\r\n  @auth(\r\n    rules: [\r\n      { allow: owner },\r\n      { allow: public, provider: iam, operations: [read] }\r\n    ]\r\n  )\r\n{\r\n  ...\r\n}\r\n```\r\nbut the above schema seems like an anti-pattern, disobeying \"don't use type names as data\". Also, the above schema would require two queries each time, and whatever you set up for one of the two types would have to be repeated identically for the other type, leaving room for errors if you did not repeat it identically.\r\n\r\nPerhaps instead we could use just one `Entry` type that has a `visibility` field that determines whether the entry is private or public. \r\n\r\nHowever, I don't know how to achieve this use case and still have the proper privacy protections with only one `Entry` type.\r\n\r\n\r\n","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"noskovvkirill"},"body":"Hi! I was wondering if you've found a solution to your problem? I'm currently using an Entry field with a boolean flag for visibility and @auth directive on the field itself, but as you mentioned in your post that doesn't seem to be the most secure solution. "}},{"node":{"author":{"login":"dorontal"},"body":"We've changed things! To implement private / public \"Entry\" model, currently taking a different approach from the above: use one model with a boolean flag for visibility, as you do, so the model is now\r\n```graphql\r\ntype Entry\r\n  @auth(\r\n    rules: [\r\n      { allow: owner },\r\n      { allow: public, provider: iam, operations: [read] }\r\n    ]\r\n  )\r\n{\r\n  ...\r\n  public: Boolean\r\n  owner: String\r\n  ...\r\n}\r\n```\r\nThe `ListEntries` query **resolver** checks the value `public` -- if it's `true` then the resolver will emit all entries; if the value of `public` is `false` then the resolver will emit only entries for which `owner` is the currently logged in owner.\r\n\r\nIn the Javascript code, before we call the `ListEntries` query with `public === true`, we call\r\n```typescript\r\nAmplify.configure({ aws_appsync_authenticationType: 'AWS_IAM' });\r\n```\r\nAnd if we are to call `ListEntries` with `public === false` then (a) we make sure the user is logged in in the Javascript code; (b) we call\r\n```typescript\r\nAmplify.configure({ aws_appsync_authenticationType: 'AMAZON_COGNITO_USER_POOLS' });\r\n```\r\nThe `Amplify.configure()` calls cause the correct `@auth` directive rule (out of the two rules defined in the schema above) to be used.\r\n\r\n----------------\r\n\r\nThis is the current \"solution\".  I wrote it up here not just to answer the above but also to invite others to give feedback. If you have anything to say here on whether this is a good way of doing things or if you know of any improvements -- that would be very much appreciated!"}},{"node":{"author":{"login":"dorontal"},"body":"What you are proposing seems like a nice solution @noskovvkirill I will try it.\r\n\r\nIt also adds a third use-case to the original private / public use-cases. The original two use cases were:\r\n* public for all users\r\n* private for only one owner\r\n\r\nYour proposal above also adds:\r\n* public for some users (e.g, collaborators of the owner)\r\n\r\nYour proposal seems like great approach - thank you very much for that!\r\n\r\nIn the meantime, however, I want to mention that the solution I've proposed above was modified. There is no longer any need to re-configure via `Amplify.configure(...)` in the code. Adding another `@auth` rule seems to have allowed for that [though I'm not 100% sure that adding the `@auth` rule is indeed what allowed me to remove the `Amplify.configure(...)` code without getting 401 errors ]. The following schema is what is implemented now and works:\r\n\r\n```graphql\r\ntype Entry\r\n  @auth(\r\n    rules: [\r\n      # allow all authenticated users ability to create tracks\r\n      # allow owners ability to update and delete their tracks\r\n      { allow: owner },\r\n\r\n      # allow all authenticated users to read tracks\r\n      { allow: private, operations: [read] },\r\n\r\n      # allow all guest users (not authenticated) to read tracks\r\n      { allow: public, provider: iam, operations: [read] }\r\n    ]\r\n  )\r\n{\r\n  ...\r\n  public: Boolean\r\n  owner: String\r\n  ...\r\n}\r\n```\r\n\r\nBut this modification is still a very slight improvement over my first proposal above, which still seems more hacky than your solution, so I will try your solution (I will only implement part-1 of your solution -- the part that deals with \"public for all\" or \"private for owner\" but not the part that allows for \"public for some\", not the second half of your proposal).\r\n\r\nThere is another thing I don't like with my proposed solution here: With the above schema, for any owner who wants to see all entries -- which includes both their own private entries plus everybody's public entries -- the code has to make **two query calls** to `ListEntries()` -- one with `public: { eq: true }` and another with `public: { eq: false }` -- but what I am hoping is that your suggested solution will only require one query call to the `ListEntries()` query. In other words, I hope that your solution will automatically filter private / public when listing all entries, depending on ownership of each entry and therefore only one query will be needed, which would be another reason your solution is cleaner. Will try your solution and report - thank you!"}},{"node":{"author":{"login":"dorontal"},"body":"Found this one - it looks like a good solution. It covers my use case of having public stuff available to unauthenticated users as well as authenticated ones, but I think it also covers your use case, which does not need the unauthenticated access part. I will probably try this solution and will report if I do, but here is the alleged solution if you wanted to get started: https://medium.com/@fullstackpho/aws-amplify-multi-auth-graphql-public-read-and-authenticated-create-update-delete-1bf5443b0ad1"}},{"node":{"author":{"login":"danielgeri"},"body":"@dorontal @noskovvkirill love the conversation! I desperately needed to gain some insight on public/private strategies. I'd like to describe my situation and see if I can glean any information from you guys. My situation is the following (keep in mind I'm new to amplify/graphql):\r\n\r\nI have a type that I'd like to toggle between private and public. If the record is private, we need the ability to add users (probably leveraging the `ownerField`. If the record is public, then both signed-on and signed-off users need to be able to access these records. To further add complexity to this, we have nested types and can also be accessed/updated independently.\r\n\r\nBased on this need, I am leaning towards this approach https://github.com/aws-amplify/amplify-js/discussions/6544#discussioncomment-296625. I am thinking the overall solution may look something like this:\r\n\r\n```graphql\r\ntype Entry\r\n  @auth(\r\n    rules: [\r\n      # allow all authenticated users ability to create tracks\r\n      # allow owners ability to update and delete their tracks\r\n      { allow: owner },\r\n\r\n      # allow all authenticated users to read tracks\r\n      { allow: private, operations: [read] },\r\n\r\n      # allow all guest users (not authenticated) to read tracks\r\n      { allow: public, provider: iam, operations: [read] }\r\n    ]\r\n  )\r\n{\r\n  ...\r\n  public: Boolean\r\n  owner: String\r\n  childEntries: [ChildEntry]\r\n  ...\r\n}\r\n\r\ntype ChildEntry   @auth(\r\n    rules: [\r\n      # allow all authenticated users ability to create tracks\r\n      # allow owners ability to update and delete their tracks\r\n      { allow: owner },\r\n\r\n      # allow all authenticated users to read tracks\r\n      { allow: private, operations: [read] },\r\n\r\n      # allow all guest users (not authenticated) to read tracks\r\n      { allow: public, provider: iam, operations: [read] }\r\n    ]\r\n  )\r\n{\r\n  ...\r\n  public: Boolean\r\n  owner: String\r\n}\r\n```\r\nTherefore mutations would have to include updates to parent and nested types. Curious to know if you guys have additional thoughts to this."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjI4NzQw","author":{"login":"ronakm"},"title":"Reset the amplify.configure() setting after modifying graphql_headers in Amplify.configure","body":"We have use case where we are using two different type of AppSync queries \r\n1. Using Auth mode : cognito\r\n2. Using Auth mode : AWS_IAM\r\n\r\nAs React Amplify Appsync library uses \"accessToken\" by default while making API request when Auth mode is (AMAZON_COGNITO_USER_POOLS).  As we wanted to pass the claims or custom attributes to backend lambda resolver, i am modifying amplify.configure as below before making actual API call:\r\n\r\nAmplify.configure({\r\n        API: {\r\n          graphql_headers: async () => ({\r\n            \"Authorization\": session.getIdToken().getJwtToken(),\r\n          }),\r\n        },\r\n      });\r\nconst requestData = {\r\n        body: {\r\n          type: \"test\",\r\n        },\r\n      };\r\n      try {\r\n        const response = await API.graphql({\r\n          query: testAuthQuery,\r\n          variables: requestData,\r\n          authMode: \"AMAZON_COGNITO_USER_POOLS\",\r\n        });\r\n        console.log(response)\r\n      } catch (e) {\r\n        console.log(e)\r\n      }\r\n\r\nNow , if i logout from application and try to make any query API with authmode \"AWS_IAM\" as below : \r\n\r\n Amplify.configure(myAppConfig);\r\n    try {\r\n        const queryData = {\r\n            test : input\r\n            }\r\n            console.log(\"Inside create account \", input);\r\n            const data =  await API.graphql({query: testUnauthApi, variables: queryData, authMode: 'AWS_IAM'});\r\n            console.log(data);\r\n            return data;\r\n        } catch (e) {\r\n            console.log(\"Error\");\r\n            console.error(e);\r\n            return e;\r\n        }\r\n\r\nIt fails, with \"user not found\".  I tried to reset the Amplify.configure just before the API. but it looks like it still try to send \"Authorization\" header with idToken.\r\n\r\nHow i can reset my Amplify.configure(myAppConfig) after using first API(cognito one) \r\n\r\nNote : After signout and if i refresh the page and try to make API query with auth mode AWS_IAM, it works fine. \r\n        \r\n       \r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjI4Mjcx","author":{"login":"joshkh"},"title":"How can I verify a Developer Authenticated Federated Identity in my REST API?","body":"I am using Amplify to successfully sign in my Federated Users with my Custom Developer Provider.\r\n\r\nThis is done using a combination of\r\n`GetOpenIdTokenForDeveloperIdentity` on the back-end to fetch an IdentityID and an OpenID Token\r\n`Auth.federatedSignIn(\"developer\", ...)` on the front-end to fetch STS credentials\r\n\r\nSo far so good. 👍\r\n\r\nAfter successfully authenticating, users interact with my REST API. However, I don't understand how to provide the user's federated IdentityId to my API in such a way that it can be verified.\r\n\r\nBack when I was using Amplify with a simple Cognito User Pool, I could call `Auth.signInUserSession()` on the client to retrieve the user's Cognito ID JWT, and then include it with their requests to my API where the tokens were verified using the User Pool's public JWKs. From there I had a trustable identity of the user, specifically their Cognito ID from the token's subject.\r\n\r\nIt seems that with the `Auth.federatedSignIn(\"developer\", ...)` workflow, I end up with STS credentials, which just provide authorization to service level roles. And that Open ID token from `GetOpenIdTokenForDeveloperIdentity` is short lived, and I've only seen it used to fetch STS credentials, so I don't think that's the correct way to identify the user either.\r\n\r\nNow that my Federated Users are signed in, is there an idiomatic way to identify them when they call my REST API? Specifically, I want to trust their IdentityId.\r\n\r\nAny help or guidance is much appreciated. Thanks!","upvoteCount":3,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjI2OTM5","author":{"login":"htc007"},"title":"Does Amplify DataStore selective sync based on PK perform scan or query?","body":"According to the docs for Amplify DataStore, you can selectively sync a subset of your data by specifying a sync expression.\r\n\r\nIf I construct a sync expression based on the partition key of the primary index (not a GSI), will the base sync perform a scan operation or a query operation? This is not clear in the docs.\r\n\r\nIf the base table contains a million items, but I only need to sync 100 specified items, a scan operation will be really inefficient and costly.\r\n\r\nI understand that it's possible to define a sync expression that returns the partition key of a GSI (instead of the primary index) and this will perform a query operation. However, this requires me to create a GSI with a duplicate set of data just for this purpose.\r\n\r\nIt would be really helpful if someone can clarify whether specifying the partition key of the primary index in the sync expression will perform a scan operation or a query operation.","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjI2Njk2","author":{"login":"hakenmt"},"title":"FederatedSignin Usage For Custom Provider","body":"I have a Cognito Identity Pool set up with an OIDC IdP (it's a custom one, this was all done outside of Amplify, I'm not using the CLI). I also have an existing Angular app. The experience I'm trying to create is that a not logged in user browses to the site, it sees that they are not logged in (i.e. forces login), redirects them to the OIDC site, lets them login, and then brings them back to my app with their cognito credentials (which will later be used to invoke API Gateway). Feels like this is a pretty straight forward workflow, but I cannot, for the life of me, figure out how to make this work with Amplify. I don't need user signup or an actual signin page (or even a signin button), I'm not even really interested in individual user metrics. Just enforce login, redirect to IdP, get the credentials from Cognito. That's it.\r\n\r\n```\r\nimport { Auth, Hub } from 'aws-amplify';\r\n\r\nawsconfig = {\r\n  Auth: {\r\n    identityPoolId: \"us-east-1:XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\",\r\n    region: \"us-east-1\",\r\n    mandatorySignIn: true,\r\n  }\r\n}\r\nAmplify.configure(awsconfig)\r\n...\r\nexport class AppComponent implements OnInit {\r\n constructor(private http: HttpClient) {\r\n      Auth.federatedSignIn({\r\n        customProvider: \"my.oidc.example.com\"\r\n      })\r\n  }\r\n}\r\n```\r\n\r\nThis doesn't work, I get `AuthError - Error: Amplify has not been configured correctly.`.  What am I missing here? Do I need to have the token from my OIDC provider before calling federatedSignin? And if so, what's the point of Amplify, I could just call Cognito directly at that point if I have to plumb the app to force the user to the OIDC first.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjI2NTc5","author":{"login":"ffxsam"},"title":"[Auth] Why doesn't confirming a new account set email_verified to true?","body":"I would think that if a user makes an account and clicks the verification link in their email, `email_verified` should be set to true, but it's not. Why is that? We'd rather not make the user go through another step to confirm their email when they technically already have.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjE0ODA5","author":{"login":"jk171505"},"title":"Record validation on the backend (AppSync / GraphQL)","body":"I'm looking for a way to validate and update records in DynamoDB table inserted by `DataStore.save()`. \r\nHere is the exact case:\r\n\r\nThere is a DynamoDB table (Bid) where user can add a record:\r\n```\r\nDataStore.save(new Bid({\r\n  amount: 3,\r\n  userId: <some_id>\r\n}));\r\n```\r\nLet's assume there was 5 inserts into this table, so the sum of the amounts is equal 15.\r\nNow amin approves each bid, one by one:\r\n```\r\nconst oldBid = await DataStore.query(Bid, id);\r\nconst approvedBid = await DataStore.save(\r\n  Bid.copyOf(oldBid, b => {\r\n    b.bitOK = true;\r\n  }\r\n));\r\n```\r\nThe thing is that the sum of all bids cannot be higher than 10, so the expected behaviour on the backend during 4th bid approval by admin would be:\r\n1. adjust the amount of this bit to 1 (3+3+3+1 = 10)\r\n2. delete all other bids that weren't approved yet - in this case the last one (5th)\r\n3. trigger lambda function with parameters like: recordAdjusted, recordsDeleted\r\n\r\nAs far as I know this could be done in AppSync pipeline resolvers but I'm looking for some hints on how to accomplish this. ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMDgxNDA2","author":{"login":"dorontal"},"title":"How to set proper permissions to allow post-confirmation trigger lambda function to access a REST API (both created by Amplify, getting 403 errors)","body":"When trying to access a REST API (that the client can access) from a post confirmation trigger lambda function, the post confirmation trigger lambda function gets back a 403 error.\r\n\r\nCurious if anybody knows how to solve this. \r\n\r\nBackground: Noticing that Amplify did create an IAM role for the post confirmation lambda, I attached the `AmazonAPIGatewayInvokeFullAccess` policy to the IAM role of the post confirmation lambda.\r\n\r\nBut that did not help: when trying to `GET` from a REST API (also created via Amplify) I still get 403 errors despite the attached full access policy. \r\n\r\nIf anybody has encountered this and found the secret, please share!  Thanks!","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"dorontal"},"body":"Please NOTE: After trying many things, I'm now convinced this is not a question but an issue so I opened an issue here (and would continue any further discussion in that issue): https://github.com/aws-amplify/amplify-cli/issues/6589"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMTkxNTgz","author":{"login":"VivekNeel"},"title":"InAppBrowser.openAuth() never gets resolved","body":"Hi,\r\n\r\nRecently our app got rejected by apple for social logins. So i have this solution using InAppBrowser.openAuth() but the issue is that our app never gets redirected **(because the promise does not get resolved hence Linking.openUrl never gets called)** it just redirects to the redirected url in the in app browser after logging in successfully\r\n\r\nI have the following configuration : \r\n\r\n```\r\nuserPoolId: awsExports.UserPoolId,\r\n  userPoolWebClientId: awsExports.UserPoolClientId,\r\n  storage: MemoryStorage,\r\n  identityPoolId: awsExports.IdentityPoolId,\r\n  region: awsExports.Region,\r\n  authenticationFlowType: 'USER_PASSWORD_AUTH',\r\n  aws_appsync_graphqlEndpoint: awsExports['API-Endpoint'],\r\n  aws_appsync_region: awsExports.Region,\r\n  aws_appsync_authenticationType: 'AWS_IAM',\r\n  graphql_headers: graphqlHeader,\r\n  oauth: {\r\n    domain: awsExports.UserPoolDomain,\r\n    scope: UserPoolClients.mobileClientScope,\r\n    redirectSignIn: UserPoolClients.mobileClientCallbackURLs[0],\r\n    redirectSignOut: UserPoolClients.mobileClientLogoutURLs[0],\r\n    responseType: 'code',\r\n    urlOpener: delegateToInAppBrowser ? urlOpener : null,\r\n  },\r\n```\r\n```\r\nasync function urlOpener(url: string, redirectUrl: string) {\r\n  try {\r\n    if (await InAppBrowser.isAvailable()) {\r\n      InAppBrowser.openAuth(url, redirectUrl, {\r\n        // iOS Properties\r\n        ephemeralWebSession: true,\r\n        // Android Properties\r\n        showTitle: false,\r\n        enableUrlBarHiding: true,\r\n        enableDefaultShare: false,\r\n      }).then((response) => {\r\n        console.log('.......response', response);\r\n        if (\r\n          response.type === 'success'\r\n          && response.url\r\n        ) {\r\n          Linking.openURL(response.url);\r\n          InAppBrowser.closeAuth();\r\n        }\r\n      });\r\n    } else {\r\n      Linking.openURL(url);\r\n    }\r\n  } catch (error) {\r\n    console.log('.......error', error);\r\n    Linking.openURL(url);\r\n  }\r\n}\r\n```\r\nNeither catch or then block gets called after providing credentials for any provider facebook, google , apple\r\n\r\n","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMTc5ODYw","author":{"login":"cnikolov"},"title":"Does anyone know how to validate token with cognito-identity-js ?","body":"I am trying to validate my tokens and the only way I could find is to  create refreshToken object, empty CognitoUser\r\n\r\nand to call cognitoUser.refreshSession , is that the right way ?\r\n\r\nLets say I have localhost/secret and I want only authenticated people to hit this endpoint and if they are authenticated I would like to get some of the attributes... currently can do but only with refreshSession , any suggestions?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMTM1MzE2","author":{"login":"Ochaun"},"title":"Can you Upload a Custom S3 Path without User ID prepended?","body":"I'm using the Client Amplify Storage API to upload to a custom folder. I'm using the `customPrefix` option to upload to **someDir**, but when I look in S3 it is **somedir/[userUUID]**. Is there a way to set custom prefix without the UUID appended? \r\n\r\n```js\r\nhandleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    await Storage.put(this.state.fileName, this.fileInput.current.files[0], {\r\n      serverSideEncryption: serverSideEncryption,\r\n      contentType: 'image/jpeg',\r\n      customPrefix: {\r\n        private: 'someDir/'\r\n      }\r\n    })\r\n      .then((res) => {\r\n        alert(\"all done here!\");\r\n      })\r\n      .catch((err) => {\r\n        console.error(err);\r\n      });\r\n\r\n  }\r\n```","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"Ochaun"},"body":"For anyone who stumbles on this, the answer is no. The prefix settings is handled at [`_prefix`](https://github.com/aws-amplify/amplify-js/blob/566b569b4256e82aa9ac3f682f33cfe08c8597e2/packages/storage/src/providers/AWSS3Provider.ts#L474) and is referenced in all methods including [put](https://github.com/aws-amplify/amplify-js/blob/566b569b4256e82aa9ac3f682f33cfe08c8597e2/packages/storage/src/providers/AWSS3Provider.ts#L226)"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMTM1NTEx","author":{"login":"ab-jfortich"},"title":"Cognito Federated Identities (Identity Pool) + SAML Authentication","body":"Hello,\r\n\r\nA project I am working on is currently using Cognito identity pools to allow users to login to our application using Google and FB sign-in. We are now trying to integrate authentication with our app using SAML. \r\n\r\nIn our application, the proposed flow would be:\r\n1) User authenticates with IdP\r\n2) User is redirected back to our application using some endpoint to receive the SAML response\r\n3) We pass the SAML response to AWS cognito identity to get user credentials\r\n\r\nIs this something that is possible to do with Cognito identity pool? This is our ideal approach as the SAML assertion has some additional attributes that we would need to do processing with.\r\n\r\nAlternatively, if we would need to pass the assertion directly to AWS cognito, is it possible to redirect to a different success URL? For example, instead of navigating to the AWS console, can we navigate back to our own application with info from the assertion?\r\n\r\nAny help/feedback is appreciated.\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMTY2MjAw","author":{"login":"rraczae"},"title":"DataStore unique record per Cognito User","body":"Hey Everyone,\r\n\r\nMy use case is to create a UserSettings table that is restricted to have only one record per Cognito user. It's easy to set the owner of a record, however I don't see a way to guarantee the required uniqueness. My initial idea was to set the Cognito user's id as the primary key but that is not possible at the moment:\r\n\r\nhttps://github.com/aws-amplify/amplify-js/discussions/5976\r\n\r\nAny thoughts?\r\n\r\nBest,\r\n\r\nRob","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"mynameisguy"},"body":"Did you manage to find a solution?"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yOTcwODk0","author":{"login":"CarlJoven"},"title":"Does datastore support auth mode like in API graphql?","body":"Does datastore support auth mode like in API graphql?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb241NzI5","author":{"login":"screendriver"},"title":"How to send emails from a contact form?","body":"I want to build a website with a contact form. But how can I send an email out of the contact form to some persons? I'm aware of [Amazon Simple Email Service](https://aws.amazon.com/ses/) (aka `Amazon SES`) and [Netlify Forms](https://www.netlify.com/products/forms/) but is there something similar in `Amplify` out of the box?","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"amhinson"},"body":"@screendriver There isn't any current Amplify category that does what you're describing, but that makes for a great feature request! Feel free to open an \"Feature Request\" issue so we can track any additional interest from the community."}},{"node":{"author":{"login":"mkaschke"},"body":"In my case, I used lambda, SES triggered by the Dynamodb to do this. "}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yODUzMjc5","author":{"login":"togro"},"title":"How Hide forgot password link ?","body":"How can hide \"Forgot your password\" hint ?\r\n\r\nWe have an application that only with usernames created by admins .\r\n\r\n![image](https://user-images.githubusercontent.com/7252575/107077923-4d221280-67cc-11eb-9621-47d27c89c367.png)\r\n","upvoteCount":4,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yODM3ODQ4","author":{"login":"ari-cv"},"title":"Vue JS Amplify authenticator - Binding to events","body":"I wanted to ask how I can implement a spinner while waiting for login from the amplify authenticator.. the loading event **doesn't** seem to fire until **just before** the login details are resolved and I am not able to use the slots implementation to customize my sign-in button with events using nuxt.js as they don't override the default contents. ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNjk4","author":{"login":"syang"},"title":"How to get the URL of an avatar when we use Amplify Storage","body":"I wanted to build a user profile feature using Amplify Storage. Basically, I wanted to have the user to upload his avatar onto the protected folder under his Identity_ID, i.e., \r\n `arn:aws:s3:::my-avatar-bucket/protected/${cognito-identity.amazonaws.com:sub}`\r\n\r\nI have setup up my S3 bucket as instructed by [Amplify Storage S3 setup](https://docs.amplify.aws/lib/storage/getting-started/q/platform/js#using-amazon-s3)\r\n\r\nLet's say after the avatar upload operation, the avatar file is located here:\r\n`arn:aws:s3:::my-avatar-bucket/protected/[syang's identity id here]/avatar.jpg`\r\n\r\nHow can I get the above avatar URL and persist it into my profile record (say it's a record in a DynamoDB)? Should I use Amplify's get method (see the method below) to get the URL and post it into my DynamoDB? Or is there a way for me to configure a lambda trigger on the S3 side?\r\n\r\n```\r\n    // get object/pre-signed url from storage\r\n    get(key: string, options?): Promise<String|Object>\r\n```\r\n\r\n\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"yalamber"},"body":"Hello, anybody found solution for this?"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yODU2","author":{"login":"jmonguilo"},"title":"Same 2LD and different 3LD for multiple Amplify apps with common backend.","body":"Hello,\r\n\r\nWe are trying to build 3 different frontends as follows:\r\n\r\nmy-domain.com\r\nassets.my-domain.com\r\nadmin.my-domain.com\r\n\r\nAnd we want to use the same backend for them. As each frontend is in a different repository, what would be the best strategy for achieve this?\r\n\r\nWe have tried the following:\r\n\r\n1- `amplify init` for my-domain.com app (we intend to develop the backend here).\r\n2- `amplify pull` and manually connect app on the Amplify console for assets.my-domain.com (impossible to setup domain because already in use) \r\n3- `amplify pull` and manually connect app on the Amplify console for admin.my-domain.com (impossible to setup domain because already in use)\r\n\r\nAdditionally, when using `amplify init` it is not possible to set a project name with dashes (e.g.: 'myproject-assets' is not valid), whereas on the console it is possible.\r\nWe should agree that having \"myprojectassetssomethingelse\" as project name does not look appealing. \r\n\r\nThank you.","upvoteCount":3,"comments":{"edges":[{"node":{"author":{"login":"ernestostifano"},"body":"Any recommendation about this?"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNTcxNTI1","author":{"login":"Mac-prof"},"title":"S3 private bucket storage - missing key prefix","body":"**Situation**: I have pretty standard Amplify project leveraging on Angular, Cognito authentication, Dynamo DB for tables storage and S3 for images storage. I want to have one of my Dynamo DB fields to point a key to the PRIVATE bucket, that will let me generate URL for image to be presented on the web page.\r\n\r\n**Complication**: the Storage.put function stores properly the image file in the private bucket, putting a dedicated prefix per each Cognito user (so sort of folder). I face however a problem to programmatically get the full Key of the stored image file. The put function returns only the key that contains the file name instead of prefix + file name in a given private bucket. \r\n\r\n**Would you please suggest what do I do wrongly? Thank you in advance.**\r\n\r\nWhile storing browser selected image I put this this way:\r\n`\r\n const response = await Storage.put(\"NewImageName\", \"NewImageFile\", { \r\n    level: 'private',\r\n    contentType: 'image/jpg', }\r\n .then (result => {\r\n          console.log('result string' + result);\r\n      }) \r\n      .catch(err => console.log(err));\r\n   }\r\n`\r\nIt is stored in a private bucket with some prefix generated by a put function specifically for given Cognito user.\r\n\r\nWhen trying to retrieve the file I need to put the key... but the key I get from the put function does not contain a prefix - it only contains the actual file name (e.g. picture.jpg), so the url does not point the stored file properly. \r\n`\r\n    params = {  Bucket: 'mybucketname',\r\n      Key: key_obtained_from_put_function,\r\n      Expires: 120*60 };\r\n    }\r\n    var url = this.s3.getSignedUrl('getObject', params);`\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNTAwNTU1","author":{"login":"jonathanloos"},"title":"Conditional Sync","body":"Hello everyone!\r\n\r\nI'm a couple weeks new to Amplify and I am loving it so far. I did see this issue: #5037 but had a slightly different application I was hoping someone here might also want/ has accomplished. I'm in the mental health sector and have found that users oftentimes don't completely trust the cloud and don't always have network connection. With this, Datastore has made it super easy for offline stuff and cloud sync, but I'd like to onboard users without the cloud (everything local) and then give them the option to sync when they're ready. By the sounds of the connected issue it doesn't sound like this is an option, but has anyone attempted this or something similar?\r\n\r\nThanks in advance!","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"sasweb"},"body":"Hey! \r\n\r\nI have started a discussion on this just some days ago: https://github.com/aws-amplify/amplify-js/discussions/7624\r\nMy description is more technical but I think we want the same :D \r\n\r\nHowever, as you maybe noticed the AWS team doesn't care. If you look through the issues you'll notice that there are plenty issues with most trivial requests open for months and years without any comments from Amplify contributors. They just ignore it.\r\n\r\nMy current approach for React Native is now to implement a custom solution with AsyncStorage and Firebase. Let's see if this works out better.\r\n\r\n\r\n\r\n"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMjU1OTI0","author":{"login":"danielgeri"},"title":"GraphQL Resource/Object based Authorization","body":"Hello! Currently my API is structured so that there is are public and private parts to my site using GraphQL. However, in the very near future I'm looking to structure my access rules such that there is resource-based authorization (e.g. think google docs user access - for a private document, users who are explicitly added to a \"shared list\" have access). Is there a best practices approach of this same concept using Amplify? \r\n\r\nperhaps this may also provide insight/clarity to the question:https://aws.amazon.com/blogs/apn/how-to-implement-object-based-authorization-in-serverless-applications-using-amazon-cognito/?nc1=b_rp","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMjMwMzk2","author":{"login":"mjza"},"title":"How to pass items in queries?","body":"When I use AWS AppSync and play with queries I can run a query like following which by `item` I declared what columns I need. \r\n\r\n```\r\nquery MyQuery {\r\n  listUserReportsByUpdatedAt(owner: \"c40aabc8-9b21-4aa5-b296-12175390e28e\") {\r\n    items {\r\n      id\r\n      location\r\n      longitude\r\n      latitude\r\n    }\r\n  }\r\n}\r\n```\r\n\r\nWhen I want to do the same in js (React) what do I have to do? \r\n\r\nI am using this snippet of code:\r\n\r\n```js\r\nconst apiData = await API.graphql(\r\n      graphqlOperation(listUserReportsByUpdatedAt,\r\n        // Sort and filter long arrays\r\n        {\r\n          owner: \"c40aabc8-9b21-4aa5-b296-12175390e28e\",\r\n          sortDirection: 'DESC',\r\n          limit: 100,\r\n          nextToken: this.state.nextToken \r\n        }\r\n      )\r\n    );\r\n```\r\n\r\nHowever, I don't know how to pass items here?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"mjza"},"body":"I found a work around for modifying the items in a graghql query:\r\n\r\n```js\r\nreplaceItemsInQuery(query, items) {\r\n    const regex = /(items\\s*)({(\\s*[^{]*{[^}]*})*(\\s*[^}]*)*})+/gm;\r\n    let m = regex.exec(query);\r\n     if (m !== null && m.length>0) {\r\n         return query.replace(m[2],items);\r\n     }\r\n    return query;\r\n  }\r\n  \r\n  async fetchUserReportsByUpdatedAt() {   \r\n    let query = this.replaceItemsInQuery(listUserReportsByUpdatedAt, \r\n      `{\r\n        id\r\n        location\r\n        latitude\r\n        longitude\r\n       }`);\r\n\r\n    const apiData = await API.graphql(\r\n      graphqlOperation(query,\r\n        // Sort and filter long arrays\r\n        {\r\n          owner: \"c40aabc8-9b21-4aa5-b296-12175390e28e\",\r\n          sortDirection: 'DESC',\r\n          limit: 100,\r\n          nextToken: this.state.nextToken\r\n        }\r\n      )\r\n    ); \r\n    this.setState({reports: apiData.data.listUserReportsByUpdatedAt.items});   \r\n  }\r\n``` "}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMTA2NzQ1","author":{"login":"sasweb"},"title":"How to use and transform anonymous user to Cognito User Pool","body":"Hi there!\r\n\r\nI am exploring amplify now for some weeks. \r\nAfter some research and trial & error I am still not sure if my use case will work.\r\n\r\nMy setup:\r\n- React Native\r\n- DataStore\r\n- Auth\r\n\r\nMy goal:\r\nNot a todo app but very similar. Users can create items locally. No need for real time sync with other users. However, a user may sign in from different devices. If the user is registered data should be synced between devices.\r\n\r\nThe issue:\r\nI use a freemium model without mandatory registration. Users can use the app (offline only) right away and may never sign up. This also makes totally sense because the online option is more like a premium feature. However, as soon as the user decides to sign up (Goole and Apple sign in only, no email) the account should be transformed into a Cognito Pool User and all existing data should be synced. I have already setup both - auth and api. But it's hard to make both parts work together.\r\n\r\nMy questions:\r\n- How can users sign up/in anonymously? I have seen some comments in the issues but no docs that clearly say how to do this. Anonymously means it's a local only user. I assume that this is needed as a preparation for the potential \"upgrade\" to a Google or Apple account.\r\n- How can an anonymous user be transformed to a Cognito User Pool User? Haven't found anything on this.\r\n- How to setup auth rules? Is this an use case for Owner based Authorization with OIDC provider?\r\n\r\nI have added kind of an activity diagram with some notes on it. Maybe this makes it clearer.\r\n\r\n<img width=\"858\" alt=\"chart\" src=\"https://user-images.githubusercontent.com/15066762/105909392-caf55980-6027-11eb-9c06-b206c9560388.png\">\r\n\r\nThanks!\r\n\r\nEdit: This is how firebase does it: https://firebase.google.com/docs/auth/web/anonymous-auth?hl=en","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNjU3NTkx","author":{"login":"sammy532"},"title":"Aws Amplify Auth does not work in react native app","body":"I want to use AWS Amplify within my react native app as suggested [here][1]: I wanted to integrate the basic usage within my app. Here is the basic usage as suggested from the docs: \r\n\r\n    const App = () => (\r\n      <AmplifyAuthenticator>\r\n        <div>\r\n          My App\r\n         <AmplifySignOut />\r\n       </div>\r\n     </AmplifyAuthenticator>\r\n     );\r\n\r\nMy app, after adding the aws auth: \r\n\r\n      function App() {\r\n        return (\r\n          <AmplifyAuthenticator>\r\n            <NavigationContainer>\r\n               <SomeStack />\r\n            </NavigationContainer>\r\n            <AmplifySignOut />\r\n         </AmplifyAuthenticator>\r\n       ); \r\n     }\r\n\r\nInstead of showing the authentication flow it gives me the following error: `414 Authenticator - Failed to verify contact, [Invariant Violation: View config getter callback for component amplify-authenticator must be a function (received undefined). Make sure to start component names with a capital letter.]`\r\n\r\nBefore adding the aws auth, my app was working as expected, but I don't understand where the problem is.\r\n\r\nMy `packaje.json` file:\r\n\r\n\r\n        {\r\n          \"main\": \"node_modules/expo/AppEntry.js\",\r\n            \"scripts\": {\r\n                \"start\": \"expo start\",\r\n                \"android\": \"expo start --android\",\r\n                 \"ios\": \"expo start --ios\",\r\n                 \"web\": \"expo start --web\",\r\n                 \"eject\": \"expo eject\"\r\n             },\r\n            \"dependencies\": {\r\n                   \"@aws-amplify/ui-components\": \"^0.9.8\",\r\n                  \"@aws-amplify/ui-react\": \"^0.2.33\",\r\n                 \"@react-native-community/masked-view\": \"^0.1.10\",\r\n                 \"@react-native-community/netinfo\": \"^5.9.7\",\r\n                 \"@react-navigation/bottom-tabs\": \"^5.11.2\",\r\n                 \"@react-navigation/native\": \"^5.8.10\",\r\n                 \"@react-navigation/stack\": \"^5.12.8\",\r\n                 \"@react-navigation/web\": \"^1.0.0-alpha.9\",\r\n                  \"aws-amplify\": \"^3.3.13\",\r\n                  \"aws-amplify-react-native\": \"^4.2.10\",\r\n               \"expo\": \"~40.0.0\",\r\n              \"expo-status-bar\": \"~1.0.3\",\r\n             \"react\": \"16.13.1\",\r\n             \"react-dom\": \"16.13.1\",\r\n             \"react-native\": \"https://github.com/expo/react-native/archive/sdk-40.0.1.tar.gz\",\r\n              \"react-native-gesture-handler\": \"^1.8.0\",\r\n             \"react-native-reanimated\": \"^1.13.2\",\r\n             \"react-native-safe-area-context\": \"^3.1.9\",\r\n             \"react-native-screens\": \"^2.15.0\",\r\n            \"react-native-web\": \"~0.13.12\"\r\n            },\r\n           \"devDependencies\": {\r\n                  \"@babel/core\": \"~7.9.0\"\r\n            },\r\n           \"private\": true\r\n         }\r\n \r\n\r\n\r\n  [1]: https://docs.amplify.aws/ui/auth/authenticator/q/framework/react#installation ","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"jo-fra"},"body":"Maybe try to use the `withAuthenticator` Higher Order Component if you target React Native.\r\nAs described here:\r\n[https://docs.amplify.aws/ui/auth/authenticator/q/framework/react-native](https://docs.amplify.aws/ui/auth/authenticator/q/framework/react-native)"}},{"node":{"author":{"login":"amhinson"},"body":"It looks like you're trying to use the Authenticator component for React, which will not work in React Native. You'll need to utilize the Amplify UI components built specifically for React Native [here](https://docs.amplify.aws/ui/auth/authenticator/q/framework/react-native)."}},{"node":{"author":{"login":"sammy532"},"body":"Thank you, this was the answer I was looking for!  "}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xOTc3ODUx","author":{"login":"ignaciolarranaga"},"title":"How can we translate Cognito custom validation messages during the authentication?","body":"For example, I've the authentication configured for username, email or phone, but if the user introduces the phone wrongly formatted Cognito rejects it because it is not matching any of the possible formats.\r\n\r\nA message like this:\r\n```\r\n2 validation errors detected: Value '+598 99 123123' at 'userName' failed to satisfy constraint: Member must satisfy regular expression pattern: [\\p{L}\\p{M}\\p{S}\\p{N}\\p{P}]+; Value '+598 99 123123' at 'userAlias' failed to satisfy constraint: Member must satisfy regular expression pattern: [\\p{L}\\p{M}\\p{S}\\p{N}\\p{P}]+\r\n```\r\n\r\nI know I can override the slot but I would prefer not having to eject that logic for such a minor thing :)\r\n\r\nWhat about something like a callback for intercepting messages before display?\r\nP.S.: A trim before sending the userName might not be bad also.","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xOTY1ODY2","author":{"login":"skilenton"},"title":"[PubSub] Programmatically attaching IoT policy to the current authenticated user","body":"I can't seem to find a way to attach iot policy programmatically in js. The guide only shows how to do it via cli. I've tried lambda triggers but identityId is hidden/undefined even in post authentication. Help pls :(","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xOTQ2MjY1","author":{"login":"CoonHouse"},"title":"Newly created custom attributes in Cognito not available in identity.claims","body":"Hello,\r\nFor a long time, I was using a custom attribute in my Appsync resolvers detect tenants, using ` $ctx.identity.claims[\"custom:tenantID\"]`. This is working fine. Now I added an extra custom attribute to Cognito but I cannot access it from my resolvers. I logged the \"claims' object, my tenantID is there with morevalues like 'sub', 'cognito.groups', 'iss', etc. but not my new attribute. Wwen I use te cli command `aws cognito-idp admin-get-user` my new attribute is present. \r\nDo I need to do additioanal actions to make them available in Appsync?\r\n\r\nThanks,\r\n\r\nWilco","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"CoonHouse"},"body":"I Found it!\r\nFor anyone else searching for this. Its in the Userpool settings under \"App clients' -> 'Show details' -> 'Set attribute read and write permissions'"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xOTM0ODc5","author":{"login":"sacrampton"},"title":"AppSync Resolvers & Amplify DataStore","body":"Our current app uses GraphQL Resolvers to create / update / delete records. We are trying to move to DataStore and have a question about using custom resolvers.\r\n\r\nIn the GraphQL Resolvers we implement logic and security (given @auth limitations with respect to subscriptions and DataStore). Here is an example - in a resolver I want to have a default value for auditCompleted - so if one is not provided in the create mutation that we default to these values.\r\n\r\n```\r\n#if($ctx.args.input.auditCompleted)\r\n\t#set( $auditCompleted = $ctx.args.input.auditCompleted) #else\r\n\t#set( $auditCompleted = false)\r\n#end\r\n$util.qr($context.args.input.put(\"auditCompleted\", $auditCompleted))\r\n```\r\n\r\nAlso, the resolver sets a default ID if none is provide.\r\n```\r\n$util.qr($context.args.input.put(\"id\", $util.defaultIfNull($ctx.args.input.id, $util.autoId())))\r\n\r\n```\r\n\r\nIn DataStore is there some way to use the logic in the resolvers when doing the local cache operations.","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xOTMzOTcz","author":{"login":"lucianomlima"},"title":"Set token expiration with Amplify and React Native","body":"https://aws.amazon.com/about-aws/whats-new/2020/08/amazon-cognito-user-pools-supports-customization-of-token-expiration/\r\n\r\nAfter reading the above blog post, I'm trying to find a way to define the expire time in a React Native with amplify, but can't find anything. Is there a way to define accessToken expire time per app?","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xOTIyMDgy","author":{"login":"yaquawa"},"title":"what does it mean if `@connection` without arguments?","body":"I saw this sample code on the doc:\r\n\r\n```gql\r\ntype Project @model {\r\n  id: ID!\r\n  name: String\r\n  team: Team @connection\r\n}\r\n\r\ntype Team @model {\r\n  id: ID!\r\n  name: String!\r\n}\r\n```\r\n\r\nit's unclear what it's going to do compare with this example code:\r\n```gql\r\ntype Project @model {\r\n  id: ID!\r\n  name: String\r\n  teamID: ID!\r\n  team: Team @connection(fields: [\"teamID\"])\r\n}\r\n\r\ntype Team @model {\r\n  id: ID!\r\n  name: String!\r\n}\r\n```\r\n\r\nand I can't find any info on the docs.\r\nDoes anyone know what it mean if `@connection` without any arguments?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xOTA4NzUz","author":{"login":"TAConsulting"},"title":"Extra login field (role)","body":"Hi guys,\r\n\r\nWhat I'm trying to do is create an admin portal where you can sign in using username, password and ROLE - as our admins might want a different level of access.\r\n\r\nI was able to add a new role field using the formFields property in Amplify on the front-end - but the value doesn't get sent on sign-in (by Amplify anyway), I'm trying to essentially get a value I can process in the pre-tokenGeneration trigger \r\n\r\nAny info appreciated!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xODk3NzYx","author":{"login":"richgmorg"},"title":"Sources not visible after import aws-amplify when debugging React app","body":"As soon as I add \"import Amplify from 'aws-amplify';\" to the App.js file in a simple application created with \"create-react-app\" I no longer see the sources and set breakpoints when attempting to debug the application in Chrome or Firefox.\r\n\r\nIs there a way to use the Amplify libraries and still see the source and set breakpoints in the browser?\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xODk0OTc0","author":{"login":"debugguru"},"title":"Customise AmplifyConfirmSignUp","body":"Currently AmplifyConfirmSignUp only allows code verification. We are using email link verification. Is there a way to customise the AmplifyConfirmSignUp so that it shows custom text, user email and button to take user back to sign in page?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xODc4Nzky","author":{"login":"marco910"},"title":"Should I use environment variables for my Amplify config?","body":"Hi everyone,\r\n\r\nSince a few months I'm working on a NextJS project with AWS Cognito as Auth Provider (the backend is a existing one, that is configured manually). If I'm using my Amplify config for server-side actions all works fine but if there is a action which is carried out in the browser I'm getting an error that Amplify is not configured correctly. \r\n\r\nI figured out that this is caused by the environment variables used in my Amplify config. If i put the Auth-Pool-ID etc. directly into the Amplify config all works fine.\r\n\r\nDo I have to include the Amplify secrets with environment variables in a production version to keep my app and backend secure?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"pedramp20"},"body":"Yes, you should define them in the front-end and leave them empty or set dummy values for them. Then you should define environment variable in your CI/CD pipeline and replace them on build and/or publish. "}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xODczNjkw","author":{"login":"myfairshare"},"title":"Easiest way to handle a 30 day check...ie a subscription check","body":"Hello,\r\n\r\n    I'm just wondering if anyone could suggest an optimal way to handle a subscription feature.  So the flow would basicly be something like...\r\n\r\nUser clicks start free subscription\r\nI update the users subscription status in dynamodb to 'started' with a datastore update function\r\n\r\nAfter 30 days I check if a payment has been received, if no payment received I update the subscription to deactivated.\r\n\r\nIs this a scenario where I should use a cron job with a serverless function, can I access the database with these functions?\r\n\r\nOr would some kind of JS function using Time suffice.\r\n\r\nAny tips much appreciated, thanks!","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"pedramp20"},"body":"You should add a claim to your user JWT token. If you are using cognito, you should either utilise groups or define an attribute and set the attribute instead of a value in your dynamo db. Then, in your custom resolver, you should check the token and authorise the user for a specific action. For the frontend side, you should check the token and customise your view, when a user authenticates or refreshes its token."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xODkxNTEz","author":{"login":"pedramp20"},"title":"How to detect disgraceful disconnection of an authenticated user from a specific  graphql subscription","body":"Imaging that there is a graphql subscription, where authenticated users can subscribe to. In the case of graceful connection and disconnection, of course the user can update a certain state in a DB or communicate it. However, when it comes to disgraceful disconnection, only the server (in this case AppSync) can detect it (after the connection is timed out). \r\nHow can a lambda function be triggered on an appsync disconnection?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xODg1OTEx","author":{"login":"newbie737"},"title":"I can't apply custom theme for withAuthenticator in React Native","body":"I want to apply a custom theme on my login screen using `aws auth` services. I tried to do so using `withauthenticator`. I read all possible information online, what people suggest, yet it doesnt work for me. I tried what was suggested [here][1] as well, but the solution doesnt work for me.\r\nBasically, I can use `aws auth` serivces calling just `export default withAuthenticator(App, true);` That worked fine for me. However, the default sign up screen requires telephone number, which I dont want. So I created a custom config: \r\n\r\n  \r\n\r\n       export default signUpConfig = {\r\n      hiddenDefaults: ['phone_number'],\r\n      signUpFields: [\r\n        {\r\n          label: 'User Name',\r\n          key: 'username',\r\n          required: true,\r\n          displayOrder: 1,\r\n          type: 'username',\r\n          custom: false\r\n        },\r\n        {\r\n          label: 'Email',\r\n          key: 'email',\r\n          required: true,\r\n          displayOrder: 2,\r\n          type: 'email',\r\n          custom: false\r\n        },\r\n        {\r\n          label: 'Password',\r\n          key: 'password',\r\n          required: true,\r\n          displayOrder: 3,\r\n          type: 'password',\r\n          custom: false\r\n        }\r\n      ]\r\n    };\r\n\r\nAfter that I called my component the following way: \r\n\r\n       export default withAuthenticator(App, {\r\n                includeGreetings: true,\r\n                signUpConfig: signUpConfig}\r\n              );\r\nThat worked fine as well. I did not see the phone number field any more. \r\nHere is the problematic part. I wanted to create a custom style. Nothing fancy, I just want to be able to see that I am able to apply this custom style. So I created my custom theme: \r\n\r\n   \r\n\r\n       import { AmplifyTheme } from \"aws-amplify-react\";\r\n    \r\n    export default authTheme = {\r\n      ...AmplifyTheme,\r\n      sectionHeader:{\r\n        ...AmplifyTheme.sectionHeader,\r\n        color:\"red\",\r\n      },\r\n      formSection: {\r\n        ...AmplifyTheme.formSection,\r\n        backgroundColor: \"green\",\r\n      },\r\n      sectionFooter: {\r\n        ...AmplifyTheme.sectionFooter,\r\n        backgroundColor: \"purple\"\r\n      },\r\n      button: {\r\n          ...AmplifyTheme.button,\r\n          backgroundColor: \"blue\"\r\n      }\r\n    }\r\n\r\nI tried so many was to apply this theme, yet nothing worked and none of the colors have been changed. Some of the things which I tried and didnt work: \r\n   \r\n\r\n    export default withAuthenticator(App, {\r\n                    includeGreetings: true,\r\n                    signUpConfig: signUpConfig,\r\n                    theme: authTheme });\r\n\r\n The app loads, but the colors are the same.\r\n\r\n`export default withAuthenticator(App, false, [], null, authTheme);` - the app doesnt load and my expo crashes;\r\n`export default withAuthenticator(App, false, [], null, authTheme, { signUpConfig } );` - same as the above\r\n \r\nI also tried to apply just the theme, without any sign up config, but it didnt work.\r\nAny suggestions are welcome!\r\n\r\n  [1]: https://stackoverflow.com/questions/57464208/customize-colors-of-withauthenticator-hoc-component\r\n\r\n","upvoteCount":6,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMTA2MQ==","author":{"login":"funkel1989"},"title":"Help with Amplify and Nuxt SSR","body":"Recently the amplify team provided an example of a SSR site using next.js and in the article they speak of Nuxt also:\r\nhttps://aws.amazon.com/blogs/mobile/ssr-support-for-aws-amplify-javascript-libraries/\r\n\r\nHas anyone determined how to deploy a nuxt SSR site using amplify yet?\r\n\r\nI've done this with serverless framework where site dynamic content is deployed on a lambda and I'm trying to determine if this SSR stuff can be done with Amplify or not.\r\n\r\nExamples would be wonderful if anyone has one yet!\r\n\r\nThanks for any help you may provide!","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"regenrek"},"body":"Hi this a pretty late response but we have an app in production which uses amplify libraries for auth. \r\nI have created a small reproduction repository here: https://github.com/regenrek/nuxt-aws-amplify-auth\r\n"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNzkzMjI2","author":{"login":"joebernard"},"title":"Token refresh with React Native, Amplify, and Apollo","body":"The [docs](https://docs.amplify.aws/lib/auth/advanced/q/platform/js#token-refresh) mention that automatic token refresh is not supported in React Native but they are light on details as to how this is accomplished. I assume this means I need to manually refresh the token somehow.\r\n\r\nI understand how to retrieve a new token, but not entirely sure what to do after that or when this should be called.\r\n\r\n```javascript\r\ntry {\r\n    const cognitoUser = await Auth.currentAuthenticatedUser();\r\n    const currentSession = cognitoUser.signInUserSession;\r\n    cognitoUser.refreshSession(currentSession.refreshToken, (err, session) => {\r\n      // do something with the new session\r\n    });\r\n  } catch (e) {\r\n    // whatever\r\n  }\r\n};\r\n```\r\n\r\nI'm using the `@apollo/client` package to build my client. It exposes an `onError` [link](https://www.apollographql.com/docs/link/links/error/#retrying-failed-requests). Should I be using this to refresh tokens when an auth error occurs, or is there a better approach? If I switched to the `aws-appsync` would token refresh be handled automatically? An example of how others are handling this within React Native, Amplify, and Apollo 3 would be great.","upvoteCount":4,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNzgyNTEw","author":{"login":"kieranjen"},"title":"No credentials error when using Storage.put","body":"I'm putting this here because I'm not sure if it's a bug or something incorrect with my config.\r\n\r\nI have a Cognito user pool and S3 bucket configured outside of Amplify.\r\n\r\nI configure Amplify with the following:\r\n\r\n```\r\nAmplify.configure(Auth: {\r\n        identityPoolId: IDENTITY_POOL_ID,\r\n        region: REGION,\r\n        userPoolId: USER_POOL_ID,\r\n        userPoolWebClientId: APP_CLIENT_ID,\r\n        identityPoolRegion: REGION,\r\n        mandatorySignIn: true\r\n    },\r\n    Storage: {\r\n        AWSS3: {\r\n            bucket: UPLOAD_BUCKET,\r\n            region: REGION,\r\n            level: 'private'\r\n        }\r\n    },\r\n    API: {\r\n        endpoints: [\r\n            {\r\n                name: 'apis',\r\n                endpoint: API_ENDPOINT,\r\n                region: REGION\r\n            }\r\n        ]\r\n    });\r\n```\r\nTo then upload to S3 I do the following:\r\n\r\n```\r\nAuth.currentUserCredentials()\r\n            .then(() => {\r\n                Storage.put(selectedFile.name, selectedFile, {\r\n                    contentType: selectedFile.type,\r\n                })\r\n                    .then(() => {\r\n                        console.log('Uploaded');\r\n                    })\r\n                    .catch((err) => console.log(err));\r\n            });\r\n```\r\n\r\nAn error is caught when calling `Storage.put`, which prints out `No credentials`.\r\n\r\nI have enabled debug with `window.LOG_LEVEL = 'DEBUG'`. The following is the output:\r\n\r\n```\r\n[DEBUG] 02:20.479 AuthClass - Getting current user credentials ConsoleLogger.js:97\r\n[DEBUG] 02:20.480 AuthClass - Getting current session ConsoleLogger.js:97\r\n[DEBUG] 02:20.481 AuthClass - Getting the session from this user: \r\nObject { username: \"<username>\", pool: {…}, Session: null, client: {…}, signInUserSession: {…}, authenticationFlowType: \"USER_SRP_AUTH\", storage: Storage, keyPrefix: \"CognitoIdentityServiceProvider.<output>\", userDataKey: \"CognitoIdentityServiceProvider.<key>.userData\", attributes: {…}, … }\r\nConsoleLogger.js:107\r\n[DEBUG] 02:20.483 AuthClass - Succeed to get the user session \r\nObject { idToken: {…}, refreshToken: {…}, accessToken: {…}, clockDrift: 0 }\r\nConsoleLogger.js:107\r\n[DEBUG] 02:20.483 AuthClass - getting session success \r\nObject { idToken: {…}, refreshToken: {…}, accessToken: {…}, clockDrift: 0 }\r\nConsoleLogger.js:107\r\n[DEBUG] 02:20.484 Credentials - set credentials from session ConsoleLogger.js:97\r\n[DEBUG] 02:20.655 Credentials - Load credentials successfully \r\nObject { identityId: \"<identity>\", accessKeyId: \"<access key>\", secretAccessKey: \"<secret key>\", sessionToken: \"<session token>\", expiration: Date Thu Jan 14 2021 13:02:20 GMT+0000 (Greenwich Mean Time) }\r\nConsoleLogger.js:107\r\n[DEBUG] 02:20.655 Credentials - getting credentials ConsoleLogger.js:97\r\n[DEBUG] 02:20.655 Credentials - picking up credentials ConsoleLogger.js:97\r\n[DEBUG] 02:20.655 Credentials - getting new cred promise ConsoleLogger.js:97\r\n[DEBUG] 02:20.655 Credentials - checking if credentials exists and not expired ConsoleLogger.js:97\r\n[DEBUG] 02:20.655 Credentials - need to get a new credential or refresh the existing one ConsoleLogger.js:97\r\n[WARN] 02:20.656 AWSS3Provider - ensure credentials error No Auth module registered in Amplify react_devtools_backend.js:2430:23\r\nNo credentials\r\n```\r\n\r\nI have found various issues relating to this but the solutions haven't worked. The output looks ok to me up until the `AWSS3Provider` warning.\r\n\r\nHere are the amplify packages I have in my `package.json`:\r\n\r\n```\r\n\"@aws-amplify/api\": \"^3.2.17\",\r\n\"@aws-amplify/auth\": \"^3.4.17\",\r\n\"@aws-amplify/cache\": \"^3.1.42\",\r\n\"@aws-amplify/core\": \"^3.8.9\",\r\n\"@aws-amplify/storage\": \"^3.3.17\",\r\n```\r\n\r\nCan anyone tell me if I have configured something wrong?\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"kieranjen"},"body":"This was fixed by deleting `package-lock.json` and `node_modules` and then running `npm install`."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNzYwMjM4","author":{"login":"shweta-codeprism"},"title":"IAM Access to amplify graphql apis","body":"Some of my graphql apis are being consumed by lambdas using appsync. To make it possible I have to allow iam access to the api by adding (@aws_iam) tag in the schema from the AWS Appsync console . \r\n\r\nThe issue is, every time I update my schema, the tags get deleted ( This is reasonable because \"amplify push\" is actually updating the schema) and I have to reset the (@aws_iam) tags for the required apis and connections.\r\n\r\nIs there a way to persist it ?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNzM3OTA5","author":{"login":"patweb99"},"title":"Are there any new events that will be available for Interactions outside of chatCompleted?","body":"Currently, the only Interactions event that is available is chatCompleted. \r\n\r\nIt would be great to have some of the following\r\n1. chatTextSent & chatVoiceSent: Whenever a new chat message is sent to lex\r\n2. chatTextReceived & chatVoiceReceived: Whenever a new change is received\r\n3. chatStart: Whenever the chat has started","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNzM3OTA4","author":{"login":"patweb99"},"title":"Are there any to create more events such as chatCompleted for Interactions available?","body":"Currently, the only Interactions event that is available is chatCompleted. \r\n\r\nIt would be great to have some of the following\r\n1. chatTextSent & chatVoiceSent: Whenever a new chat message is sent to lex\r\n2. chatTextReceived & chatVoiceReceived: Whenever a new change is received\r\n3. chatStart: Whenever the chat has started","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNzE3OTQy","author":{"login":"Salmandabbakuti"},"title":"Whats the point of using ```Auth.currentAuthenticatedUser()``` to update user attributes","body":"I found below code snippet in the amplify auth library usage documentation [Here](https://docs.amplify.aws/lib/auth/manageusers/q/platform/js#managing-user-attributes)\r\n```\r\nlet user = await Auth.currentAuthenticatedUser();\r\n\r\nlet result = await Auth.updateUserAttributes(user, {\r\n    'email': 'me@anotherdomain.com',\r\n    'family_name': 'Lastname'\r\n});\r\nconsole.log(result); // SUCCESS\r\n```\r\nI'm wondering why we're using ```Auth.currentAuthenticatedUser()``` to update user attributes? what if there's a new user ```user2``` who just logs in while we're in process of updating user ```user1``` attributes. so the ```Auth.currentAuthenticatedUser()``` will now points to the user ```user2``` who just logs in and we end up updating new user attributes(```user2```) instead of ours? (```user1```).  isn't that a big issue or am I missing anything here?\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNzA4NDQ0","author":{"login":"0x54321"},"title":"AmplifySignIn component - setting value","body":"The `formFields` property on the `<AmplifySignIn>` component [seems to allow](https://github.com/aws-amplify/amplify-js/tree/main/packages/amplify-ui-components/src/components/amplify-form-field#properties) for controlling the value of the inputs, like so:\r\n\r\n```\r\n     <AmplifySignIn\r\n          slot=\"sign-in\"\r\n          formFields={[\r\n            {\r\n              type: \"text\",\r\n              label: \"Username\",\r\n              value: usr,\r\n              handleInputChange: (e) => setUsr(e.target.value),\r\n            },\r\n            {\r\n              type: \"password\",\r\n              label: \"Password\",\r\n              value: pwd,\r\n              handleInputChange: (e) => setPwd(e.target.value),\r\n            },\r\n          ]}\r\n        />\r\n```\r\n\r\nHowever, this doesn't actually work. It throws `Cannot read property 'bind' of undefined`, in the function `handleFormFieldInputWithCallback`. Am I missing something?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMjA4NjMx","author":{"login":"malcomm"},"title":"Angular Amplify Error Handler - GraphQL API Calls","body":"I am using a \"global error handler\" per: [ErrorHandler](https://angular.io/api/core/ErrorHandler) and it is trapping the errors for calls made the APIService. The problem: the error that is being received by this:\r\n\r\n```\r\nhandleError(error: any): void {\r\n}\r\n```\r\n\r\nEnds up being an object, which looks like this:\r\n\r\n```\r\nError: Uncaught (in promise): Object: {\"data\": .... },\"errors\":[{\"path\":[\"listPractitioners\",\"items\",35,\"sites\"],\"data\":null,\"errorType\":\"DynamoDB:ApiCallTimeoutException\",\"errorInfo\":null,\"locations\":[{\"line\":8,\"column\":7,\"sourceName\":null}],\"message\":\"Client execution did not complete before the specified timeout configuration: 10000 millis\"}]}\r\n    at resolvePromise (https://www.foobar.com/polyfills.js:1044:23)\r\n    at https://www.foobar.com/polyfills.js:935:11\r\n    at rejected (https://www.foobar.com/vendor.js:373291:89)\r\n    at ZoneDelegate.invoke (https://www.foobar.com/polyfills.js:461:160)\r\n    at Object.onInvoke (https://www.foobar.com/vendor.js:300569:25)\r\n    at ZoneDelegate.invoke (https://www.foobar.com/polyfills.js:461:48)\r\n    at Zone.run (https://www.foobar.com/polyfills.js:187:37)\r\n    at https://www.foobar.com/polyfills.js:1112:28\r\n    at ZoneDelegate.invokeTask (https://www.foobar.com/polyfills.js:494:173)\r\n    at Object.onInvokeTask (https://www.foobar.com/vendor.js:300557:25)\r\n```\r\n\r\nIf I put a try/catch around the APIService call, then I get `GraphQLResult` as the error:\r\n\r\n```\r\n    try {\r\n      const result = await this.apiService.ListSomething();\r\n    } catch (error) {\r\n      // error here is a GraphQLResult { \"data\": ... }, \"errors\": []\r\n      this.errorService.graphqlResult = error;\r\n      throw error;\r\n    }\r\n```\r\n\r\nWithout the try/catch, my global error handler gets a wrapped `GraphQLResult` object with stack trace and an error message. I'm trying to avoid having to put a try/catch all over my code and still get the `GraphQLResult`. The above try/catch is the best workaround I've found so far.\r\n\r\nAnother workaround: parse out the `GraphQLResult` from error object in the error handler ... this is less than ideal and seems backwards.\r\n\r\n1. So in general, what's the best practice here?\r\n2. Is there another way to still have the global error handler, but get the actual error object?\r\n\r\nThank you!","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"malcomm"},"body":"So this might have been super obvious to other folks out there but it wasn't for me. You can get at the original `GraphQLResult` by looking at the `error.promise` and `error.rejection`. So in your handleError method:\r\n\r\n```\r\n  isGraphQLResult(rejection: any): boolean {\r\n    return rejection !== undefined && (rejection.data !== undefined || rejection.errors !== undefined);\r\n  }\r\n\r\n  handleError(error: any): void {\r\n\r\n    if (error !== undefined && this.isGraphQLResult(error.rejection)) {\r\n      const graphqlResult: GraphQLResult = error.rejection as GraphQLResult;\r\n      // handle the graphqlResult\r\n    }\r\n  }\r\n```\r\n\r\nHonestly didn't know that `error.promise` and `error.rejection` were even there ... I guess I missed the memo on that one."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNjI4NzU0","author":{"login":"emilyDZC"},"title":"Override AmplifyAuthenticator components","body":"I'm using the AmplifyAuthenticator from `@aws-amplify/ui-react`, and I'm trying to replace the ConfirmSignUp component with our own custom component. \r\n\r\nThis worked well in react-native (using the Authenticator from `aws-amplify-react-native`) by using the 'override' feature, eg. `<CustomConfirmSignUp override='ConfirmSignUp' />`. \r\n\r\nHowever, this feature doesn't seem to exist in the react-ui AmplifyAuthenticator. \r\n\r\nDoes anyone have any suggestions?","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNjEwMTM2","author":{"login":"hmisonne"},"title":"Analytics: Can I export Cognito User Pool email addresses to AWS Pinpoint?","body":"Hello, I am using Amplify Analytics and I would like to send a survey to my users! \r\nSince I am also using Cognito, is there a way to export email addresses to Pinpoint to create a campaign?\r\n\r\nI already tried to \"add analytics and user campaigns to this user pool\" on the Cognito Analytics tab with \"share user profile data\" but it did not work.\r\nThank you for your help 🙏","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNTc5NjU4","author":{"login":"bjm88"},"title":"Amplify custom UI - how to use Auth JWT for api calls to GraphQL, Rest, or DataStore??","body":"I am using Amplify frontend and backend, but with custom UI for Auth flows.  The React/JS libraries have nice Auth.signIn, .signUp, etc simple calls to make and can hook those up in my custom react UI pages.\r\n\r\nAlso the Amplify API.GraphQL, API.Rest, and Datastore.save all seem very nice.  The gap seems to be connecting both, the documentation seems to think authentication is just taken care of somewhere else or assuming you are using the \"withAuthenticator\" wrapper, which would be nice to use except very hard to customize fully.  Without using \"withAuthenticator\" higher order component or wrapper, HOW DO WE GET AN ACCESS TOKEN FROM Auth. and pass it to the API layers??????\r\n\r\nAssuming something like this would exist:\r\n\r\nDataStore.configureAuthHeaderPreflight = () => (await Auth.currentSession()).getIdToken().getJwtToken())\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNTc0MTU5","author":{"login":"elchicofrommo"},"title":"Encoding customState for OAUTH redirect","body":"Hello, I've got my system set up so I can transfer my auth session between one device an another using the Access Token, id Token constructing a redirect that piggy backs off the same oauth redirect that I use for social log in. The problem I have is when I updated my library I lost the ability to programmatically set the state attribute ... I guess Amplify prepends some typechecked value to the beginning of the custom state that I can't seem to replicate on my own. So when I'm listening to the hub for custom state it always comes across as junk. Can anyone tell me what I need to prepend to get this field processes in the normal manner and generate good data in the hub?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNTUxMjIx","author":{"login":"myfairshare"},"title":"Integrate Amplify React app in a wordpress site","body":"Hello,\r\n\r\n   Could anyone suggest if this is possible, I have a wordpress site/blog and would like to integrate my amplify app into that site, can that be done, thank you.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNTM4MjI3","author":{"login":"andy2sey"},"title":"How To Use Fedarated Authentication Using Custom Provider","body":"Hello,\r\n\r\nI am using AWS Amplify and I would like to federate my user login through a specific provider (not one of the currently supported).   I am struggling to find clear documentation on how to accomplish this and I hoping someone can point me in the right direction.  This is ultimately a React Native application using Expo.  I am able to retrieve an access token from my provider using Expo's AuthSession.\r\n\r\nMy Questions Are:\r\n\r\n1. Is this the correct way to go about this with Amplify?  Should I get the token first and then pass this into Amplify's Auth?\r\n2. Can I pass my provider's authorization URL endpoint into Amplify instead and have the Amplify handle it?\r\n3. Is there a better way to do this?\r\n\r\nHappy to clarify any questions, I am new to Amplify and still learning terminology.  ","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNTI5MDc0","author":{"login":"myfairshare"},"title":"Handling Caching in my Amplify app","body":"Hello,\r\n\r\n     I am currently creating an app with amplify and DataStore, caching is an area I'm not very strong in.  \r\n\r\nI have two different types of users in the app, I have signed myself up as one of each with two different email accounts.  When I sign out and sign in I need to do a hard refresh otherwise stale data is picked up.\r\n\r\nI have tried DataStore.clear() on signout but that doesnt help.  If anyone could point me in the right direction that would be great, thank you.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMjUyMzY5","author":{"login":"funawo"},"title":"What you can do with your client ID","body":"I want to know what you can do with a client ID in an app that uses Amplify.\r\nI think I can operate my own user stored in the user pool, but I am wondering if I can operate a third party user","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb241OTkwNA==","author":{"login":"Xumeiquer"},"title":"Are cognito client apps potentially hackable?","body":"Hi there, I am starting with Amplify and Cognito and I having some questions about the security of my application.\r\n\r\nMy use case is (at the moment) a webapp (without server side) used only for signing up users. As this application only runs on client-side any kind of key is public, which is also mentioned in the AWS documentation and I am also agreed with that. On the other hand, Amplify `Auth` section gets configured with *region*, *identity pool region*, *user pool id*, and *user pool web client id*. Remember all public information, there is no server side and the application is fully running on client-side.\r\n\r\nAs my application is only used for signing up user I do not configure oauth2, which is also not required based on the Amplify documentation.\r\n\r\nMy concern is, how can I avoid anyone to take my public _keys_ and use them on another application or using a malicious use of them, like signing up thousands of users? Perhaps, should I user lambda for doing the sign up?\r\n\r\n Thank you.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"gmreburn"},"body":"A lambda function can work but I suggest deploying an API Gateway and route your application's communication to API Gateway instead of AppSync. API Gateway can forward the request with the API Key configured in AppSync (keep that API key private). API Gateway supports WAFs, AWS Shield, usage plans, and custom authorizers."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb241NTM4NTM=","author":{"login":"marcelkipp"},"title":"Angular-Testing: Cannot read property 'aws_appsync_region' of null","body":"We are using Ionic/Angular for our app. We want to use the angular integrated testing but facing the following error:\r\n\r\n`TypeError: Cannot read property 'aws_appsync_region' of null`\r\n\r\nDid somebody faced that issue before or is running angular testing with angular and amplify js and has some advise?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb244NDAyNw==","author":{"login":"ammarasmro"},"title":"Getting 403 with Amplify’s API even though I’m signed in","body":"Considering that I have included all the required portions to set a project up until running `Amplify.configure(....)` portion including\r\n- Installing `aws-amplify` and `@aws-amplify/ui-vue`\r\n- `const { Amplify, Auth, API } = require('aws-amplify')`\r\n- Setting up Lambda functions - UserPool with a test user, Identity Pool with permissions for API gateway\r\n- Setup permissions for API gateway to use the userpool as the authorizer\r\n\r\nWhen I run `Auth.signIn('email@domain.com', 'password')`. It is succeeding. When I take the retrieved access token and test it in the Cognito authorizer tester, it is succeeding. When I run `API.get('apiname', '/api/path/requiring/authentication')` It is failing. Sometimes with 403 and others with 401 codes. Am I missing something? Do I need to explicitly provide auth headers?\r\n\r\nFYI\r\nIf I remove the auth requirement in API gateway on the same paths, API.get... is working so the issue seems to be with the Auth parts","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb244MjA3MQ==","author":{"login":"hmisonne"},"title":"How can I improve app loading experience with Hub.listen() and React Hooks?","body":"I am currently using a splashscreen to delay the rendering of my app while waiting for the async calls to complete.\r\n\r\n```javascript\r\nconst App = () => {\r\n  const [isAppReady, setAppReady] = React.useState(false);\r\n  \r\n  if (!isAppReady) {\r\n    return (\r\n      <AppLoading\r\n        startAsync={_cacheResourcesAsync}\r\n        onFinish={()=>setAppReady(true)}\r\n        onError={console.warn}\r\n    />\r\n    )\r\n  return (\r\n   ...\r\n  )\r\n  }\r\n\r\n async function _cacheResourcesAsync() {\r\n  \r\n  const fonts = await Font.loadAsync({\r\n    ...MaterialCommunityIcons.font,\r\n  });\r\n\r\n  return fonts;\r\n}\r\n```\r\n\r\n***startAsync** (function) is A function that returns a Promise, and the Promise should resolve when the app is done loading required data and assets.*\r\n\r\nIt works well for loading fonts. However I was not able to use it with datastore sync.\r\n\r\nI would ideally like for the datastore to be ready before rendering the app using **Hub.listen()**:\r\n\r\n```javascript\r\nasync function loadDataStore() {\r\n      try {\r\n        await DataStore.start();\r\n      } catch (e) {\r\n        console.warn(e);\r\n      } finally {\r\n        const removeListener = Hub.listen(\"datastore\", async (data) => {\r\n          const { payload } = data;\r\n          if (payload.event === \"ready\") {\r\n            removeListener();\r\n            return Promise(true)\r\n          }\r\n        });        \r\n      }\r\n    }\r\n```\r\n\r\nHowever if I use loadDataStore function in the **startAsync** parameter, it does not wait for the datastore to be ready\r\n```javascript\r\nreturn (\r\n      <AppLoading\r\n        startAsync={loadDataStore}\r\n        onFinish={()=>setAppReady(true)}\r\n        onError={console.warn}\r\n    />\r\n    )\r\n```\r\n\r\nIs there a way to return a Promise only when the DataStore is ready?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb244MDMyMA==","author":{"login":"funawo"},"title":"Clientid of Cognito","body":"Quoted from a forum article.\r\nIf you know the content of the article, please tell me\r\n\r\nhttps://forums.aws.amazon.com/thread.jspa?messageID=889721\r\n>I have a javascript application integrated with cognito, using javascript SDK. The SDK requires user pool Id and Client Id, to connect with congnito. Everything works fine, no issues.\r\n\r\n>My concern is that, should I hide these client-id and userpool-id from javascript code, so that the users wont be able to see from the sources (in the browser). or these public information ?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb243OTYzMQ==","author":{"login":"mpcooke3"},"title":"Upgrading Authenticator to AmplifyAuthenticator","body":"In react with the older <Authenticator> component I was able to prevent the initial sign-in dialog coming up immediately like this:\r\n<Authenticator hideDefault={'true'} authState={'none'}>\r\n\r\nAnd then trigger it later with:\r\nonStateChange('signIn',{}) \r\n\r\nIs there an equivalent or any alternative way to trigger the SignIn component manually using AmplifyAuthenticator?\r\n\r\n","upvoteCount":3,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMTM4","author":{"login":"Albert-Gao"},"title":"Storage module for a multi-tenant application","body":"There is 3 access levels listed on this page: https://docs.amplify.aws/lib/storage/configureaccess/q/platform/js\r\n\r\n- Public: Accessible by all users of your app. Files are stored under the public/ path in your S3 bucket.\r\n- Protected: Readable by all users, but writable only by the creating user. Files are stored under protected/{user_identity_id}/ where the user_identity_id corresponds to the unique Amazon Cognito Identity ID for that user.\r\n- Private: Only accessible for the individual user. Files are stored under private/{user_identity_id}/ where the user_identity_id corresponds to the unique Amazon Cognito Identity ID for that user.\r\n\r\nHowever, none of them are adding constraints to a group of people.\r\n\r\nIs there an Amplify way to upload files to S3 with access control only to a group of people?\r\n\r\n","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb243ODQzOQ==","author":{"login":"amirmishani"},"title":"Datastore Relational models with combo keys and Id naming convention","body":"I'm new to Datastore and while designing my schema, I was looking at [relational models docs](https://docs.amplify.aws/lib/datastore/relational/q/platform/js) and came across the following:\r\n\r\n> When using the `@key` directive with DataStore, as long as you specify a `name` you can use any value(s) in `fields`. However, if the `name` property is omitted, the first item in the `fields` array must be `\"id\"`. E.g., `@key(fields: [\"id\", \"content\"])`.\r\n\r\nMy schema is for a multi-tenant setup requires a hash-sort combo key with the tenantId being the hash and looks something like this:\r\n\r\n```graphql\r\ntype Tenant @model {\r\n   id: ID!\r\n   # ... more fields\r\n}\r\n\r\ntype User @model @key(fields: [\"tenantId\", \"id\"] {\r\n   tenantId: ID!\r\n   id: ID!\r\n   # ... more fields\r\n}\r\n```\r\n\r\nUsing the above model each tenant can only list items based on matching `tenantId` hash key and therefore all the sort `id`'s become a uniqueId in the client cache.  \r\n\r\nSo my question is that is it just about the `name` of the field being `id`  or does the docs mean that the unique id must always be the hash field? I guess I'm asking whether renaming the uniqueId to `userId` and renaming the `tenantId` to `id` and changing the schema to looks like the following would work:\r\n\r\n```graphql\r\n\r\ntype User @model @key(fields: [\"id\", \"userId\"] {\r\n   id: ID!\r\n   userId: ID!\r\n   # ... more fields\r\n}\r\n```\r\nOr is there something deeper involved? For example I know in Apollo if you change the uniqueId field name to something other than `\"id\"` can mess with your cache so you would need to specifically tell Apollo to replace `id` with `userId` using `dataIdFromObject` in your client configuration.\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb243NTMxOQ==","author":{"login":"giorgiocarniel"},"title":"Max S3 Signed URL length","body":"Hi everyone,\r\n\r\nwe are using a Lambda to generate a signed URL to get a file from an s3 Bucket.\r\nI'm wondering if there is a maximum length of the generated URL.\r\n\r\nBy doing some tests I see it is around 1220 characters, but It changes from a call to another.\r\n\r\nDoes anyone know the max length of that URL?\r\n\r\nThanks!","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb243NTA3NA==","author":{"login":"ViepleJimJames"},"title":"I18n - Default Vocabulary","body":"Hey, I am successfully initialising and using I18n in my angular project. The problem I'm having is if I am not supporting a language in my custom vocabulary, how do I have the browser default to one of the supported ones?\r\n\r\nThanks in advanced, I couldn't find anyone else discussing this sort of issue here.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb243NDQzMA==","author":null,"title":"Is It possible to receive notifications with debug mode?","body":"My app gets notifications when I use Ad Hoc. But using Ad Hoc is impossible to debug. Did someone being able to receive notifications using debug mode ? Is it possible?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMTY2NA==","author":{"login":"stayingcool"},"title":"AppSync List API - Database returned more than the allowed response size limit","body":"**Issue:**\r\nAppSync List API throws this error and returns a null response:\r\n\r\n> \"error\": {\r\n>             \"message\": \"RDSHttp:{\\\"message\\\":\\\"Database returned more than the allowed response size limit\\\"}\",\r\n>             \"type\": \"400 Bad Request\"\r\n>         },\r\n\r\nI understand that there is a 1 MB response limit, hence the above error is thrown.\r\n\r\n**My requirement** is to be able to **run a report** to pull all the records within a month. My resolver has a simple select statement with a where clause on the date column to filter records for that period. \r\nI cannot place a limit clause in the select statement as there is already a filter (where clause) to reduce the number of items returned.\r\n\r\n**My Environment:**\r\n\"react\": \"^16.12.0\",\r\nAmplify CLI version:  4.25.0\r\n\"aws-amplify\": \"^3.3.4\"\r\namplify-serverless using Aurora MySQL (default.aurora5.6)\r\n\r\n**What can we do to meet the requirement?**\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"stayingcool"},"body":"Is there anyone who can provide some guidance? This seems to be a show stopper for me to proceed with AppSync."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb243MDEzNw==","author":{"login":"maximelebastard"},"title":"What is the best way to handle different clients versions ?","body":"Hi !\r\n\r\nI'm adding a mobile app to my existing amplify API and web app.\r\nAs some of you may know, the issue with mobile app is updates. We can have a few days, weeks or even months where a previous version of the app will still request the API.\r\n\r\nThis is an issue when deleting a GraphQL field, renaming one or adding a new mandatory field.\r\n\r\nDo you guys already deal with that ? Do you have some advices ?\r\n\r\nThanks","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb242MjcwNQ==","author":{"login":"SZubarev"},"title":"Amplify authentication without Cognito","body":"Hi,\r\n\r\nCan Amplify's authentication be used with other OpenID identity providers without Cognito? We are building an app for a AWS region where Cognito is not available, can we still use Amplify authentication mechanism?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb242MjU0OQ==","author":{"login":"fabianjj"},"title":"Is there a way to do user-defined groups and secure with @auth?","body":"I'm writing an application with public sign-up where users need to be able to collaborate in user-defined groups\r\nThere should be space for a lot of groups. I.E. I want to be able to scale to 10 million groups, I won't have 10 million groups, but if there's a limit of ~50 groups, then it's not really the right mechanism for my use case.\r\n\r\nThese groups will be created by and managed by the users. E.g. any user can invite any other user to any group that they themselves are a member of, and any member of a group can see and edit the group's content (except for some content that can be viewed by group members but only edited by the content's owner). If you are not a member of a given group, you can neither see not edit the content associated with that group.\r\n\r\nIn order to enforce the security of the data in this model, I was looking at using the @auth directive somehow to make sure that no object could be CRUDLed without the proper authorization. \r\n\r\nBut from what I can tell, it looks like Cognito User Groups is the only method to enforce that, and Cognito User Groups doesn't seem to be designed for that purpose. The administration in examples seems to be more oriented towards internal corporate applications where I might have a small set of predefined user groups (\"Writers\", \"Editors\"), and a special case for the one individual owner for each object.\r\n\r\nI don't mind going a little bit beyond the most basic implementations, I can have a look at lambda triggers, custom resolvers, the aws-api, etc., if that helps. But I don't want to go to far into this implementation if it's likely that I run into roadblocks or try to use the system in ways that will cause it to fight back, or if I have to do a lot of workarounds at every step.\r\n\r\nIs there a way to implement user-defined user groups the way I want in order to secure access to the data? Have I missed something fundamental about how this works?\r\nOr am I thinking about this the wrong way? Should I be separating this on some other way? Is there a different way in which I should thinking about? Or Is the Amplify back-end not really meant for this use case? \r\n\r\nMy ideal implementation would be a simple type in the graphql schema that could contain a list of unique user identifiers, editable by any user whose identifier is part of the list, and a way to attach a reference to that object to the authrules of an object to ensure only the right users have access.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb242MTk5Mg==","author":{"login":"march08"},"title":"Forget Device doesn't invalidate refresh token?","body":"Hey guys, I am using `CognitoUser.forgetSpecificDevice`, this will successfully remove the device from the `forgetSpecificDevice.listDevices` but doesn't invalidate the refresh token and still allows actions on the forgotten device. Is this expected behaviour? How should I invalidate the refresh token on the forgotten device? Thank you","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb242MDcwMg==","author":{"login":"karrettgelley"},"title":"Calling AppSync from Lambda","body":"I've been trying to call AppSync from a lambda function (both created using the aws-amplify cli), but I can't find any documentation that are both up to date and complete. For instance, I came across an article about [building a client app using aws-mobile-appsync-sdk](https://docs.aws.amazon.com/appsync/latest/devguide/building-a-client-app-node.html), but that library hasn't been touched in 5mo and seems like overkill in a nodejs environment. So, does anybody know if there is a standard or recommended way of calling AppSync from a lambda function? Any help is appreciated","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb241Njk5OQ==","author":{"login":"mansdahlstrom1"},"title":"Polymorphism + GraphQL via AWS Amplify","body":"Hello, I'm wondering about polymorphism + GraphQL via AWS Amplify\r\n\r\nIn it's simplest form, i would want to be able get an \"Event\"  and based on the enum in the event called \"type\" i want to only get data from another @model, see my psuedo code bellow. \r\n\r\n```\r\n\r\nenum EVENT_TYPES {\r\n  CUSTOM_EVENT_1\r\n  CUSTOM_EVENT_2\r\n  CUSTOM_EVENT_3\r\n  CUSTOM_EVENT_4\r\n}\r\n\r\n@model\r\ntype CustomEvent1\r\n{\r\n  id: ID!,\r\n  ...some more data\r\n}\r\n@model\r\ntype CustomEvent2\r\n{\r\n  id: ID!,\r\n  ...some more data\r\n}\r\n\r\nunion PolymorphedModel = CustomEvent1 | CustomEvent2\r\n\r\n@model\r\ntype Event\r\n{\r\n  id: ID!,\r\n  eventId: ID!,\r\n  type: EVENT_TYPES!,\r\n\r\n  eventData: PolymorphedModel @connection(fields: [\"eventId\"])\r\n}\r\n```\r\n\r\nIs this possible with AWS Amplify? I havn't been able to find anything regarding polymorphism and aws amplify so far and my backup solution currently is something like this https://github.com/aws-amplify/amplify-cli/issues/5152 . But support for this is currently in a PR here https://github.com/aws-amplify/amplify-cli/pull/5153\r\n\r\nThanks!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb241NTUzNA==","author":{"login":"nschneider-sommset"},"title":"Cant get UserAttributes from a cognito user.","body":"In my code Im unable to get userAttributes from a user who has signed in with google.\r\n```\r\n  const cognitoUser = await Auth.currentAuthenticatedUser()\r\n  await cognitoUser.getUserAttributes((data) => {\r\n      console.log({ data })\r\n  });\r\n```\r\nthe data being logged is:\r\ncode: \"NotAuthorizedException\"\r\nmessage: \"Access Token does not have required scopes\"\r\nname: \"NotAuthorizedException\"\r\n\r\nI have enabled read/write permissions for all attributes.\r\nAny idea of what I could be missing?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb240MDE5OQ==","author":{"login":"rlaphoenix"},"title":"How do I get a list of remembered devices?","body":"What would be the amplify alternative to `cognitoUser.listDevices(10, null, callbacks)`?\r\n\r\nI cannot find anything related to it.","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zOTg2Nw==","author":{"login":"yaquawa"},"title":"what happens when use `@auth` without the `operations` argument?","body":"I saw a lots of examples in the doc which omit the `operations`, for example:\r\n\r\n```gql\r\n# The simplest case\r\ntype Post @model @auth(rules: [{ allow: owner }]) {\r\n  id: ID!\r\n  title: String!\r\n}\r\n\r\n# The long form way\r\ntype Post\r\n  @model\r\n  @auth(\r\n    rules: [\r\n      { allow: owner, ownerField: \"owner\", operations: [create, update, delete, read] },\r\n    ])\r\n{\r\n  id: ID!\r\n  title: String!\r\n  owner: String\r\n}\r\n```\r\ndoes this mean if omit the `operations` argument, the default value is going to be `[create, update, delete, read]` ? even if the `allow` was not set to `owner` for example `public`\r\n\r\n```gql\r\n# The simplest case\r\ntype Post @model @auth(rules: [{ allow: public }]) {\r\n  id: ID!\r\n  title: String!\r\n}\r\n```\r\nDoes the above mean:  ?\r\n```gql\r\ntype Post\r\n  @model\r\n  @auth(\r\n    rules: [\r\n      { allow: public, ownerField: \"owner\", operations: [create, update, delete, read] },\r\n    ])\r\n{\r\n  id: ID!\r\n  title: String!\r\n  owner: String\r\n}\r\n```","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zOTg1Ng==","author":{"login":"icecog"},"title":"How do I use Cognito Hosted UI with Amplify?","body":"I feel like I'm trying to do something quite straight forward, but I'm not able to figure it out.\r\nSomeone please help me.\r\n\r\nI'm using AWS Amplify with Svelte. I do not want to develop and maintain my own login flows and so I thought I'd just use the Hosted UI. Simple enough.\r\n\r\nI've configured the Redirects in Cognito User Pool App Clients and I'm getting the callback with response_type=code or response_type=token.\r\n\r\nHow do I get Amplify to grab the credentials for the logged in user?\r\n\r\nI have configured Amplify with my Cognito user pool and identity pool already, and can use Auth.SignIn(...). But I don't want to build the UI myself.\r\n\r\nI've spent the better part of 20h on this and feel like mush.\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"icecog"},"body":"Well, I guess I'm just stupid.\r\n\r\nI had never actually updated / refreshed my 'Amplify import Auth' after configuring the domain and redirect uri's of the Cognito User Pool.\r\n\r\nAs soon as I did that I got the '\"oauth\": {' section of my aws-export.js file filled in and then it magically worked.\r\n\r\nOnce again, I feel like the Amplify documentation fucks with you by omitting details of what it uses to create its magic."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zOTUwNg==","author":{"login":"amlcodes"},"title":"API security for public reads and cognito groups","body":"via CLI - if I allow unauthenticated access, as well as configuring IAM as an additional auth type and then configure my schema around public reads and cognito group access - do I have to programmatically fetch data with and without using         authMode: 'AWS_IAM' in API.graphql() based on Auth.currentCredentials() ? If I were to use DataStore instead, How would would I specify using IAM authmode for public users? ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zOTU2MA==","author":{"login":"shweta-codeprism"},"title":"FormData and Amplify Rest API","body":"How are we supposed to send formData over Amplify Rest Api ? \r\n` const formData = new FormData();\r\n  const init= {\r\n    body: formData,\r\n    headers: {\r\n        Accept: \"application/json\"\r\n    }\r\n  };\r\nAPI.post('api', 'path', init);  // *API gateway binary type updated\r\n`\r\nis allowing us to send the data, but ends up receiving status 0 over xhr call\r\n@tom-rb , I have taken your fix, but I seem to be doing something wrong :(","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zOTU1Mw==","author":{"login":"JPilawka"},"title":"Errors using in-app-browser in React Native","body":"**Describe the bug**\r\nWe have a problem with in-app-browser configuration of amplify authorization in react native (0.61).\r\nWe use the same in-app-browser which is recommended in docs.amplify, react-native-inappbrowser-reborn. The plugin on it’s own works fine, both standard .open() and .openAuth() functions. Also authorization with an outside-app browser works fine.\r\nBut when we try to connect in-app browser according to documentation: \"Social sign-in (OAuth)\" the  browser doesn’t start, we get error: „TypeError: Cannot read property 'oauthSignIn' of undefined”\r\nThe only changes we made in code apply only to Amplify.configure() object:\r\nAmplify.configure({\r\n  …CONFIG,\r\n  oauth: {\r\n    ...CONFIG.oauth,\r\n    urlOpener,\r\n  },\r\n});\r\n\r\nWe have a custom CONFIG, not generated by CLI, below you can find the CONFIG object. \r\nCONFIG: {\r\n  Auth: {\r\n    region: 'eu-central-1',\r\n    userPoolId: 'eu-central-1_XXXXXXXXX’,\r\n    userPoolWebClientId: ‚XXXXXXXXXXXXXXXXXX’,\r\n    oauth: {\r\n      domain: ‚XXXXXXXXXXXXXX.auth.eu-central-1.amazoncognito.com',\r\n      scope: ['email', 'openid'],\r\n      redirectSignIn: 'app-name://signIn',\r\n      redirectSignOut: 'app-name://signOut',\r\n      clientId: ‚XXXXXXXXXXXXXXXXXX’,\r\n      responseType: 'code',\r\n      urlOpener: null,\r\n    },\r\n  },\r\n},\r\n\r\nThe urlOpener property was added after the error occurred but it didn’t change anything.\r\n\r\nWe also tried to use it with HOC withOAuth but IDE (WebStorm) can’t recognize any of the methods from aws-amplify-react-native, warning: „Cannot resolve symbol 'withOAuth' „.\r\nImporting of methods is done exactly as it is in documentation: with destructuring.\r\nYet we get an error: „TypeError: Cannot read property 'urlOpener' of undefined”.\r\nWe tried to find the solution but none works.\r\n\r\n**Plugins versions**\r\n\"amazon-cognito-identity-js\": \"^4.5.4\",\r\n\"aws-amplify\": \"^3.3.8\",\r\n\"aws-amplify-react-native\": „^4.2.9\",\r\n\r\nNewest aws-amplify 3.3.11 version gives us error with aws-sdk as it cannot see ./configure in it’s node_modules folder\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zODk3OQ==","author":{"login":"karol-szymanowski"},"title":"Using yarn instead of npm to install function's dependencies","body":"In my project, we use yarn and yarn workspaces to manage all dependencies, and I noticed that every time functions are deployed or mocked, the package-lock.json file is generated. Is there a way to set yarn as the default tool or ideally disable installing dependencies step?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yOTI2MA==","author":{"login":"syang"},"title":"Can amplify.js lib use Cognito Identity Pool (CIP) without Cognito User Pool (CUP)?","body":"I am using amplify js library to build my front-end. \r\n\r\nI am trying to build the authentication mechanism with \r\n\r\n- Facebook as social login\r\n- Cognito Identity Pool as AWS temp credential provider\r\n\r\nThere is an aws-sdk base tutorial here https://medium.com/@trannotes/serverless-with-aws-cognito-facebook-login-integration-3a5751a89a58\r\n\r\nBut my question is can I use amplify to achieve the above architecture (i.e., I don't want to use Cognito User Pool in my stack)?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"amhinson"},"body":"Identity Pool federation is possible with Amplify. There is also a Facebook example for React in the docs. Is this what you're looking for?\r\n\r\nhttps://docs.amplify.aws/lib/auth/advanced/q/platform/js#identity-pool-federation"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zODU1MQ==","author":{"login":"mansdahlstrom1"},"title":"CI / CD For Native apps","body":"Hi!\r\n\r\nWe have been developing a React Native app for some time now and we are using AWS Amplify for this. So far everything is working okay and seems to be working fine, we are quickly approaching our first release and i have some concerns regarding CI & CD with AWS Amplify for React Native. Currently i'm having a hard time finding resources regarding how to automate the Deployment step for mobile.\r\n\r\nI will explain in some more detail:\r\n\r\nI want to use fastlane for automated app store / google play deployment for the react native app. But we are also in need of deploying the Amplify resources at the same time. There is little to nothing in the Amplify documentation that shows examples of how to integrate CI / CD for Native apps, all examples seems to be for web applications.\r\n\r\nThe issue here is that whenever we deploy a new version of the app and the Amplify environment the user must update the app from App Store/Play Store manually to be able to have a functioning app. This since my understanding is that the Amplify ENV is overwritten when i will deploy a new version on AWS amplify. This has the effect of invalidating the version of the app that is already downloaded for the user.\r\n\r\n• How is deployment of AWS Amplify powered Native app supposed to work?\r\n• Is it posible to use versioning of the cloudformation resources that are deployed? So that we can support older version of the app giving the users some time / headroom to update?\r\n• How is it recommended to handle breaking changes to the Amplify API / DB in a production senario?\r\n\r\nIs this a flaw in the design of AWS Amplify or am I missing something?\r\n\r\nDoes any here have experience with a production React Native app running on AWS Amplify?\r\n\r\nThank in advance\r\n/ M ","upvoteCount":5,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zODUxMQ==","author":{"login":"allssu"},"title":"What if someone is hosting with my Amplify.configure settings?","body":"Hello. I'm making stuff with amplify. I am not using the amplify CLI, and I am connecting Cognito, Appsync, and DynamoDB using CDK.\r\n**I have a question while using Amplify.configure.** \r\nIf someone works on a Frontend site using my Amplify.configure, will it be authenticated? If so, how can I add authorization for this? Even if you add authentication that only one user can access, **it will be a problem if someone makes the sign-up and login screens the same.**\r\nWhat do you think about this problem? Even if you search for keywords like Configure, it only talks about SRP and Oauth. I want to talk about essential AuthZ. Like it's controlled by the Security Group.\r\nI want to hear an easy explanation for me! I love you~ :)","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zODIyNw==","author":{"login":"masapasa"},"title":"Module not found '../aws-exports'","body":"Module not found: Can't resolve '../aws-exports' in '/codebuild/output/src240068493/src/nnews/next/pages'\r\nbuild:\r\ncommands:\r\n- echo Amplify build...\r\n- amplifyPush --simple\r\nWhile deploying through the console with an ECR image","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zODAxNQ==","author":{"login":"iamsteveng"},"title":"Generate graphql documentation","body":"Hi there, I found that all the `description` fields in the schema.json are all `null`.  This makes graphql documentation generator not possible to have meaningful descriptions for all APIs. Any way to input `description` for each mutation at least?","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNzY2MQ==","author":{"login":"skulljoi"},"title":"Problem build ui-components","body":"I am trying to build: `yarn build --scope @aws-amplify/ui-components` but an error is occuring:\r\n\r\n> @aws-amplify/ui-components: [ ERROR ]  sass error: src/components/amplify-chatbot/amplify-chatbot.scss:1:1\r\n@aws-amplify/ui-components:            Can't find stylesheet to import.\r\n@aws-amplify/ui-components:       L1:  /**\r\n@aws-amplify/ui-components:       L2:   * @prop --width: Width of the container\r\n@aws-amplify/ui-components: [ ERROR ]  sass error: src/components/amplify-authenticator/amplify-authenticator.scss:1:1\r\n@aws-amplify/ui-components:            Can't find stylesheet to import.\r\n@aws-amplify/ui-components:       L1:  /**\r\n@aws-amplify/ui-components:       L2:   * @prop --background-color: Background color of the container\r\n@aws-amplify/ui-components: [ ERROR ]  sass error: src/components/amplify-greetings/amplify-greetings.scss:1:1\r\n@aws-amplify/ui-components:            Can't find stylesheet to import.\r\n@aws-amplify/ui-components:       L1:  /**\r\n@aws-amplify/ui-components:       L2:   * @prop --background-color: Background color of the container\r\n@aws-amplify/ui-components: [ ERROR ]  sass error: src/components/amplify-photo-picker/amplify-photo-picker.scss:1:1\r\n@aws-amplify/ui-components:            Can't find stylesheet to import.\r\n@aws-amplify/ui-components:       L1:  :host {\r\n@aws-amplify/ui-components:       L2:    --object-fit: cover;\r\n@aws-amplify/ui-components: [ ERROR ]  sass error: src/components/amplify-nav/amplify-nav.scss:1:1\r\n@aws-amplify/ui-components:            Can't find stylesheet to import.\r\n@aws-amplify/ui-components:       L1:  .nav {\r\n@aws-amplify/ui-components:       L2:    display: flex;\r\n@aws-amplify/ui-components: [ ERROR ]  sass error: src/components/amplify-s3-text/amplify-s3-text.scss:1:1\r\n@aws-amplify/ui-components:            Can't find stylesheet to import.\r\n@aws-amplify/ui-components:       L1:  /**\r\n@aws-amplify/ui-components:       L2:   * @prop --container-color: Background color of the text container\r\n@aws-amplify/ui-components: [ ERROR ]  sass error: src/components/amplify-totp-setup/amplify-totp-setup.scss:1:1\r\n@aws-amplify/ui-components:            Can't find stylesheet to import.\r\n@aws-amplify/ui-components:       L1:  .totp-setup {\r\n@aws-amplify/ui-components:       L2:    text-align: center;\r\n@aws-amplify/ui-components: [ ERROR ]  sass error: src/components/amplify-auth-fields/amplify-auth-fields.scss:1:1\r\n@aws-amplify/ui-components:            Can't find stylesheet to import.\r\n@aws-amplify/ui-components:       L1:  .auth-fields {\r\n@aws-amplify/ui-components:       L2:    margin-bottom: 2rem;\r\n@aws-amplify/ui-components: [ ERROR ]  sass error: src/components/amplify-form-section/amplify-form-section.scss:1:1\r\n@aws-amplify/ui-components:            Can't find stylesheet to import.\r\n@aws-amplify/ui-components:       L1:  /**\r\n@aws-amplify/ui-components:       L2:   * @prop --header-color: Text color within the form header\r\n@aws-amplify/ui-components: [ ERROR ]  sass error: src/components/amplify-section/amplify-section.scss:1:1\r\n@aws-amplify/ui-components:            Can't find stylesheet to import.\r\n@aws-amplify/ui-components:       L1:  /**\r\n@aws-amplify/ui-components:       L2:   * @prop --font-family: Font family of the text within the container\r\n@aws-amplify/ui-components: [ ERROR ]  sass error: src/components/amplify-checkbox/amplify-checkbox.scss:1:1\r\n@aws-amplify/ui-components:            Can't find stylesheet to import.\r\n@aws-amplify/ui-components:       L1:  /**\r\n@aws-amplify/ui-components:       L2:   * @prop --font-family: Text font family\r\n@aws-amplify/ui-components: [ ERROR ]  sass error: src/components/amplify-icon-button/amplify-icon-button.scss:1:1\r\n@aws-amplify/ui-components:            Can't find stylesheet to import.\r\n@aws-amplify/ui-components:       L1:  /**\r\n@aws-amplify/ui-components:       L2:   * @prop --button-color: Text color of the button\r\n@aws-amplify/ui-components: [ ERROR ]  sass error: src/components/amplify-sign-in/amplify-sign-in.scss:1:1\r\n@aws-amplify/ui-components:            Can't find stylesheet to import.\r\n@aws-amplify/ui-components:       L1:  /**\r\n@aws-amplify/ui-components:       L2:   * @prop --footer-font-family: Font family of the footer\r\n@aws-amplify/ui-components: [ ERROR ]  sass error: src/components/amplify-sign-up/amplify-sign-up.scss:1:1\r\n@aws-amplify/ui-components:            Can't find stylesheet to import.\r\n@aws-amplify/ui-components:       L1:  /**\r\n@aws-amplify/ui-components:       L2:   * @prop --footer-font-family: Font family of the footer\r\n@aws-amplify/ui-components: [ ERROR ]  sass error: src/components/amplify-strike/amplify-strike.scss:1:1\r\n@aws-amplify/ui-components:            Can't find stylesheet to import.\r\n@aws-amplify/ui-components:       L1:  /**\r\n@aws-amplify/ui-components:       L2:   * @prop --color: Text color of the content placed between the horizontal rules\r\n@aws-amplify/ui-components: [ ERROR ]  sass error: src/components/amplify-tooltip/amplify-tooltip.scss:1:1\r\n@aws-amplify/ui-components:            Can't find stylesheet to import.\r\n@aws-amplify/ui-components:       L1:  /**\r\n@aws-amplify/ui-components:       L2:   * @prop --font-family: Font family of the text placed within the tooltip\r\n@aws-amplify/ui-components: [ ERROR ]  sass error: src/components/amplify-loading-spinner/amplify-loading-spinner.scss:1:1\r\n@aws-amplify/ui-components:            Can't find stylesheet to import.\r\n@aws-amplify/ui-components:       L1:  :host {\r\n@aws-amplify/ui-components:       L2:    --spinner-circle-fill: var(--amplify-smoke-white);\r\n@aws-amplify/ui-components: [ ERROR ]  sass error: src/components/amplify-picker/amplify-picker.scss:1:1\r\n@aws-amplify/ui-components:            Can't find stylesheet to import.\r\n@aws-amplify/ui-components:       L1:  .picker {\r\n@aws-amplify/ui-components:       L2:    position: relative;\r\n@aws-amplify/ui-components: [ ERROR ]  sass error: src/components/amplify-hint/amplify-hint.scss:1:1\r\n@aws-amplify/ui-components:            Can't find stylesheet to import.\r\n@aws-amplify/ui-components:       L1:  /**\r\n@aws-amplify/ui-components:       L2:   * @prop --color: Color of the text\r\n@aws-amplify/ui-components: [ ERROR ]  sass error: src/components/amplify-form-field/amplify-form-field.scss:1:1\r\n@aws-amplify/ui-components:            Can't find stylesheet to import.\r\n@aws-amplify/ui-components:       L1:  :host {\r\n@aws-amplify/ui-components:       L2:    --label-font-size: var(--amplify-text-md);\r\n@aws-amplify/ui-components: [ ERROR ]  sass error: src/components/amplify-icon/amplify-icon.scss:1:1\r\n@aws-amplify/ui-components:            Can't find stylesheet to import.\r\n@aws-amplify/ui-components:       L1:  /**\r\n@aws-amplify/ui-components:       L2:   * @prop --width: Width of the icon\r\n@aws-amplify/ui-components: [ ERROR ]  sass error: src/components/amplify-label/amplify-label.scss:1:1\r\n@aws-amplify/ui-components:            Can't find stylesheet to import.\r\n@aws-amplify/ui-components:       L1:  /**\r\n@aws-amplify/ui-components:       L2:   * @prop --label-color: Text color within the label\r\n@aws-amplify/ui-components: [ ERROR ]  sass error: src/components/amplify-container/amplify-container.scss:1:1\r\n@aws-amplify/ui-components:            Can't find stylesheet to import.\r\n@aws-amplify/ui-components:       L1:  :host {\r\n@aws-amplify/ui-components:       L2:    display: flex;\r\n@aws-amplify/ui-components: [ ERROR ]  sass error: src/components/amplify-link/amplify-link.scss:1:1\r\n@aws-amplify/ui-components:            Can't find stylesheet to import.\r\n@aws-amplify/ui-components:       L1:  :host {\r\n@aws-amplify/ui-components:       L2:    --link-color: var(--amplify-primary-color);\r\n@aws-amplify/ui-components: [ ERROR ]  sass error: src/components/amplify-s3-album/amplify-s3-album.scss:1:1\r\n@aws-amplify/ui-components:            Can't find stylesheet to import.\r\n@aws-amplify/ui-components:       L1:  /**\r\n@aws-amplify/ui-components:       L2:   * @prop --overlay-bg-color: Image overlay color on hover\r\n@aws-amplify/ui-components: [ ERROR ]  sass error: src/components/amplify-s3-image/amplify-s3-image.scss:1:1\r\n@aws-amplify/ui-components:            Can't find stylesheet to import.\r\n@aws-amplify/ui-components:       L1:  /**\r\n@aws-amplify/ui-components:       L2:   * @prop --height: Image height\r\n@aws-amplify/ui-components: [ ERROR ]  sass error: src/components/amplify-toast/amplify-toast.scss:1:1\r\n@aws-amplify/ui-components:            Can't find stylesheet to import.\r\n@aws-amplify/ui-components:       L1:  /**\r\n@aws-amplify/ui-components:       L2:   * @prop --background-color: Background color of the container\r\n@aws-amplify/ui-components: [ ERROR ]  sass error: src/components/amplify-radio-button/amplify-radio-button.scss:1:1\r\n@aws-amplify/ui-components:            Can't find stylesheet to import.\r\n@aws-amplify/ui-components:       L1:  :host {\r\n@aws-amplify/ui-components:       L2:    --font-family: var(--amplify-font-family);\r\n@aws-amplify/ui-components: [ ERROR ]  sass error: src/components/amplify-button/amplify-button.scss:1:1\r\n@aws-amplify/ui-components:            Can't find stylesheet to import.\r\n@aws-amplify/ui-components:       L1:  /**\r\n@aws-amplify/ui-components:       L2:   * @prop --background-color: Background color of the button\r\n@aws-amplify/ui-components: [ ERROR ]  sass error: src/components/amplify-phone-field/amplify-phone-field.scss:1:1\r\n@aws-amplify/ui-components:            Can't find stylesheet to import.\r\n@aws-amplify/ui-components:       L1:  .phone-field {\r\n@aws-amplify/ui-components:       L2:    display: inline-flex;\r\n@aws-amplify/ui-components: [ ERROR ]  sass error: src/components/amplify-select/amplify-select.scss:1:1\r\n@aws-amplify/ui-components:            Can't find stylesheet to import.\r\n@aws-amplify/ui-components:       L1:  /**\r\n@aws-amplify/ui-components:       L2:   * @prop --color: Text color of the select choices\r\n@aws-amplify/ui-components: [ ERROR ]  sass error: src/components/amplify-sign-in-button/amplify-sign-in-button.scss:1:1\r\n@aws-amplify/ui-components:            Can't find stylesheet to import.\r\n@aws-amplify/ui-components:       L1:  :host {\r\n@aws-amplify/ui-components:       L2:    --button-color: var(--amplify-secondary-color);\r\n@aws-amplify/ui-components: [ ERROR ]  sass error: src/components/amplify-input/amplify-input.scss:1:1\r\n@aws-amplify/ui-components:            Can't find stylesheet to import.\r\n@aws-amplify/ui-components:       L1:  /**\r\n@aws-amplify/ui-components:       L2:   * @prop --color: Text color within the input\r\n@aws-amplify/ui-components: [ WARN  ]  Bundling Warning PLUGIN_WARNING\r\n@aws-amplify/ui-components:            The namedExports option from \"@rollup/plugin-commonjs\" is\r\n@aws-amplify/ui-components:            deprecated. Named exports are now handled automatically.\r\n@aws-amplify/ui-components: [04:00.8]  build failed in 9.57 s\r\n@aws-amplify/ui-components: npm ERR! code ELIFECYCLE\r\n@aws-amplify/ui-components: npm ERR! errno 1\r\n@aws-amplify/ui-components: npm ERR! @aws-amplify/ui-components@0.9.5 stencil: `stencil build --docs-readme`\r\n@aws-amplify/ui-components: npm ERR! Exit status 1\r\n@aws-amplify/ui-components: npm ERR!\r\n@aws-amplify/ui-components: npm ERR! Failed at the @aws-amplify/ui-components@0.9.5 stencil script.\r\n@aws-amplify/ui-components: npm ERR! This is probably not a problem with npm. There is likely additional logging output above.\r\n@aws-amplify/ui-components: npm ERR! A complete log of this run can be found in:\r\n\r\nanyone know how to fix it?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNzUzNQ==","author":{"login":"platium111"},"title":"How to update multiple tables data in the transaction with GraphQL React","body":"Hi everyone,\r\nIn one-to-many (Customer has many Contracts) relation, I want to create a new record in the Customer table and many contracts for this customer. Basically, when I create the new Customer, I get customer id back, then in Contract table, I will put customer ID into createContracts mutation (for example: contractCustomerId). But if the mutation fails in createContracts, the customer should not be added. Here is my table\r\n\r\n`type Customer @model {\r\n  id: ID!\r\n  firstName: String!\r\n  contracts: [Contract] @connection(name: \"CustomerContracts\")\r\n}\r\n\r\ntype Contract @model {\r\n  id: ID!\r\n  loanStatus: String\r\n  note: String\r\n  customer: Customer @connection(name: \"CustomerContracts\")\r\n}\r\n`\r\n\r\nI think it could be Transaction to control that but don't know how to connect between `transactItems`. The below transaction is what I get in docs example here [docs](https://aws.amazon.com/blogs/mobile/appsync-caching-transactions/)\r\nWhat I don't understand is if I have `PutItem` for Customer, how can I get customer id and put to the second one which is `PutItem` for Contract.\r\n`{\r\n        \"version\": \"2018-05-29\",\r\n        \"operation\": \"TransactWriteItems\",\r\n        \"transactItems\": [\r\n           {\r\n               \"table\": \"posts\",\r\n               \"operation\": \"PutItem\",\r\n               \"key\": {\r\n                   \"post_id\": {\r\n                       \"S\": \"p1\"\r\n                   }\r\n               },\r\n               \"attributeValues\": {\r\n                   \"post_title\": {\r\n                       \"S\": \"New title\"\r\n                   },\r\n                   \"post_description\": {\r\n                       \"S\": \"New description\"\r\n                   }\r\n               },\r\n               \"condition\": {\r\n                   \"expression\": \"post_title = :post_title\",\r\n                   \"expressionValues\": {\r\n                       \":post_title\": {\r\n                           \"S\": \"Expected old title\"\r\n                       }\r\n                   }\r\n               }\r\n           },\r\n           {\r\n               \"table\":\"authors\",\r\n               \"operation\": \"UpdateItem\",\r\n               \"key\": {\r\n                   \"author_id\": {\r\n                       \"S\": \"a1\"\r\n                   },\r\n               },\r\n               \"update\": {\r\n                   \"expression\": \"SET author_name = :author_name\",\r\n                   \"expressionValues\": {\r\n                       \":author_name\": {\r\n                           \"S\": \"New name\"\r\n                       }\r\n                   }\r\n               },\r\n           }\r\n        ]\r\n    }`\r\n\r\nWhat should be the solution for it?. Thanks for your help.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNzQ1NQ==","author":{"login":"gruckionvit"},"title":"Amplify mock api switching back to in cloud end point","body":"When using `amplify mock api` this switches the end point the `aws-exports.js` file so that graphql is pointing to the local instance. What is the intended way to switch back to the cloud?\r\n\r\nCurrently I have found typing `amplify init` will do the job but this seems a little strange as I am not initializing the project.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNzQ1Mg==","author":{"login":"myfairshare"},"title":"Connecting my amplify app to a wordpress site..","body":"Hello,\r\n\r\n   Could someone please point me in the right direction.\r\n\r\nSo I have a wordpress site build promoting a business and in the meantime I'm building my amplify full stack app using DataStore and have it deployed to a random url.\r\n\r\nSo at the moment they are essentially 2 websites.\r\n\r\nIs it possible to maybe combine them, ie sign in to the app on the wordpress site, thanks for any tips!\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNDc0MQ==","author":{"login":"ericclemmons"},"title":"RFC: pin aws-amplify dependencies (remove ^)","body":"_This issue is a Request For Comments (RFC). It is intended to elicit community feedback regarding a proposed change to the library. Please feel free to post comments or questions here._\r\n\r\n## Summary\r\n\r\nRemove `^` from `dependencies` so that `aws-amplify` and its `@aws-amplify/*` packages can be installed from a specific moment-in-time:\r\n\r\nhttps://github.com/aws-amplify/amplify-js/blob/2f74c6b74d38af570017139f2ba8269dc1009135/packages/aws-amplify/package.json#L36-L49\r\n\r\nhttps://github.com/aws-amplify/amplify-js/blob/2f74c6b74d38af570017139f2ba8269dc1009135/packages/datastore/package.json#L50-L53\r\n\r\netc.\r\n\r\n## Motivation\r\n\r\n1. Allow pinning of `aws-amplify` in `package.json` when a regression/bug is found.\r\n1. Faster reproduction of issues by being able to install all packages from that moment-in-time.\r\n\r\nSuppose `aws-amplify/core` is released today with a regression.  Because `aws-amplify` specifies `@aws-amplify/core` with a `^` **customers will be broken even if they have `aws-amplify` pinned to a specific version**.\r\n\r\nThis is surprising behavior and extremely difficult to work-around (unless you have `yarn.lock` / `package-lock.json`).  One way of resolving this is with [yarn's resolutions](https://classic.yarnpkg.com/en/docs/selective-version-resolutions/), but that doesn't exist in NPM.\r\n\r\nI would argue that `aws-amplify` acts as a single-dependency wrapper for Amplify JS, much like [`react-scripts` \"bundles\" dependencies with explicit versions](https://github.com/facebook/create-react-app/blob/master/packages/react-scripts/package.json).\r\n\r\nToday's behavior would still work when using:\r\n\r\n```json\r\n\"dependencies\": {\r\n  \"aws-amplify\": \"^3.1.0\"\r\n}\r\n```\r\n\r\nBut, if `3.1.1` had a regression, a customer could simply pin their version & choose to upgrade again later:\r\n\r\n```json\r\n\"dependencies\": {\r\n  \"aws-amplify\": \"3.1.0\"\r\n}\r\n```\r\n\r\nIn the case of #6811, this option wasn't available. Customers were broken until a fix was released (or an unclear work-around was found).\r\n\r\nYes, a lock-file mitigates this, but again those aren't guaranteed to exist. Consider a brand new project: **the customer has no ability to use a previous good release!**\r\n\r\nBut there's an additional benefit: **reproducibility**.\r\n\r\nIf a customer opens up an issue with `aws-amplify@3.1.0`, it is impossible for us to consume that package from NPM/Yarn at the time of release: `@aws-amplify/*` will always refer to the latest `^` published package.\r\n\r\nBy pinning `@aws-amplify/*` dependencies, we will be able to install _all_ of the `@aws-amplify/*` packages for quicker reproduction through NPM. To do so otherwise would require `yarn link`ing, `git bisect`, and a slow, difficult `yarn build` process.  _And this doesn't work well for React Native!_.\r\n\r\n\r\n## Drawbacks\r\n\r\n- I'm not sure if this is a breaking change at all:\r\n\r\n  - Customers who install individual packages (e.g. `@aws-amplify/datastore`) will continue to do so, and will continue to use `^` at their discretion.\r\n\r\n  - Customers who install `aws-amplify` (per our recommendation) will either have it pinned (including our sub-packages), or with `^` and receive updates (since we update sub-packages with `aws-amplify`) via lerna.\r\n\r\n## Adoption Strategy\r\n\r\nShould not rely on any changes in documentation or for our customers.\r\n\r\nBy default, `npm install --save aws-amplify` uses `^`:\r\n\r\n```json\r\n  \"dependencies\": {\r\n    \"aws-amplify\": \"^3.3.3\"\r\n  }\r\n```\r\n\r\n## Related Issues\r\n\r\nAdd GitHub issue numbers/URLs that informed or would be impacted by this proposal.\r\n\r\n- #6836 \r\n- #6811 \r\n- https://github.com/aws-amplify/amplify-js/issues/6930#issuecomment-708153567\r\n\r\n## References\r\n\r\n- https://classic.yarnpkg.com/en/docs/selective-version-resolutions/\r\n- https://github.com/facebook/create-react-app/blob/master/packages/react-scripts/package.json","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"sammartinez"},"body":"Do look into other packages as well for carrots, e.g. [auth](https://github.com/aws-amplify/amplify-js/blob/main/packages/auth/package.json#L44-L45)"}},{"node":{"author":{"login":"wlee221"},"body":"I'm for this change! Many times I had to compare changelogs and use `resolutions` to debug a specific version. This would solve subdependency version conflicts too."}},{"node":{"author":{"login":"skorfmann"},"body":"Just ran into a situation with https://github.com/aws-amplify/amplify-js/pull/7237 where easy version pinning would have saved me lots of headaches."}},{"node":{"author":{"login":"ericclemmons"},"body":"Pinning has been released via https://github.com/aws-amplify/amplify-js/pull/7040!"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNjkwMw==","author":{"login":"charleslouis"},"title":"📩 Send Cognito user email to email marketing software (Mailchimp, Sendinblue...)","body":"Hi 👋\r\n\r\nI want users to subscribe to newsletter upon signup with Cognito.\r\n\r\nHow would you send the email address of Cognito users to an email marketing software such as Mailchimp or Sendinblue?\r\n\r\nI'm thinking something like SNS + Webhooks?\r\n\r\nBut I don’t really know where to look for documentation and most integration is about Zapier and CognitoForms (not cognito).\r\n\r\nThank you for your help 🙏\r\nCharlo\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"sw-yx"},"body":"nah no sns needed. use post confirmation trigger.\r\n\r\n- https://docs.amplify.aws/lib/auth/advanced/q/platform/js#lambda-triggers\r\n- https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-user-identity-pools-working-with-aws-lambda-triggers.html"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzczMTc0","author":{"login":"ulisescarreonalvarez"},"title":"Social Login Required Attributes Error","body":"**Describe the bug**\r\nWe wan't to add Facebook login on our react application, we actually use only Google, we add the configuration and created the app on Facebook, we add the mapping attributes but only with Facebook we are getting this error:\r\n\r\n![Captura de Pantalla 2020-11-19 a la(s) 19 17 11](https://user-images.githubusercontent.com/25987364/99743702-d95d4d00-2a9b-11eb-8cae-189f1e6e9a72.png)\r\n\r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n\r\n` onClick={() => Auth.federatedSignIn({ provider: \"Facebook\" })}\r\n`\r\n\r\nAccept that the app can use the Login Feature.\r\n\r\n**Expected behavior**\r\nAs Google, we don't know why the email is marked as required if Facebook has de attribute mapped.\r\n\r\n**Code Snippet**\r\n\r\n ```\r\nHub.listen(\"auth\", ({ payload: { event, data } }) => {\r\n            console.log('event', event, data);\r\n            switch (event) {\r\n                case \"signIn\":\r\n                    let store = configureStore();\r\n                    localStorage.setItem(\"user_id\", data.username);\r\n                    break;\r\n                case 'signIn_failure':\r\n                    console.log(event);\r\n                    break;\r\n                case \"signOut\":\r\n                    this.setState({ user: null });\r\n                    break;\r\n                case \"customOAuthState\":\r\n                    this.setState({ customState: data });\r\n            }\r\n        });\r\n```\r\n\r\n**Screenshots**\r\n\r\n![Captura de Pantalla 2020-11-19 a la(s) 19 16 04](https://user-images.githubusercontent.com/25987364/99743751-f42fc180-2a9b-11eb-9754-85142e175e2f.png)\r\n\r\n![Captura de Pantalla 2020-11-19 a la(s) 19 18 30](https://user-images.githubusercontent.com/25987364/99743801-090c5500-2a9c-11eb-9ec0-ec2274b11d78.png)\r\n\r\n**What is Configured?**\r\n\r\n```\r\nconst awsConfig = {\r\n    \"aws_project_region\": \"us-east-1\",\r\n    \"aws_cognito_identity_pool_id\": \"us-east-1:xxxx\",\r\n    \"aws_cognito_region\": \"us-east-1\",\r\n    \"aws_user_pools_id\": \"us-east-1_xxxx\",\r\n    \"aws_user_pools_web_client_id\": \"xxxx\",\r\n    \"oauth\": {\r\n        \"domain\": \"xxxx.auth.us-east-1.amazoncognito.com\",\r\n        \"scope\": [\r\n            \"email\",\r\n            \"openid\",\r\n            \"profile\",\r\n            \"aws.cognito.signin.user.admin\"\r\n        ],\r\n        \"redirectSignIn\": \"http://localhost/callback/cognito/\",\r\n        \"redirectSignOut\": \"http://localhost/logout/\",\r\n        \"responseType\": \"code\"\r\n    },\r\n    \"federationTarget\": \"COGNITO_USER_POOLS\"\r\n};\r\n```","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzUzOA==","author":{"login":"ricardoribas"},"title":"Amplify console automation process","body":"Hi folks, i would to ask a couple of questions about the CI/CD process regarding the amplify web applications. I am using at the moment to build one web application, but i would like to know more about all the steps taken to perform it. I didn't find any sort of documentation that would explain all the steps. Preferably, if you guys can recommend some github pages that deeply describe, i would appreciate. \r\n\r\nAdditionally, there is any way to access old bundle files? In order to debug old bugs, i need to access old bundles. As we are a team that is constantly deploying new code, is hard to keep track of old files.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNjU0","author":{"login":"Johnniexson"},"title":"Can't pass parameters to Amplify Angular generated API service subscriptions.","body":"Hello, it seems there is no way to pass parameters to subscriptions with arguments.\r\n\r\nFor instance i have my model and subscriptions declared in my schema like this:\r\n\r\n```\r\ntype Message\r\n  @model(subscriptions: null)\r\n  @key(name: \"byAuthor\", fields: [\"authorId\"], queryField: \"messageByUser\")\r\n  @key(\r\n    name: \"byConvo\"\r\n    fields: [\"conversationId\"]\r\n    queryField: \"messageByConvo\"\r\n  ) {\r\n  id: ID!\r\n  authorId: ID!\r\n  conversationId: ID!\r\n  content: String!\r\n  createdAt: String!\r\n}\r\n\r\n```\r\n```\r\ntype Subscription {\r\n  onCreateMessage(conversationId: ID!): Message @aws_subscribe(mutations: [\"createMessage\"])\r\n}\r\n```\r\n\r\nOn `amplify codegen` for angular the generated subscription in the API.service.ts looks like this:\r\n\r\n```\r\nOnCreateMessageListener: Observable<OnCreateMessageSubscription> = API.graphql(\r\n    graphqlOperation(\r\n      `subscription OnCreateMessage($conversationId: ID!) {\r\n        onCreateMessage(conversationId: $conversationId) {\r\n          __typename\r\n          id\r\n          authorId\r\n         conversationId\r\n          content\r\n          createdAt\r\n          updatedAt\r\n          _version\r\n          _deleted\r\n          _lastChangedAt\r\n        }\r\n      }`\r\n    )\r\n  ) as Observable<OnCreateMessageSubscription>;\r\n```\r\n\r\nTo listen to this subscription in component i have: \r\n\r\nPS: This only work if there was no argument specified when creating the subscription, but with argument, there is no way to pass parameters to the subscription.\r\n```\r\nthis.apiService.OnCreateMessageListener.subscribe({\r\n        next: (listener) => {\r\n          console.log(listener);\r\n        },\r\n      })\r\n```\r\n\r\nPS: I tried passing the conversationId like this, but i get Error, OnCreateMessageListener is not a function.\r\n\r\n```\r\nthis.apiService.OnCreateMessageListener(conversationId).subscribe({\r\n        next: (listener) => {\r\n          console.log(listener);\r\n        },\r\n      })\r\n```\r\n\r\nPls what am i doing wrong? Thanks in anticipation.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"markeames"},"body":"I have the same issue, \r\n\r\nUsing amplify cli 4.29.3 and Angular 8.2.x\r\n\r\ntype ChangeSource @model(subscriptions: null) @auth(rules: [ { allow: groups, groupsField: \"group\" }]) \r\n\r\n{\r\n    \r\nid: ID!\r\ngroup: String! \r\nsource: String! \r\naction: Int! \r\ntarget: String! \r\ncreatedAt: String\r\n}\r\n\r\ntype Subscription {\r\n    onCreateChangeSource(group: String): ChangeSource @aws_subscribe(mutations: [\"createChangeSource\"])\r\n}\r\n\r\n\r\ngenerates \r\n\r\nOnCreateChangeSourceListener: Observable<\r\n    OnCreateChangeSourceSubscription\r\n  > = API.graphql(\r\n    graphqlOperation(\r\n      `subscription OnCreateChangeSource($group: String) {\r\n        onCreateChangeSource(group: $group) {\r\n          __typename\r\n          id\r\n          group\r\n          source\r\n          action\r\n          target\r\n          createdAt\r\n          updatedAt\r\n        }\r\n      }`\r\n    )\r\n  ) as Observable<OnCreateChangeSourceSubscription>;\r\n\r\n\r\nwhile the   graphql onCreateChangeSource takes a group argument, but how to pass it via the generated API.service.ts?\r\n\r\nIs this a defect in how the Angular API service is being generated from the subscriptions.graphql?"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMDY1","author":{"login":"mrichman"},"title":"How to hide authenticator sign up link in Vue.js","body":"There is no documentation on how to hide the signup link and text. This is the \"No account? Create account\" prompt.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"jordanranz"},"body":"Hey @mrichman, I am working on opening up a `slot` API to customize different parts of the footer for sign in and sign up. I'll like the PR here and in your feature request when it is ready"}},{"node":{"author":{"login":"alexvdvalk"},"body":"This also applies to the Angular UI components.\r\n\r\n`<amplify-authenticator>\r\n<amplify-sign-in slot=\"sign-in\">\r\n    <div slot=\"secondary-footer-content\"></div>  \r\n  </amplify-sign-in>\r\n</amplify-authenticator>`"}},{"node":{"author":{"login":"scottpederick"},"body":"Looking at the source, you can pass 'hide-sign-up' as a boolean:\r\n\r\n```\r\n<amplify-authenticator :authConfig=\"authConfig\">\r\n    <amplify-sign-in slot=\"sign-in\" hide-sign-up=\"true\"></amplify-sign-in>\r\n</amplify-authenticator>\r\n```"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjM5MQ==","author":{"login":"niloy369"},"title":"How to add extra anchor link in sign in secondary footer content along with the original content","body":"I'm using angular ui component. I'm wishing to customize the secondary footer content but keeping the original content also. I'm facing issue redirecting to signup page. My code is following\r\n\r\n`<amplify-sign-in slot=\"sign-in\" usernameAlias=\"email\">\r\n    <div class=\"\" slot=\"secondary-footer-content\">\r\n      No account? <amplify-button slot=\"sign-up-link\" type=\"anchor\" data-test=\"sign-in-create-account-link\" class=\"hydrated\">Create account</amplify-button>\r\n      <br>\r\n      Or <a routerLink=\"/sign-up\">Click Here</a> to signup as mentor\r\n    </div>\r\n  </amplify-sign-in>`\r\n\r\n<img width=\"545\" alt=\"Screenshot 2020-11-15 at 9 55 24 PM\" src=\"https://user-images.githubusercontent.com/4466897/99189815-61d2a980-278d-11eb-897f-4c753411c7ee.png\">\r\n\r\nMy issue is clicking on the create account link doesn't redirect to sign up page. How can I achieve that\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjExMA==","author":{"login":"myfairshare"},"title":"Guarding against malicious image/video upload workflow","body":"Hello,\r\n\r\n    I am creating a property app where users will be able to upload images and video of a property.\r\n\r\nToday our team were discussing the edge case of a user uploading distasteful content.\r\n\r\nCould someone please offer me some guidance on how to go about this, I'm guessing there is some kind of package / AI to scan images on the backend, like a lamda function, thank you!\r\n\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"sw-yx"},"body":"yup! on the clientside you can use this https://github.com/infinitered/nsfwjs\r\n\r\non the serverside: https://docs.amplify.aws/lib/predictions/label-image/q/platform/js#setup-the-backend"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjEzNw==","author":{"login":"yaquawa"},"title":"How to assign a default value for schema ?","body":"I found a lib that adds a `@default` directive to set a default value.\r\n\r\nhttps://github.com/trek10inc/graphql-default-value-transformer\r\n\r\n\r\nI don't know if this is a best practice.\r\nIs there any official way to assign a default value for schema ?","upvoteCount":3,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjA3Ng==","author":{"login":"purbanow"},"title":"Secure Kinesis channels with Cognito identity pool","body":"Hi\r\n\r\nI'm building video chat using Cognito + webRTC and I'm trying to figure out how to secure access to dynamically created channels so every user will be only able to access particular rooms.\r\n\r\nThanks a lot!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMTM1OQ==","author":{"login":"hmisonne"},"title":"Amplify and Redux: How to dispatch actions only when the sync is ready?","body":"I would like to know how to set up Redux to make sure it only dispatch actions when the sync is completed. Currently, I am dispatching actions after querying the DataStore. \r\n\r\n```javascript\r\n// redux/actions\r\nimport { User, GroceryList, Product } from \"../src/models\";\r\nimport { DataStore } from 'aws-amplify'\r\n\r\nexport const loadGroceryLists = (groceryLists) => ({\r\n  type: \"LOAD_GROCERY_LIST\",\r\n  groceryLists,\r\n});\r\n\r\nexport function handleLoadGroceryLists() {\r\n  return (dispatch, getState) => {\r\n\t\tconst {user} = getState()\r\n\t\treturn fetchUserGroceryLists()\r\n\t\t\t.then((groceryLists)=> dispatch(loadGroceryLists(groceryLists)))\r\n\t}\r\n}\r\n\r\nasync function fetchUserGroceryLists() {\r\n  const groceryLists = await DataStore.query(GroceryList)\r\n  return groceryLists \r\n}\r\n```\r\n\r\nHowever, I would like to make sure the `Datastore` is reflecting the **latest state before triggering an action**. \r\n\r\nI am referring to a scenario where **SelectiveSync** is required: Whenever the `syncExpression` is updated, the `DataStore` needs to be restarted to update the data received, after that the DataStore will reflect a new State.\r\n\r\nWhat is happening now, is that the action gets called before the synchronization is completed, and even though the browser datastore is correctly reflecting the latest info, the state displayed on the App is different. \r\n\r\nIs there a way to solve this?\r\n\r\nI thought about using `Hub.listen('datastore',...)` but I could not manage to solve my issue with it.\r\n\r\nThank you in advance for your help!","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"tysoncung"},"body":"Checkout DataStore events here:\r\n\r\nhttps://docs.amplify.aws/lib/datastore/datastore-events/q/platform/js\r\n\r\n`// Create listener\r\nconst listener = Hub.listen(\"datastore\", async hubData => {\r\n  const  { event, data } = hubData.payload;\r\n  if (event === \"ready\") {\r\n    // do something here once the data is synced from the cloud\r\n  }\r\n})\r\n\r\n// Remove listener\r\nlistener();`\r\n"}},{"node":{"author":{"login":"hmisonne"},"body":"Thank you @tysoncung for your answer. Here is how I implemented Redux with Amplify and SelectiveSync:\r\n\r\nThe loadPost() function will call a function to **synchronize the DataStore** with the new postID **instead of dispatching directly an action**.\r\nAdding a listener on my React Component will then make sure the Redux actions are only dispatched when the state of synchronization is ready.\r\n\r\n\r\n```javascript\r\n# screens/Home\r\nimport React from \"react\";\r\nimport { connect, useDispatch } from \"react-redux\";\r\nimport {\r\n  handleLoadPost,\r\n  syncDatastore,\r\n} from \"../redux/actions\";\r\n\r\nconst Home = () => {\r\n  const dispatch = useDispatch();\r\n  async function loadPost(id) {\r\n    syncDatastore(id)\r\n    const removeListener =\r\n    Hub.listen(\"datastore\", async (hubData) => {\r\n      const { event, data } = hubData.payload;\r\n      if ( event === \"ready\") {\r\n        dispatch(handleLoadPost());\r\n        removeListener();\r\n      }\r\n    });\r\n  }\r\n  return( ... )\r\n}\r\n\r\nexport default connect()(Home);\r\n```\r\n\r\n```javascript\r\n# redux/actions\r\n\r\nimport { DataStore, syncExpression, Hub } from 'aws-amplify'\r\nimport {  Post } from \"../../models\";\r\n\r\n// Initialize Selective Sync with empty data\r\nlet postID= ''\r\n\r\nDataStore.configure({\r\n  syncExpressions: [\r\n   syncExpression(Post, () => {\r\n      return (c) => c.id('eq', postID);\r\n    }),\r\n  ],\r\n});\r\n\r\n// Redux Actions to load Posts\r\nexport const loadPost= (post) => ({\r\n  type: \"LOAD_POST\",\r\n  post,\r\n});\r\n\r\nexport function handleLoadPost() {\r\n  return (dispatch, getState) => {\r\n    return fetchPost()\r\n    .then((post)=> dispatch(loadPost(post)))\r\n  }\r\n}\r\n\r\nasync function  fetchPost() {\r\n  const result = await DataStore.query(Post)\r\n  return result\r\n}\r\n\r\n// update postID and restart Datastore to reevalute syncExpressions with new postID\r\nexport async function syncDatastore(id){\r\n  postID = id\r\n await DataStore.stop();\r\n await DataStore.start();\r\n}\r\n\r\n```\r\n\r\nFeel free to comment if you have a better idea on how to implement Redux with SelectiveSync! "}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMTU1Mw==","author":{"login":"anand-010"},"title":"How do I filter subscriptions with ids?","body":"My problem is more related to a real-time chat application with multiple chat rooms.\r\nI want to filter each message and send it to users who subscribed to the same chatrooms. (not filtering on client-side)\r\n\r\nI am a beginner to app sync. How do I do that Please help me?\r\n\r\nPlease give me relevant links, codes or steps.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"tysoncung"},"body":"You can subscribe to only an object by providing an id\r\n\r\nhttps://docs.amplify.aws/lib/datastore/real-time/q/platform/js\r\n\r\nconst id = '69ddcb63-7e4a-4325-b84d-8592e6dac07b';\r\n\r\nconst subscription = DataStore.observe(Post, id).subscribe(msg => {\r\n  console.log(msg.model, msg.opType, msg.element);\r\n});"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMDcyNw==","author":{"login":"hmisonne"},"title":"SelectiveSync: Is there a way to synchronize data with an array of value?","body":"I would like to get data synchronized based on their parent relationship. In my scenario, a GroceryList (parent) can have multiple Products (child). I've described my app on this ticket #7128. \r\n\r\nWould it be possible to retrieve all the products that belongs to specific Grocery Lists? That is to say, how can I use an array of groceryListIDs as argument in the syncExpression (see below)?\r\n\r\n```javascript\r\nDataStore.configure({\r\n  syncExpressions: [\r\n    syncExpression(Product, () => {\r\n      return (c) => c.groceryListID('eq', [groceryListID1, groceryListID2]);\r\n    }),\r\n  ],\r\n});\r\n```","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"iartemiev"},"body":"Hey @hmisonne, there's not an official well-documented way of doing that currently, but I think the following should work:\r\n\r\n```js\r\nDataStore.configure({\r\n  syncExpressions: [\r\n    syncExpression(Product, () => {\r\n      const groceryListIDs = ['groceryListID1', 'groceryListID2'];\r\n      return (c) =>\r\n        c.or((c) => {\r\n          return groceryListIDs.reduce((acc, curVal) => {\r\n            return acc.groceryListID('eq', curVal);\r\n          }, c);\r\n        });\r\n    }),\r\n  ],\r\n});\r\n```\r\nThis is the equivalent of chaining together a bunch of OR predicates, i.e., \r\n```js\r\n(c) => c.or(c.groceryListID('eq', 'groceryListID1').groceryListID('eq', 'groceryListID2'))\r\n```\r\n\r\nIf you want to reuse that functionality in other places, you can create a helper like:\r\n\r\n```js\r\nconst listPredicate = (c, list, field) => {\r\n  return c.or((c) => list.reduce((_c, operand) => _c[field]('eq', operand), c));\r\n};\r\n\r\nDataStore.configure({\r\n  syncExpressions: [\r\n    syncExpression(Product, () => {\r\n      const groceryListIDs = ['groceryListID1', 'groceryListID2'];\r\n      return (c) => listPredicate(c, groceryListIDs, 'groceryListID');\r\n    }),\r\n  ],\r\n});\r\n```"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMTMxOQ==","author":{"login":"darylalexjohnson"},"title":"Token refresh with 'another' Federated provider","body":"[Documentation](https://docs.amplify.aws/lib/auth/advanced/q/platform/js#token-refresh) gives sample for refreshing token with another federated provider. However, I'm seeing the \"other\" federated provider must still authenticate with Cognito Identity Pools https://github.com/aws-amplify/amplify-js/blob/main/packages/core/src/Credentials.ts#L352.  Is there a work around solution for refreshing the token without Identity Pools?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMTI5Ng==","author":{"login":"yaquawa"},"title":"Signup without password required?","body":"Is it possible to have a user signup flow like this?\r\n\r\n1. signup with a given email, and a random password\r\n2. verification link sent to the given email\r\n3. user click on the verification link\r\n4. user verified(use https://docs.amplify.aws/cli/usage/lambda-triggers#email-verification-link-with-redirect)\r\n5. redirect to my site, let the user set a new password\r\n\r\nI was able to accomplish this flow until step 4.\r\non step 5, I don't know how to sign in the user automatically after the redirection.\r\nanyone know how to do this? Thanks!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMTAyNA==","author":{"login":"ifmael"},"title":"sync a specific model fot the Datastore from a list of id","body":"I'm trying the selective sync feature for the Datastore and I don't know how i can sync my model from a list of items returned from a promise.\r\n\r\n```\r\nDataStore.configure({\r\nDataStore.configure({\r\n  syncExpressions: [\r\n    syncExpression(Content, async () => {\r\n      const listOfContents = await getListOfContents();\r\n      // listOfContents  = \"001 002  003 \"\r\n      return (c) => {\r\n        return c.id(\"contains\", listOfContents);\r\n      };\r\n    }),\r\n  ],\r\n});\r\n```\r\n\r\nThe snippet above doesn't work because the `contains` operator works opposite that i thought. It checks if the  listOfContent  String is contained inside the id string.   Any suggestion?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"iartemiev"},"body":"Hey @ifmael, please try the following: https://github.com/aws-amplify/amplify-js/discussions/7135#discussioncomment-125467"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMDk3NQ==","author":{"login":"hmisonne"},"title":"unit test: How to mock Datastore and Models in Jest?","body":"I would like to add unit tests to all my calls to the Amplify DataStore using jest and I am wondering what are the best practices.\r\n\r\nHere is an example of one function to fetch all the GroceryLists instances:\r\n```javascript\r\nasync fetchAllGroceryLists() {\r\n    try {\r\n      const allGroceryLists = await DataStore.query(GroceryList);\r\n      console.log(\"grocery lists retrieved successfully!\");\r\n      return allGroceryLists;\r\n    } catch (error) {\r\n      console.log(\"Error retrieving grocery lists\", error);\r\n    }\r\n  }\r\n```\r\n\r\nTo test this function, my idea was to create a **BackendInterface Class** that would accept a **dataStore object in the constructor**:\r\n```javascript\r\nexport class BackendInterface {\r\n  constructor(dataStore) {\r\n      this._dataStore = dataStore\r\n  }\r\n  async fetchAllGroceryLists() {\r\n    try {\r\n      const allGroceryLists = await this._dataStore.query(GroceryList);\r\n      ...\r\n    }\r\n  }\r\n}\r\n```\r\nThis way, I could initialize a BackendInterface with a mocked datastore in my **test file**:\r\n```javascript\r\nimport { BackendInterface } from \"../BackendInterface\";\r\n\r\ndescribe(\"Backend Interface with Datastore\", () => {\r\n  describe(\"case 1 : GroceryLists\", () => {\r\n    const dataStore = {\r\n      query: () => [\r\n        {\r\n          id: \"1\",\r\n          name: \"test\",\r\n          groceryList: { id: \"1\" },\r\n        },\r\n        {\r\n          id: \"2\",\r\n          name: \"test\",\r\n          groceryList: { id: \"2\" },\r\n        },\r\n      ],\r\n    };\r\n    const API = new BackendInterface(dataStore);\r\n    test(\"fetchAllGroceryLists should return all items from the datastore\", () => {\r\n      return API.fetchAllGroceryLists().then((data) => {\r\n        expect(data.length).toBe(2);\r\n      });\r\n    });\r\n });\r\n```\r\n\r\nEven though this approach does work for this example, it does not allow me to perform more complicated queries. Moreover, it does not solve the problem of creating and updating the models.\r\n\r\nAfter researching online, I saw that some people recommended to use [mock-async-storage](https://www.npmjs.com/package/mock-async-storage) however I don't see how it could help me with my issue.\r\n\r\nThank you for your help!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMDk2MQ==","author":{"login":"ChihweiLHBird"},"title":"How to Make My Chrome Extension Login via My Website?","body":"I have a web app that's written in React, and I also have a Chrome extension written in html and javascript without frameworks.\r\n\r\nIn my chrome extension, I use `amazon-cognito-identity.min.js` as the library.\r\nIn my web app, I use the amplify package with React.\r\n \r\nI like to make my Chrome extension able to check the login state of the web app and to get the cognitoUser from the web app. Is there any way I can do this? Thank you!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMDkzOA==","author":{"login":"tnorlund"},"title":"Response from Postman but no response from Amplify","body":"I'm using the Amplify SDK to setup a REST endpoint. I set up the lambda function by editing the default lambda function created by amplify:\r\n```js\r\n...\r\n// Enable CORS for all methods\r\napp.use( function( req, res, next ) {\r\n  res.header( `Access-Control-Allow-Origin`, `*` )\r\n  res.header(\r\n    `Access-Control-Allow-Headers`,\r\n    `Origin, X-Requested-With, Content-Type, Accept`\r\n  )\r\n  next()\r\n} )\r\n...\r\napp.get( `/blog`, function ( request, response ) {\r\n  let params = {\r\n    TableName: tableName,\r\n    Key: {\r\n      'PK': `#BLOG`,\r\n      'SK': `#BLOG`\r\n    }\r\n  }\r\n  dynamodb.get( params, ( error, result ) => {\r\n    if ( error ) {\r\n      response.json( { statusCode: 500, error: error.message } )\r\n    } else {\r\n      response.json(\r\n        {\r\n          statusCode: 200,\r\n          url: request.url,\r\n          body: result.Item\r\n        }\r\n      )\r\n    }\r\n  } )\r\n} )\r\n...\r\n```\r\nWhen I run the GET command through postman I get the correct response:\r\n<img width=\"1392\" alt=\"Screen Shot 2020-11-08 at 9 04 52 AM\" src=\"https://user-images.githubusercontent.com/26452518/98482451-5c39fa00-21b6-11eb-9934-a5e93d91de3e.png\">\r\n\r\nIn the JS app, I'm able to post and put perfectly, but when I get:\r\n```js\r\nAPI.get( `blogAPI`, `/blog/`, {} )\r\n  .then( blogResponse => console.log( `response`, { blogResponse } ) )\r\n  .catch( error => console.log( `error`, { error } ) )\r\n```\r\nI produce the following error:\r\n\r\n```\r\nOrigin http://localhost:8000 is not allowed by Access-Control-Allow-Origin.\r\nXMLHttpRequest cannot load https://<API ENDPOINT>/blog due to access control checks.\r\n```\r\n\r\nAny idea how I can get this to work on the frontend?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTQ3","author":{"login":"superphung"},"title":"How can I upload relatively large file to S3 with slower connection?","body":"Hi,\r\nI have the same problem as this issue and the answers don't work for me.\r\n[#2166](https://github.com/aws-amplify/amplify-js/issues/2116).\r\n\r\nWhat I did:\r\n\r\n```\r\nimport { AWS } from \"@aws-amplify/core/lib/\";\r\n\r\nAWS.config.s3 = { \r\n  httpOptions: { \r\n    timeout: MORE_THAN_2_MINUTES \r\n  } \r\n}; //added before the Storage.vault.put()\r\n```\r\n\r\nI use aws-amplify@^2.2.1 and aws-amplify-react@^2.4.4.\r\nDo you guys have any ideas ?\r\n\r\nThanks you\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"j2d2"},"body":"@superphung - i was able to get this working by importing from \"@aws-amplify/core\"; (not \"core/lib/\")\r\n\r\nAmplify Team (cc @ericclemmons since you made the docs commit):\r\ni know this is old, but i am concerned about the amplify3xx-has-breaking-changes note now in the [README](https://github.com/aws-amplify/amplify-js#amplify3xx-has-breaking-changes-please-see-the-breaking-changes-below):\r\n\r\n> Amplify@3.x.x has breaking changes. Please see the breaking changes below:\r\nAWS.credentials and AWS.config don’t exist anymore anywhere in Amplify JS\r\nBoth options will not be available to use in version 3.\r\n\r\nThis is a required modification for my PWA - will this be addressed in the near future?"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMDU2OA==","author":{"login":"hmisonne"},"title":"Selective Sync: Can I manage the order of models sync ?","body":"I am working on a **Shareable Grocery Shopping List app** that I developed on React Native with **AWS Amplify** and **AppSync**. Currently a user will receive the complete database which is not ideal. \r\n\r\nI have 4 models: User, Grocery List and Products and UserGroceryListJoin (to handle many to many relationship). The idea is that a Grocery List contains multiple Products and multiple Users can have access to multiple Grocery Lists.\r\n\r\n```graphql\r\ntype Product @model \r\n@key(name: \"productByGroceryList\", fields: [\"groceryListID\"])\r\n{\r\n  id: ID!\r\n  groceryListID: ID!\r\n  name: String!\r\n}\r\n\r\ntype GroceryList @model {\r\n  id: ID!\r\n  name: String!\r\n  products: [Product] @connection(keyName: \"productByGroceryList\", fields: [\"id\"])\r\n  users: [UserGroceryListJoin] @connection(keyName: \"byUser\", fields: [\"id\"])\r\n}\r\n\r\ntype User @model @auth(rules: [{ allow: owner }]){\r\n  id: ID!\r\n  username: String\r\n  groceryLists: [UserGroceryListJoin] @connection(keyName: \"byGroceryList\", fields: [\"id\"])\r\n}\r\n\r\ntype UserGroceryListJoin @model(queries: null)\r\n  @key(name: \"byUser\", fields: [\"userID\", \"groceryListID\"])\r\n  @key(name: \"byGroceryList\", fields: [\"groceryListID\", \"userID\"]){\r\n  id: ID!\r\n  userID: ID!\r\n  groceryListID: ID!\r\n  user: User! @connection(fields: [\"userID\"])      \r\n  groceryList: GroceryList! @connection(fields: [\"groceryListID\"])  \r\n}\r\n```\r\n\r\n\r\nI thought about implementing `@auth` directive but unfortunately **it does not work with multiple owners**. The idea of my app is to be able to have multiple users interact with one list so I had to find a way around.\r\n\r\nI thought about using **Selective Sync**, to get only the products that belongs to a specific grocery list. To implement this, I would limit one groceryList per User. Unfortunately, to get the grocery list ID, I first have to get the user identified, and then get the Grocery List ID that he is using from the UserGroceryListJoin model.\r\n\r\n```javascript\r\nasync getGroceryListIDForSync() {\r\n      const users = await DataStore.query(User)\r\n      const userID = users[0].id\r\n      const groceryListID = await fetchUserGroceryLists(userID)\r\n      DataStore.configure({\r\n        syncExpressions: [\r\n          syncExpression(Product, async () => {\r\n            return (c) => c.groceryListID('eq', groceryListID)\r\n          })\r\n        ]\r\n      });\r\n   }\r\n```\r\n\r\nI see that currently, the Product model is getting synchronized first, then the User model, ect... So to run this query without errors, the sync needs to be complete which defeat the purpose.\r\n\r\nWould it be possible to set the order of the sync so that I can decide to have the User and Grocery List models synchronized first, and then perform the SelectiveSync operation on the Product model with the groceryListID?\r\n\r\nI am open to any suggestions to simplify this process !\r\n\r\nThank you for your help!\r\n\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"iartemiev"},"body":"Hey @hmisonne, I think there is a way that you can accomplish this. \r\n\r\n`DataStore.configure` needs to be called _before_ DataStore starts, however, you can try something like this:\r\n\r\nSet up a sync expression that will initially return no results for `Product`, e.g., \r\n\r\n```js\r\nlet groceryListID = '';\r\n\r\nDataStore.configure({\r\n  syncExpressions: [\r\n    syncExpression(Product, () => {\r\n      return (c) => c.groceryListID('eq', groceryListID);\r\n    }),\r\n  ],\r\n});\r\n```\r\n\r\nAfter DataStore performs its initial sync, there should be no records in the local store for Product. \r\n\r\nThen you can do:\r\n\r\n```js\r\nasync getGroceryListIDForSync() {\r\n  const users = await DataStore.query(User)\r\n  const userID = users[0].id\r\n  \r\n  // same groceryListID that's being passed to the sync expression\r\n  groceryListID = await fetchUserGroceryLists(userID) \r\n  await DataStore.stop();\r\n  await DataStore.start();\r\n}\r\n```\r\n\r\nThis will cause DataStore to re-evaluate that sync expression and apply the new value to the sync query. Once the sync completes, you should only have Product records stored locally that match the specified `groceryListID`."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yOTMzOA==","author":{"login":"samputer"},"title":"Datastore optional models","body":"Hi,\r\n\r\nI have a web app built using Amplify and Vue. I'm currently exploring migrating to the new DataStore way of doing things, as I love the concept and it will hopefully make my life a whole lot easier!\r\n\r\nThe problem is, I have quite a large number of models, some of which have hundreds of thousands of entries. I'd prefer to not sync all of these but handle them independently. I find that as soon as the sync starts, it attempts to pull down all of these, fetching needless data and timing out.\r\n\r\nI have looked into `syncExpression`, but is there any way I can exclude a model from the sync entirely?\r\n\r\nThanks,\r\nSam","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"iartemiev"},"body":"Hey @samputer, there's not currently a documented way of disabling sync for a model, but we intend to add that capability soon. \r\n\r\nAs a workaround in the meantime, you can change the `syncable` value to `false` in ./models/schema.js for the model(s) you'd like to exclude from syncing. \r\n\r\nYou'll need to do this every time after running `amplify codegen models` since that will overwrite the value."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMDMyMg==","author":{"login":"yaquawa"},"title":"How to list ALL objects but not the ones created by \"owner\" ?","body":"For example I have the following schema\r\n```graphql\r\ntype Post @model @auth(rules: [{ allow: owner }]) {\r\n  id: ID!\r\n  title: String!\r\n}\r\n```\r\n\r\nThis gives me only the posts that created by the currently logged in user.\r\n```graphql\r\nquery MyQuery {\r\n  lisPosts {\r\n    items {\r\n      id\r\n      title\r\n    }\r\n  }\r\n}\r\n```\r\n\r\nI'm going to create the admin page, which could list all the posts created by all users.\r\nHow can I do that?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"yaquawa"},"body":"I found that I can accomplish it by add another rule which allow user in the admin group access it.\r\nI'm not sure if this is the recommended way to do this. Anyone know this?\r\n\r\n```graphql\r\ntype Post @model @auth(rules: [\r\n    { allow: owner },\r\n    {\r\n        allow: groups,\r\n        groups: [\"Admins\"],\r\n        operations: [read, update, delete]\r\n    }\r\n]){\r\n    id: ID!\r\n    title: String!\r\n}\r\n```"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yOTk1MA==","author":{"login":"corasan"},"title":"How do I make authenticated requests to Amplify GraphQL using Firebase Auth as OIDC?","body":"I need help setting up Firebase Auth + Amplify GraphQL. I'm trying to log in using federated sign with securetoken.google.com/PROJECT-ID as the provider, and it seems to log in alright because when I call `Auth.currentAuthenticatedUser()` I get the token, and when listening to Hub \"signIn\" event I get the token. My problem is making authenticated requests to my GraphQL API.\r\n\r\n```javascript\r\nconst signIn = async () => {\r\n  try {\r\n    // already logged in using firebase so I just need to get the token from the current user\r\n    const tokenResult = await currentUser?.getIdTokenResult()\r\n    await Auth.federatedSignIn('securetoken.google.com/PROJECT-ID', {\r\n      token: tokenResult?.token,\r\n    })\r\n    const res = await Auth.currentAuthenticatedUser()\r\n    console.log('token', res.token) // eyjhxxxxxxxxxx...\r\n  } catch (error) {\r\n    // ...\r\n  }\r\n}\r\n```\r\n\r\n```javascript\r\nconst client = new AWSAppSyncClient({\r\n  url: AppSyncConfig.aws_appsync_graphqlEndpoint,\r\n  region: AppSyncConfig.aws_appsync_region,\r\n  auth: {\r\n    type: AppSyncConfig.aws_appsync_authenticationType,\r\n    jwtToken: () => getToken(),\r\n  },\r\n})\r\n\r\nconst getToken = async () => {\r\n  const token = await Cache.getItem('@accessToken')\r\n  return token\r\n}\r\n```\r\n\r\nWhen calling `Auth.currentSession()` I get \"No current user\". Also, I do see the token in the Authorization header when I attempt to fetch data.\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMzczMg==","author":{"login":"stayingcool"},"title":"Storage.list returning an incorrect list of files","body":"**Issue**\r\nStorage.list is returning an incorrect list of files.\r\n\r\n**Expected behavior**\r\nThe list API should return files only for specific ID (Example - 125).\r\n\r\n**To Reproduce**\r\nHere is the screenshot of my UI showing an incorrect list of files being returned:\r\n<img width=\"195\" alt=\"Screen Shot 2020-10-06 at 8 30 53 pm\" src=\"https://user-images.githubusercontent.com/31205483/95184437-14b8fa80-0813-11eb-978e-3c3e40eb8717.png\">\r\n\r\nThe API was invoked with the ID as 125. However, the result came up with the list of files for IDs (125, 1250,  1256 ...).\r\n\r\n**Code Snippet (Excerpt)**\r\n```\r\nimport { Storage } from \"aws-amplify\";\r\n\r\nexport function getAttachments(ID) {\r\n  const path = {\r\n    public: \"uploads/orders/tax/attachments/\",\r\n  };\r\n\r\n  return function (dispatch) {\r\n     return Storage.list(ID, {\r\n        customPrefix: path,\r\n      })   \r\n  };\r\n}\r\n```\r\n\r\n**Env**\r\npackage.json:\r\n\"aws-amplify\": \"^3.0.13\",\r\n\r\nAmplify CLI:\r\n4.25.0","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"ashika01"},"body":"@stayingcool Sorry I dont understand you request for ID here. `Storage.list` can only take input as path. Can you brief more on this so I can help.\r\n\r\nAlso, if you are trying to get all file under `125/`, I suggest you make a call something along these lines,\r\n\r\n`Storage.list('uploads/orders/tax/attachments/125/')`"}},{"node":{"author":{"login":"stayingcool"},"body":"This is the excerpt code from my other project with Amplify Version (\"aws-amplify\": \"1.2.4\",) which seems to be working fine.\r\n```\r\ngetListOfAttachments(ID: string): Promise<Attachment[]> {\r\n        return new Promise((resolve, reject) => {\r\n            Storage.list(ID, {\r\n                customPrefix: this.customPrefix\r\n            }).then(function (results) {\r\n                results.map(item => {\r\n                    return new Attachment(\r\n                        item.key,\r\n                        item.lastModified,\r\n                        item.size\r\n                    );\r\n                });\r\n                resolve(results);\r\n            }).catch(function (results) {\r\n                reject(results)\r\n            });\r\n        });\r\n    }\r\n```\r\n\r\nI think this issue is with customPrefix. Not sure if the current version of Storage.list API went through change due to which the API returns all the bucket contents with a begins with clause maybe!\r\n\r\nAs per your suggestion, If I invoke the API as follows then the API returns an empty response:\r\n```\r\ngetListOfAttachments(ID) {\r\n    let path = `uploads/orders/tax/attachments/${ID}`\r\n    return Storage.list(path);\r\n  }\r\n```\r\n**Request in Chrome**\r\n<img width=\"1377\" alt=\"Screen Shot 2020-10-07 at 10 46 41 am\" src=\"https://user-images.githubusercontent.com/31205483/95271921-df4ff380-088a-11eb-9343-3f352f6408e4.png\">\r\n\r\n**Response in Chrome**\r\n<img width=\"902\" alt=\"Screen Shot 2020-10-07 at 10 51 00 am\" src=\"https://user-images.githubusercontent.com/31205483/95272100-3c4ba980-088b-11eb-829b-acbcfa4a4ff4.png\">\r\n\r\n\r\n**This is the path where the attachments are being stored:**\r\n<img width=\"899\" alt=\"Screen Shot 2020-10-07 at 10 24 42 am\" src=\"https://user-images.githubusercontent.com/31205483/95271327-597f7880-0889-11eb-85fe-473f307b241f.png\">\r\n\r\n"}},{"node":{"author":{"login":"ashika01"},"body":"@stayingcool The older version of Amplify was using `aws-sdk-js` v2 but the latest ones use https://github.com/aws/aws-sdk-js-v3. Looking at ts file for the call, it was the path. I will try custom prefix and update here in a while. Thanks for the info, let me get back with some code snippets."}},{"node":{"author":{"login":"ashika01"},"body":"@stayingcool : Hey, sorry my suggestion was wrong. Apologies from my end.\r\n\r\nCould you turn on the the Amplify debug logger by following to `App.js` \r\n`Amplify.Logger.LOG_LEVEL = 'DEBUG';`\r\n\r\nAnd what the list file resolves to. Screenshot similar to this,\r\n\r\n![Screen Shot 2020-10-07 at 5 15 03 PM](https://user-images.githubusercontent.com/35131273/95401030-0a553a00-08c1-11eb-9630-a9e17359b6e7.png)\r\n"}},{"node":{"author":{"login":"stayingcool"},"body":"<img width=\"1250\" alt=\"Screen Shot 2020-10-08 at 1 02 29 pm\" src=\"https://user-images.githubusercontent.com/31205483/95406804-0c71d400-0967-11eb-99d4-68c6f2f3196b.png\">\r\n"}},{"node":{"author":{"login":"ashika01"},"body":"@stayingcool I would like you to try do that list with `125/` rather than `125` you have here. That should fix the issue for you."}},{"node":{"author":{"login":"stayingcool"},"body":"Yes. That forward slash towards the end added now gets the exact list of files under that path. I'm hoping that there is not going to be any other issue 😊\r\n\r\n**Code Snippet (Excerpt)**\r\n\r\n```\r\nimport { Storage } from \"aws-amplify\";\r\n\r\nexport function getAttachments(ID) {\r\n  const path = {\r\n    public: \"uploads/orders/tax/attachments/\",\r\n  };\r\n\r\n  return function (dispatch) {\r\n     return Storage.list(`${ID}/`,, {\r\n        customPrefix: path,\r\n      })   \r\n  };\r\n}\r\n```\r\n\r\nThank you for your time, we can close this issue."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNDk2","author":{"login":"mrichman"},"title":"How to map Cognito identity ids to user pool ids?","body":"I'm using the Storage APIs, and I see it creating `/private/<identity_id>/foo.txt` etc. However, there's no obvious way to see which user pool user this `<identity_id>` maps to.\r\n\r\nMy Cognito auth role specifies `arn:aws:s3:::<my_bucket>/private/${cognito-identity.amazonaws.com:sub}/*` which, as I understand, is **not** the user pool sub claim, but rather the `<identity_id>`. (Do I have that wrong?)\r\n\r\nSo how do I know which users all those S3 objects under `/private/<identity_id>/` map to?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"mrichman"},"body":"I have a bit of a workaround. When I sign in, I am doing this:\r\n\r\n```javascript\r\nAuth.currentUserInfo().then(info => {\r\n    Storage.put('userInfo.json', JSON.stringify(info), { level: 'private', contentType: 'application/json' });\r\n  });\r\n```\r\n\r\nThis gives me:\r\n\r\n```json\r\n{\r\n  \"id\": \"us-east-1:c1ecd265-dead-beef-cafe-fa0cffa42ff1\",\r\n  \"username\": \"688746f8-dead-beef-cafe-0c3de99fff98\",\r\n  \"attributes\": {\r\n    \"sub\": \"688746f8-dead-beef-cafe-0c3de99fff98\",\r\n    \"email\": \"user@example.com\"\r\n  }\r\n}\r\n```\r\n\r\nI suppose I can use this as a lookup if needed."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yODk4MQ==","author":{"login":"adsk-alexand"},"title":"How can you get the next 1000 records in the S3 bucket?","body":"https://github.com/aws-amplify/amplify-js/blob/958f61ef2918728cc46b9b210d60e868edd87f39/packages/storage/src/providers/AWSS3Provider.ts#L395","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"sammartinez"},"body":"Hello @adsk-alexand, \r\nS3 does have a limit as to how many records can be returned in a single request. From this [documentation on the S3 SDK](https://docs.aws.amazon.com/AWSJavaScriptSDK/latest/AWS/S3.html#listObjects-property), there is a limit of 1000. "}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yODgxMg==","author":{"login":"roysailor"},"title":"How to use custom on submit handler with AmplifySignUp?","body":"Hey, \r\n\r\nI am using the AmplifySignUp component from '@aws-amplify/ui-react' package. \r\n\r\nWhat I am trying to achieve here is:\r\n\r\n1. Add a custom field \"Organisation\" to the submit form.\r\n2. Write a custom handler to register the user manually and also create an organization for him in the database.\r\n\r\nFollowing is the sample code:\r\n\r\n```\r\nimport React, {useEffect, useState} from 'react';\r\nimport { AmplifyAuthenticator, AmplifySignIn, AmplifySignUp, AmplifyForgotPassword } from '@aws-amplify/ui-react';\r\nimport '../styles/App.scss';\r\nimport { AuthState, onAuthUIStateChange } from '@aws-amplify/ui-components';\r\nimport ProtectedRoutes from './ProtectedRoutes';\r\n\r\nfunction App() {\r\n\r\n  const [authState, setAuthState] = React.useState();\r\n  const [user, setUser] = React.useState();\r\n\r\n  const onSignup = (event) => {\r\n\r\n    event.preventDefault();\r\n\r\n    const { organisation, username, password, name } = event.target;\r\n\r\n    console.log(organisation, username, password, name);\r\n\r\n  }\r\n\r\n  useEffect(() => {\r\n\r\n      return onAuthUIStateChange((nextAuthState, authData) => {\r\n          setAuthState(nextAuthState);\r\n          setUser(authData)\r\n      });\r\n\r\n  }, []);\r\n\r\n  return ( authState === AuthState.SignedIn && user ) \r\n  ? \r\n  (\r\n    <ProtectedRoutes />\r\n  ) \r\n  : \r\n  (\r\n            <AmplifyAuthenticator>\r\n                <AmplifySignIn headerText=\"Login\" usernameAlias=\"email\" submitButtonText=\"Continue\" slot=\"sign-in\" />\r\n                <AmplifySignUp \r\n                  headerText=\"Signup for a free Listen2It account\" \r\n                  slot=\"sign-up\"\r\n                  handleSubmit={onSignup} \r\n                  formFields={[\r\n                    { \r\n                      type: \"organisation\",\r\n                      label: \"Organisation *\",\r\n                      placeholder: \"Enter Organisation name\",\r\n                      required: true\r\n                    },\r\n                    { \r\n                      type: \"username\",\r\n                      label: \"Email *\",\r\n                      placeholder: \"Enter your email\",\r\n                      required: true\r\n                    },\r\n                    { \r\n                      type: \"password\"\r\n                    },\r\n                    { \r\n                      type: \"name\",\r\n                      label: \"Name *\",\r\n                      placeholder: \"Enter your name\",\r\n                      required: true,\r\n                    }\r\n                  ]}\r\n                />\r\n                <AmplifyForgotPassword \r\n                  headerText=\"Recover Password\"  \r\n                  slot=\"forgot-password\"\r\n                  usernameAlias=\"email\"\r\n                />\r\n              </AmplifyAuthenticator>\r\n  );\r\n\r\n} \r\n\r\n\r\nexport default App;\r\n\r\n```\r\n\r\nThe issues which I am facing here are:\r\n\r\n1. I am getting organisation, username, password, and name as undefined in onSignup function.\r\n2. I have marked the fields as required, still, I am able to submit the blank form.\r\n3. If I have to validate the form manually, then how do I display the errors?\r\n\r\nAny clue how to achieve this? Please guide.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yODQ4MA==","author":{"login":"ffxsam"},"title":"Questions about security and Cognito user pools","body":"Should we be keeping our Cognito user pool ID secure (maybe obfuscate it in the client)? I've realized something, that if someone obtains the user pool ID, then they can grab the keys via:\r\n\r\n`https://cognito-idp.us-east-1.amazonaws.com/<user pool ID>/.well-known/jwks.json`\r\n\r\nAnd then they'd be able to use those to decode their JWT tokens, figure out how to modify certain claims, and then forge JWT tokens and set in their browser to make false claims.\r\n\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"ffxsam"},"body":"Ah, of course. These are _public_ keys we can access, not private keys for signing JSON objects.\r\n\r\nI'm relatively new to working with JWTs. 😬 "}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNzQ1MQ==","author":{"login":"andrei-gheorghiu"},"title":"What's the difference between `aws-amplify-vue` and `@aws-amplify/vue-ui`?","body":"It looks like they contain a lot of overlapping content. Found a few guides and tutorials featuring one or the other. They have both been updated 3 days ago and they seem to have the same contributors. \r\n\r\nThis leads to the conclusion they are both up to date and maintained, but it would be nice to have someone more _in-the-know_ write up a little explanation on why there are two packages. \r\n\r\nScope, purpose, reasoning, recommended usage. \r\n\r\nA nice bonus would be to know if any one of them is more TypeScript friendly.\r\n\r\nThank you.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"morgler"},"body":"To me it seems that vue-ui is the modern way of injecting Amplify components into a vue app. Please correct me, if I'm wrong."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNzg2OA==","author":{"login":"castledraw"},"title":"Unable to verify secret hash for client","body":"Hi, everybody\r\n\r\nI have the same issue reported in https://github.com/aws-amplify/amplify-js/issues/1368\r\nI want to login my amplify app with a cognito appclient with secret key. There is required for me, because i configured an elasticsearch instances with cognito, and automatically thats created an appclient with secretkey. So i want to load a dashboard kibana in my amplify app, but i received de same error Unable to verify secret hash for client. \r\n\r\nI can't create another appclient without secret key, because elasticsearch use another with this.\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNzgwNQ==","author":{"login":"Raghvendra0601"},"title":"Getting notfication.foreground as undefined in onNotification handler for iOS","body":"I am handling remote push notification in foreground state for react native app. Below is code of onNotification handler\r\n\r\nPushNotification.onNotification(async (notification) => {\r\n    if (notification.foreground) {\r\n      console.log('in app notification', notification);\r\n      // RootNavigation.navigate('Notifications');\r\n    } else {\r\n      console.log('onNotification data', notification);\r\n      const userRole = await getItem('userRole');\r\n      if (userRole) {\r\n        //Navigation to diff screens\r\n      }\r\n    }\r\n\r\nWhen callback is made to onNotification handler then for android I am getting notification.foreground as true and flow is working as per expectation but for iOS it is undefined. Can you please let me know, How I can fix the issue?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNTE4Mw==","author":{"login":"roysailor"},"title":"How to customise the CSS of the button or toast component from @aws-amplify/ui-react package","body":"Hey,\r\n\r\nI am using several components from @aws-amplify/ui-react to build an Auth flow in a React application.\r\n\r\nI am not able to figure out how to customize the CSS of components like SignIn Button or Toast message.\r\n\r\nAny clue how to change those?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"sw-yx"},"body":"amplify uses web components under the hood. apply css or css variables directly. see the docs https://docs.amplify.aws/ui/customization/customizing-css/q/framework/react"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNzI5NA==","author":{"login":"yaquawa"},"title":"How to setup Lambda triggers?","body":"I'm reading https://docs.amplify.aws/cli/usage/lambda-triggers#set-up-lambda-triggers\r\n\r\nBut what's the command that bring me this:\r\n```\r\n$ Do you want to enable any of the following capabilities?\r\n  ❯ ◯ Add Google reCaptcha Challenge\r\n    ◯ Email Verification Link with Redirect\r\n    ◯ Add User to Group\r\n    ◯ Email Domain Filtering (deny list)\r\n    ◯ Email Domain Filtering (allow list)\r\n    ◯ Custom Auth Challenge Flow (basic scaffolding - not for production)\r\n    ◯ Override ID Token Claims\r\n```\r\nBy the way, I have ran `amplify add auth` already.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"sw-yx"},"body":"i think you can run `amplify configure auth` and look for manual options. \r\n\r\n@mauerbac i think this is a docs question"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNzE4NQ==","author":{"login":"0x54321"},"title":"AmplifyTotpSetup errors","body":"Hi,\r\nI have configured a User Group to require MFA (TOTP), and added the AmplifyTotpSetup component to my app. However, the verification flow simply does not work.\r\n\r\nAfter the user sets their password, the TOTP screen appears, but without a QR code (it's just a broken image). After refreshing the page and re-entering credentials, a proper QR code is displayed, but with an error on top: \"Only one request to update user Software Tokens can be processed at a time.\"\r\n\r\nI've tried for hours, but just cannot get this to work. Please advise!\r\n\r\nThank you.\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNjg1MA==","author":{"login":"antimonad"},"title":"Risk of unauthorized use of public/client-side Amplify Config Paramters by third-parties","body":"Ahoi all,\r\n\r\nWhat are the security/privacy consequences of an unauthorited third-party using the public configuration of an amplify client in their application?\r\n\r\nWhat risks does such \"unauthorized config use\" pose to the operation of legitimate/authorized amplify/cognito clients?\r\n\r\nWhat *data* would this potentially make available to third parties, if fe. they manage to trick users to provide their creds on a fishing site f.e.?\r\n\r\nIf the scenario of unauth-config-use is a true risk, what mitigation strategies are available?\r\n\r\nAny hints/pointers available to previous discussions regarding such topics in context of amplify/cognito-public api?\r\n\r\nThanks in advance","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"antimonad"},"body":"To clarify, the most important config visible publicly is probably the oauth config (client-id(no-secret), user-pool).\r\nThe question seeks to clarify the risks arising from unauthorized use of that config.\r\ntia,cheers\r\n"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNjkwNQ==","author":{"login":"htunnicliff"},"title":"Refactor amazon-cognito-identity-js to use Promises instead of callbacks","body":"We are using `amazon-cognito-identity-js` pretty heavily at my organization. Right now, we are forced to write wrappers around most of the library in order to use promises instead of callbacks. \r\n\r\nI would be happy to submit a pull request that refactors this package to use promises. There are two obvious strategies for refactoring:\r\n\r\n### 1. Completely replace callbacks with async/await and Promises\r\n\r\nPros | Cons\r\n-----|------\r\n⭐️ Promises! | 🚫 Breaking API changes\r\n⭐️ Smaller codebase | 🚫 Major version change\r\n⭐️ No more callback hell | \r\n\r\n### 2. Add async/await and Promises while maintaining existing callback APIs\r\n\r\nPros | Cons\r\n-----|------\r\n⭐️ Promises! | 🚫 Larger codebase\r\n⭐️ Preserves backwards compatibility | 🚫 Conditional logic everywhere\r\n⭐️ Minor version change | \r\n\r\nIs this sort of alteration a favorable improvement @ericclemmons, @sammartinez, @iartemiev? ","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNjg4MA==","author":{"login":"ekailly"},"title":"Does Sign in with Apple via Cognito/Amplify support React Native apps made with Expo managed workflow?","body":"Hello, \r\n\r\nI have a project that's currently made with Expo's managed workflow and we're on SDK version 38. We use Cognito/Amplify for sign in with Facebook and Google without issue. I have attempted to follow [these docs](https://docs.amplify.aws/lib/auth/social/q/platform/js) to a tee, but I have not been successful setting up Sign in with Apple on standalone builds. \r\n\r\nI have a hunch that this may only be supported only in either a vanilla React Native project or an Expo project made in the bare workflow, as one comment from [an Amplify contributor](https://github.com/aws-amplify/amplify-js/issues/6547#issuecomment-674070922) in a bug report similar to this problem asked the author of the bug report if they've configured their URL scheme in `Info.plist`.  I do have the code snippet being used in the docs for a custom `urlOpener` and Expo's `WebBrowser`, but I'm still unsuccessful with that.\r\n\r\nI can share my configuration details if necessary, but it would be really awesome to hear from any other members in this community that got Sign in with Apple to work with an Expo managed workflow project so I could learn what I'm doing wrong here!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNDU5OQ==","author":{"login":"john-redd"},"title":"Amplify Auth: Custom Storage","body":"I'm trying to implement a custom storage solution to avoid having the Cognito JWT's stored in localStorage or on a non httpOnly cookie, but there isn't very good documentation on all the methods that need to be defined in the custom Storage class that gets passed to the Amplify configure method.\r\n\r\nI currently have the following methods on my custom Storage class:\r\n\r\n```js\r\nsetItem(key, value) => string\r\ngetItem(key) => string\r\nremoveItem(key) => string\r\nclear() => object\r\n```\r\n\r\nAfter diving into the source code, it looks like [this](https://github.com/aws-amplify/amplify-js/blob/2b4f6d8c5377cee9be0446ed9f75fa8fa1ce5803/packages/auth/src/Auth.ts#L2047) is what is expected. But then later on they look for another method name [sync](https://github.com/aws-amplify/amplify-js/blob/2b4f6d8c5377cee9be0446ed9f75fa8fa1ce5803/packages/auth/src/Auth.ts#L163) and there is no good documentation about what parameters it is expected to accept, if any, and what it should return, if anything.\r\n\r\nAny help would be much appreciated.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"Rajan-Gupta1"},"body":"@john-redd Were you able to find an answer to this ? I was able to register sync() method but on debugging setItem is not getting called but getItem and sync are being called which indicates there is a bug. Can anyone confirm?"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNjYzNQ==","author":{"login":"daviddeslauriers"},"title":"Using same Admin Query for two different apps","body":"So here's my situation...I have two React apps that need to talk to the same Cognito User Pool. I've been able to accomplish this by copying the aws-exports.js file from the first app to the second app I created (not sure if this is something I should be doing or not but it is working). The issue I am having however is when I run an Admin Query on the second app (to say list users in the Cognito User Pool) I get a 403 (Forbidden) error. Has anyone ever run into this before? Googling all day has not helped me so I figured I would ask.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"undefobj"},"body":"The A[dmin Queries code uses an environment variable](https://github.com/aws-amplify/amplify-cli/blob/4e5f5c62287252ff59ecda050390e9b3c2b00146/packages/amplify-category-auth/resources/adminAuth/admin-auth-cognitoActions.js#L18) for the current user pool configured for a CLI project.\r\n\r\nIf you wanted this to leverage another User Pool you could potentially alter this code or change the variable, but note that the Lambda Function which is interfacing with the other User Pool needs to be granted appropriate permissions to perform such an action."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNjY2OQ==","author":{"login":"vrebo"},"title":"Is possible the dynamic configuration of the API module?.","body":"Hi community!.\r\n\r\nI have a question regarding if it's possible to configure the API module at runtime via the API.configure() function?.\r\n\r\nMy use case is the following.\r\n\r\nI have an app in react native that initially works through Cognito Pool Authorization. With this configuration a specific user profile can configure some settings in the app (between them the app authorization through API Key). From there, the app is ready to be used by unauthorized users and should use this new configuration until the API Key expires or the configuration is changed by the logged user.\r\n\r\nIs this behavior possible?\r\n\r\nThanks in advance.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"vrebo"},"body":"From @dabit3 in the #graphql-help Channel in Discord. \r\n\r\n> Yes, this is works fine and is an approach I've seen taken.\r\n> \r\n> Keep in mind too that you can switch authorization modes for API calls by overriding the default auth mode: \r\n> \r\n> https://docs.amplify.aws/lib/graphqlapi/authz/q/platform/js"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNjQ3OA==","author":{"login":"paulsjohnson91"},"title":"Facebook user pool login through hosted ui, can you get a facebook token to retrieve a users friends?","body":"I've given users the ability to log into a react native app with facebook federated sign in using aws amplify hosted UI.\r\nI'm trying to work out how to give the user the ability to see their facebook friends to add them on the app, is there a way to do this? I guess I'd need an auth token for facebook api.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNjQyNw==","author":{"login":"RoniFinTech"},"title":"amazon-cognito-identity-js confirm that email and username (preferred username) are both unique","body":"I tried playing with the Cognito User Pool setup properties and I can either have username unique or email uniqu but never both unique.\r\nIs it even possible>?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNjM0Ng==","author":{"login":"Rajan-Gupta1"},"title":"Angular UI Component routing user to Home after a successful login","body":"I have been able to integrate Angular UI Comp and auth seems to be working fine. However the problem I am having is not knowing where to put code to route the user to home component when AuthGuard is enabled and router-outlet is in-place. I need to route user to by doing this\r\nthis.router.navigate(['/home']) but do not understand where to put that.\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNjMwMA==","author":{"login":"joshuafernandes1996"},"title":"\"Amazon\" Federated Identity Sign In using Amplify","body":"I am trying to Sign in using \"LoginWithAmazon\", See code below\r\n\r\n  const handleAmazonLogin = (event) => {\r\n    event.preventDefault();\r\n    console.log(window)\r\n    options = {};\r\n    options.scope = 'profile';\r\n    options.pkce = true;\r\n    window.amazon.Login.authorize(options, function(response) {\r\n      if (response.error) {\r\n        console.error('oauth error ' + response.error);\r\n        return;\r\n      }\r\n      window.amazon.Login.retrieveToken(response.code, function(response) {\r\n        if (response.error) {\r\n          console.error('oauth error ' + response.error);\r\n          return;\r\n        }\r\n        const acc_token = response.access_token;\r\n        const expires_at = response.expires_in;\r\n\r\n        window.amazon.Login.retrieveProfile(response.access_token, function(response) {\r\n\r\n          if (window.console && window.console.log)\r\n            window.console.log(response);\r\n\r\n          const user = {\r\n            name: response.profile.Name,\r\n            email: response.profile.PrimaryEmail\r\n          };\r\n\r\n          aws_amplify.Auth.federatedSignIn(\r\n            'loginWithAmazon', {\r\n              token: acc_token,\r\n              expires_at\r\n            },\r\n            user\r\n          );\r\n\r\n          // location.reload();\r\n        });\r\n      });\r\n    });\r\n  }\r\n\r\nbut when I use amplify to validate access_token, it says\r\n\r\nUncaught (in promise) NotAuthorizedException: Invalid login token. Not a valid OpenId Connect identity token.\r\n\r\nI have done the same for Facebook and Google, But I am struggling to understand why this is not working for amazon.\r\n\r\nAny help would be appreciated.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNjI1OQ==","author":{"login":"Zinga9"},"title":"Cookies not getting stored in iOS using amazon-cognito-identity-js","body":"Hi there,\r\n\r\nWe're using the amazon-cognito-identity-js for authenticating the user in our ionic - angular app.\r\n\r\nIt works really nice in web!\r\n\r\nThe only question I have is around the cookies. As expected, when i mention the CookieStorage the cookies are getting added in web and also on Android app.\r\nimport { CognitoUserPool, CognitoUser, CookieStorage } from 'amazon-cognito-identity-js';\r\n\r\nvar pool = new CognitoUserPool({\r\n  UserPoolId: COGNITO_USER_POOL_ID,\r\n  ClientId: COGNITO_CLIENT_ID,\r\n  Storage: new CookieStorage({ domain: DOMAIN })\r\n});\r\n\r\nvar user = new CognitoUser({\r\n  Username: username,\r\n  Pool: pool,\r\n  Storage: new CookieStorage({ domain: DOMAIN })\r\n});\r\n\r\n\r\nHowever when i run the same on iOS app, cookies are not getting set.\r\n\r\nCan someone guide me in getting this worked.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNTg4MA==","author":{"login":"sharayup12"},"title":"NEED Help Not able to read the data from s3 bucket","body":"Hi there,\r\n\r\nI have created an android application using Amplify storage, in which amplify creates a folder in s3 bucket named pulic and by using thier functions it creates an object in the public folder(e.g xyz.txt file). but when im trying to read that folder using a esp32 wroom in board(hifi1 rev b) im not able to read the data somebody please help.\r\n\r\nfollowing is the log im getting\r\nesp32>\r\nready\r\nATE0\r\nesp32> ATE0\r\nesp32>\r\nOK\r\nAT\r\nesp32>\r\nOK\r\nAT+CWMODE=1\r\nesp32>\r\nOK\r\nAT+CWJAP=\"ONEPLUS\",\"moho1419\"\r\nAT+CIPSTART=\"TCP\",\"risc-v-demo.s3.us-east-2.amazonaws.com\",80,2\r\nesp32> ERR CODE:0x010b0000\r\nesp32>\r\nbusy p...\r\nAT+CIPSEND=79\r\nesp32> ERR CODE:0x010b0000\r\nesp32>\r\nbusy p...GET /public\r\n/data.txt HTTP/1.1\r\nHost:risc-v-demo.s3.us-east-2.amazonaws.com\r\n\r\nesp32> ERR CODE:0x010b0000\r\nesp32>\r\nbusy p...\r\nAT+CIPCLOSE\r\nesp32> ERR CODE:0x010b0000\r\nLEDs off\r\n        esp32>\r\nbusy p...\r\n\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNDg2OQ==","author":{"login":"rohanbam"},"title":"Cloudflare Workers","body":"Does the aws-amplify/amplify-js work inside cloudflare workers where there is no node.js environment but a javascript v8 isolate instead?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNDgzOQ==","author":{"login":"lexfaraday"},"title":"Import a generated GraphQL mutation inside Lambda","body":"Hello,\r\nFollowing this example to call a mutation from a Lambda/NodeJS https://docs.amplify.aws/lib/graphqlapi/graphql-from-nodejs/q/platform/js#mutation the mutation specification (createTodo) is hardcoded, this is hard to maintain, the question is, how can import the generated mutation code by \"amplify cli\" inside a Lambda and use the API utility from AWS libraries?\r\n\r\nAn option is make a copy of the generated code inside Lambda's bundle but this is manual anyway, and for the utilities to call a GraphQL API we want to use the same code as the client, will be a great option the usage of import { API } from 'aws-amplify';\r\n\r\nThanks in advance!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNDgxMw==","author":{"login":"simon-zhangmuye"},"title":"Need help! I cannot use my schema.graphql to create my stack.","body":"Here is my schema.graphql file.\r\n`type Post @model\r\n@auth(rules: [\r\n    { allow: groups, groups: [\"Admin\"]},\r\n    { allow: owner},\r\n    { allow: public, operations: [read] }\r\n])\r\n@key(name: \"postByCreatedAt\", fields:[\"id\",\"createdAt\"], queryField:\"PostByCreatedAt\")\r\n{\r\n  id: ID!\r\n  title: String!\r\n  content: String!\r\n  username: String!\r\n  avatar: String!\r\n  createdAt: String\r\n  comment: [Comment] @connection(keyName: \"commentByPostId\", fields: [\"id\"])\r\n  postLike: [PostLike] @connection(keyName: \"postLikeByPostId\", fields: [\"id\"])\r\n}\r\n\r\ntype Comment @model\r\n@key(name: \"commentByPostId\", fields: [\"postId\"])\r\n@key(name: \"commentByCreatedAt\", fields:[\"id\",\"createdAt\"], queryField:\"CommentByCreatedAt\")\r\n@auth(rules: [\r\n    { allow: groups, groups: [\"Admin\"]},\r\n    { allow: owner},\r\n    { allow: public, operations: [read] }\r\n])\r\n{\r\n  id: ID!\r\n  postId: ID!\r\n  content: String!\r\n  username: String!\r\n  avatar: String!\r\n  createdAt: String\r\n  commentLike: [CommentLike] @connection(keyName: \"commentLikeByCommentId\", fields: [\"id\"])\r\n  post: Post @connection(fields: [\"postId\"])\r\n}\r\n\r\n\r\ntype PostLike @model\r\n@key(name: \"postLikeByPostId\", fields: [\"postId\"])\r\n@key(name: \"postlikeByCreatedAt\", fields:[\"id\",\"createdAt\"], queryField:\"PostlikeByCreatedAt\")\r\n@auth(rules: [\r\n    { allow: groups, groups: [\"Admin\"]},\r\n    { allow: owner},\r\n    { allow: public, operations: [read] }\r\n])\r\n{\r\n  id: ID!\r\n  postId: ID!\r\n  username: String!\r\n  avatar: String!\r\n  category: Category\r\n  createdAt: String\r\n  post: Post @connection(fields:[\"postId\"])\r\n}\r\n\r\ntype CommentLike @model\r\n@key(name: \"commentLikeByCommentId\", fields: [\"commentId\"])\r\n@key(name: \"commentlikeByCreatedAt\", fields:[\"id\",\"createdAt\"], queryField:\"CommentlikeByCreatedAt\")\r\n@auth(rules: [\r\n    { allow: groups, groups: [\"Admin\"]},\r\n    { allow: owner},\r\n    { allow: public, operations: [read] }\r\n])\r\n{\r\n  id: ID!\r\n  commentId: ID!\r\n  username: String!\r\n  avatar: String!\r\n  category: Category\r\n  createdAt: String\r\n  comment: Comment @connection(fields:[\"commentId\"])\r\n}\r\n\r\nenum Category {\r\n  like\r\n  dislike\r\n}`\r\n\r\nWhen I use amplify push, the console gives me this error.\r\n![2](https://user-images.githubusercontent.com/10706610/96067609-e5c31880-0ee5-11eb-8c5f-8f1ff058e31d.png)\r\n![3](https://user-images.githubusercontent.com/10706610/96067624-ee1b5380-0ee5-11eb-9b9d-4f64794a7b25.png)\r\n![4](https://user-images.githubusercontent.com/10706610/96067637-f1aeda80-0ee5-11eb-8b02-7841d4c74a64.png)\r\n![5](https://user-images.githubusercontent.com/10706610/96067641-f4a9cb00-0ee5-11eb-905e-aad1fd28f435.png)\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNDY4NA==","author":{"login":"simon-zhangmuye"},"title":"What is the best practice for adding a local secondary index after creating dynamodb table?","body":"I just learn AWS Amplify and want to add a new sort key in my schema.graphql.\r\nWhen I use amplify push, it rises an error \"you cannot add a local secondary index in your dynamodb, local secondary indexes can only be created when creating dynamodb\".\r\nWhat should I do in this case？\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNDI5NA==","author":{"login":"An0r4k"},"title":"How to update push notifications channels using amplify-cli","body":"Problem: Unable to update the notifications to use FCM.\r\n\r\nSteps to reproduce: \r\n1. Create a react native project\r\n2. Add notifications using \"amplify add notifications\"\r\n3. Choose the APN channel and follow the steps provided in the Amplify documentation\r\n4. Now try to update the notifications to add FCM using \"amplify update notifications\"\r\n\r\nDescription:\r\nI'm building a react native application, and for push notifications I decided to go with Amplify notifications (Pinpoint). First I added Apple Push Notifications (APN) using amplify cli \"amplify add notifications\" and selecting the APN channel. It worked well. Then I wanted to add another channel FCM (Firebase Cloud Messaging), I tried using \"amplify update notifications\" and choosing FCM, it gives an error saying \"No resources to update\"( See the attached screenshot)\r\n\r\n<img width=\"696\" alt=\"Screen Shot 2020-10-08 at 2 51 21 PM\" src=\"https://user-images.githubusercontent.com/68049549/95792344-2e859200-0c98-11eb-8976-2c8b791a5fa6.png\">\r\n\r\n\r\nSince it didn't workout I tried using \"amplify add notifications\", it says \"Notifications is migrated from Mobile Hub and channels cannot be added with amplify CLI\".\r\n<img width=\"645\" alt=\"Screen Shot 2020-10-08 at 2 54 33 PM\" src=\"https://user-images.githubusercontent.com/68049549/95792396-46f5ac80-0c98-11eb-9372-5f7bd5a7f9bf.png\">\r\n\r\nThen as a last resort I tried adding FCM using the AWS console (the website). It asked me the ApiKey which I provided. And it said FCM is enabled and seemed like everything has fallen in place. \r\n<img width=\"1140\" alt=\"Screen Shot 2020-10-08 at 2 59 12 PM\" src=\"https://user-images.githubusercontent.com/68049549/95792409-4ceb8d80-0c98-11eb-9940-b6dc7e42dc68.png\">\r\n\r\nNow I went back to my repo and tried to pull from the AWS cloud to update my workspace with the FCM configuration. I tried using \"amplify pull\". And it says \"Update channel error, there was an error initializing your environment. Missing required key 'ApiKey' in params.GCMChannelRequest \". But when I tried to pull it didn't prompt me to enter ApiKey. Isn't it enough to add the ApiKey in the console. How do I provide the ApiKey from the amplify cli. I want to add the FCM channel to my notifications project. Any help will be greatly appreciated. Thank you in advance. \r\n<img width=\"1008\" alt=\"Screen Shot 2020-10-08 at 3 01 24 PM\" src=\"https://user-images.githubusercontent.com/68049549/95792458-64c31180-0c98-11eb-8034-026e14e1a44f.png\">\r\n\r\n\r\n\r\n\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNDUxOQ==","author":{"login":"duncangroenewald"},"title":"Why am I unable to create an object relationship in Lambda function?","body":"I am trying to get a list of video objects with some properties of related objects.\r\n\r\nSchema as shown below:\r\n\r\n```\r\n    type SessionType \r\n    @model\r\n    {\r\n        id: ID!\r\n        name: String!\r\n        activityTypes: [ActivityType] @connection(keyName: \"bySessionType\", fields: [\"id\"])\r\n        videos: [Video] @connection(name: \"SessionTypeVideo\")\r\n    }\r\n\r\n    type Video \r\n    @model \r\n    {\r\n        id: ID!\r\n        bucket: String!\r\n        key: String!\r\n        sessionDate: String\r\n        isReviewed: String!\r\n        reviewedBy: ID\r\n        reviewDate: String\r\n        title: String\r\n        comments: String\r\n        sessionTypeID: ID!\r\n        sessionType: SessionType @connection(name: \"SessionTypeVideo\")\r\n        activityTypeID: ID!\r\n        modeID: ID!\r\n        genderID: ID!\r\n        ageGroupID: ID!\r\n        weightCategoryID: ID!\r\n    }\r\n    \r\n    \r\n    # create the input object for the lambda function so \r\n    # we can pass in the owner - is this actually required ??\r\n\r\n    input CreateVideoInput {\r\n    \tid: ID\r\n      owner: String\r\n    \tsessionDate: String!\r\n      genderID: ID!\r\n      ageGroupID: ID!\r\n      weightCategoryID: ID!\r\n      sessionTypeID: ID!\r\n      videoSessionTypeId: ID!\r\n      activityTypeID: ID!\r\n      modeID: ID!\r\n      isReviewed: String!\r\n    \tbucket: String!\r\n    \tkey: String!\r\n    \ttitle: String\r\n    }\r\n```\r\n\r\nAppSync annotations appear to have created the `videoSessionTypeId` property in the actual graphql schema definition when viewed in AppSync console.  Although these don't show up in the generated queries and mutations which are shown below.\r\n\r\n ```\r\n   export const createVideo = /* GraphQL */ `\r\n      mutation CreateVideo(\r\n        $input: CreateVideoInput!\r\n        $condition: ModelVideoConditionInput\r\n      ) {\r\n        createVideo(input: $input, condition: $condition) {\r\n          id\r\n          bucket\r\n          key\r\n          sessionDate\r\n          isReviewed\r\n          reviewedBy\r\n          reviewDate\r\n          title\r\n          comments\r\n          sessionTypeID\r\n          sessionType {\r\n            id\r\n            name\r\n            activityTypes {\r\n              nextToken\r\n            }\r\n            modes {\r\n              nextToken\r\n            }\r\n            createdAt\r\n            updatedAt\r\n            videos {\r\n              nextToken\r\n            }\r\n          }\r\n          activityTypeID\r\n          modeID\r\n          genderID\r\n          ageGroupID\r\n          weightCategoryID\r\n          athletes {\r\n            items {\r\n              id\r\n              createdAt\r\n              updatedAt\r\n            }\r\n            nextToken\r\n          }\r\n          createdAt\r\n          updatedAt\r\n          owner\r\n        }\r\n      }\r\n    `;\r\n    \r\n    export const listVideos = /* GraphQL */ `\r\n      query ListVideos(\r\n        $filter: ModelVideoFilterInput\r\n        $limit: Int\r\n        $nextToken: String\r\n      ) {\r\n        listVideos(filter: $filter, limit: $limit, nextToken: $nextToken) {\r\n          items {\r\n            id\r\n            bucket\r\n            key\r\n            sessionDate\r\n            isReviewed\r\n            reviewedBy\r\n            reviewDate\r\n            title\r\n            comments\r\n            sessionTypeID\r\n            sessionType {\r\n              id\r\n              name\r\n              createdAt\r\n              updatedAt\r\n            }\r\n            activityTypeID\r\n            modeID\r\n            genderID\r\n            ageGroupID\r\n            weightCategoryID\r\n            athletes {\r\n              nextToken\r\n            }\r\n            createdAt\r\n            updatedAt\r\n            owner\r\n          }\r\n          nextToken\r\n        }\r\n      }\r\n    `;\r\n```\r\n\r\nCurrently the sessionType {id, name} property returned by the listVideos function is always null so I guess the create method I am using is not setting the correct properties on the Video object.  If I manually create the entry using AppSync console and setting the videoSessionTypeId property it works.\r\n\r\nThe input properties are passed as metadata when uploading the file and subsequently extracted from the S3.headObject().\r\nThe input object used in the Lambda function is as follows:\r\n\r\n ```\r\n   const item = {\r\n    \t\tid: id, \r\n        owner: metadata.owner,\r\n        sessionDate: metadata.sessiondate,\r\n        genderID: metadata.genderid,\r\n        ageGroupID: metadata.agegroupid,\r\n        weightCategoryID: metadata.weightcategoryid,\r\n        sessionTypeID: metadata.sessiontypeid,\r\n        videoSessionTypeId: metadata.sessiontypeid,               <==== \r\n        activityTypeID: metadata.activitytypeid,\r\n        modeID: metadata.modeid,\r\n        isReviewed: 'false',\r\n        bucket: bucketName,\r\n        key: key,\r\n        title: metadata.videotitle\r\n      } \r\n```\r\n\r\nThe lambda function that calls the mutate function is shown below:\r\n\r\n  ```\r\n  async function storeVideoInfo(item) {\r\n      console.log('storeVideoItem', JSON.stringify(item))\r\n      const createVideo = gql`\r\n        mutation CreateVideo(\r\n          $input: CreateVideoInput!\r\n          $condition: ModelVideoConditionInput\r\n        ) {\r\n          createVideo(input: $input, condition: $condition) {\r\n            id\r\n            sessionDate\r\n            genderID\r\n            ageGroupID\r\n            weightCategoryID\r\n            sessionTypeID\r\n            videoSessionTypeId\r\n            activityTypeID\r\n            modeID\r\n            isReviewed\r\n            title\r\n            owner\r\n            bucket\r\n            key\r\n          }\r\n        }\r\n      `;\r\n    \r\n      console.log('trying to createvideo with input', JSON.stringify(item))\r\n      const result = await client.mutate({\r\n        mutation: createVideo,\r\n        variables: { input: item },\r\n        fetchPolicy: 'no-cache'\r\n      })\r\n    \r\n      console.log('result', JSON.stringify(result))\r\n      return result\r\n    }\r\n```\r\n\r\nHowever when calling the AppSync API to create the video record is fails when running validation on the input property 'videoSessionTypeId'.\r\n\r\nCan anyone provide an explanation for how relations work and how you create a new object and the relationships such that subsequent queries return the object and properties of related objects.\r\n\r\nBTW this is the error from the Lambda function:\r\n\r\n```\r\n    2020-10-13T22:28:35.438Z\td42efde3-100b-434f-b967-ce080bd43e6e\tERROR\tUnhandled Promise Rejection\t\r\n    {\r\n        \"errorType\": \"Runtime.UnhandledPromiseRejection\",\r\n        \"errorMessage\": \"Error: GraphQL error: Validation error of type FieldUndefined: Field 'videoSessionTypeId' in type 'Video' is undefined @ 'createVideo/videoSessionTypeId'\",\r\n        \"reason\": {\r\n            \"errorType\": \"Error\",\r\n            \"errorMessage\": \"GraphQL error: Validation error of type FieldUndefined: Field 'videoSessionTypeId' in type 'Video' is undefined @ 'createVideo/videoSessionTypeId'\",\r\n            \"graphQLErrors\": [\r\n                {\r\n                    \"path\": null,\r\n                    \"locations\": [\r\n                        {\r\n                            \"line\": 9,\r\n                            \"column\": 5,\r\n                            \"sourceName\": null\r\n                        }\r\n                    ],\r\n                    \"message\": \"Validation error of type FieldUndefined: Field 'videoSessionTypeId' in type 'Video' is undefined @ 'createVideo/videoSessionTypeId'\"\r\n                }\r\n            ],\r\n            \"networkError\": null,\r\n            \"message\": \"GraphQL error: Validation error of type FieldUndefined: Field 'videoSessionTypeId' in type 'Video' is undefined @ 'createVideo/videoSessionTypeId'\",\r\n            \"stack\": [\r\n                \"Error: GraphQL error: Validation error of type FieldUndefined: Field 'videoSessionTypeId' in type 'Video' is undefined @ 'createVideo/videoSessionTypeId'\",\r\n                \"    at new ApolloError (/var/task/node_modules/apollo-client/bundle.umd.js:85:32)\",\r\n                \"    at Object.next (/var/task/node_modules/apollo-client/bundle.umd.js:890:37)\",\r\n                \"    at notifySubscription (/var/task/node_modules/zen-observable/lib/Observable.js:135:18)\",\r\n                \"    at onNotify (/var/task/node_modules/zen-observable/lib/Observable.js:179:3)\",\r\n                \"    at SubscriptionObserver.next (/var/task/node_modules/zen-observable/lib/Observable.js:235:7)\",\r\n                \"    at notifySubscription (/var/task/node_modules/zen-observable/lib/Observable.js:135:18)\",\r\n                \"    at onNotify (/var/task/node_modules/zen-observable/lib/Observable.js:179:3)\",\r\n                \"    at SubscriptionObserver.next (/var/task/node_modules/zen-observable/lib/Observable.js:235:7)\",\r\n                \"    at notifySubscription (/var/task/node_modules/zen-observable/lib/Observable.js:135:18)\",\r\n                \"    at onNotify (/var/task/node_modules/zen-observable/lib/Observable.js:179:3)\"\r\n            ]\r\n        },\r\n        \"promise\": {},\r\n        \"stack\": [\r\n            \"Runtime.UnhandledPromiseRejection: Error: GraphQL error: Validation error of type FieldUndefined: Field 'videoSessionTypeId' in type 'Video' is undefined @ 'createVideo/videoSessionTypeId'\",\r\n            \"    at process.on (/var/runtime/index.js:37:15)\",\r\n            \"    at process.emit (events.js:198:13)\",\r\n            \"    at process.EventEmitter.emit (domain.js:448:20)\",\r\n            \"    at emitPromiseRejectionWarnings (internal/process/promises.js:140:18)\",\r\n            \"    at process._tickCallback (internal/process/next_tick.js:69:34)\"\r\n        ]\r\n    }\r\n```","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNDQwNA==","author":{"login":"sukidhar"},"title":"How to access a Cognito UserPool data from lambda function through API Gateway","body":" What role lets me to have the access to cognito user pool data","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMzc1NQ==","author":{"login":"lochawala"},"title":"Remove auth attribute from required but still it's create as required","body":"**Describe the bug**\r\nwhen i add auth in amplify and removing email from required attribute still it's create as required  \r\n\r\n**To Reproduce**\r\nSteps to reproduce the behavior:\r\n\r\namplify add auth\r\nDo you want to use the default authentication and security configuration?\r\n❯ Default configuration\r\nHow do you want users to be able to sign in?\r\n❯ Email or Phone Number\r\nDo you want to configure advanced settings?\r\n❯ Yes, I want to make some additional changes.\r\nWhat attributes are required for signing up?\r\n❯ unselect Email\r\nDo you want to enable any of the following capabilities?\r\n❯ hit enter\r\namplify push\r\n\r\n**Expected behavior**\r\ncreate user pull as not required email attribute","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"ashika01"},"body":"@lochawala What is the error you are seeing? Could you provide with your amplify js code sample.\r\n\r\nAlso, I would suggest to through the manual configuration flow in CLI rather than going down default and unselecting required."}},{"node":{"author":{"login":"lochawala"},"body":"@ashika01 Thanks for your reply \r\nI have tried with custom configuration too, but still, it's created email as required attribute \r\nI have attached some screen shots for better understanding\r\n \r\n![Screen Shot 2020-10-08 at 10 02 45 AM](https://user-images.githubusercontent.com/14148438/95415602-539f9b00-094e-11eb-8499-4b093573d761.png)\r\n\r\n\r\n![Screen Shot 2020-10-08 at 10 07 18 AM](https://user-images.githubusercontent.com/14148438/95415538-2521c000-094e-11eb-8732-bcb85d032c2d.png)\r\n\r\n\r\nCheck in first screenshot I have unselected email, but in the 2nd screen shot you can seen email as a required attribute\r\n"}},{"node":{"author":{"login":"ashika01"},"body":"Hi @lochawala I was able to setup with just username login by following manual configuration.\r\n\r\nThis is steps to go through in Amplify CLI for manual configuration,\r\n![Screen Shot 2020-10-08 at 2 19 56 PM](https://user-images.githubusercontent.com/35131273/95517755-79409a80-0976-11eb-9a15-a8fcc78e8d5e.png)\r\n\r\n\r\nThis is my userpool console equivalent,\r\n![Screen Shot 2020-10-08 at 2 53 50 PM](https://user-images.githubusercontent.com/35131273/95517799-8eb5c480-0976-11eb-82d8-168b45056547.png)\r\n\r\n\r\nIf you want your users to sign in with email and phone number it will become required attribute. That might be why you are having problems. I am moving this to discussion to get help from community."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb245MjQx","author":{"login":"kimfucious"},"title":"How to implement usage plans?","body":"Hi there,\r\n\r\nI've got an app built with Amplify that uses several functions via API Gateway.\r\n\r\nI'd like to limit/throttle traffic on these endpoints with some granularity.\r\n\r\nI've read up on how to setup a usage plan in the API Gateway, and it requires API requests to set an `x-api-key` in the header of the API requests.\r\n\r\nI've tried the below, where API is an import from `aws-amplify`,but the key registers no usage, and thus enforces nothing.\r\n```js\r\n  const response = await API.post(\r\n    \"MY_API\",\r\n    \"/PATH\",\r\n    {\r\n      header: { \"x-api-key\": \"MY_API_KEY\" },\r\n      body: {\r\n        ...\r\n      }\r\n    }\r\n  );\r\n```\r\nIt's obvious that I don't know what I'm doing, so any help is appreciated.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"bwobbones"},"body":"I got this working, i needed to set up the usage plan in the AWS console (though I'm pretty sure you could do this with CloudFormation if you wanted to).  Then you need to change the template to use the usage plan settings.\r\n\r\nIn the api you created, modify the `apiname-cloudformation-template.json`.  \r\n\r\nReplace the `securityDefinitions` section with\r\n```\r\n\"securityDefinitions\": {\r\n  \"sigv4\": {\r\n    \"type\": \"apiKey\",\r\n    \"name\": \"Authorization\",\r\n    \"in\": \"header\",\r\n    \"x-amazon-apigateway-authtype\": \"awsSigv4\"\r\n  },\r\n  \"api_key\": {\r\n    \"type\": \"apiKey\",\r\n    \"name\": \"x-api-key\",\r\n    \"in\": \"header\"\r\n  }\r\n},\r\n```\r\n\r\nThen in both of the `x-amazon-apigateway-any-method` sections under the path add this:\r\n```\r\n\"x-amazon-apigateway-auth\": {\r\n  \"type\": \"NONE\"\r\n},\r\n\"security\": [\r\n  {\r\n    \"api_key\": []\r\n  }\r\n],\r\n```\r\n\r\nThen `amplify push` and you should be good.  You might need to redeploy the API in the console (API->Resources->path->Actions->Deploy API), I'm not sure why that doesn't happen automatically."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMzk0MA==","author":{"login":"vrebo"},"title":"DataStore: How to query using a secondary GSI","body":"Hi community!.\r\n\r\nI couldn't find in the DataStore documentation how to make queries that use Global Secondary Indexes neither as documentation nor as examples. Does anyone know if this feature exists and how to do it?.\r\n\r\nThanks in advance.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"vrebo"},"body":"From @undefobj in the [DataStore Discord Channel](https://discord.gg/gmvQz8r)\r\n\r\n> Delta sync automatically use GSIs. Base sync does not but you'll be able to control that in a few weeks\r\n> Note though that with DataStore when you run a query it's always against the local store on the device, not the network.\r\n> The local store is transparently updated for you by base/delta queries as part of sync as well as subscriptions.\r\n> The new feature that is coming out will allow you to do \"selective sync\" which will transparently perform GSI queries behind the scenes during the base sync operations"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMzgyMQ==","author":{"login":"simon-zhangmuye"},"title":"How update my local graphql operation, amplify push doesn't work.","body":"Hi,\r\n\r\nI make some changes in my schema and use amplify push to upload.\r\nBut the local graphql operations don't update.\r\nHow can I update local graphql operations after making changes in my schema?\r\n\r\nThank you very much.\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMzc2OA==","author":{"login":"sw-yx"},"title":"[Request] Storage File Explorer UI Component and JS APIs","body":"**Is your feature request related to a problem? Please describe.**\r\n\r\nthe `Storage.list` API available to us today is pretty low level: given a prefix, they list all files and folders to arbitrary depth. it is up to the user to further parse folders and files for immediate depth. furthermore, some \"folders\" are just defined inside of filenames, so that needs to be parsed too. a lot of work to wrangle this data into something usable.\r\n\r\n**Describe the solution you'd like**\r\nwe should make it very easy to replicate the S3 interface already offered by AWS:\r\n\r\n![image](https://user-images.githubusercontent.com/6764957/95493876-ae2d0b80-09cf-11eb-9e9f-984e9ebb84ad.png)\r\n\r\nI think this is a 2 part process\r\n\r\n- offer a slightly higher level API that spits out nested filesystem data\r\n- build a UI component that will easily display this (together with file upload progress)\r\n\r\n**Describe alternatives you've considered**\r\ndo nothing\r\n\r\n**additional context**\r\n\r\notherwise we have to do ugly stuff like this https://github.com/aws-amplify/docs/pull/2516","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"ashika01"},"body":"@sw-yx This is solid. This is part of our roadmap to add new UI components for s3. Moving it to0 discussions to get more thoughts for everyone."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMzU1OQ==","author":{"login":"drixta"},"title":"Aws-Amplify importing the entire aws-sdk library creating huge bundle size","body":"**Describe the bug**\r\n\r\nAWS-Amplify is importing aws-sdk entirely creating a massive bundle size. This issue hasn't happened before.\r\n\r\n![Screen Shot 2020-09-25 at 4 42 38 PM](https://user-images.githubusercontent.com/2681321/94324352-58c41980-ff4e-11ea-8c7f-1d68679e0288.png)\r\n\r\n\r\n**To Reproduce**\r\nI'm currently using [webpack-bundle-analyzer](https://www.npmjs.com/package/webpack-bundle-analyzer) to generate this report;\r\n\r\nMy current project dependencies is as follows.\r\nAs you can see I'm not importing `aws-sdk` anywhere and aws-amplify imports aws-sdk for it's own logic, specifically in cognito.\r\n\r\n  \"dependencies\": {\r\n    \"@ag-grid-community/all-modules\": \"^23.2.1\",\r\n    \"@ag-grid-enterprise/all-modules\": \"^24.0.0\",\r\n    \"@aws-amplify/ui-react\": \"^0.2.18\",\r\n    \"@craco/craco\": \"^5.6.4\",\r\n    \"@emotion/core\": \"^10.0.28\",\r\n    \"@testing-library/jest-dom\": \"^4.2.4\",\r\n    \"@testing-library/react\": \"^9.3.2\",\r\n    \"@testing-library/user-event\": \"^7.1.2\",\r\n    \"@types/facebook-js-sdk\": \"^3.3.0\",\r\n    \"@types/jest\": \"^24.0.0\",\r\n    \"@types/node\": \"^12.0.0\",\r\n    \"@types/react\": \"^16.9.0\",\r\n    \"@types/react-big-calendar\": \"^0.24.6\",\r\n    \"@types/react-dom\": \"^16.9.0\",\r\n    \"@types/react-router-dom\": \"^5.1.5\",\r\n    \"ag-grid-community\": \"^23.2.1\",\r\n    \"ag-grid-react\": \"^23.2.1\",\r\n    \"antd\": \"^4.2.5\",\r\n    \"aws-amplify\": \"^3.3.1\",\r\n    \"date-fns\": \"^2.16.1\",\r\n    \"dayjs\": \"^1.8.36\",\r\n    \"formik\": \"^2.1.4\",\r\n    \"formik-antd\": \"^2.0.1\",\r\n    \"handsontable\": \"^7.4.2\",\r\n    \"react\": \"16.12.0\",\r\n    \"react-big-calendar\": \"^0.27.0\",\r\n    \"react-contenteditable\": \"^3.3.5\",\r\n    \"react-dnd\": \"^11.1.3\",\r\n    \"react-dnd-html5-backend\": \"^11.1.3\",\r\n    \"react-dom\": \"^16.13.1\",\r\n    \"react-icons\": \"^3.10.0\",\r\n    \"react-infinite-scroll-hook\": \"^3.0.0\",\r\n    \"react-intersection-observer\": \"^8.28.5\",\r\n    \"react-loading-skeleton\": \"^2.1.1\",\r\n    \"react-query\": \"^2.21.0\",\r\n    \"react-query-devtools\": \"^1.1.16\",\r\n    \"react-router-dom\": \"^5.2.0\",\r\n    \"react-scripts\": \"3.4.1\",\r\n    \"react-spring\": \"^8.0.27\",\r\n    \"react-stack-gallery\": \"^1.0.4\",\r\n    \"react-stack-grid\": \"^0.7.1\",\r\n    \"time-ago\": \"^0.2.1\",\r\n    \"typescript\": \"~3.7.2\",\r\n    \"yup\": \"^0.29.1\"\r\n  },\r\n\r\n**Expected behavior**\r\nExpecting not the entire `aws-sdk` is imported to the project as it is unreasonable to expect the users to download the entire library without using it.\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"ashika01"},"body":"@drixta The latest versions of Amplify lib enables tree shaking on prod builds. Please run a prod build and compare size you should not be seeing huge bundle chunks."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMzU1Mg==","author":{"login":"duncangroenewald"},"title":"Cannot find file './aws-exports' in './src'","body":"Describe the bug\r\nWhen building Frontend with AWS CI/CD we are now getting this error.\r\n\r\nTo Reproduce\r\nAny time we commit code the CodeCommit and the front-end application is deployed we get this error during the build process\r\n\r\nExpected behaviour\r\nThe build process should automatically create the aws-exports.js file relevant for the environment being deployed to.\r\n\r\nScreenshots\r\nN/A\r\n\r\nDesktop (please complete the following information):\r\nN/A\r\n\r\nSmartphone (please complete the following information):\r\nN/A\r\n\r\nAdditional context\r\nIt's not clear what other information is required. As we understand it the aws-exports.js file should be created automatically by AWS Amplify when the Frontend is built. It's unclear where there is anything we need to do to or might have don't to affect creation of the aws-exports.js file.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"ashika01"},"body":"@duncangroenewald are you using setting up your backend using Amplify CLI?! "}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMzQ4OA==","author":{"login":"tnorlund"},"title":"DynamoDB not being queried by GraphiQL","body":"Hey guys!\r\n\r\nI'm currently testing hardware. The results of each test are stored to a DynamoDB table created with Amplify. \r\n\r\n<img width=\"1017\" alt=\"Screen Shot 2020-10-07 at 11 44 41 AM\" src=\"https://user-images.githubusercontent.com/26452518/95373946-91d78480-0892-11eb-81a9-575e6b277ee4.png\">\r\n\r\nI'm uploading each hash using DynamoDB's cpp sdk. When I hop back onto Amplify, I can't query any of the data.\r\n\r\n```\r\ntype Performance @model {\r\n  id: ID!\r\n  buffer: Int\r\n  cpuSerial: String\r\n  dateTime: String\r\n  fpsReal: Float\r\n  fpsRequested: Int\r\n  numberFrames: Int\r\n  runTime: Float\r\n  timeRequested: Int\r\n}\r\n```\r\n\r\n```bash\r\n$ amplify mock api\r\n```\r\n\r\n\r\n<img width=\"1528\" alt=\"Screen Shot 2020-10-07 at 11 46 21 AM\" src=\"https://user-images.githubusercontent.com/26452518/95374100-c3e8e680-0892-11eb-8106-f4d4c40f4bcf.png\">\r\n\r\nIf I know that the data is in the table, but not in the result of the query, how should I move forward?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"tnorlund"},"body":"So I was able to query the data using AppSync.\r\n\r\n<img width=\"1170\" alt=\"Screen Shot 2020-10-07 at 12 27 50 PM\" src=\"https://user-images.githubusercontent.com/26452518/95378290-8a1ade80-0898-11eb-9b85-ca9fefe71c66.png\">\r\n\r\nThe issue I'm facing now, is that I can't query the data in my Gatsby site. I added the required config to gatsby browswer.\r\n\r\n```js\r\nimport { PageComponents, Providers } from 'components/Global'\r\nimport React from 'react'\r\nimport Amplify from 'aws-amplify'\r\nimport config from './src/aws-exports'\r\nAmplify.configure( config )\r\n\r\nexport const wrapRootElement = ({ element }) => {\r\n  return <Providers>{element}</Providers>\r\n}\r\n\r\nexport const wrapPageElement = ({ element, props }) => {\r\n  return <PageComponents {...props}>{element}</PageComponents>\r\n}\r\n\r\n// https://gatsbyjs.org/docs/add-offline-support-with-a-service-worker\r\nexport const onServiceWorkerUpdateReady = () => window.location.reload()\r\n\r\n```\r\n\r\nBut I have a component that I'd like to query the data from.\r\n\r\n```js\r\nimport React from 'react'\r\nimport DarkToggle from '../DarkToggle'\r\nimport Nav from '../Nav'\r\nimport { HeaderDiv, Logo } from './styles'\r\n\r\nimport { API } from 'aws-amplify'\r\nimport * as queries from '../../graphql/queries'\r\n\r\nasync function asyncCall() {\r\n  API.graphql( { query: queries.listPerformances } )\r\n    .then( result => {\r\n      console.log(\"finshed query\")\r\n      console.log(result)\r\n    })\r\n    .catch( error => {\r\n      console.log(\"errored\")\r\n      console.log(error)\r\n    })\r\n}\r\n\r\nexport default function Header( { site } ) {\r\n  const thisImage = asyncCall()\r\n  return (\r\n    <HeaderDiv>\r\n      <Logo to=\"/\" title={site.title} rel=\"home\">\r\n        tnor\r\n      </Logo>\r\n      <Nav />\r\n      <DarkToggle />\r\n    </HeaderDiv>\r\n  )\r\n}\r\n```\r\n\r\nWhen I `gatsby develop` this locally, I get the following error in console:\r\n\r\n```\r\ndata: {}\r\nerrors: Array(1)\r\n    0: GraphQLError\r\n        message: \"Network Error\"\r\n        extensions: undefined\r\n        locations: undefined\r\n        nodes: undefined\r\n        originalError: undefined\r\n        path: undefined\r\n        positions: undefined\r\n        source: undefined\r\n        stack: \"GraphQLError: Network Error↵    at GraphQLAPIClass.<anonymous> (http://localhost:8000/commons.js:9401:38)↵    at step (http://localhost:8000/commons.js:9089:23)↵    at Object.throw (http://localhost:8000/commons.js:9070:53)↵    at rejected (http://localhost:8000/commons.js:9062:65)\"\r\n        __proto__: Error\r\n    length: 1\r\n    __proto__: Array(0)\r\n```\r\n\r\nAre there any other steps I need to take to query the data?"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMzA5NA==","author":{"login":"AndreasLangberg"},"title":"Storage does not make use of Auth credentials","body":"I'm trying to do something I would have thought should be fairly simply: Upload profile pictures from users (logged in with Cognito through Amplify.Auth) to S3. But for whatever reason, even if the user logs in correctly, Storage doesn't seem to be able to make use of the credentials, and tries to use \"undefined\" as its user, which is then promptly denied.\r\n\r\n![image](https://user-images.githubusercontent.com/3735880/95200691-1a94e880-07df-11eb-82af-041c6ab804a2.png)\r\n\r\nIt also seems to slam down 4 POST commands before attempting the PUT, which returns 400\r\n\r\nconfig:\r\n\r\n```\r\n{\r\n  Auth: {\r\n    identityPoolId: \"eu-central-1:________-____-____-____-__________\",\r\n    region: \"eu-central-1\",\r\n    identityPoolRegion: \"eu-central-1\",\r\n    userPoolId: \"eu-central-1_---------\",\r\n    userPoolWebClientId: \"--------------------------\",\r\n  },\r\n  Storage: {\r\n    AWSS3: {\r\n      bucket: \"s3-bucket-name\",\r\n      region: \"eu-north-1\",\r\n      level: \"private\",\r\n    },\r\n  },\r\n}\r\n```\r\n\r\nUsers are currently logging in using \"withauthenticator\" from @aws-amplify/ui-react, and I am able to check that the credentials are correct by running Auth.currentAuthenticatedUser().\r\n\r\nThe put command:\r\n\r\n```\r\nStorage.put(`userimages/${currentImage.name}`, currentImage, {\r\n        contentType: currentImage.type,\r\n      })\r\n        .then((result) => console.log(result))\r\n        .catch((err) => console.log(err));\r\n```\r\nusing\r\n\"@aws-amplify/ui-react\": \"0.2.9\",\r\n\"amazon-cognito-identity-js\": \"4.4.0\",\r\n\"aws-amplify\": \"3.3.3\",\r\n\r\nAnyone have any ideas how to approach this, or at the very least a way to get better debug info? some 400s and a 403 without anything else isn't super useful","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMjc5Mw==","author":{"login":"twoandahalf2"},"title":"Google and Facebook federeated identities with AWS Amplify return \"Error: Cannot retrieve a new session. Please authenticate.\" after a few hours of inactivity.","body":"hello , i have added federated identities to my React.js application and all worked good initially, however after a few hours the user is not able to log back in. -->  \"Error: Cannot retrieve a new session. Please authenticate.\"\r\n\r\n I am using a very basic setup : \r\n\r\n`<div className=\"facebook-login\">\r\n            <Button onClick={() => {\r\n              Auth.federatedSignIn({provider: 'Facebook'})\r\n            } }> Login with Facebook</Button>\r\n</div>`\r\n\r\n`Amplify.configure({\r\n  Auth: {\r\n    mandatorySignIn: true,\r\n    region: config.cognito.REGION,\r\n    userPoolId: config.cognito.USER_POOL_ID,\r\n    identityPoolId: config.cognito.IDENTITY_POOL_ID,\r\n    userPoolWebClientId: config.cognito.APP_CLIENT_ID,\r\n    oauth: {\r\n      domain: \"domain.auth.us-east-1.amazoncognito.com\",\r\n      redirectSignIn: 'http://localhost:3000/',\r\n      redirectSignOut: 'http://localhost:3000/',\r\n      responseType: \"token\"\r\n    }\r\n}`\r\n\r\nTo me, the issue is related to the expiration of the user token. However, i am not sure what would be the approach to fix this. I read so many posts about that issue but could not find a solution. \r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMjA3NA==","author":null,"title":"How to customize aws-amplify/ui-angulars' authenticator sign in button?","body":"How can I make the width of the sign in button 100% to the authenticators div?\r\nI can hide the sign-up link using **hide-sign-up** in the amplify-sign-in tag but couldn't customize the sign in button.\r\n\r\nI tried various access rules:\r\n\r\n`[name=secondary-footer-content] span { \r\n  display: none;\r\n}`\r\n`slot[name=secondary-footer-content] { display: none}`\r\n\r\n\r\nand applied both on global styles.css and app.component.css but none of them works.\r\n\r\nCan anyone help me? Thanks","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMjM0NA==","author":{"login":"ifmael"},"title":"Datastore doesn't trigger events in the  Hub after update \"aws-amplify\" to 3.3.2","body":"I'm listening for Datastore events through the Hub, but after update \"aws-amplify\" to the latest version, the datastore doesn't sync, Why is it happen?\r\n\r\nIf I querying for a specific models like:\r\n\r\n```\r\nuseEffect(() => {\r\n    const getContent = async () => {\r\n      try {\r\n        const contents = await DataStore.query(Content, Predicates.ALL);\r\n      } catch (error) {\r\n        console.log(error);\r\n      }\r\n    };\r\n    getContent();\r\n  }, []);\r\n```\r\n\r\nThe Hub receives these events:\r\n```\r\nEvent:  storageSubscribed\r\nEvent:  networkStatus\r\nEvent:  outboxStatus\r\n``` \r\n\r\nbut it doesn't sync the `Content` Model, ¿Is there another way to work with Datastore? ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMTkzMw==","author":{"login":"chai86"},"title":"Can I set a true/false for every entry in a single column using DynamoDB AWS console?","body":"@sammartinez  @manueliglesias \r\n\r\nI have a table in DynamoDB and i'd like essentially to set a boolean to true/false for ALL rows or entries in that table, for just a single column. Let's say the column is called UserActive. I know i can do this by clicking the pencil/edit icon in the console, for each individual row, but for thousands of entries, that's just not feasible. I need to be able to do this from the AWS console.\r\n\r\nHow can i set them all to true/false in one go?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMTYwMg==","author":{"login":"mogalmahesh"},"title":"Dynamic groups with AppSync/DataStore with Cognito user pool group limit of 10,000","body":"Hi, \r\n**Usecase:**\r\nI am building an application where users can invite others to join their team and everyone in the team will have access to account resources. \r\nI am planning to use DataStore with a model where the owner, as well as the dynamic group, can have access to some record.\r\n\r\n**My problem:**\r\nmy problem is, I can see there is a hard limit of 10,000 groups per user pool in AWS Cognito. I know it is a generous limit and very few applications will hit that limit. But I do not want to get bound by this in the case in future I need more than 10,000 groups.\r\n\r\nhttps://docs.aws.amazon.com/cognito/latest/developerguide/limits.html\r\n\r\n**Best case possible**\r\nAm I wrong in thinking that when I use a dynamic group, in the backend it creates one new group in AWS Cognito? That these 10,000 groups per user pool are not related to how we create groups in AppSync/DataStore?\r\nIf those things are not related this is no issue at all.\r\n\r\nBut if we have this limit of 10,000 groups then this may put me in a spot of bother exactly when my app is getting used by many people. \r\n\r\nis there any way I can handle this?\r\n\r\nThanks in advance for your help and guidance.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMTU1Mw==","author":{"login":"ripley"},"title":"How to maintain a sound SaaS payment user model.","body":"Dear community\r\n\r\nI'm trying to create a SaaS notes app based on amplify and had a hard time to come up with an appropriate\r\nauthorization / authentication design.\r\n\r\nMy requirements are as below:\r\n\r\n1. Newly signed up user could use all feature (notes CRUD) for some time.\r\n2. User will not be able to create new notes after the trail is end but still could read/edit/delete them.\r\n3. Separated user could only access notes of their own.\r\n\r\nThere's no problem of creating a subscription from stripe and maintain groups like trial / paid users, but I don't know how to continue from there.\r\n1. Owner based authentication has no end time.\r\n2. Group based authentication will allow a group of user to access each others resources, which is not acceptable.\r\n3. I tried to attach auth rules below\r\n    {allow: owner, operations: [update, read, delete]},\r\n    {allow: groups, groups: [\"Premium\"]}\r\nThe entries created by this has no owner field and cannot be accessed by the owner.\r\n\r\nI'm thinking of not to invoke GraphQL API from my client app but to migrate the functions to a set of Lambda based APIs, which could access both DynamoDB and the table where the subscription info are stored, where I can use a Lambda authorizer to do things like above.\r\n\r\nLooks like this way will introduce much ado meanwhile abandons part of amplify.js 's capability.\r\n\r\nAny suggestions?\r\n\r\nRegards.\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMjkz","author":{"login":"tabrza"},"title":"Chatbot Styling after setting up project using amplify interactions","body":"I can't find how to style the React Chatbot widget shared by amplify js.. \r\nThe following is provided in the instructions but there is a lack of documentation around how to use this:\r\n```\r\nconst myTheme = {\r\n  ...AmplifyTheme,\r\n  sectionHeader: {\r\n    ...AmplifyTheme.sectionHeader,\r\n    backgroundColor: '#ff6600'\r\n  }\r\n};\r\n```\r\n\r\nwith this component:\r\n```\r\n        <ChatBot\r\n          title=\"My Bot\"\r\n          theme={myTheme}\r\n          botName=\"My Bot\"\r\n          welcomeMessage=\"Welcome, how can I help you today?\"\r\n          clearOnComplete={true}\r\n          conversationModeOn={false}\r\n        />\r\n\r\n```\r\n\r\nWould appreciate some guidance on this","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"sw-yx"},"body":"just catching up on this. interesting! did you end up figuring it out?"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMTQ5MA==","author":{"login":"Ajwah"},"title":"How to leverage @aws-amplify/ui-react for federated authentication?","body":"My objective here is to use the UI-package and theme it accordingly; but it seems to me that the flow is broken on at least two levels:\r\n\r\n1. There is an apparent disjunct between doing the custom flow vs the UI-package flow in the sense that the custom flow  will take all the relevant credentials from whatever is provided during `amplify add auth` which in turn stores it inside: `team-provider-info.js`. The UI-package flow however seems not to be able to automagically load these values and thus I have to manually provide them in the code base.\r\n2. The manual flow will just work whereas the UI-package flow is confronted with a CORS issue somehow.\r\n\r\nI detail both these below.\r\n\r\n## Credentials Usage\r\n\r\nI see an example [here](https://github.com/aws-amplify/amplify-js/tree/master/packages/amplify-ui-components#amplify-authenticator-federated) but I am confused as to why I need to input credentials manually whereas I already provided all the details when doing amplify add auth:\r\n\r\n```ts\r\nconst federated = {\r\n  amazonClientId: \"your_amazon_client_id\",\r\n  facebookAppId: \"your_facebook_app_id\",\r\n  googleClientId: \"your_google_client_id\",\r\n  oauthConfig: {\r\n    redirectSignIn: \"http://localhost:1234/\",\r\n    redirectSignOut: \"http://localhost:1234/\",\r\n  }\r\n}\r\n```\r\n\r\nIn the meanwhile, I iterated to doing this instead:\r\n\r\n```js\r\nimport { AmplifyAuthenticator, AmplifyGoogleButton, AmplifySignOut} from '@aws-amplify/ui-react';\r\n\r\nwindow.LOG_LEVEL = 'DEBUG';\r\n\r\nfunction App() {\r\n  return (\r\n    <AmplifyAuthenticator>\r\n      <AmplifyGoogleButton clientId=\"XXXXXX\" slot=\"sign-in\"></AmplifyGoogleButton>\r\n      <AmplifySignOut />\r\n    </AmplifyAuthenticator>\r\n  )\r\n}\r\n\r\nexport default App;\r\n```\r\n\r\n## CORS Issue\r\n\r\nThis however gives me a CORS-issue:\r\n\r\n```\r\nCross-Origin Request Blocked: The Same Origin Policy disallows reading the remote resource at https://apis.google.com/_/scs/apps-static/_/js/k=oz.gapi.en.myOGgYJo9ys.O/m=client/rt=j/sv=1/d=1/ed=1/am=wQE/rs=AGLTcCMR2Cg_3Iqxcgmos-E9G6cjWQG_Kw/cb=gapi.loaded_0. (Reason: CORS header “Access-Control-Allow-Origin” missing).\r\n```\r\n\r\nThe callback `gapi.loaded_0` is attempted during `user.getSession` in `Auth.ts`. \r\n<img width=\"771\" alt=\"Screen Shot 2020-09-26 at 11 05 14 AM\" src=\"https://user-images.githubusercontent.com/11848116/94343731-2bc44500-ffe8-11ea-9758-338038c694b0.png\">\r\n\r\nThe stacktrace states:\r\n```\r\nUncaught (in promise) TypeError: user.getSession is not a function\r\n    userSession Auth.ts:1323\r\n    userSession Auth.ts:1321\r\n    userAttributes Auth.ts:1059\r\n    userAttributes Auth.ts:1058\r\n    verifiedContact Auth.ts:1073\r\n....\r\n    <anonymous> cb=gapi.loaded_0:527\r\n    za api:client.js:13\r\n    ya api:client.js:16\r\n    za api:client.js:13\r\n    ha api:client.js:15\r\n    A api:client.js:15\r\n    t api:client.js:15\r\n    R api:client.js:15\r\n    <anonymous> cb=gapi.loaded_0:1\r\n```\r\n\r\nIf I simply refresh the page then I am signed in though.\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"sw-yx"},"body":"i think @jordanranz can help you with the second part, but for the first part, the simple answer is that it is not yet implemented but is on our radar."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNDE4","author":{"login":"fireflysemantics"},"title":"Keeping an Amplify Session Fresh","body":"These are the original instructions I looked at, but perhaps we no longer need to do this:\r\n\r\nhttps://github.com/aws-amplify/amplify-js/issues/2560\r\n\r\n```\r\n  const cognitoUser = await Auth.currentAuthenticatedUser();\r\n  const currentSession = await Auth.currentSession();\r\n  cognitoUser.refreshSession(currentSession.refreshToken, (err, session) => {\r\n    // Irrele\r\n  });\r\n```\r\n\r\nIf I try the above code I get the error:\r\n\r\n> Property 'refreshToken' does not exist on type 'CognitoUserSession'.ts(2339)\r\n\r\nDo we need to keep the session fresh or will Amplify automatically do it?\r\n\r\nIn this particular scenario I want to make sure that the session does not time out while the user is completing a credit card transaction entry.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"brsjak"},"body":"I'm still having this issue, have you came up with a solution about this issue? "}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNTA1OA==","author":{"login":"dfang"},"title":"how make a sign up link and sign in link in header for ui-react hosted ui","body":"Hi,\r\n\r\nfor @aws-amplify/ui-react, how to make a sign up btn and sign in/out btn without customized UI ?\r\n\r\nthanks !","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"isaiahgrant"},"body":"➕ 1️⃣ \r\n\r\nWe are using Cognito's hosted UI for our federated sign ins. The \"SignUp\" view of the hosted UI is not immediately apparent for many of our users.\r\n\r\nHow can we redirect users directly to the SignUp view rather than the SignIn view? SignIn usage is currently: `Auth.federatedSignIn` so I expected something along the lines of `Auth.federatedSignUp`, but could not find any resources accordingly.\r\n\r\nShould this be a feature request?\r\n\r\nAppreciate any insights here!"}},{"node":{"author":{"login":"dfang"},"body":"@isaiahgrant  i ended up with this\r\n\r\n```\r\n// signup.jsx\r\n\r\nimport React from 'react';\r\nimport Amplify, { Auth } from 'aws-amplify';\r\nimport { AmplifyAuthenticator, AmplifySignIn, AmplifySignUp } from \"@aws-amplify/ui-react\";\r\nimport { AuthState, onAuthUIStateChange } from '@aws-amplify/ui-components';\r\nimport { useHistory } from 'react-router-dom';\r\n\r\nexport default function CustomSignUp() {\r\n\r\n  let history = useHistory()\r\n  React.useEffect(() => {\r\n\r\n    // redirect to / if a authenticated user visits /register\r\n    Auth.currentAuthenticatedUser()\r\n      .then(data => console.log(data))\r\n      .then(data => history.push(\"/\"))\r\n\r\n    return onAuthUIStateChange((nextAuthState, authData) => {\r\n      // setAuthState(nextAuthState);\r\n      // setUser(authData)\r\n      if (nextAuthState.SignedIn) {\r\n        history.push(\"/\")\r\n      }\r\n    });\r\n  }, []);\r\n\r\n  return (\r\n    <AmplifyAuthenticator initialAuthState={AuthState.SignUp}>\r\n      <AmplifySignUp />\r\n    </AmplifyAuthenticator>\r\n  );\r\n}\r\n```"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMTA5Mg==","author":{"login":"clethrill"},"title":"Single Sign On with Xero.","body":"I'm trying to use Single Sign On with Xero, Cognito and Amplify, I've got to the point of getting access tokens for the Xero auth but I don't know how to tell my react app to use these credentials to sign my user in.\r\n\r\nMy flow is currently:\r\n\r\n1. Hit sign in with Xero button in react app\r\n2. Get taken to the cognito hosted UI which redirects me to Xero login\r\n3. I login in Xero which redirects me back to the cognito hosted ui which redirects me back to my react app with a ?code=1234abc...\r\n4. I exchange that code using a post request to get my access tokens\r\n\r\n```\r\nconst req = await Axios.post(\r\n\t'https://{domain}.auth.ap-southeast-1.amazoncognito.com/oauth2/token', \r\n\t`grant_type=authorization_code&client_id=${clientID}&code=${code}&redirect_uri=${redirectUri}`, \r\n\t{\r\n\t\theaders: {\r\n\t\t\t'Content-Type': 'application/x-www-form-urlencoded'\r\n\t\t}\r\n\t}\r\n)\r\n```\r\n\r\n5. ???\r\n\r\nWhat do I do with these tokens to login using the Auth class? Auth.federatedSignIn and Auth.signIn both don't look like they take the right parameters. Am I doing a step wrong should I be doing something differently?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMDkxMQ==","author":{"login":"Nxtra"},"title":"Does @auth directive on graphQL type impact performance?","body":"Adding `@auth` to a graphQL type will add an `owner` attribute in DynamoDB.\r\nThis attribute is not part of the primary key.\r\n\r\nThat makes me wondering about the impact on performance. How does the resolver check whether this `owner` is correct.\r\nAnd does that implementation heavily impact peformance?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMDczMQ==","author":{"login":"ifmael"},"title":"Improve speed for the datastore","body":"I'm developing an app with the entry point is a login page. I'm using the datastore.\r\nIf a user sing-in correctly in the app,  the datastore start (`await DataStore.start();`) to sync all the content, but I've thousand of items in differents model so the datastore is `ready`  after 10 seconds. This is a long time showing a spinner waiting for datastore. \r\n\r\nIs there any way to do this sync faster? or any way to ask for the specific content?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMDY5OA==","author":{"login":"nguyenkien1402"},"title":"Can't hide the Forgot Password","body":"Hi guys,\r\n\r\nHow do I hide the Forgot Password in SignIn.\r\nI have referred to all the issues related to hiding the SignIn and Forgot Password in #1478\r\n#1624 and #1632. \r\n\r\nI am able to hide SignIn but not ForgotPassword \r\n`\r\n<AmplifyAuthenticator >\r\n        <AmplifySignIn slot=\"sign-in\" hideSignUp hideForgotPassword />\r\n        <AmplifySignOut/>\r\n        <Router>\r\n            ......\r\n          </Router>\r\n      </AmplifyAuthenticator>\r\n`\r\n\r\nI am using ui-react: \"^0.2.21\"\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMDY3Mg==","author":{"login":"MattM31"},"title":"Auth.currentAuthenticatedUser() is adding ?catagory=0 to url","body":"I've built my web app and I have a page where it has a table of requests and when you click on a request it changes the state which then changes the content dispalyed on the page to the request details (url dosent change). But to load that data it calls an API, and I kept getting 401 errors if the token had expired so I think I need to call Auth.currentAuthenticatedUser at the start of the api call to get/refesh the tokens. But when I call Auth.currentAuthenticatedUser it completes successfully but its adding ?category=0 to the url, which is triggering react router to navigate back to the table view again. Is there a way to prevent Auth.currentAuthenticatedUser from changing the url or do I need to re-write my application to make the request details page have its own url and route so when the url changes the page dosent redirect back?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMDUzNg==","author":{"login":"danhaab"},"title":"GraphQL Create operations on models through JS library don't respect Cognito group permissions","body":"I've got a model type that I only want users of specific groups to be able to create, but any logged in user seems to be able to create the object. Other operation permissions seem to be respected (e.g. read).\r\n\r\nThis only happens in my app, graphQL explorer returns unauthorized as I would expect for not Administrator and Publisher group users.\r\n\r\nHere's the auth directive:\r\n\r\ntype Content @model \r\n#@key(name: \"byPublisher\", fields: [\"publisherId\", \"title\", \"author\"])\r\n@auth (\r\n    rules: [\r\n      { allow: groups, groups: [\"Administrators\"] }\r\n      { allow: groups, groups: [\"Publishers\"], operations: [create, read ] }\r\n      { allow: groups, groups: [\"Readers\", \"Subscribers\"], operations: [read] }\r\n      { allow: owner, operations: [update, delete] }\r\n    ]\r\n) {\r\n  ...\r\n}\r\n\r\nWhat am I doing wrong here?\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNDcxMw==","author":{"login":"edfenergy-stevebowerman"},"title":"REST API and STS","body":"Hi,\r\n\r\nI'm my use case, my React app authenticates with Cognito User Pool+Identity pool, then needs to assume a role before making a call to API Gateway. Ie (by design) the role assumed via authentication only allows that user to assume a list of other roles. \r\n\r\nUsing Auth.currentUserCredentials() I can get the temporary creds provided by Cognito identity pool - lets refer to these as \"cogntio creds\". I can also successfully use AWS.STS to assume a role (with the \"cognito creds\") and obtain the \"assumed role creds\". However, when I call API.get(), it fails with a 403 error. On inspection, its because the creds used for the signing are the \"cognito creds\" rather than \"assumed role creds\".\r\nI've tried using AWS.config to explicitly set/override the credentials (cognito ones).\r\nRunning ampliy 2.3.0\r\n\r\nMany thanks\r\n\r\nSteve","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"MC313"},"body":"@edfenergy-stevebowerman hey sorry I don't have an answer for this but I think I'm experiencing the same issue. Have you found a solution for this or is there an issue created that I can track?"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMDMzNQ==","author":{"login":"emilycarr36"},"title":"Dynamic URL for redirect_uri using customState","body":"Hi all,\r\n\r\nHopefully you can help me. I've encountered a use case that I don't seem to be able to get the results I would like. I'm using a SAML identity provider and currently calling Auth.federatedSignIn({provider, customerState}) which logs me in and the state sting is appended with what I put in the customState arguement. \r\n\r\nWhat I want to achieve is if someone navigates to a page say https://xxxxxx/post/45 I want them to be taken there, instead of https://xxxxxxx.\r\n\r\nIs using custom state going to help me to achieve this. The AWS Console for Cognito specifies that the call back urls have to be static, however the number mentioned above would be an id, so dynamic.\r\n\r\nAny ideas of what I can do would be great please :)","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMDMxMQ==","author":{"login":"patelatharva"},"title":"Why do I receive access denied error from Storage.put request in Amplify?","body":"I have followed the steps of adding storage, have added create/update and read permission to relevant group via cli. I have assigned relevant role to the user via Cognito UI. Is there anything remaining to be done to let this user put objects in S3 bucket?\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMDE0OA==","author":{"login":"jdmwood"},"title":"Is it possible to have `SameSite = lax` for cookies when using SSR (Server Side Rendering)","body":"Hi there,\r\n\r\nWe're using the SSR approach described here: https://docs.amplify.aws/lib/ssr/q/platform/js\r\n\r\nMostly works really nicely!\r\n\r\nThe only question I have is around the cookies. As expected, when I set `ssr: true` in the config, amplify sets a couple of cookies which are sent with all requests.\r\n\r\nThe issue is that these are set to `SameSite = strict` which means that when I follow a link from a third party (e.g. clicking a link in gmail), these cookies are filtered out by the browser:\r\n\r\n![Screenshot 2020-09-18 at 09 28 32](https://user-images.githubusercontent.com/7125593/93575359-73682280-f991-11ea-8cbb-dc4c9ec784ee.png)\r\n\r\nIs there a way to make the SSR system use `lax` instead which would be more appropriate for our needs?\r\n\r\nI guess I can just configure the `Auth.cookies` section in configuration, but that means I would switch to cookie storage generally, and it seems when I do that, Amplify ends up setting a lot more cookies than with just setting `ssr: true`.\r\n\r\nThanks!\r\n","upvoteCount":4,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMDA5MQ==","author":{"login":"parth4992"},"title":"How to Use amplify app for Alexa account Linking Flows","body":"I want to facilitate alexa account linking through my amplify app. I want the user to sign in to the amplify web app, change alexa settings (pincode) and then notify alexa skill about link successful.\r\n\r\nProblems - \r\nAlexa account linking needs authorization code from cognito /oauth2/authorize (Don't know how to get outside of hosted UI)\r\nalexa skill and Amplify app have different app clients.\r\n\r\nMy current Approach - \r\nif the URL has query params redirect to the Hosted UI then wait for code and change redirect uri to my app. \r\nMy app gets the code and immediately tries to /oauth2/token which fails because different app clients\r\nOnce I get this code, I try to manually get tokens from the Cognito but then I run into 405 Method not allowed\r\n\r\n\r\nI am not sure if anyone has implemented this or not. or if there is another way to do it. ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xOTk1OQ==","author":{"login":"MuhaddiMu"},"title":"How to prevent a specific user from changing the password and email.","body":"In my Application, I am using Amplify Auth module for user authentication. \r\n\r\nI have created another user `demo@app.com` and block all post requests for the user since it's going to be demo purpose account. \r\n\r\nChaning Password, deletion of account, changing email is all handled via frontend. All the POST, PATCH, PUT, DELETE APIs are already blocked for the user but here is a security risk. \r\n\r\nI want revoke these permissions from this specific user.\r\n\r\nAny help would be highly appreciated.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xOTk1Ng==","author":{"login":"aldrindoinwork"},"title":"amplify init failed with MissingRequiredParameter error","body":"Hello guys! I'm trying to install amplify in my React Native project but I cannot proceed with the amplify init.\r\n\r\nBelow is the error that I am receiving:\r\n\r\n`MissingRequiredParameter: Missing required key 'name' in params\r\n    at ParamValidator.fail (/Users/aldrincastro/.nvm/versions/node/v12.18.1/lib/node_modules/@aws-amplify/cli/node_modules/aws-sdk/lib/param_validator.js:50:37)\r\n    at ParamValidator.validateStructure (/Users/aldrincastro/.nvm/versions/node/v12.18.1/lib/node_modules/@aws-amplify/cli/node_modules/aws-sdk/lib/param_validator.js:61:14)\r\n    at ParamValidator.validateMember (/Users/aldrincastro/.nvm/versions/node/v12.18.1/lib/node_modules/@aws-amplify/cli/node_modules/aws-sdk/lib/param_validator.js:88:21)\r\n    at ParamValidator.validate (/Users/aldrincastro/.nvm/versions/node/v12.18.1/lib/node_modules/@aws-amplify/cli/node_modules/aws-sdk/lib/param_validator.js:34:10)\r\n    at Request.VALIDATE_PARAMETERS (/Users/aldrincastro/.nvm/versions/node/v12.18.1/lib/node_modules/@aws-amplify/cli/node_modules/aws-sdk/lib/event_listeners.js:132:42)\r\n    at Request.callListeners (/Users/aldrincastro/.nvm/versions/node/v12.18.1/lib/node_modules/@aws-amplify/cli/node_modules/aws-sdk/lib/sequential_executor.js:106:20)\r\n    at callNextListener (/Users/aldrincastro/.nvm/versions/node/v12.18.1/lib/node_modules/@aws-amplify/cli/node_modules/aws-sdk/lib/sequential_executor.js:96:12)\r\n    at /Users/aldrincastro/.nvm/versions/node/v12.18.1/lib/node_modules/@aws-amplify/cli/node_modules/aws-sdk/lib/event_listeners.js:86:9\r\n    at finish (/Users/aldrincastro/.nvm/versions/node/v12.18.1/lib/node_modules/@aws-amplify/cli/node_modules/aws-sdk/lib/config.js:386:7)\r\n    at /Users/aldrincastro/.nvm/versions/node/v12.18.1/lib/node_modules/@aws-amplify/cli/node_modules/aws-sdk/lib/config.js:404:9 {\r\n  code: 'MissingRequiredParameter',\r\n  time: 2020-09-17T08:36:58.623Z\r\n}`\r\n\r\n**Versions**\r\n\r\n**React Native**\r\n0.62.2\r\n\r\n**@aws-amplify/cli**\r\n4.29.2\r\n\r\n**aws-amplify-react-native**\r\n4.2.6\r\n\r\n**aws-amplify**\r\n3.3.1","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xOTgyMw==","author":{"login":"jpmoreau2"},"title":"Amplify - React sdk throw error when verifying TOTP code w\\ google authenticator","body":"**Describe the bug**\r\nI am using amplify react sdk to create a login oauth path.  Because I read in a past post that the Cognito hosted UI could not be used to setup TOTP (dating from 2017 and I was not able to find anything updated about this), I decided to go with react for this setup.\r\nUsers are created by administrators exclusively (no sign-up page) through the aws console. When the user login for the first time, he needs to reset his password and then received a SMS-MFA code. Once this is done, he is logged in.  In the app, there is a setup page for the user to change his prefered MFA.\r\n\r\nI get a QR code but when I verify the numbers using google authenticator, Cognito respond with :\r\n![Screen Shot 2020-09-16 at 1 05 54 PM](https://user-images.githubusercontent.com/71400546/93369432-5dd1ec00-f81d-11ea-9d69-ace58393cba4.png)\r\n\r\nHere is the UI\r\n![Screen Shot 2020-09-16 at 1 04 41 PM](https://user-images.githubusercontent.com/71400546/93369524-7fcb6e80-f81d-11ea-800a-676976784f5c.png)\r\n\r\nHere is the javascript code for that page:\r\n```javascript\r\nimport React from 'react'\r\nimport { withRouter, Link } from 'react-router-dom'\r\nimport { Auth } from 'aws-amplify'\r\nimport QRCode from 'qrcode.react'\r\n\r\nexport default class Totp extends React.Component {\r\n  state = {\r\n    username: '',\r\n    user: {},\r\n    qrCode: '',\r\n    challengeAnswer: ''\r\n  }\r\n  componentDidMount() {\r\n    Auth.currentAuthenticatedUser().then(user => this.setState({ user }))\r\n    Auth.currentUserInfo()\r\n      .then(data => {\r\n        this.setState({\r\n          username: data.username\r\n        })\r\n      })\r\n      .catch(err => console.log('error: ', err))\r\n  }\r\n  addTTOP = () => {\r\n    Auth.setupTOTP(this.state.user).then((code) => {\r\n\r\n      console.log(\"user : \", this);\r\n      console.log(\"state: \", this.state)\r\n      console.log(\"state user : \", this.state.user);\r\n      const authCode = \"otpauth://totp/customApp:\"+ this.state.user.username + \"?secret=\" + code + \"&issuer=Amazon%20Cognito\";\r\n      console.log(\"AuthCode: \", authCode);\r\n      this.setState({ qrCode: authCode })\r\n    });\r\n  }\r\n  setPreferredMFA = (authType) => {\r\n    console.log(\"verifyTotpToken: \", this.state.user, \" and this : \", this.state.challengeAnswer);\r\n    Auth.verifyTotpToken(this.state.user, this.state.challengeAnswer).then(() => {\r\n      console.log(\"setPreferredMFA \",this.state.user,\"and this again \", authType)\r\n      Auth.setPreferredMFA(this.state.user, authType)\r\n        .then(data => console.log('data from verify...: ', data))\r\n        .catch(err => console.log('error: ', err))\r\n    });\r\n  }\r\n  render() {\r\n    return (\r\n      <div>\r\n        <h1>Welcome {this.state.username}</h1>\r\n        <Link to='/route1' label='route1'>Route 1</Link><br /><br /><br />\r\n        <button onClick={this.addTTOP} style={{ border: '1px solid #ddd', width: 125 }}>\r\n          <p>Add TOTP</p>\r\n        </button>\r\n        {\r\n          (this.state.qrCode !== '') && (\r\n            <div>\r\n              <br />\r\n              <QRCode value={this.state.qrCode} />\r\n            </div>\r\n          )\r\n        }\r\n        <br /><br /><br />\r\n        <input\r\n          placeholder='TOTP Code'\r\n          onChange={e => this.setState({ challengeAnswer: e.target.value })}\r\n          style={{ border: '1px solid #ddd', height: 35 }}\r\n          />\r\n        <input\r\n          placeholder='TOTP Code state'\r\n          onChange={e => this.setState((state) =>\r\n            console.log(\"setState : \", state)          )}\r\n          style={{ border: '1px solid #ddd', height: 35 }}\r\n          />\r\n          <br /><br /><br />\r\n        <button onClick={() => this.setPreferredMFA('TOTP')} style={{ border: '1px solid #ddd', width: 125 }}>\r\n          <p>Prefer TOTP</p>\r\n        </button>\r\n        <br /><br />\r\n        <button onClick={() => this.setPreferredMFA('SMS')} style={{ border: '1px solid #ddd', width: 125 }}>\r\n          <p>Prefer SMS</p>\r\n        </button>\r\n        <br /><br /><br />\r\n\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\n```","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"jpmoreau2"},"body":"Oh well. After a week and a half, just figured the device did not have the right time stamp.  \r\nI'm ashamed"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xOTcyNA==","author":{"login":"lochawala"},"title":"specify attributes for GIS","body":"Hello All \r\n\r\nHow can i provide attributes in schema definition for GSI? \r\n\r\nLike in GIS3 i want only  PK SK & GSI3\r\n\r\nBelow is my schema \r\n```\r\ntype UsersAndOrgs \r\n@model @auth(rules: [{allow: owner}])\r\n@key(fields: [ \"PK\", \"SK\" ])\r\n@key(name: \"GSI1\", fields: [ \"GSI1\" ], queryField: \"GSI1\")\r\n@key(name: \"GSI2\", fields: [ \"GSI2\"], queryField: \"GSI2\") \r\n@key(name: \"GSI3\", fields: [ \"GSI3\"], queryField: \"GSI3\") \r\n{\r\n    id: ID!\r\n    PK: String!\r\n    SK: String!\r\n    GSI1: String\r\n    GSI2: String\r\n    GSI3: String\r\n    fullProfile:String\r\n    PKProfile:String\r\n    firstName:String\r\n    lastName:String\r\n    status:String\r\n    licExp:String\r\n    statusHist:String\r\n    subsLevel:String\r\n    role:String\r\n}\r\n```","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xOTY4NQ==","author":{"login":"jeff1evesque"},"title":"ParseError: 'import' and 'export' may appear only with 'sourceType: module'","body":"I'm attempting to utilize the amplify documentation:\r\n\r\n- https://docs.amplify.aws/lib/auth/start/q/platform/js#configure-your-application\r\n\r\nSo, I have the following `package.json`:\r\n\r\n```json\r\n{\r\n  \"name\": \"reactjs\",\r\n  \"version\": \"1.0.0\",\r\n  \"description\": \"packages needed for source files.\",\r\n  \"main\": \"index.js\",\r\n  \"scripts\": {\r\n    \"prebuild:dos2unix\": \"find . -type f -print0 | xargs -0 dos2unix\",\r\n    \"build:browserify\": \"browserify -t [ babelify --presets [ @babel/preset-env @babel/preset-react ] ] content.jsx > content.js\",\r\n    \"watch:jsx\": \"onchange '**/*.jsx' '**/*.js' -- npm run build:browserify\",\r\n    \"test\": \"NODE_ENV=test jest --config jest.config.js\",\r\n    \"report:coveralls\": \"cat lcov.info | ./node_modules/coveralls/bin/coveralls.js\"\r\n  },\r\n  \"author\": \"Jeffrey Levesque\",\r\n  \"license\": \"BSD\",\r\n  \"repository\": \"github:jeff1evesque/xxxxxxxxxxxxxx\",\r\n  \"dependencies\": {\r\n    \"dos2unix-cli\": \"^1.0.1\",\r\n    \"babelify\": \"^10.0.0\",\r\n    \"browserify\": \"^16.5.2\",\r\n    \"onchange\": \"^3.3.0\",\r\n    \"babel-jest\": \"^23.6.0\",\r\n    \"core-js\": \"^2.5.4\",\r\n    \"whatwg-fetch\": \"^2.0.2\",\r\n    \"promise-polyfill\": \"^7.0.0\",\r\n    \"query-string\": \"^5.0.1\",\r\n    \"react\": \"^16.2.0\",\r\n    \"react-dom\": \"^16.2.0\",\r\n    \"react-router-dom\": \"^4.2.2\",\r\n    \"react-redux\": \"^5.0.6\",\r\n    \"react-bootstrap\": \"^0.32.0\",\r\n    \"react-router-bootstrap\": \"^0.24.4\",\r\n    \"redux\": \"^3.7.2\",\r\n    \"rearm\": \"^0.8.2\",\r\n    \"d3\": \"^4.12.2\",\r\n    \"prop-types\": \"15.6.0\",\r\n    \"react-json-view\": \"1.16.0\",\r\n    \"jest-cli\": \"^23.6.0\",\r\n    \"enzyme\": \"^3.6.0\",\r\n    \"enzyme-adapter-react-16\": \"1.5.0\",\r\n    \"global\": \"^4.3.2\",\r\n    \"coveralls\": \"^3.0.2\",\r\n    \"aws-amplify\": \"^3.2.0\",\r\n    \"@aws-amplify/ui-react\": \"^0.2.19\",\r\n    \"@babel/preset-env\": \"^7.11.5\",\r\n    \"@babel/core\": \"^7.11.6\",\r\n    \"@babel/preset-react\": \"^7.10.4\"\r\n  }\r\n}\r\n```\r\n\r\nWhich unfortunately generates the following error:\r\n\r\n```bash\r\n[Container] 2020/09/16 02:45:42 Running command npm run build:browserify\r\n--\r\n955 |  \r\n956 | > reactjs@1.0.0 build:browserify /codebuild/output/src375884655/src/jsx\r\n957 | > browserify -t [ babelify --presets [ @babel/preset-env @babel/preset-react ] ] content.jsx > content.js\r\n958 |  \r\n959 |  \r\n960 | /codebuild/output/src375884655/src/jsx/aws-exports:1\r\n961 | import Amplify, { Auth } from 'aws-amplify';\r\n962 | ^\r\n963 | ParseError: 'import' and 'export' may appear only with 'sourceType: module'\r\n964 | npm ERR! code ELIFECYCLE\r\n965 | npm ERR! errno 1\r\n966 | npm ERR! reactjs@1.0.0 build:browserify: `browserify -t [ babelify --presets [ @babel/preset-env @babel/preset-react ] ] content.jsx > content.js`\r\n967 | npm ERR! Exit status 1\r\n968 | npm ERR!\r\n969 | npm ERR! Failed at the reactjs@1.0.0 build:browserify script.\r\n970 | npm ERR! This is probably not a problem with npm. There is likely additional logging output above.\r\n971 |  \r\n972 | npm ERR! A complete log of this run can be found in:\r\n973 | npm ERR!     /root/.npm/_logs/2020-09-16T02_45_42_801Z-debug.log\r\n974 |  \r\n975 | [Container] 2020/09/16 02:45:42 Command did not exit successfully npm run build:browserify exit status 1\r\n976 | [Container] 2020/09/16 02:45:42 Phase complete: BUILD State: FAILED\r\n977 | [Container] 2020/09/16 02:45:42 Phase context status code: COMMAND_EXECUTION_ERROR Message: Error while executing command: npm run build:browserify. Reason: exit status 1\r\n```","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xOTYxMA==","author":{"login":"xterikatx"},"title":"Android app closes when sending notification with PinPoint - React Native","body":"### - I've been having this problem for weeks, and I still couldn't solve it, I have a document on the google drive that contains all the images of settings made in my application. [MORE DETAILS](https://docs.google.com/document/d/1S9_RCwxvZYVJ-lAI8ZEVHL6ApGN2lQcRrtBE9cTz5jo/edit)\r\n\r\nI thought the problem was because I was trying to send notifications by emulator, but the same problem occurs on a real device.\r\n\r\n**in app>build.gradle**\r\n\r\n`apply plugin: \"com.android.application\"\r\napply plugin: 'com.google.gms.google-services'\r\napply plugin: 'io.fabric'\r\n\r\nimport com.android.build.OutputFile\r\n[...]\r\ndependencies {\r\n    implementation project(':@react-native-community_netinfo')\r\n    implementation project(':@react-native-community_google-signin')\r\n\r\n    implementation 'com.android.support:appcompat-v7:28.0.0'\r\n    implementation 'androidx.swiperefreshlayout:swiperefreshlayout:1.1.0-alpha02'\r\n    implementation 'com.google.android.gms:play-services-auth:17.0.0'\r\n    implementation 'com.google.firebase:firebase-analytics:17.2.1'\r\n    implementation \"androidx.annotation:annotation:1.1.0\"\r\n    implementation \"com.google.firebase:firebase-auth:17.0.0\"\r\n    implementation 'com.android.support:support-annotations:28.0.0'\r\n    implementation \"com.google.firebase:firebase-core:16.0.9\"\r\n    implementation 'com.android.support:multidex:1.0.3'\r\n\r\n    implementation \"com.google.firebase:firebase-messaging:20.2.4\"\r\n    implementation 'com.crashlytics.sdk.android:crashlytics:2.10.1'\r\n  \r\n    implementation 'com.google.firebase:firebase-auth:17.0.0'\r\n    def multidex_version = \"2.0.1\"\r\n    implementation \"androidx.multidex:multidex:2.0.1\"\r\n\r\n    implementation fileTree(dir: \"libs\", include: [\"*.jar\"])\r\n\r\n    implementation project(':react-native-vector-icons')\r\n\r\n    implementation 'com.facebook.android:facebook-android-sdk:[5,6)'\r\n\r\n    if (enableHermes) {\r\n        def hermesPath = \"../../node_modules/hermes-engine/android/\";\r\n        debugImplementation files(hermesPath + \"hermes-debug.aar\")\r\n        releaseImplementation files(hermesPath + \"hermes-release.aar\")\r\n    } else {\r\n        implementation jscFlavor\r\n}\r\n}\r\n[...]`\r\n\r\n\r\n**in the androidmanifest.xml**\r\n\r\n`<manifest xmlns:android=\"http://schemas.android.com/apk/res/android\"\r\n    package=\"**hidden**\">\r\n\r\n    <uses-permission android:name=\"android.permission.INTERNET\" />\r\n    <uses-permission android:name=\"android.permission.CAMERA\" />\r\n    <uses-permission android:name=\"android.permission.WRITE_EXTERNAL_STORAGE\" />\r\n <!-- < Only if you're using GCM or localNotificationSchedule() > -->\r\n    <uses-permission android:name=\"android.permission.WAKE_LOCK\" />\r\n    <permission\r\n        android:name=\"com.nevii.permission.C2D_MESSAGE\"\r\n        android:protectionLevel=\"signature\" />\r\n    <uses-permission android:name=\"{{app.id.HIDDEN}}.permission.C2D_MESSAGE\" />\r\n    <!-- < Only if you're using GCM or localNotificationSchedule() > -->\r\n      <uses-permission android:name=\"android.permission.VIBRATE\" />\r\n    <uses-permission android:name=\"android.permission.RECEIVE_BOOT_COMPLETED\"/>\r\n \r\n\r\n    <application\r\n        android:name=\".MainApplication\"\r\n        android:allowBackup=\"false\"\r\n        android:icon=\"@mipmap/ic_launcher\"\r\n        android:label=\"@string/app_name\"\r\n        android:theme=\"@style/AppTheme\"\r\n        android:usesCleartextTraffic=\"true\">\r\n        <meta-data\r\n            android:name=\"com.facebook.sdk.ApplicationId\"\r\n            android:value=\"@string/facebook_app_id\" />\r\n        <activity\r\n            android:name=\"com.facebook.FacebookActivity\"\r\n            android:configChanges=\"keyboard|keyboardHidden|screenLayout|screenSize|orientation\"\r\n            android:label=\"@string/app_name\" />\r\n\r\n        <activity\r\n            android:name=\"com.facebook.CustomTabActivity\"\r\n            android:exported=\"true\">\r\n            <intent-filter><action android:name=\"android.intent.action.VIEW\" />\r\n\r\n                <category android:name=\"android.intent.category.DEFAULT\" />\r\n                <category android:name=\"android.intent.category.BROWSABLE\" />\r\n\r\n                <data android:scheme=\"@string/fb_login_protocol_scheme\" />\r\n            </intent-filter>\r\n        </activity>\r\n        <activity\r\n            android:name=\".MainActivity\"\r\n            android:configChanges=\"keyboard|keyboardHidden|orientation|screenSize\"\r\n            android:label=\"@string/app_name\"\r\n            android:windowSoftInputMode=\"adjustResize\">\r\n            <intent-filter>\r\n                <action android:name=\"android.intent.action.MAIN\" />\r\n                <category android:name=\"android.intent.category.LAUNCHER\" />\r\n            </intent-filter>\r\n        </activity>\r\n        <activity android:name=\"com.facebook.react.devsupport.DevSettingsActivity\" />\r\n\r\n            <!-- < Only if you're using GCM or localNotificationSchedule() > -->\r\n        <receiver\r\n            android:name=\"com.google.android.gms.gcm.GcmReceiver\"\r\n            android:exported=\"true\"\r\n            android:permission=\"com.google.android.c2dm.permission.SEND\" >\r\n            <intent-filter>\r\n                <action android:name=\"com.google.android.c2dm.intent.RECEIVE\" />\r\n                <category android:name=\"com.nevii.gcm\" />\r\n            </intent-filter>\r\n        </receiver> \r\n         <service\r\n             android:name=\"com.amazonaws.amplify.pushnotification.RNPushNotificationMessagingService\">\r\n             <intent-filter>\r\n                 <action android:name=\"com.google.firebase.MESSAGING_EVENT\"/>\r\n             </intent-filter>\r\n         </service>\r\n         <!-- [END firebase_service] -->\r\n         <!-- [START firebase_iid_service] -->\r\n         <service\r\n             android:name=\"com.amazonaws.amplify.pushnotification.RNPushNotificationDeviceIDService\">\r\n             <intent-filter>\r\n                 <action android:name=\"com.google.firebase.INSTANCE_ID_EVENT\"/>\r\n             </intent-filter>\r\n         </service>\r\n         <receiver\r\n             android:name=\"com.amazonaws.amplify.pushnotification.modules.RNPushNotificationBroadcastReceiver\"\r\n             android:exported=\"false\" >\r\n             <intent-filter>\r\n                 <action android:name=\"com.amazonaws.amplify.pushnotification.NOTIFICATION_OPENED\"/>\r\n             </intent-filter>\r\n         </receiver>\r\n     <!-- [END Push notification config -->\r\n    </application>\r\n</manifest>`\r\n\r\n\r\n**in root>app.js**\r\n\r\n`NativeModules.RNPushNotification.getToken(token_push => {\r\n      console.log('token push in getToken', token_push);\r\n      this.setState({tokenPush: token_push});\r\n\r\n    });\r\n    await PushNotification.onRegister(() => {\r\n      console.log('call ~onregister');\r\n      PushNotification.updateEndpoint(token_push);\r\n    });\r\n    PushNotification.onNotification(notification => {\r\n      if (notification.foreground) {\r\n        console.log('onNotification foreground', notification);\r\n      } else {\r\n        console.log('onNotification background or closed', notification);\r\n      }\r\n      // extract the data passed in the push notification\r\n      const data = JSON.parse(notification.data['pinpoint.jsonBody']);\r\n      console.log('onNotification data', data);\r\n      // iOS only\r\n      // notification.finish(PushNotificationIOS.FetchResult.NoData);\r\n    });\r\n\r\n    // get the notification data when notification is opened\r\n    PushNotification.onNotificationOpened(notification => {\r\n      console.log('onNotificationOpened', notification);\r\n      // extract the data passed in the push notification\r\n      const data = JSON.parse(notification['pinpoint.jsonBody']);\r\n      console.log('onNotificationOpened data', data);\r\n    });`\r\n\r\n\r\n**Can someone help me? pleaseee**\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xODgzMw==","author":{"login":"ericclemmons"},"title":"Export GRAPHQL_AUTH_MODE from aws-amplify","body":"**Is your feature request related to a problem? Please describe.**\r\n\r\nI'm always frustrated when I have `import { API, Auth } from 'aws-amplify'` but need to specify `authMode` for my `API.graphql` call, but don't remember if it's `IAM` or `AWS_IAM`.  Instead, I want to use `GRAPHQL_AUTH_MODE`, but that requires a separate import to `@aws-amplify/api` or `@aws-amplify/api-graphql`.\r\n\r\n**Describe the solution you'd like**\r\n\r\n`@aws-amplify/api` should:\r\n\r\n- `export { GraphQLAPI } from \"@aws-amplify/api-graphql\"`\r\n- `export { GRAPHQL_AUTH_MODE } from \"@aws-amplify/api-graphql\"`\r\n- `export { RestAPI } from \"@aws-amplify/api-graphql\"`\r\n\r\n`aws-amplify` should re-export those from `@aws-amplify/api`.\r\n\r\nThis will also allow improved tree-shaking for only `RestAPI` users who could find/replace usages of `import { API }` with `import { RestAPI }` and get bundle-size savings with only 4 keystrokes!\r\n\r\n**Describe alternatives you've considered**\r\n\r\n`import { GRAPHQL_AUTH_MODE } from \"@aws-amplify/api-graphql\"`.\r\n\r\nThis feels like I'm reaching into the `aws-amplify` implementation details to pull out this reference.  \r\n\r\n**Additional context**\r\n\r\nSupported APIs & interfaces should hang off of `aws-amplify`.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"manueliglesias"},"body":"We have a chance to export with a better name, `GRAPHQL_AUTH_MODE` can be a little missleading since it is AppSync specific"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xODk1MQ==","author":{"login":"ShehryarKh"},"title":"photo picker amplify storage 403 error","body":"Hi, I need some help.\r\n\r\nSo I have added auth via `amplify add auth` & storage `amplify add storage`\r\n\r\nin code im doing \r\n```\r\n<div class=\"my-8\">\r\n     <amplify-s3-image-picker\r\n          button-text=\"yes\"\r\n          header-title=\"Campaign Photo\"\r\n          track=\"true\"\r\n          :path=\"imgpath\"\r\n     ></amplify-s3-image-picker>\r\n</div>\r\n<div>\r\n   <amplify-s3-image level=\"public\" track=\"true\" :img-key=\"{{imgpath}}\" />\r\n</div>\r\n```\r\nI have a Hub listener that listens to events and checks for a successful upload.\r\nI use UUID to generate a key and I place user images  in s3 like `users/COGNITOID/images/UUID`\r\nI store the path to the image in graphql db schema\r\n\r\nThat is how im storing images for a user. They are all in public folder in s3. However, I continue to get a 403 forbidden error.\r\n` <amplify-s3-image level=\"public\" track=\"true\" :img-key=\"{{imgpath}}\" />` Returns that error:\r\n\r\nto test im not doing anything wrong I added a `ball.png` right in the public folder in s3. I still got the same error.\r\n\r\n```\r\nhttps://...s3.amazonaws.com/public/ball.png?X-Amz-Algorithm=AWS4-HMA\r\n```\r\n\r\nWhy do I get this 403 if the setup was done though amplify and guest users have read access?\r\nIs there a better way to store images than just storing the path?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xODgzMQ==","author":{"login":"elaidlaw"},"title":"Amplify/Cognito quickly forgetting devices","body":"We're using aws-amplify-react-native with Cognito to manage user authentication for our iOS app. On the Cognito user pool, we have the following settings configured:\r\n\r\nDo you want to enable Multi-Factor Authentication (MFA)?: opt-in (our frontend automatically opts users in)\r\nDo you want to remember your user's devices?: Always\r\nDo you want to use a remembered device to suppress the second factor during multi-factor authentication (MFA)?: Yes\r\n\r\nGiven these settings, after signing in and submitting the MFA code, the device should be remembered and subsequent logins should not require the second factor to authenticate. This is the case after each login for some amount time in the minutes to hours range, but after that, MFA is again required.\r\n\r\nSomething curious to me is that in the remembered devices in the Cognito user pool, it seems to be remembering the same device many times. The image below shows this being the case. This is my account, which I have only used on my phone. The IP changes based on what WiFi I'm on, but even several \"devices\" with the same IP are shown. Why is this the case?\r\n\r\n![Screen Shot 2020-09-10 at 4 13 41 PM](https://user-images.githubusercontent.com/10340382/92798237-c124cf80-f380-11ea-888a-51be912cc3a6.png)\r\n\r\nAny ideas why Amplify and Cognito aren't remembering devices properly? Also of note is the fact that this worked until a few months ago.\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xODM4NQ==","author":{"login":"minimalistinnovator"},"title":"Is there an API library for AWS Personalize Runtime","body":"I have created recommenders and campaigns in AWS Personalize. However, all the examples are using Python and could not find any examples to plug into AWS Amplify/react project.\r\n\r\nI was able to call the Personalize API directly but that required Authentication token. If this is the only option, how can I authenticate through Cognito pools and pass the credentials to the API?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"minimalistinnovator"},"body":"Solved this in a round about way:\r\nReact->API->Lambda->Personalize. Here is the lambda:\r\n```\r\nimport boto3\r\n\r\ndef handler(event, context):\r\n    personalizeRt = boto3.client('personalize-runtime')\r\n\r\n    if 'queryStringParameters' in event and 'itemId' in event['queryStringParameters']:\r\n        queryStringParameters = event['queryStringParameters']\r\n        itemId = queryStringParameters['itemId']\r\n        response = personalizeRt.get_recommendations(\r\n            campaignArn='xxxxxxxx',\r\n            itemId=itemId)\r\n        return {\r\n            'recommendations': response['itemList']\r\n        }\r\n    else:\r\n        return {\r\n            'message': 'ItemId should be passed in the queryStringParameters'\r\n        }\r\n```"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNzQ2Ng==","author":{"login":"bishonbopanna"},"title":"How to develop in one region and have production in different region ?","body":"Use case scenario : \r\n\r\n- Development for react amplify project is carried out in us-east-1 - USA EAST\r\n- Deployment is for Australia, so project will be deployed in ap-southeast-2 Sydney Australia\r\n\r\nQuestion - Is this possible using amplify ? I do understand the concept of envs in Amplify where in you could have dev, qe and prod. However all seem to be in the same region.\r\n\r\nAmplify can read from the a repo and deploy directly to production env for each new commit. Is this possible by maintaining the repo is just one region where development and testing is carried out and deployed for production in a completely different region like in the above use case ?\r\n\r\n\r\n","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNzM0Ng==","author":{"login":"ifmael"},"title":"Several warning with I add subscriptions. (validation errors)","body":"I've added some subscription in my app.  The models for these subscriptions is:\r\n\r\n```\r\n\r\ntype Content\r\n  @model\r\n  @aws_iam\r\n  @aws_cognito_user_pools\r\n  @auth(rules: [\r\n    { allow: owner, ownerField: \"owner\", operations: [delete, update] }\r\n  ])\r\n  @key(name: \"byContent\", fields: [\"userID\"])\r\n  @key(name: \"byUrl\", fields: [\"contentUrl\"])\r\n  {\r\n    id: ID!\r\n    createdOn: AWSTimestamp!\r\n    title: String!\r\n    owner: ID!\r\n    subtitle: String\r\n    description: String!\r\n    image: S3object\r\n    contentUrl: String\r\n    userID: ID!\r\n    type: String\r\n    imageUrl: String\r\n    skills: [ContentSkill] @connection(keyName: \"byContentSkill\", fields: [\"id\"])\r\n  }\r\n\r\ntype Notification\r\n  @model(queries: null)\r\n  @aws_iam\r\n  @aws_cognito_user_pools\r\n  @auth(rules: [\r\n    { allow: owner , ownerField: \"ownerID\", operations:[ delete, update]}\r\n  ])\r\n  @key(name:\"toUserID\", fields:[\"toUserID\"]){\r\n    id: ID!\r\n    createdOn: AWSTimestamp!\r\n    title: String!\r\n    type: Int!\r\n    url: String!\r\n    ownerID: ID!\r\n    toUserID: ID!\r\n    fromUserID: ID!\r\n    fromUser: User @connection(fields:[\"fromUserID\"])\r\n  }\r\n```\r\n\r\nI'm using React so I subscribe to it in the useEffect hooks:\r\n```\r\nuseEffect(() => {\r\n  const listContent = async () => {\r\n    // Does something\r\n  };\r\n\r\n\r\n  listContent();\r\n  const subscription = DataStore.observe(Content).subscribe(() => listContent())\r\n  \r\n  return () => subscription.unsubscribe();\r\n  }, []);\r\n\r\n\r\n  \r\n  useEffect(() => {\r\n    const getNewNotification = async (newNotification) => {\r\n      //  does soemething\r\n    };\r\n    \r\n    const subscription = DataStore.observe(\r\n      Notification\r\n    ).subscribe((newNotification) => getNewNotification(newNotification));\r\n\r\n    return () => subscription.unsubscribe();\r\n  }, [userNotifications, user]);\r\n```\r\n\r\nI generated the models with `amplify codegen models` and pushed the changes.\r\n\r\nThe subscription works but i got there warning in the console\r\n\r\n```\r\nConsoleLogger.ts:91 [WARN] 38:44.946 DataStore - Connection failed: {\"errors\":[{\"message\":\"Validation error of type UnknownArgument: Unknown field argument owner @ 'onUpdateContent'\"}]}\r\nConsoleLogger._log @ ConsoleLogger.ts:91\r\nConsoleLogger.ts:91 [WARN] 38:44.947 DataStore - Connection failed: {\"errors\":[{\"message\":\"Validation error of type UnknownArgument: Unknown field argument owner @ 'onDeleteContent'\"}]}\r\nConsoleLogger._log @ ConsoleLogger.ts:91\r\nConsoleLogger.ts:91 [WARN] 38:44.949 DataStore - Connection failed: {\"errors\":[{\"message\":\"Validation error of type UnknownArgument: Unknown field argument ownerID @ 'onDeleteNotification'\"}]}\r\nConsoleLogger._log @ ConsoleLogger.ts:91\r\nConsoleLogger.ts:91 [WARN] 38:44.972 DataStore - Connection failed: {\"errors\":[{\"message\":\"Validation error of type UnknownArgument: Unknown field argument \r\n``` \r\n\r\nis there something wrong in the code?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNzIwNg==","author":{"login":"lr001dev"},"title":"Branch Restrictions In Team Environment","body":"So, I'm wondering how one would enforce certain permissions on branches built by Amplify? I'd like to control who can push to our develop branch... currently, after successfully setting up my team on our resources using this tutorial https://docs.amplify.aws/cli/usage/iam-roles-mfa, anyone with access can push or change any branch currently deployed. Does amplify have any feature to help restrict some behavior?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNjc5Ng==","author":{"login":"dylan-westbury"},"title":"How to tell which environment an Elastic Search domain belongs to?","body":"Is there a way to find out which environment an Elastic Search domain belongs to? \r\n\r\nI can't find anything noticeable anywhere, I tried searching the Elastic Domain Name id (e.g. amplify-elasti-xxxxxxxxx - the xxxxxxx) in amplify directory also, but no luck.\r\n\r\nCheers","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNjY1MA==","author":{"login":"PeteDuncanson"},"title":"GDPR support/ideas with GraphQL","body":"I've been busy playing around with a prototype app I'm making and all has been going well. But then it occurred to me that fun though this is to follow the tutorials I need it to take into account privacy and the beast that is GDPR.\r\n\r\nCouple of queries really that are open for input from anyone:\r\n\r\n* Is it possible to encrypt the data in the DynamoDB used under the hood of the GraphQL api in Amplify? If so they this ticks a big box in the GDPR hit list, if not we can work around it but I couldn't find anything about amplify and encryption of sensitive data in the underlying DB.\r\n* I want to keep sensitive data in separate tables and log when someone requests to access it (so if you want to contact a customer by phone you would have click a button to say \"show the number\" and we would log this access request so we can see who has seen what). Wondering how best to do that in GraphQL. Not looked at subscriptions yet but wondered if that was the way to go. Any ideas or pointers?\r\n\r\nCheers\r\n\r\nPete","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNjY0NQ==","author":{"login":"cnbrkkaya"},"title":"Aws Amplify Using Multiple Cognito User Pools in One GraphQL Api","body":"I have two different front end (react) projects. One of them for blog readers and one of them for editors.For both application i want to use same DynamoDB tables(and use graphql api). But i want to different user pools for each project. How can i implement this?\r\n\r\nI was reading this article - https://medium.com/@fullstackpho/aws-amplify-multi-auth-graphql-public-read-and-authenticated-create-update-delete-1bf5443b0ad1\r\n\r\nI know aws appsync support multiple authorization types like cognito, api key ... But does it support two cognito type?\r\n\r\nThanks,","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNjM0Ng==","author":{"login":"marianolc"},"title":"How to add an extra value in the Sign In request using Cognito","body":"Hi! I trying to develop a multi-tenant app. \r\n\r\nWhat I'm trying to achieve now is to give the user the option to write the workspace/section/group he is going to work before the sign-in. \r\n\r\nSomething similar to slack when you have to indicate first the \"workspace\" and then your credentials. Or the same AWS where you can log in with accountId + email when using IAM.\r\n\r\nThis value will be used in the pre token generation lambda to assign the correct groups. So I would need to know how to read that value there.\r\n\r\nThanks!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNjI1MQ==","author":{"login":"psaks"},"title":"Hide Skip link in VerifyContact in aws-amplify-react","body":"Hi all,\r\n\r\nDoes anyone know how to hide the \"Skip\" link in VerifyContact - does it even make sense to have it there? \r\n\r\nWould you ever want a user to be signed in if the contact (e.g., email) is not verified? \r\n\r\n","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNjEyMw==","author":{"login":"elchicofrommo"},"title":"Appsync: how to fail create mutation if the key already exists","body":"I know I saw this somewhere but I can't find it again. I have a model with a pk/sk. Calling createXXX with the same pk/sk overrides the original (particularly with createdAt/updatedAt) but I'd like it to fail or noop. I thought I could use the conditional input that is generated, but condition type never includes the pk/sk. Is the only solution really to write a custom resolver with the condition checks? Seems like this would be a common use case so I'd be surprised if that were the case.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNDkwOQ==","author":{"login":"elchicofrommo"},"title":"Using Amplify inside Jest","body":"I'm writing some integration tests with amplify that I can run  after standing up an environment that validate expected APIs, Auth  and some Appsync endpoints. Problem is, when I use my same export to Amplify.configure as I use for the running the app I get empty objects for currentCredentials (I have unauth ident pools set up) and calling signUp or sign in fails. I have to assume it's because I'm running in Jest. I've tried to  use jest.requireActual but that doesn't work either. Any thoughts?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"elchicofrommo"},"body":"I ended up opening a ticket, ive seen a few others comment that this was a problem for them as well. "}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNjAzMg==","author":{"login":"Ajwah"},"title":"Use UI components for federated signin flows","body":"I have setup `amplify add auth` for Google Oauth. I am able to get it working with `Auth.federatedSigning` components but such components are bereft of any styling. As such, I want to leverage `<AmplifyAuthenticator />` instead. However, when I do:\r\n```\r\nimport App from './App'\r\nimport Amplify from 'aws-amplify'\r\nimport config from './aws-exports'\r\nAmplify.configure(config)\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n```\r\nand for App.js:\r\n```\r\nimport { AmplifyAuthenticator } from '@aws-amplify/ui-react';\r\nfunction App() {\r\n  return (\r\n    <AmplifyAuthenticator />\r\n  )\r\n}\r\n```\r\n\r\nthen it is not rendering for me the Google Sign in button:\r\n![Screen Shot 2020-08-29 at 8 11 35 PM](https://user-images.githubusercontent.com/11848116/91648300-d8d08f80-ea33-11ea-8255-caac25f33dd6.png)\r\nOf course, clicking on `Sign In With AWS` button does render the desired `Continue with Google Account`:\r\n![Screen Shot 2020-08-29 at 8 12 29 PM](https://user-images.githubusercontent.com/11848116/91648310-f9004e80-ea33-11ea-8632-6c54a75b1639.png)\r\nand when pressing it all works fine. However, instead; I would like that social account signin to be present on the main component. After some searching, it appears that `<AmplifyAuthenticator>` accepts the property: `federated` and generally is to be used like this:\r\n```\r\nconst federated = {\r\n  googleClientId: \"*****\",\r\n  oauthConfig: {\r\n    redirectSignIn: \"http://localhost:3000/\",\r\n    redirectSignOut: \"http://localhost:3000/\",\r\n  }\r\n}\r\n\r\nfunction App() {\r\n  return (\r\n    <AmplifyAuthenticator federated={federated} />\r\n  )\r\n}\r\n```\r\nThis does render the desired button:\r\n![Screen Shot 2020-08-29 at 8 16 03 PM](https://user-images.githubusercontent.com/11848116/91648359-77f58700-ea34-11ea-98aa-58d06cd21542.png)\r\n\r\nBut when I click that button then I get the error:\r\n```\r\n{error: \"idpiframe_initialization_failed\", details: \"Not a valid origin for the client: http://localhos…itelist this origin for your project's client ID.\"}\r\ndetails: \"Not a valid origin for the client: http://localhost:3000 has not been whitelisted for client ID *****. Please go to https://console.developers.google.com/ and whitelist this origin for your project's client ID.\"\r\nerror: \"idpiframe_initialization_failed\"\r\n__proto__: Object\r\n```\r\n\r\nThe questions I have at this point are:\r\n1. Why do I need to pass through a `federated` property repeating all the information I already provided during the `amplify add auth` flow? `team-provider-info.json` and `aws-exports.json` contain all that information so when doing `Amplify.configure(config)` in `index.js`, why does the component `<AmplifyAuthenticator />` not suffice to recognize that a dedicated button for Google Signin is to be rendered as well?\r\n2. I tried to pinpoint exactly which `http://localhost:3000/` is causing the above error. I did a project wide search and I updated it do a different value in:\r\nA) federated property:\r\n```\r\nconst federated = {\r\n  googleClientId: \"*****\",\r\n  oauthConfig: {\r\n    redirectSignIn: \"http://localhost:3002/\",\r\n    redirectSignOut: \"http://localhost:3002/\",\r\n  }\r\n}\r\n```\r\nB) `amplify update auth` as follows:\r\n```\r\nlease note that certain attributes may not be overwritten if you choose to use defaults settings.\r\nUsing service: Cognito, provided by: awscloudformation\r\n What do you want to do? Add/Edit signin and signout redirect URIs\r\n Which redirect signin URIs do you want to edit? http://localhost:3000/\r\n? Update http://localhost:3000/ http://localhost:3002/\r\n Do you want to add redirect signin URIs? No\r\n? Do you want to add another redirect signin URI No\r\n Which redirect signout URIs do you want to edit? http://localhost:3000/\r\n? Update http://localhost:3000/ http://localhost:3002/\r\n Do you want to add redirect signout URIs? No\r\nSuccessfully updated resource oautha9745125 locally\r\n```\r\nThen I did a `amplify push`\r\n\r\nBut in both cases A and B; the error message is always complaining about: `http://localhost:3000/`. This leads me to believe that `http://localhost:3000/` is some default value set when there is no proper configuration on my side. So where does this value come from and why is this not working?\r\n\r\nLastly, I have not setup anything related to `AWS Signin` for OAuth purposes. So far I have only played with Google Oauth. Why is it that the button shows up and how to remove it?\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNTg1Mw==","author":{"login":"martysweet"},"title":"React: Cannot find module './amplify-authenticator.cjs.entry.js'","body":"Hi,\r\n\r\nI'm trying to upgrade to the new `@aws-amplify/ui-react` module but I am getting some runtime errors when I try and render the `AmplifyAuthenticator` component.\r\n\r\n**Code (initialized from App)**\r\n```js\r\nimport React, {Component} from 'react'\r\nimport { AmplifyAuthenticator, AmplifySignOut } from '@aws-amplify/ui-react';\r\n\r\nexport class Account extends Component {\r\n\r\n    render() {\r\n        return (\r\n                <AmplifyAuthenticator>\r\n                    <div>\r\n                        My App\r\n                        <AmplifySignOut />\r\n                    </div>\r\n                </AmplifyAuthenticator>\r\n        )\r\n    }\r\n\r\n}\r\n\r\nexport default Account;\r\n```\r\n\r\n**Errors**\r\n```\r\nreact_devtools_backend.js:2273 Error: Cannot find module './amplify-authenticator.cjs.entry.js'\r\n    at o (Analytics.js:7)\r\n    at Analytics.js:7\r\n    at index-dbc7c762.js:1627\r\n    at async initializeComponent (index-dbc7c762.js:1340)\r\n\r\nError: Cannot find module './amplify-nav_2.cjs.entry.js'\r\n    at o (Analytics.js:7)\r\n    at Analytics.js:7\r\n    at index-dbc7c762.js:1627\r\n    at async initializeComponent (index-dbc7c762.js:1340)\r\n```\r\n\r\nThe Analytics.js file mentioned here is `@aws-amplify/analytics/lib/Analytics.js`, which is a dependency of the `aws-amplify` package.\r\n\r\nMy package.json file contains the following aws-amplify packages (latest versions). node_modules has been deleted and reinstalled.\r\n```\r\n\"@aws-amplify/api\": \"^3.1.23\",\r\n\"@aws-amplify/ui-react\": \"^0.2.15\",\r\n\"aws-amplify\": \"^3.0.24\",\r\n```\r\n\r\nI'm thinking this is potentially a bundling issue? Though am not sure how to debug this issue further.\r\nI have the following browserify entry in my gulpfile.js.\r\n```js\r\nlet bundler = browserify(\r\n\t\t{\r\n\t\t\tentries      : PKG.main,\r\n\t\t\textensions   : [ '.js', '.jsx', '.tsx', '.ts' ],\r\n\t\t\t// required for sourcemaps (must be false otherwise).\r\n\t\t\tdebug        : process.env.NODE_ENV === 'development',\r\n\t\t\t// required for watchify.\r\n\t\t\tcache        : {},\r\n\t\t\t// required for watchify.\r\n\t\t\tpackageCache : {},\r\n\t\t\tfullPaths    : true,\r\n\t\t\tignoreMissing: true,\r\n\t\t})\r\n\t\t.transform('babelify', { extensions   : [ '.js', '.jsx', '.tsx', '.ts' ] })\r\n```\r\n\r\nAny help would be greatly appreciated!\r\n\r\nThanks,\r\nMarty","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNTYyNQ==","author":{"login":"sacrampton"},"title":"Command Line Query using AMAZON_COGNITO_USER_POOLS Authorization","body":"I am using Cognito User Pools on my GraphQL API and I want to run queries from the command line.\r\n\r\nThis web site gives the CURL command for an api-key authorization\r\nhttps://docs.aws.amazon.com/appsync/latest/devguide/security.html\r\n```\r\ncurl -XPOST -H \"Content-Type:application/graphql\" -H \"x-api-key:ABC123\" -d '{ \"query\": \"query { movies { id } }\" }' https://YOURAPPSYNCENDPOINT/graphql\r\n```\r\n\r\nHow can I use a Cognito identity to authorize a query instead of an api-key from a CURL command?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNTQ0Nw==","author":{"login":"hirocsingh"},"title":"How to use setupTOTP?","body":"I ran into this error while trying to get secret code.\r\n\r\n`Auth.ts: 843 Uncaught (in promise) TypeError: user.associateSoftwareToken is not a function`\r\n\r\nMy Code:\r\n\r\n```\r\nasync function getCode(user) {\r\n  let code = await Auth.setupTOTP(user);\r\n  return code;\r\n}\r\n\r\nuseEffect(() => {\r\n  if(location.search) {\r\n    let username = new URLSearchParams(location.search).get(\"user\");\r\n    let issuer = new URLSearchParams(location.search).get(\"issuer\");\r\n    let code = getCode(username);\r\n  }\r\n```","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNTM2Ng==","author":{"login":"dvliman"},"title":"facebook login button image","body":"I am working on a react-native app. The code looks like this:\r\n```\r\n  // in the view\r\n  return (\r\n    <View style={styles.container}>\r\n      <Button title=\"Facebook\" onPress={() => loginFacebook() }/>\r\n      <Button title=\"Google\" onPress={() => loginGoogle() }/>\r\n    </View>\r\n  );\r\n\r\n  // function definitions\r\n  const loginFacebook = () => Auth.federatedSignIn({ provider: 'Facebook' });\r\n  const loginGoogle   = () => Auth.federatedSignIn({ provider: 'Google' });\r\n\r\n```\r\n\r\nCalling `Auth.federatedSignIn({ provider: 'Facebook' });` will still point to hosted UI's URL (or rather the lambda function) and I believe it immediately redirect to Facebook's endpoint\r\n\r\nSo far so good\r\n\r\nThen I realize Facebook doesn't share the login button as an image anymore. \r\nhttps://developers.facebook.com/docs/facebook-login/web/login-button#faq - We either need to use the SDK or we can follow the iframe, find some ways to get the image: https://www.facebook.com/v8.0/plugins/login_button.php?app_id=113869198637480&auto_logout_link=false&button_type=continue_with&channel=https%3A%2F%2Fstaticxx.facebook.com%2Fx%2Fconnect%2Fxd_arbiter%2F%3Fversion%3D46%23cb%3Df2f5eac1c082cec%26domain%3Ddevelopers.facebook.com%26origin%3Dhttps%253A%252F%252Fdevelopers.facebook.com%252Ff381de9c9c39acc%26relation%3Dparent.parent&container_width=734&locale=en_US&login_text=&sdk=joey&size=large&use_continue_as=false\r\n\r\nI am not exactly sure if Facebook will have a problem with this. I doubt it. I am sure the image in the hosted UI works the same way\r\n> Can I use the Login button with server-side registration code?\r\nYou can, however you will still need to use the JavaScript SDK partially. Once the login process started by clicking on the button is done, the SDK will have access to an authResponse object using FB.getLoginStatus(). You can use this function to pass the response object to your server-side code to complete any registration that exists there.\r\n\r\nSo I was wondering if there is a plan to include the login image in the UI component?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb242MjEz","author":{"login":"anastasialanz"},"title":"Overriding the .section class within the Vue Authenticator component","body":"I'm looking to remove the `box-shadow` on the `.section` class within the `<amplify-sign-in>` shadow root. Is there a way to override this or style the container for the login form?\r\n\r\n<img width=\"1072\" alt=\"Screen Shot 2020-06-10 at 8 32 58 AM\" src=\"https://user-images.githubusercontent.com/3081483/84268025-096bf180-aaf5-11ea-8399-f95c3aa7d2ef.png\">\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"sammartinez"},"body":"@jordanranz @ashika01  Do we have this ability in our UI Components today to adjust this? "}},{"node":{"author":{"login":"sammartinez"},"body":"@anastasialanz I went ahead and created a feature request on your behalf as we currently don't have this support within our UI Components Library. Please find the feature request [here](https://github.com/aws-amplify/amplify-js/issues/6076)"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNTMxNQ==","author":{"login":"xuan9230"},"title":"How to generate base types for TypeScript with codegen?","body":"I'm building a React + aws AppSync graphql web app with amplify. Have been enjoying this fantastic tool, but couldn't get the `codegen` to work as I expected - it doesn't generate base types for TypeScript frontend.\r\n\r\nSay I feed this `schema.graphql` file to `amplify codegen`:\r\n\r\n```\r\ntype Event @model {\r\n  id: ID!\r\n  name: String\r\n  effects: [EventEffects]\r\n}\r\n\r\ntype EventEffect {\r\n  name: String\r\n  delta: Int\r\n}\r\n```\r\n\r\nwith this `config.yml`:\r\n\r\n```\r\nprojects:\r\n  myapi:\r\n    schemaPath: amplify/backend/api/myapi/build/schema.graphql\r\n    includes:\r\n      - src/graphql/**/*.ts\r\n    excludes:\r\n      - ./amplify/**\r\n    extensions:\r\n      amplify:\r\n        codeGenTarget: typescript\r\n        generatedFileName: src/API.ts\r\n        docsFilePath: src/graphql\r\nextensions:\r\n  amplify:\r\n    version: 3\r\n```\r\n\r\nThen codegen gives me `API.ts` and `queries.ts`, `mutations.ts`, `subscriptions.ts` and `schema.json`. The problem is, there are no base types generated.\r\n\r\nI can get interface for Event with:\r\n```\r\nexport interface Event\r\n  extends Omit<Exclude<GetEventQuery[\"getEvent\"], null>, \"__typename\"> {}\r\n```\r\n\r\nBut there's no way to get interface for `EventEffect`, since I didn't add `@modal` directive.\r\n\r\nTo narrow down my questions:\r\n\r\n1. Is it by design that amplify doesn't generate base types?\r\n\r\n2. How to get base type for `EventEffect`?\r\n\r\n3. What is the `schema.json` generated used for?\r\n\r\nThanks for any help!\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNTE0MA==","author":{"login":"joshis2020"},"title":"How to obtain AWS temporary credentials when using HOC like withAuthenticator","body":"I have seen that Amplify automatically calls the Auth.currentCredentials() and refreshes the token for us when making calls to AWS services that amplify supports. But for services like R53, we need to call the Auth.currentCredentials() manually and make the respective aws api calls. My question is, if the credentials expire after 1 hr then how do we detect this and handle this situation?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNTExNw==","author":{"login":"RameshRM"},"title":"How to Verify SMS Code in Cognito","body":"I am able to send `sms mfa code` on `User Login`, I want to understand how to confirm the User after the User Enters the `MFA Code` , I dont see `cognito identity js` docs related to this. \r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNDg2OA==","author":{"login":"CarlosBalladares"},"title":"Error: Unknown argument \"operations\" on directive \"@auth\".","body":"Not sure what I'm doing wrong. Has anyone got this message?\r\n\r\n```\r\ntype Form @model @auth(rules: [{ allow: all }], operations: [create]) {\r\n```","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNDQ4Mg==","author":{"login":"asumaran"},"title":"Invalid S3 bucket name (Bucket name shouldn't contain '/') when using `Storage` via AWS Amplify","body":"I'm migrating my app from `\"aws-amplify\": \"1.1.29\"` to `\"aws-amplify\": \"^3.0.23\"` and I got the following error.\r\n\r\nI couldn't find anything related to this warning so I was wondering what should I do regarding this. Should I change the bucket name? Thoughts?\r\n\r\nWorth mentioning that with the old aws-amplify version there's no warning and file upload works normal. With the new version file upload also works but the following warning is logged.\r\n\r\n```\r\nreact_devtools_backend.js:2273 [WARN] 57:46.301 AWSS3Provider - error uploading InvalidBucketName: Bucket name shouldn't contain '/', received 'project-name-ui-storage/cognito/project-ui'\r\n    at http://localhost:3000/static/js/0.chunk.js:294098:19\r\n    at step (http://localhost:3000/static/js/0.chunk.js:535975:17)\r\n    at Object.next (http://localhost:3000/static/js/0.chunk.js:535906:14)\r\n    at http://localhost:3000/static/js/0.chunk.js:535879:67\r\n    at new Promise (<anonymous>)\r\n    at Module.__awaiter (http://localhost:3000/static/js/0.chunk.js:535858:10)\r\n    at http://localhost:3000/static/js/0.chunk.js:294092:22\r\n    at S3Client.Client.send (http://localhost:3000/static/js/0.chunk.js:297053:14)\r\n    at AWSS3ProviderManagedUpload.<anonymous> (http://localhost:3000/static/js/0.chunk.js:124416:18)\r\n    at step (http://localhost:3000/static/js/0.chunk.js:124321:17)\r\n    at Object.next (http://localhost:3000/static/js/0.chunk.js:124252:14)\r\n    at fulfilled (http://localhost:3000/static/js/0.chunk.js:124206:24)\r\noverrideMethod @ react_devtools_backend.js:2273\r\nConsoleLogger._log @ ConsoleLogger.ts:99\r\nConsoleLogger.warn @ ConsoleLogger.ts:132\r\n(anonymous) @ AWSS3Provider.ts:328\r\nstep @ index.ts:57\r\n(anonymous) @ index.ts:57\r\nrejected @ index.ts:57\r\nPromise.then (async)\r\nstep @ index.ts:57\r\nfulfilled @ index.ts:57\r\nPromise.then (async)\r\nstep @ index.ts:57\r\n(anonymous) @ index.ts:57\r\npush../node_modules/@aws-amplify/storage/lib-esm/providers/AWSS3Provider.js.__awaiter @ index.ts:57\r\nAWSS3Provider.put @ AWSS3Provider.ts:226\r\n(anonymous) @ Storage.ts:199\r\nstep @ Storage.ts:1\r\n(anonymous) @ Storage.ts:1\r\n(anonymous) @ Storage.ts:1\r\npush../node_modules/@aws-amplify/storage/lib-esm/Storage.js.__awaiter @ Storage.ts:1\r\nStorage.put @ Storage.ts:190\r\nuploadFile @ ProductsPageContainer.ts:401\r\nProductsPage.uploadFile @ ProductsPage.tsx:609\r\nFileUploader.submitFile @ FilePicker.tsx:82\r\ncallCallback @ react-dom.development.js:188\r\ninvokeGuardedCallbackDev @ react-dom.development.js:237\r\ninvokeGuardedCallback @ react-dom.development.js:292\r\ninvokeGuardedCallbackAndCatchFirstError @ react-dom.development.js:306\r\nexecuteDispatch @ react-dom.development.js:389\r\nexecuteDispatchesInOrder @ react-dom.development.js:414\r\nexecuteDispatchesAndRelease @ react-dom.development.js:3278\r\nexecuteDispatchesAndReleaseTopLevel @ react-dom.development.js:3287\r\nforEachAccumulated @ react-dom.development.js:3259\r\nrunEventsInBatch @ react-dom.development.js:3304\r\nrunExtractedPluginEventsInBatch @ react-dom.development.js:3514\r\nhandleTopLevel @ react-dom.development.js:3558\r\nbatchedEventUpdates$1 @ react-dom.development.js:21871\r\nbatchedEventUpdates @ react-dom.development.js:795\r\ndispatchEventForLegacyPluginEventSystem @ react-dom.development.js:3568\r\nattemptToDispatchEvent @ react-dom.development.js:4267\r\ndispatchEvent @ react-dom.development.js:4189\r\nunstable_runWithPriority @ scheduler.development.js:653\r\nrunWithPriority$1 @ react-dom.development.js:11039\r\ndiscreteUpdates$1 @ react-dom.development.js:21887\r\ndiscreteUpdates @ react-dom.development.js:806\r\ndispatchDiscreteEvent @ react-dom.development.js:4168\r\nShow 14 more frames from Library code\r\n```","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"asumaran"},"body":"Turns out File upload didn't work at all using `\"aws-amplify\": \"^3.0.23\"`. Had to revert to `\"aws-amplify\": \"1.1.29\"` to make it work. I couldn't find any reason for this strange behavior."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNDY1Ng==","author":{"login":"jefelewis"},"title":"AWS Amplify + Redux Saga","body":"Was anyone able to get an auth channel/subscription to keep track of the `currentAuthenticatedUser`? Below is how I am trying to do it, but my AWS auth channel is not working. I'm coming from Firebase, so below is an example of a working saga to keep track of the user.\r\n\r\n**Firebase Saga (Working):**\r\n```javascript\r\n// Redux Saga: Firebase Auth Channel\r\nexport function* firebaseAuthChannelSaga() {\r\n  try {\r\n    // Auth Channel (Events Emit On Login And Logout)\r\n    const authChannel = yield call(reduxSagaFirebase.auth.channel);\r\n\r\n    while (true) {\r\n      const { user } = yield take(authChannel);\r\n\r\n      // Check If User Exists\r\n      if (user) {\r\n        // Firebase ID Token\r\n        const firebaseIdToken = yield user.getIdTokenResult();\r\n\r\n        // Redux: Login Success\r\n        yield put(loginSuccess(user));\r\n      }\r\n      else {\r\n        // Redux: Logout Success\r\n        yield put(logoutSuccess());\r\n\r\n        // authChannel.close();\r\n      }\r\n    }\r\n  }\r\n  catch (error) {\r\n    console.log(error);\r\n  }\r\n};\r\n```\r\n\r\n\r\n\r\n\r\n**AWS Saga (Not Working):**\r\n```javascript\r\n// Redux Saga: AWS Auth Channel\r\nexport function* awsAuthChannelSaga() {\r\n  try {\r\n    console.log('AUTH CHANNEL');\r\n\r\n    // Auth Channel (Events Emit On Login And Logout)\r\n    const currentUser = yield call([Auth, 'currentAuthenticatedUser']);\r\n\r\n    while (true) {\r\n      const { attributes } = yield take(currentUser);\r\n\r\n      // Check If User Exists\r\n      if (attributes) {\r\n        console.log('AUTH CHANNEL LOGGED IN');\r\n\r\n        // Redux: Login Success\r\n        yield put(loginSuccess(attributes));\r\n      }\r\n      else {\r\n        console.log('AUTH CHANNEL LOGGED OUT');\r\n\r\n        // Redux: Logout Success\r\n        yield put(logoutSuccess());\r\n      }\r\n    }\r\n  }\r\n  catch (error) {\r\n    console.log(error);\r\n  }\r\n};\r\n```\r\n\r\n**Index:**\r\n```javascript\r\n// Root Saga\r\nexport default function* rootSaga() {\r\n  // AWS Auth Channel\r\n  yield fork(awsAuthChannelSaga);\r\n\r\n  yield all([\r\n    // Sagas: Auth\r\n    fork(watchLoginSaga),\r\n    fork(watchLogoutSaga),\r\n    fork(watchResetPasswordSaga),\r\n    fork(watchSendVerificationCodeSaga),\r\n  ]);\r\n};\r\n```","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNDYzNQ==","author":{"login":"LucasAndrad"},"title":"Can I delete many items using Amplify Graphql API?","body":"I would like to now how to delete many items using Amplify AppSync Graphql API\r\n\r\nExample: in a N to N relation between Posts and Users, amplify graphql schema will have that table PostUser, with connections for Posts and Users, so if I remove a Post, I would like to remove all the relations between that Post and the Users, in this case all PostUser items with `postID = Post.id`.\r\n\r\nI know that dynamoDB has the [batchWrite](https://docs.aws.amazon.com/amazondynamodb/latest/APIReference/API_BatchWriteItem.html) method that we can use, but create a lambda, that check if there are 25 or more items, create all calls etc etc seems too much for this feature, so is there an easier way to do it? If not, can we have a feature request for this?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNDU3Mg==","author":{"login":"dfang"},"title":"why All fields provided to an @connection must be non-null scalar or enum fields","body":"eg. for this model\r\n\r\n```\r\ntype Task @model \r\n  @key(name: \"tasksByStatus\", fields: [\"status\"], queryField: \"tasksByStatus\") {  \r\n  id: ID!\r\n  title: String\r\n  status: TaskStatus!\r\n  assignerID: ID\r\n  assigneeID: ID\r\n  assigner: User @connection(fields: [\"assignerID\"])\r\n  assignee: User @connection(fields: [\"assigneeID\"])\r\n}\r\n```\r\n\r\ni got this error:\r\n\r\n`All fields provided to an @connection must be non-null scalar or enum fields`","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNDI2OQ==","author":{"login":"The0racle"},"title":"Use RNPushNotificationMessagingService with other services that utilize Firebase Cloud Messaging","body":"Docs require `AndroidManifest.xml` to include:\r\n\r\n```\r\n        <service\r\n            android:name=\"com.amazonaws.amplify.pushnotification.RNPushNotificationMessagingService\"\r\n            android:enabled=\"true\"\r\n            android:exported=\"true\">\r\n            <intent-filter>\r\n                <action android:name=\"com.google.firebase.MESSAGING_EVENT\" />\r\n            </intent-filter>\r\n        </service>\r\n```\r\nHowever, there are other services that also use FCM such as Intercom. In that case, we subclass `RNFirebaseMessagingService` and checking whether it is an Intercom notification or not. \r\n\r\n```\r\npublic class MainMessagingService extends RNFirebaseMessagingService {\r\n    private static final String TAG = \"MainMessagingService\";\r\n    private final IntercomPushClient intercomPushClient = new IntercomPushClient();\r\n\r\n    @Override\r\n    public void onMessageReceived(RemoteMessage remoteMessage) {\r\n        Map message = remoteMessage.getData();\r\n        if (intercomPushClient.isIntercomPush(message)) {\r\n            Log.d(TAG, \"Intercom message received\");\r\n            intercomPushClient.handlePush(getApplication(), message);\r\n        } else {\r\n            super.onMessageReceived(remoteMessage);\r\n        }\r\n    }\r\n}\r\n```\r\nHow can we do something similar with amplify (`amplifyPushService.isAmplifyPush`)?\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMjEy","author":{"login":"rpivo"},"title":"Does the Cognito Identity SDK verify JWT tokens?","body":"I've been working with this SDK for the past couple of weeks and liking it so far. I've been reading up on JWT tokens and I know I should be verifying them. Does this SDK automatically verify them? If not, would I have to get the tokens into Lambda to be verified? How would I go about doing that?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"elorzafe"},"body":"@rpivo The tokens are not validated on the client, the library can ask for tokens and refresh those in case they are expired however the tokens should be always verified on the backend for Authorization purposes.\r\n\r\nWhat is your use case to validate the token on the client?"}},{"node":{"author":{"login":"IsaacTrevino"},"body":"Related [issue #5477](https://github.com/aws-amplify/amplify-js/issues/5477#issuecomment-675518220)"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNDI0MA==","author":{"login":"pranav1812"},"title":"Build failed when I implemented pushed a commit in which I just connected to the backend","body":"Hi, I am new to AWS. I was playing around with a handson tutorial on how to host react app with aws amplify.\r\nFirst I hosted a static hello world app (the one that is built by Create React App). Then I configured amplify console and initialized the app. then added basic authentication. It worked well on local machine but when I pushed the latest commits to github, it showed an error that build failed to complete successfully. I'm unable to figure out anything from the console message.\r\n\r\nI tried pushing aws exports.js file and other amplify files\r\n\r\nP.S. my process of reaching here was not that straight:\r\n\r\n1st I deployed the app with aws educate account which had access limitations, so I deployed the same app in my aws account in mumbai region but at the time of configuring, I configures N. Verginia region by mistake. It got configured but lead to another error while initializing (can not find project). Finally I configured again(this time in mumbai region) and it got initialized and worked in local machine..... what happened next you know\r\n![Screenshot from 2020-08-18 23-23-53](https://user-images.githubusercontent.com/55294644/90547986-ea9b7280-e1a9-11ea-8b0c-bab3ff6e27d5.png)\r\n![Screenshot from 2020-08-18 23-27-20](https://user-images.githubusercontent.com/55294644/90548384-7b724e00-e1aa-11ea-9a21-f0b9ac327fda.png)\r\n![Screenshot from 2020-08-18 23-27-32](https://user-images.githubusercontent.com/55294644/90548385-7d3c1180-e1aa-11ea-9eeb-30b325743c38.png)\r\n![Screenshot from 2020-08-18 23-27-40](https://user-images.githubusercontent.com/55294644/90548393-7e6d3e80-e1aa-11ea-9cf4-b5ea60e07f6c.png)\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"pranav1812"},"body":"[https://aws.amazon.com/getting-started/hands-on/build-react-app-amplify-graphql/module-two/](url)\r\nI was following this tutorial"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb243OTkw","author":{"login":"avlonder"},"title":"Track user online status with websockets","body":"Hi everyone,\r\n\r\nIs it possible to change values in a dynamoDB table if the server notices that a websocket (subscription) is disconnected?\r\nThis would allow me to track the user's online status in real-time. ","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"crolly"},"body":"Hi, unfortunately I cannot help, however have a similar use case. Did you happen to stumble upon a solution?"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNDE2Mw==","author":{"login":"giorgiocarniel"},"title":"Unable to translate text with Predictions - AccessDeniedException","body":"[Amplify 4.22.0]\r\n\r\nI'm trying to translate a text inside my Amplify application but when I call `Predictions.convert` I get:\r\n\r\n> `AccessDeniedException: CognitoIdentityCredentials is not authorized to perform: translate:TranslateText`\r\n\r\nDoes anybody know what can cause this error, or any workaround?\r\n\r\nI've done:\r\n>amplify add predictions\r\n\r\nwith the following parameters:\r\n\r\n>? Please select from one of the categories below Convert\r\n>? What is the source language? Italian\r\n>? What is the target language? English\r\n>? Who should have access? Auth users only\r\n\r\nMy code:\r\n```\r\nimport Predictions, { AmazonAIPredictionsProvider } from '@aws-amplify/predictions';\r\n\r\nexport function TranslateItem(name) {\r\n    Predictions.addPluggable(new AmazonAIPredictionsProvider());\r\n\r\n    Predictions.convert({\r\n      translateText: {\r\n        source: {\r\n          text: \"Prova\",\r\n          language : \"it\" \r\n        },\r\n        targetLanguage: \"en\"\r\n      }\r\n    })\r\n    .then(result => {\r\n    \tconsole.log(\"result\", result);\r\n    })\r\n    .catch(error => {\r\n    \tconsole.log(\"error\", error);\r\n    });\r\n}\r\n```\r\n\r\nError:\r\n![AccessDeniedException](https://user-images.githubusercontent.com/69838480/90488091-a8d3e300-e13b-11ea-988b-e40a0ba27328.png)\r\n\r\ntranslateText-template.json:\r\n\r\n```\r\n{\r\n    \"AWSTemplateFormatVersion\": \"2010-09-09\",\r\n    \"Description\": \"Convert resource(s) stack creation using Amplify CLI\",\r\n    \"Parameters\": {\r\n        \"authRoleName\": {\r\n            \"Type\": \"String\"\r\n        },\r\n        \"unauthRoleName\": {\r\n            \"Type\": \"String\"\r\n        },\r\n        \"convertPolicyName\": {\r\n            \"Type\": \"String\"\r\n        },\r\n        \"convertType\": {\r\n            \"Type\": \"String\"\r\n        },\r\n        \"access\": {\r\n            \"Type\": \"String\"\r\n        },\r\n        \"resourceName\": {\r\n            \"Type\": \"String\"\r\n        },\r\n        \"sourceLang\": {\r\n            \"Type\": \"String\"\r\n        },\r\n        \"targetLang\": {\r\n            \"Type\": \"String\"\r\n        },\r\n        \"env\": {\r\n            \"Type\": \"String\"\r\n        }\r\n    },\r\n    \"Conditions\": {\r\n        \"AuthGuestRoleAccess\": {\r\n            \"Fn::Equals\": [\r\n                {\r\n                    \"Ref\": \"access\"\r\n                },\r\n                \"authAndGuest\"\r\n            ]\r\n        }\r\n    },\r\n    \"Outputs\": {\r\n        \"region\": {\r\n            \"Value\": {\r\n                \"Fn::FindInMap\": [\r\n                    \"RegionMapping\",\r\n                    {\r\n                        \"Ref\": \"AWS::Region\"\r\n                    },\r\n                    {\r\n                        \"Ref\": \"convertType\"\r\n                    }\r\n                ]\r\n            }\r\n        },\r\n        \"sourceLang\": {\r\n            \"Value\": {\r\n                \"Ref\": \"sourceLang\"\r\n            }\r\n        },\r\n        \"targetLang\": {\r\n            \"Value\": {\r\n                \"Ref\": \"targetLang\"\r\n            }\r\n        }\r\n    },\r\n    \"Resources\": {\r\n        \"TranslatePolicy\": {\r\n            \"Type\": \"AWS::IAM::Policy\",\r\n            \"Properties\": {\r\n                \"PolicyName\": {\r\n                    \"Ref\": \"convertPolicyName\"\r\n                },\r\n                \"Roles\": {\r\n                    \"Fn::If\": [\r\n                        \"AuthGuestRoleAccess\",\r\n                        [\r\n                            {\r\n                                \"Ref\": \"authRoleName\"\r\n                            },\r\n                            {\r\n                                \"Ref\": \"unauthRoleName\"\r\n                            }\r\n                        ],\r\n                        [\r\n                            {\r\n                                \"Ref\": \"authRoleName\"\r\n                            }\r\n                        ]\r\n                    ]\r\n                },\r\n                \"PolicyDocument\": {\r\n                    \"Version\": \"2012-10-17\",\r\n                    \"Statement\": [\r\n                        {\r\n                            \"Effect\": \"Allow\",\r\n                            \"Action\": [\r\n                                \"translate:TranslateText\"\r\n                            ],\r\n                            \"Resource\": \"*\"\r\n                        }\r\n                    ]\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \"Mappings\": {\r\n        \"RegionMapping\": {\r\n            \"us-east-1\": {\r\n                \"translateText\": \"us-east-1\"\r\n            },\r\n            \"us-east-2\": {\r\n                \"translateText\": \"us-east-1\"\r\n            },\r\n            \"us-west-2\": {\r\n                \"translateText\": \"us-west-2\"\r\n            },\r\n            \"eu-west-1\": {\r\n                \"translateText\": \"eu-west-1\"\r\n            },\r\n            \"eu-west-2\": {\r\n                \"translateText\": \"eu-west-1\"\r\n            },\r\n            \"eu-central-1\": {\r\n                \"translateText\": \"eu-central-1\"\r\n            },\r\n            \"ap-northeast-1\": {\r\n                \"translateText\": \"ap-northeast-1\"\r\n            },\r\n            \"ap-northeast-2\": {\r\n                \"translateText\": \"ap-northeast-2\"\r\n            },\r\n            \"ap-southeast-1\": {\r\n                \"translateText\": \"ap-southeast-1\"\r\n            },\r\n            \"ap-southeast-2\": {\r\n                \"translateText\": \"ap-southeast-1\"\r\n            },\r\n            \"ap-south-1\": {\r\n                \"translateText\": \"ap-south-1\"\r\n            }\r\n        }\r\n    }\r\n}\r\n```","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMzg4NQ==","author":{"login":"hashitha"},"title":"Uncaught SyntaxError: The requested module './js/aws-amplify/aws-amplify.js' does not provide an export named 'default'","body":"I am trying to use Auth module in the browser directly `<script type=\"module\" src=\"index.js\"></script>`\r\nbut I am getting the following error.\r\n\r\n`Uncaught SyntaxError: The requested module './js/aws-amplify/aws-amplify.js' does not provide an export named 'default'`\r\n\r\nI have attached a sample code\r\n[sample.zip](https://github.com/aws-amplify/amplify-js/files/5078424/sample.zip)\r\n\r\nI can get amplify working if I use webpack but I want to keep it simple and develop without webpack.\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb244MjE5","author":{"login":"Ivelraj1997"},"title":"Angular amplify latest UI component-style","body":"How can i add custom css to amplify component in angular latest? because  no proper documentation there.\r\n\r\nHow can i hide creat account link in footer section?\r\n\r\nthanks advance.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"karlitos"},"body":"I am actually searching for a solution as well. We recently switched from **Angular 7** and **aws-amplify-angular (legacy)** to **Angular 10** and **@aws-amplify/ui-angular (latest)**\r\n\r\nPreviously I was able to pierce the encapsulation with **::ng-deep**, this des not work anymore\r\n\r\nI was now desperately trying to:\r\n* get rid of the`box-shadow: rgba(0, 0, 0, 0.15) 1px 1px 4px 0px;` on `amplify-section -> section`\r\n* increase the height of the `input` fields and increase the `border-radius`\r\n* place the `primary-footer-content` above the `secondary-footer-content` (Button  over the signup hint text)\r\n\r\nNo luck so far 😠 😭 "}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMzczMA==","author":{"login":"gbwashleybrown"},"title":"Reopening of closed, but not fixed issues?","body":"There are no doubt bugs in the issues section that have been prematurely closed despite the fact it clearly hasn't been addressed.\r\n\r\nSo am I right to assume we open a new thread, thats identical to the one that's been closed (despite comment after comment that its still a problem) ? Adding comments to a closed thread don't seem to get it any attention. So what do we do?\r\n\r\nI'm talking about #1857 to be specific. ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb245NzI3","author":{"login":"cklingspor"},"title":"Custom Theme ignored?","body":"I'm trying to customize the signOut button but I'm most certainly using it wrong\r\nAccording to [this](https://docs.amplify.aws/lib/auth/customui/q/platform/js#customize-withauthenticator-hoc) part of the official documentation, it should be possible to pass a piece of code to the withAuthenticator component.\r\n\r\nI'm passing the following piece of code to the component\r\n```\r\nconst MyTheme = {\r\n    Button: { 'fontWeight': '10' },\r\n}\r\n\r\nexport default withAuthenticator(\r\n  WebApp, false, [], null, MyTheme\r\n);\r\n```\r\n\r\nUltimately, what I'm trying to do is changing, how the AmplifySignOut-component looks like. I'm pretty sure I'm missing something obvious but I can't make it work right now. \r\nCould someone maybe help out?\r\n\r\nBest Regards!\r\n\r\n\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"hitchiceburg"},"body":"I have been playing with custom UI a lot and it is very confusing. \r\nYou can use css for some things. https://docs.amplify.aws/ui/customization/theming/q/framework/react\r\n\r\nTheming has not worked for me. I wish there was a definite description of functionality. "}},{"node":{"author":{"login":"kjones"},"body":"I'm also having trouble with customization. I can't get `<AmplifyGreetings />` to honor CSS settings. I simply want to change the background. Here is my CSS:\r\n```jsx\r\n<AmplifyGreetings>\r\n  <div slot=\"logo\">Amplify Todos</div>\r\n  <div slot=\"nav\">\r\n    <span>{user?.username ?? ''}</span>\r\n    <AmplifySignOut />\r\n  </div>\r\n</AmplifyGreetings>\r\n```\r\nThis doesn't work:\r\n```css\r\namplify-greetings {\r\n  background-color: grey;\r\n}\r\n```\r\nThis doesn't work:\r\n```css\r\n.greetings {\r\n  background-color: grey;\r\n}\r\n```\r\nThe only thing that works is overriding `--amplify-white` on the `amplify-greetings` element. This works:\r\n```css\r\namplify-greetings {\r\n  --amplify-white: grey;\r\n}\r\n```\r\nI guess I can live with that but wait... I also can't set the `border-width`. No matter what I do it is always 1px.\r\n\r\naws-amplify: 3.0.23\r\n@aws-amplify/ui-react: 0.2.14\r\n@aws-amplify/ui-components: 0.6.1"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMzYwMA==","author":{"login":"ifmael"},"title":"DataStore observer does not trigger in other application instances logged in as different user","body":"I am not sure if Datastore complies with this feature.\r\nI'm developing a notification system for different users that can share content between them.  So when the user A shares content with the user B,  I want to the user b receives a notification with the content. \r\nI'm using Datastore.observer to do create the notification system. Initially, the system didn't working even when a user shared content with himself, but  I found this topic I've checked this topic https://github.com/aws-amplify/amplify-js/issues/5687 , and I could fix it this case of use.\r\nThe problem is it is not working with different users, and the users that receive the notification need to refresh the page.\r\n\r\nI've tried to overwrite the owner field with the cognito user id for the user that will receive the notifications but when i add it this fields, the Datastore.save  doesn't save the notifications.\r\n\r\nThe notification model:\r\n```\r\ntype Notification\r\n  @model(queries: null)\r\n  @aws_iam\r\n  @aws_cognito_user_pools\r\n  @auth(rules: [\r\n    { allow: owner, operations: [create, read, delete, update] }\r\n    { allow: public, provider: iam , operations: [read] }\r\n    { allow: groups, groups: [\"everyone\"], operations: [read] }\r\n  ])\r\n  @key(name:\"toUserID\", fields:[\"toUserID\"]){\r\n    id: ID!\r\n    fromUserID: ID!\r\n    toUserID: ID!\r\n    createdOn: AWSTimestamp!\r\n    type: Int!\r\n    title: String!\r\n    url: String!\r\n    owner: String\r\n  }\r\n```\r\n\r\n\r\n```\r\n      const notification = new Notification({\r\n        fromUserID: user.id,\r\n        toUserID: id,\r\n        createdOn: parseInt(moment(new Date()).format('x')),\r\n        type:1,\r\n        title:titleContent,\r\n        url: window.location.href,\r\n        owner: owner\r\n      });\r\n      \r\n      const x = await DataStore.save(notification);\r\n```","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMzU0NQ==","author":{"login":"linfiesto"},"title":"How do I assume role properly so I can clone repository during amplify build","body":"When cloning repository during the build process of amplify it says\r\n\r\n2020-08-12T02:37:14.776Z [ERROR]: !!! Unable to assume specified IAM Role. Please ensure the selected IAM Role has sufficient permissions and the Trust Relationship is configured correctly.\r\n2020-08-12T02:37:14.907Z [INFO]: # Starting environment caching...\r\n2020-08-12T02:37:14.908Z [INFO]: # Environment caching completed\r\nTerminating logging...\r\n\r\nI never had problem with this in my other client's AWS account. I did the standard AWS amplify-backend-console role found here. [](https://docs.aws.amazon.com/amplify/latest/userguide/how-to-service-role-amplify-console.html) And I made sure my IAM user has AdministratorAccess.\r\n\r\n![image](https://user-images.githubusercontent.com/4402009/90082829-637e7280-dd43-11ea-9757-8ee073315cd2.png)\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMzQwNw==","author":{"login":"raux"},"title":"Software Engineering Survey on GitHub Discussions.","body":"Do you find GitHub discussions useful as a communication channel? Maybe not? \r\nHello Developers! I am Raula Gaikovina Kula, a Software Engineering researcher\r\nhttps://raux.github.io/\r\n\r\nTogether with a team of researchers, we are interested in your thoughts about\r\nusing the GitHub Discussions Beta. We noticed that your project is currently using.\r\n\r\nWe have developed a simple 3 question survey that could take up to 5 mins to complete.\r\nhttps://forms.gle/peBxiio8u99QvKMk6\r\n\r\nThank you in advance for your time and apologize if this is not a proper use of this channel.\r\n\r\n@raux\r\nRaula, PhD on behalf of Hideaki, Sebastian, Nicole and Christoph","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMzMyNw==","author":{"login":"hbj"},"title":"How to add custom cloudformation configs that don't get overridden by the CLI","body":"Hi,\r\n\r\nI have a REST API created with the CLI and I need to add a custom config to it's cloudformation template, more specifically the \"BinaryMediaTypes\" property. According to the documentation (https://docs.amplify.aws/cli/usage/customcf) this should be done in the corresponding \"api-cloudformation-template.json\" file, but my changes are getting overridden if I update the API from the CLI, e.g. with `amplify api update`. Is there a way to add custom configs that don't get overridden?\r\n\r\nThanks.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMzI4MQ==","author":{"login":"shubh9795"},"title":"Getting UnrecognizedClientException while calling appSync API","body":"I am working on a application which contains a react web app & a react-native mobile app. I have configured amplify in the react app from scratch and used the same backend in the web app as well.\r\n\r\nI have also configured multi-auth for APIs which uses cognito userpool as primary authentication and IAM as secondary.\r\n\r\nIn web app I have enforced to login and hence only authenticated users are accessing the data and things are working fine but in react native app, I want users to access some amount of data without them being logged in. For that I am using IAM as authMode while calling API.\r\n\r\nconst categoriesData = await API.graphql({\r\n          query: listCategorys,\r\n          authMode: \"AWS_IAM\",\r\n        });\r\n\r\nAlthough I am getting UnrecognizedClientException while making any API calls with this method in react native app.","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMzI3Nw==","author":{"login":"3atharvkurdukar"},"title":"Help regarding AWS SNS Service","body":"I am using AWS Amplify to manage my React application as well as the serverless Express API for the backend. The customer has requested to send SMS to a list of users at specified time everyday. However, the user info is not stored in AWS Cognito for some reasons.\r\nI have added and API endpoint to get the list of mobile numbers based on some conditions and I want to add a lambda function that calls the API at specified time.\r\nHowever, I don't know how to call the API from the lambda function. Google Search is not helpful as well. Please let me know which way I am supposed to use.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"3atharvkurdukar"},"body":"Is it possible and recommended to use 'amplify-js' for the backend?"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMzE2Ng==","author":{"login":"danrivett"},"title":"DataStore - Support for client-side CRUD Permissions?","body":"We already use DataStore for data that is owned by the owner and modified on the client side in a React Native app, we now want to flow data updates from the backend for other data models that are designed to be read only by the client - e.g. data that's more of a notification-type of data.\r\n\r\nAn example of this sort of notification would be like a saved search in craiglist, and when there's a new posting that matches the saved search, then the user gets notified.\r\n\r\nWe're using Elasticsearch and its Percolator functionality to determine who should get notified, however the question is - how should they get notified.\r\n\r\nWe initially thought about defining a vanilla GraphQL mutation that the backend can call with the notification, and the front-end can subscribe to, and this could work well.\r\n\r\nThe downside we see though is that now the client needs to use the DataStore API for entity type data, and a separate GraphQL client for notification-based data. It's doable, but I'm wondering if we can simplify things for the client and use DataStore for all of it, and if it's a good idea.\r\n\r\nThe way I see it working if we used DataStore would be that we'd have a new model type for the notification and we'd use the `@auth` directive to limit the notifications synced to the client to be just theirs. However one issue I'm seeing is there's nothing to stop the client accidentally, or ignorantly, mutating the synced notifications locally, since I don't believe there's any way of having client-side access control to instruct that certain data types are read only for example?\r\n\r\nOf course we can just tell the app to not be silly, but I'm wondering if this is showing whether using DataStore for this use case is even a good idea?\r\n\r\nIf we went with the vanilla GraphQL client approach it would introduce complexity of a second way of accessing and subscribing to AppSync data, which doesn't seem great. Plus we'd also need to keep hold of that data locally (perhaps in Redux) for as long as that data is valid. And so it starts to look like it would become way more work than just observing a data model type in DataStore.\r\n\r\nAny thoughts here are most welcome.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMjk1Mg==","author":{"login":"dingdongping"},"title":"pubsub","body":" I only need to use PubSub in my react-native application. Can I just create a cognito account? All accounts in my system share the same cognito account to use PubSub service.\r\nOr is there any better suggestion for my program to use PubSub instead of creating a cognito account for each account","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMjkwMQ==","author":{"login":"syang"},"title":"Can I use Amplify JS lib to sign-up and sign-in with Google, but directly integrate Identity Pool (not User Pool)?","body":"A lot of Amplify Auth tutorials give the way to integrate Cognito User Pool with Google Oauth2 as IdP like this.\r\n![image](https://user-images.githubusercontent.com/188004/89716953-4eca6500-d966-11ea-88e0-c8d31840ae3d.png)\r\n\r\nBUT, **the above is not** what I am looking for. What I am looking is integrate Google as IdP directly with Cognito Identity Pool like this \r\n<img width=\"953\" alt=\"CognitoDiagram\" src=\"https://user-images.githubusercontent.com/188004/89716963-73bed800-d966-11ea-887a-b95de76b0fab.png\">\r\n\r\n\r\nIs there a way for me to use Amplify JS library to achieve this? If so, can I have a reference point?\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMjYyMA==","author":{"login":"sakhmedbayev"},"title":"How to hook custom user pool programmatically?","body":"We are building a SaaS using AWS Amplify and AWS AppSync. For each new tenant/customer, we create a new Cognito User Pool using cloudformation. We know that it is possible to hook those user pools manually using AppSync's console, however, is it possible to do the same programmatically?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"sw-yx"},"body":"[redacted; misunderstood the qtn]"}},{"node":{"author":{"login":"RossWilliams"},"body":"https://github.com/aws-amplify/amplify-js/issues/6518#issuecomment-670647826 ?"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNjM0","author":{"login":"chai86"},"title":"Get 'id' from a row entry in DynamoDB/AppSync?","body":"I want to do something seemingly so simple, but i am a bit lost as to how to do it: I have a table with user information already in it. Here's the Schema:\r\n\r\n\r\n    type Users @model {\r\n      id: ID!\r\n      userName: String\r\n      firstname: String\r\n      weblink: String\r\n      email: String\r\n      mobileNum: String\r\n     .\r\n     .\r\n     .\r\n    }\r\n    \r\n    \r\n    //**Here's my current Query.js**\r\n    export const getUsers = `query GetUsers($id: ID!) {\r\n      getUsers(id: $id) {\r\n        id\r\n        userName\r\n        firstname\r\n        weblink\r\n        email\r\n        .\r\n        .\r\n        .\r\n      }\r\n    }\r\n    `;\r\n\r\nThis table is populated in DynamoDB when i check my AWS console. What i need is to be able to get the id from the table using the userName (not vice versa). The id is generated when i createUser() and it's used throughout my app to get all my user's information. However when a user signs in on a new phone, this id isn't available anymore. So when they sign in via Cognito, i do know the userName and all i need to do is retrieve this id. Because there's only one unique **userName**, it should only return one **id**\r\n\r\nHow can this be done easily?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"mauerbac"},"body":"hi @chai86 - this seems more like a general GQL question. Will move into our discussion section! "}},{"node":{"author":{"login":"ericclemmons"},"body":"@chai86 Ah, I've ran into this issue myself!  What I did was use `@key` to provide another index for to query by:\r\n\r\n> https://aws-amplify.github.io/docs/cli-toolchain/graphql#how-to-use-key\r\n\r\n/cc @yuth from the Amplify CLI team\r\n"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMDkxMA==","author":{"login":"ksabr"},"title":"React authenticator without sign up and password reset","body":"Hi all,\r\n\r\nI'd like to make a react authentication form without the sign up and password reset options (as the users can only be manually created and modified by an admin). How is this done? There's a vast amount of information out there on customizing the authenticator but I didn't come across a simple solution to this - presumably common - use case.\r\n\r\nThanks in advance.","upvoteCount":1,"comments":{"edges":[{"node":{"author":null,"body":"AmplifySignIn has an exposed field `hideSignUp` but no equivalent for forgotpassword. The code below works for me though:\r\n\r\n```\r\n    <AmplifyAuthenticator>\r\n      <div slot=\"sign-in\" style={{ textAlign: 'center' }}>\r\n        <AmplifySignIn\r\n          hideSignUp=\"true\"\r\n          headerText=\"Sign In\"\r\n          formFields={[{ type: \"email\" }, { type: \"password\", hint:null }]}\r\n        />\r\n      </div>\r\n      <App />\r\n    </AmplifyAuthenticator>\r\n```"}},{"node":{"author":{"login":"ksabr"},"body":"An update: I updated to Firefox 68.11.0 and it looks fine. Thanks again!"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMjMwNw==","author":{"login":"awshanks"},"title":"passing props to function wrapped in withAuthenticator","body":"Hi.  I might be missing something but it doesn't seem possible to have a function wrapped in withAuthenticator and also allow props to be passed down.\r\n\r\ne.g.  I have an app with router:\r\n\r\n```\r\nimport Name from \"./components/name\";\r\n\r\nconst App = () => {\r\n    const [appTenant, setAppTenant] = useState(null);\r\n\r\n    return (\r\n        <Router>\r\n            <Header tenant={appTenant} setTenant={setAppTenant}/>\r\n            <Switch>\r\n                <Route path=\"/name\" exact component={withProps(Farm, {setTenant: setAppTenant,tenant: appTenant})} />\r\n            </Switch>\r\n        </Router>\r\n    );\r\n}\r\n\r\nexport default App;\r\n```\r\n\r\nThe Name component is just a function: \r\n\r\n\r\n```\r\nexport const Name = ({\r\n                  tenant,\r\n                  setTenant,\r\n              }) => {\r\n\r\n    console.log('function',setTenant)\r\n    console.log('function', tenant)\r\n\r\n    return <Container fluid=\"md\">some text</Container>\r\n\r\n};\r\n\r\nexport default withAuthenticator(Name)\r\n```\r\n\r\nThis will show the Authenticator login screen, allow login and then render the view, but the console statements are null.\r\n\r\nIf I import the Name component with `{Name}` after a successful login everything works as expected but then authenticator no longer works.\r\n\r\nWhat I want to have, is have auth routes and public routes but keep the Header outside and use useState to show / hide different links that would be available to users.\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"awshanks"},"body":"I have seen many different ways to do auth with Amplify, mostly involving custom auth flows and I really wanted to steer away from this whilst still being able to have both public and private routes.\r\n\r\nI have come up with a solution using nested routes with react-router that achieves this aim.\r\n\r\nThe main **App** has the top level routing and the **ProtectedApp** component houses the nested routing for the App to be authenticated.  This overcomes the problem above as components within the ProtectedApp that is wrapped by withAuthenticator(), can freely pass props as required.\r\n\r\n\r\n### App.js\r\n```\r\nconst App = () => {\r\n    return (\r\n        <Router>\r\n            <Switch>\r\n                <Route path=\"/\" exact render={() => <Home/>}/>\r\n                <Route path=\"/farm\" render={() => <ProtectedApp/>}/>\r\n                <Route path=\"/admin\" render={() => <AdminHome/>}/>\r\n            </Switch>\r\n        </Router>\r\n    );\r\n}\r\n\r\nexport default App;\r\n```\r\n\r\n### ProtectedApp.js\r\n\r\n```\r\nimport Amplify from \"aws-amplify\";\r\nimport awsExports from \"./aws-exports\";\r\nAmplify.configure(awsExports);\r\n\r\nconst ProtectedApp = () => {\r\n    const [appTenant, setAppTenant] = useState(null);\r\n\r\n    return (\r\n        <div>\r\n            <ProtectedHeader tenant={appTenant} setTenant={setAppTenant}/>\r\n            <Switch>\r\n                <Route path=\"/farm\" exact render={() => <Farm tenant={appTenant} setTenant={setAppTenant}/>}/>\r\n                <Route path=\"/farm/create\" exact render={() => <FarmSetup/>}/>\r\n            </Switch>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default withAuthenticator(ProtectedApp);\r\n```"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMjcwMQ==","author":{"login":"Jeff17Robbins"},"title":"It seems that my conflictHandler is called after my Datastore.Save()'s Promise is fulfilled?","body":"I am trying to use Optimistic Concurrency with my GraphQL API.  Everything seems properly setup.  DynamoDb shows updating `_version` numbers.  If I run one instance of my app, all is well.  \r\n\r\nBut if I bring up the same record in two instances of my app (instances retrieved via `await DataStore.query(entity, params.id);`), update the record from one instance (via `Datastore.Save(...using copyOf in here...)`) which succeeds, then attempt to update the now out-of-date record in the other app instance, the second `Datastore.Save()` succeeds (no error is thrown) and **then** the `conflictHandler` I registered via `Datastore.configure()` gets called.\r\n\r\nIs there some way to get Datastore to hold-off fulfilling until the `.Save()` succeeds or fails?  I realize that this might be contrary to an \"offline first\" approach, but I have subsequent operations which are a waste of time once it turns out that the `.Save()` will never succeed.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMjY3Nw==","author":{"login":"mauerbac"},"title":"Notes from 8/6/20 Amplify Office Hours via Discord","body":"Starting a thread to take notes from our office hours","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"RossWilliams"},"body":"I'm interested in hearing about how to decide on whether to use Pinpoint for Push Notifications. What would make you not want to use Pinpoint."}},{"node":{"author":{"login":"josh-tncarry"},"body":"Name: Josh Carroll (Twitter: @jwcarroll)\r\nDiscord: jwcarroll\r\n\r\ntopic(s): AppSync Resolvers, Pinpoint\r\n\r\nQuestions:\r\n\r\n- I may not 100% understand the mechanics, but is there a potential issue with how owner filtering works on resolvers? If I am reading it correctly, it filters after the records have been returned from DynamoDB, which seems like you could run into potential issues or limits or performance issues if there isn't already a secondary index including that column.\r\n- Since direct lambda resolvers have been introduced, are there any plans to generate Lambda resolvers using Node or another runtime instead of VTL templates? If not, what is the current best way to integrate more RPC style calls into my API?\r\n- I have a decent amount of experience with Pinpoint, but the integration with web based apps seems to be broken. I have things configured, and even have Cognito set to push things to pinpoint, but none of that seems to be working. Am I just missing something, or is the integration between Amplify and Pinpoint not fully baked?\r\n\r\nJS AppSync Issues/Question:\r\n\r\n- In one of my current apps, it seems that the connections to AppSync seem to timeout at some point. Is there an idomatic way to extend this timeout (keepalive) or set something up to simply reconnect after a timeout event?"}},{"node":{"author":{"login":"BrianHHough"},"body":"Name: Brian Hough (Twitter: @BrianHHough)\r\nDiscord: InterstellarXD\r\n\r\ntopic(s): Auth, Style\r\n\r\nQuestions:\r\n- How do you create a custom login screen? I can edit the colors via my SCSS file, but how do I add a logo? \r\n- It's importing the blue primary color into some of my div elements, but how do I edit the colors if it's pulling AWS Amplify colors?"}},{"node":{"author":{"login":"Ricardo1980"},"body":"Name: Ricardo\r\n\r\nDiscord: Ricardo#4748.\r\n\r\nTopic: Amplify, cloud formation, aurora serverless\r\n\r\nQuestion 1:\r\nWhen using AppSync with Aurora Serverless, how can I pass secretStoreArn and clusterIdArn to my lambda function?  (I am trying modifying my cloud formation templates but no luck)\r\n\r\nQuestion 2:\r\nHow can I update my aurora serverless from version 1.17 to version 2?"}},{"node":{"author":{"login":"supercodes1223"},"body":"We are currently doing a lot of custom logic in vtl with #if statements and etc. I would like to know in general is it advisable to rely so much on vtl for business logic? Is there such a thing as too much vtl customizing. \r\n\r\nAlso, would love for someone to explain vtl and how it works under the hood."}},{"node":{"author":{"login":"ayushjainrksh"},"body":"Name: Ayush Jain [@ayushjn_](https://twitter.com/ayushjn_)\r\nDiscord: Ayush Jain\r\n\r\nI migrated a node.js backend from EC2 to AWS Amplify. The React frontend was hosted on S3. The problem was that the frontend did not have any SSL, and thus, was served over `http` but the backend was served over `https` by Amplify and blocked all the request from the frontend. Can Amplify be configured to serve over `http` or is there a workaround to this?"}},{"node":{"author":{"login":"albac"},"body":"Name: Alfredo\r\nDiscord: albac\r\nTopic: React UI Oauth, hosted ui\r\nI recently completed my first react backend and frontend app. Initially I use withAuthenticator with aws cognito and everything work as expected. Now I am adding Saml Authentication, I did this through the aws cognito console adding a federated provided. Using the aws console this works well when using the hosted UI option, but the app still using the user and password screen too. I am unable to find documentation to enable this on the react side, I do see there are examples for google, facebook, but not for any other third party. Do you have any information on how to do this? I am using OneLogin as identity provider."}},{"node":{"author":{"login":"mauerbac"},"body":"Thanks everyone for joining! Let us know if you have improvement suggestions in the #discord-discussion channel. "}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMDE1MQ==","author":{"login":"wraila"},"title":"clarify amplify support in angular","body":"I cannot find any documentation of which versions of aws-amplify and its related packages, e.g. aws-amplify-angular, aws-amplify/ui*, work with which versions of angular. Very frustrating. \r\n\r\n@ericclemmons has mentioned in some other threads documentation at \r\n> Please also note that the AWS Amplify Angular components do not yet support Ivy.\r\n> – https://aws-amplify.github.io/docs/js/angular#angular-6-support\r\n\r\nbut that link redirects to a tutorial with no mention of ivy or other angular version info. [It does mention edits for polyfills.ts, but that hasn't changed since angular 6.]\r\n\r\nI'm trying to upgrade from angular 8. \r\n\r\nWhich versions of which amplify packages can be used with angular 9?\r\nWhich versions of which amplify packages can be used with angular 10?\r\n\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"sammartinez"},"body":"Apologizes for the late response here. For our support of Angular, we currently support up to Angular 9 with our newer [Amplify UI Components](https://docs.amplify.aws/ui/q/framework/angular) implementations. We are exploring support for Angular 10 but dont have a timeline as its a new release from Angular.\r\n"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMjYzNg==","author":{"login":"sandeep621"},"title":"Mobile Application login via AD","body":"Hi Team,\r\n\r\nWe are developing hybrid application using ionic framework. Signing in via AD we get successful login in web browser as the user auth object is retrieved from local storage & the user is authorised.\r\n\r\nBut for mobile application we are using InappBrowser provided by ionic. After signing in via AD credentials we are getting the response code back for successful authentication. However while authorisation function “Auth.currentAuthenticatedUser” is returning “Not authenticated” since we are not able to capture user auth object from InAppbrowser. \r\n\r\n Is there any listener to check the auth event & get the user object instead of local storage.\r\n\r\nOr if there is any other way to handle login from Mobile apps please let us know.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"sammartinez"},"body":"We do have the ability to listen to Auth Events via our [Hub Events Utility](https://docs.amplify.aws/lib/utilities/hub/q/platform/js#listening-for-messages). Please let us know if you have anymore questions in regards to this."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb240NDk3","author":{"login":"carlhaynes"},"title":"How can I add a checkbox to AmplifySignUp?","body":"I have the new auth ui working so I can sign up, login etc but for my signup I need to have a checkbox checked before registering (It is an alcohol related site that needs confirmation on age)\r\n\r\nI see there is an AmplifyCheckbox component, but I can not figure out how to add it to the config for sign up, \r\n\r\nMy Signup is very straightforward:\r\n\r\n```\r\n          <AmplifySignUp\r\n            headerText=\"Please Sign up for Vinotrove\"\r\n            slot=\"sign-up\"\r\n            formFields={[\r\n              {\r\n                type: 'preferred_username',\r\n                label: 'Username',\r\n                placeholder: 'Username',\r\n                required: true,\r\n              },\r\n              {\r\n                type: 'username',\r\n                label: 'Email',\r\n                placeholder: 'user@email.com',\r\n                required: true,\r\n              },\r\n              {\r\n                type: 'password',\r\n                label: 'Password',\r\n                placeholder: 'Password',\r\n                required: true,\r\n              },\r\n            ]}\r\n          />\r\n\r\n```\r\n\r\nThe [docs](https://github.com/aws-amplify/amplify-js/tree/master/packages/amplify-ui-components/src/components/amplify-form-field#properties) say that it can be any html input type but putting \"checkbox\" as the type does not work (shows a text field)\r\n\r\n<img width=\"1011\" alt=\"Screen Shot 2020-05-24 at 9 37 58 PM\" src=\"https://user-images.githubusercontent.com/1378540/82778700-f07df380-9e06-11ea-8206-0e90cdd677c3.png\">\r\n\r\nHow do I do this, it must be a common ask since most apps need you to agree to the terms before signing up.\r\n\r\nIs there an alternate way to do this without re-writing the forms and not using the new ? I'm hoping to let amplify to the auth work for me.\r\n\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"nkint"},"body":"Hi!\r\nI need this feature too.\r\nInclude a Term of service/Privacy checkbox is mandatory in most of user flow today.\r\n\r\nI'm concerned where documentation is clear `Can be any HTML input type` but \"checkbox\" is not a valid value, or is ignored.\r\n\r\nI've tried to dig into the code but I'm not really understand where is the problem. Maybe someone can spot the problem?\r\n\r\nHere is the path I'm following to check where the code can be changed to let `amplify-input` accept also \"checkbox\":\r\n\r\n- https://github.com/aws-amplify/amplify-js/blob/main/packages/amplify-ui-components/src/components/amplify-sign-up/amplify-sign-up.tsx#L313\r\n- https://github.com/aws-amplify/amplify-js/blob/main/packages/amplify-ui-components/src/components/amplify-auth-fields/amplify-auth-fields.tsx#L40\r\n- https://github.com/aws-amplify/amplify-js/blob/main/packages/amplify-ui-components/src/components/amplify-auth-fields/component-field-mapping.tsx#L65\r\n- https://github.com/aws-amplify/amplify-js/blob/main/packages/amplify-ui-components/src/components/amplify-form-field/amplify-form-field.tsx#L49\r\n- https://github.com/aws-amplify/amplify-js/blob/main/packages/amplify-ui-components/src/components/amplify-input/amplify-input.tsx#L49\r\n\r\nI think that the field `type` is missing here: \r\n\r\nhttps://github.com/aws-amplify/amplify-js/blob/main/packages/amplify-ui-components/src/components/amplify-auth-fields/component-field-mapping.tsx#L65\r\n\r\nCan anyone help me to spot if this is the right place?\r\n\r\n```\r\n<amplify-form-field\r\n      type={ff.type}\r\n      label={ff.label}\r\n      placeholder={ff.placeholder}\r\n      required={ff.required}\r\n      handleInputChange={ff.handleInputChange}\r\n      value={ff.value}\r\n      inputProps={ff.inputProps}\r\n      disabled={ff.disabled}\r\n    />\r\n```\r\n\r\nthis can be enough?\r\n"}},{"node":{"author":{"login":"nkint"},"body":"I have tried to fix with this PR: https://github.com/aws-amplify/amplify-js/pull/6502"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMjI5Ng==","author":{"login":"hirenumradia"},"title":"How do I remove the drop shadow from the authentication react component?","body":"I have been trying to remove the drop shadow of the authentication react component, but cant get it to select the right element.\r\n\r\nhttps://docs.amplify.aws/ui/customization/theming/q/framework/react#for-colors\r\n\r\nThis is the element with a drop shadow. I have limited experience working with web components. How do I style this? Any help would be appreciated.\r\n\r\n`\r\n<section class=\"section\" role=\"application\"><slot></slot></section>\r\n`\r\nThanks,\r\nHiren","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"sw-yx"},"body":"unfortunately you can't burst through the web component shadow dom to do custom styling like that. i recommend forking/copying out the code into your own codebase and modifying it for yourself.\r\n\r\ncc @jordanranz for comment"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMjA4MQ==","author":{"login":"jdwil"},"title":"Overridden groups are lost on token refresh","body":"I have a Pre-Token Generation lambda trigger that adds groups to user's id/access tokens based on a custom database. After an hour, amplify will refresh my access token, but the groups (\"cognito:groups\") overridden in the lambda trigger are gone. Does anyone know why the tokens, after a refresh, are not identical to the originals?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"jdwil"},"body":"This wasn't an amplify thing. My lambda callback wasn't executing for the \"TokenGeneration_RefreshTokens\" triggerSource."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMjExNw==","author":{"login":"batmanwannabe"},"title":"Can someone post a code snippet on how to do a Federated Login with amazon-cognito-identity-js ?","body":"We have a old app that uses amazon-cognito-identity-js for authentication, I need to add SSO login to it, I don't want to update to Amplify just for this. Is there any way amazon-cognito-identity-js can achieve this? \r\n\r\nI searched online but could not find anything,","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMTg3OQ==","author":{"login":"atyshka"},"title":"Request: Support or Documentation for using pubsub with Cognito groups","body":"**Is your feature request related to a problem? Please describe.**\r\nWhen integrating sensitive IoT data into my web app, I don't want any user of the app to be able to access it, I would like to restrict access using cognito groups. How can I achieve this? I have current tried adding an all-wildcard policy on the group, but this isn't working. Attempting to subscribe leads to an error code 8: socket closed error. I know something is incorrect with the IAM policies, but I'm unsure.\r\n\r\n**Describe the solution you'd like**\r\nSupport for user groups as a form of permissions for IoT. If this already is possible, then documentation on how to achieve this.\r\n\r\nHere is my user-pool-group-precedence.json that adds the inline policy:\r\n```\r\n[\r\n  {\r\n    \"groupName\": \"TrustedUsers\",\r\n    \"precedence\": 1,\r\n    \"customPolicies\": [\r\n      {\r\n        \"PolicyName\": \"admin-group-policy\",\r\n        \"PolicyDocument\": {\r\n          \"Version\": \"2012-10-17\",\r\n          \"Statement\": [\r\n            {\r\n              \"Sid\": \"statement1\",\r\n              \"Effect\": \"Allow\",\r\n              \"Action\": [\"iot:*\"],\r\n              \"Resource\": [\"*\"]\r\n            }\r\n          ]\r\n        }\r\n      }\r\n    ]\r\n  },\r\n  {\r\n    \"groupName\": \"UntrustedUsers\",\r\n    \"precedence\": 2\r\n  }\r\n]\r\n```\r\nOther than that, I haven't made the single-user changes in the pubsub tutorial, as I want to configure on a group basis rather then per user.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"ashika01"},"body":"@atyshka Have you tried looking into [AppSync service](https://docs.aws.amazon.com/appsync/latest/devguide/welcome.html)? They handle a lot the use cases you are trying to solve. You can use [amplify to interact with the appsync service.](https://docs.amplify.aws/lib/graphqlapi/getting-started/q/platform/js)\r\n\r\n"}},{"node":{"author":{"login":"atyshka"},"body":"I ended up solving the issue. It wasn't initially clear that IAM policies and IoT policies are completely separate things. The eventual user permissions are the intersection of the IAM policy and the IoT policy. It's buried in the IoT docs but that's pretty important info. So in my case, I am giving every user, trusted or untrusted, a full access IoT policy upon sign up. However, only users in the IAM group receive the IAM policy with IoT permissions, and as such they are the only ones who can access the IoT data."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMTU1Ng==","author":{"login":"trylas"},"title":"CognitoUserPool - Client.js - missing http status error code","body":"I would like to ask why error codes are missing and methods like signUp respond errors as per below. Instead of 400 code 'InvalidParameterException'.\r\n```\r\n{ \r\n  code: 'InvalidParameterException',\r\n  name: 'InvalidParameterException',\r\n  message: '1 validation error detected: Value null at \\'confirmationCode\\' failed to satisfy constraint: Member must not be null' \r\n}\r\n```\r\n\r\nInvalidParameterException\r\nThis exception is thrown when the Amazon Cognito service encounters an invalid parameter.\r\nHTTP Status Code: 400\r\n\r\nLink to file\r\nhttps://github.com/aws-amplify/amplify-js/blob/3642e6af455ee1848c1cc743a7a503e96baefa41/packages/amazon-cognito-identity-js/src/Client.js#L55\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMTU1NA==","author":{"login":"3atharvkurdukar"},"title":"How do I use AWS Pinpoint to send text messages?","body":"I have added SMS service using AWS Amplify CLI with command `amplify add notification`. But, I am unable to find any documentation regarding how to implement it. Please help. I want to manually send SMS to a list of mobile numbers, which are not stored in Cognito User Pool.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMTQ3Nw==","author":{"login":"justingrant"},"title":"Same user (same email) logging into Cognito Identity Pool with both Facebook and Google social providers","body":"My web app offers both Facebook and Google login providers using a Cognito Identity Pool. (I'm not using Cognito User Pools.) My login flow looks like this: \r\n1) User clicks a login button in my app\r\n2) I show a dialog with \"Login with Facebook\" and \"Login with Google\" buttons\r\n3) When the user clicks a login button, my app calls into the Facebook or Google SDK to show a login UI\r\n4) If the user successfully logs into their social provider, my app uses code like below to log into Cognito: \r\n```typescript\r\nasync function cognitoLogin(provider: 'google' | 'facebook', name: string, email: string, token: string, expiresAt: number) {\r\n  const federatedUser: FederatedUser = { name, email };\r\n  const federatedResponse: FederatedResponse = { token, expires_at: expiresAt };\r\n  try {\r\n    await Auth.federatedSignIn(provider, federatedResponse, federatedUser);\r\n    console.log('Cognito federated login success');\r\n  } catch (e) {\r\n    console.log(`Cognito federated login error: ${(e as Error).message}`);\r\n    throw e;\r\n  }\r\n}\r\n```\r\n5) If Cognito login succeeds, my app calls a `getOrCreateUser` Lambda function that looks up that user in a backend database using the Cognito Identity ID as a key and returns the user profile back to the client. If the user doesn't exist in my database, then the Lambda will create a new user in the database, storing its Cognito Identity ID as well as email, name, and other profile info returned from the social provider.\r\n\r\nUntil recently my app only supported Facebook login, but now that it also supports Google login, I'm running into the case where a user originally signs up using one social provider (e.g. Google) but later decides to log in with another provider (e.g. Facebook). My database will prevent a duplicate account from being created with the same email as another account. So today this use case simply fails with an error, e.g. \"_You've previously logged in using Facebook, so please use Facebook to log in again._\" \r\n\r\nInstead, I'd like to enable users to log in with either social provider. For this use case, do developers typically store multiple Cognito Identity IDs per user (one per social provider) in the back-end database, instead of just storing one identity per user?  Or is there some way to tell Cognito to match the email address so that only one Cognito Identity ID will be created per email address?  I assume not, but wanted to know before changing my DB schema.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMTQ0NQ==","author":{"login":"filburt-turle"},"title":"Federated Signin w/Axios but feed access_tokens into amplify lib?","body":"Hi,\r\n\r\nI currently use a third-party auth provider w/cognito. I have my provider working w/cognito and I'm able to do the gran_code workflow to obtain access_tokens, etc...\r\n\r\nAt the moment I'm unable to use the Auth for Amplify because of:\r\n\r\nhttps://github.com/aws-amplify/amplify-js/issues/6438#issuecomment-665279255\r\n\r\nI'm wondering if there's a way that if I do my exchange outside of the Amplify lib to get my JWT-tokens, is there a way to inject that data into Amplify lib, so that appsync queries using the lib, would be seamless as I've already got the auth tokens needed?\r\n\r\n\r\nAny help would be appreciated.\r\nThanks","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMTIzMw==","author":{"login":"andsee"},"title":"How to register a guest Identity Id to a User Pool User.","body":"Our app starts users as guests for a low friction start. They may play for as long as they wish against the IdentityId from the Federated Identity Pool and data is saved and uploaded to S3 against their IdentityId.\r\n\r\nAfter deciding they like the app they decide to register by linking their save to an email or (Google / Facebook / Apple etc)\r\n\r\nSo this creates a UserPool user for them, but in doing so the amplify library assigns them a new IdentityId from the federated identity pool.\r\n\r\nHow do I switch the UserPool user to use the original IdentityId so that the user can access their previous data?\r\n\r\nI’ve tried storing the existing IdentityId before calling SignIn (during a registration of new user flow) and then linking it to the user as follows however the UserPool user remains linked to the new IdentityId.\r\n\r\n```\r\n\r\n    async linkUser(identityId:string)\r\n    {\r\n        let session = await Auth.currentSession();\r\n        console.log('linkUser session', session);\r\n        let config = Auth.configure(undefined);\r\n        let credentials = undefined;\r\n        const region = config.identityPoolRegion || config.region;\r\n        const userPoolId = config.userPoolId;\r\n        const provider = 'cognito-idp.' + region + '.amazonaws.com/' + userPoolId;\r\n        const token = session.getIdToken().getJwtToken();\r\n        const logins = {};\r\n        logins[provider] = token;\r\n        // TODO Append with any existing logins\r\n        const cognitoClient = new CognitoIdentityClient({\r\n            region,\r\n            customUserAgent: getAmplifyUserAgent(),\r\n        });\r\n        const cognitoIdentityParams: FromCognitoIdentityParameters = {\r\n            identityId: identityId,\r\n            logins,\r\n            client: cognitoClient,\r\n        };\r\n        console.log('linkUser useExistingIdentity setup', cognitoIdentityParams);\r\n\r\n        credentials = fromCognitoIdentity(cognitoIdentityParams)();\r\n        console.log('linkUser resulting credentials', credentials);\r\n    }\r\n\r\n    async doRegister({password, email}: {password: string, email: string}) {\r\n        let originalUserId = this.userIdentity;\r\n        const data = {username: this.userIdentity, password};\r\n        const Register = await Auth.signUp({ ...data, attributes: {email} });\r\n        const SignIn = await Auth.signIn(data);\r\n        console.log('[Auth] Sign in: ', SignIn);\r\n        this.linkUser(originalUserId);\r\n        const SendCode = await Auth.verifyCurrentUserAttribute('email');\r\n        return { Register, SignIn, SendCode };\r\n    }\r\n```","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMTEwNg==","author":{"login":"malmil"},"title":"no-ssr in Nuxt.js with amplify-authenticator","body":"Hi,\r\n\r\nI've recently switched from SPA to Universal (Server Rendered (Universal SSR)) in Nuxt and this caused some problems with aws-amplify-vue.\r\nEverything worked fine before this, but because I now have to wait for the client I need to have conditional imports.\r\n\r\nI have a component that is going to show amplify-authenticator:\r\n\r\n```\r\n<template>\r\n   <v-container grid-list-md>\r\n      <no-ssr placeholder=\"Loading...\">\r\n         <!-- not signed in -->\r\n         <v-flex v-if=\"!signedIn\" sx12>\r\n            <amplify-authenticator v-bind:authConfig=\"authConfig\" />\r\n         </v-flex>\r\n      </no-ssr>\r\n   </v-container>\r\n</template>\r\n<script>\r\nexport default {\r\n   data() {\r\n    return {\r\n      authConfig: {\r\n        signInConfig: {\r\n          header: 'Login as admin',\r\n          isSignUpDisplayed: false\r\n        }\r\n      }\r\n   },\r\n   computed: {\r\n      signedIn() {\r\n         return this.$store.state.user.signedIn\r\n      }\r\n   },\r\n   beforeMount() {\r\n     if (process.client) {\r\n       const { AmplifyEventBus: eventBus } = require('aws-amplify-vue')\r\n       eventBus.$on(\"authState\", info => {\r\n         if (info === 'signedIn') {\r\n           this.$store.dispatch('user/setUser', true)\r\n         }\r\n       })\r\n     }\r\n  }\r\n}\r\n</script>\r\n```\r\n\r\nThe problem with this is that if I write; `import { AmplifyEventBus } from 'aws-amplify-vue'` I will get document is not defined. And having the solution I wrote over gives me `TypeError: Cannot read property 'Logger' of undefined`\r\n\r\n**Additonal info:**\r\n\r\nplugin in nuxt.config.js\r\n```\r\nplugins: [\r\n    {\r\n        src: '~plugins/aws.js',\r\n        mode: 'client'\r\n    }\r\n  ],\r\n```\r\n\r\nplugins/aws.js\r\n```\r\nimport Vue from 'vue'\r\nimport Amplify, * as AmplifyModules from 'aws-amplify'\r\nimport AWSAppSyncClient from 'aws-appsync'\r\nimport awsconfig from '../src/aws-exports'\r\n\r\nconst AmplifyPlugin =  process.client ? import('aws-amplify-vue'.AmplifyPlugin) : null\r\n\r\nif (process.client && AmplifyPlugin) {\r\n  Amplify.configure(awsconfig)\r\n  Vue.use(AmplifyPlugin, AmplifyModules)\r\n\r\n  const client = new AWSAppSyncClient({\r\n    url: awsconfig.aws_appsync_graphqlEndpoint,\r\n    region: awsconfig.aws_appsync_region,\r\n    auth: {\r\n      type: awsconfig.aws_appsync_authenticationType,  //AWS_IAM\r\n      credentials: () => AmplifyModules.Auth.currentCredentials(),\r\n    }\r\n  })\r\n}\r\n```\r\n\r\n\r\nAnyone that knows how to fix this?\r\n\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMDgwNw==","author":{"login":"GetJoot"},"title":"S3.Storage and Cognito Group Policies","body":"Related to issues discussed in another thread, I want to explain a situation in our web app that is causing a 403 when using Amplify to upload a file to S3 for an authenticated user that belongs to a Cognito group that has a policy attached to it granting all access to the specific S3 bucket and folders.\r\n\r\nI have designed a Serverless app using the guidelines defined at [serverleses-stack.com](http://serverless-stack.com). This guide does not use the Amplify CLI for creating/generating/configuring the serverless architecture, but a similar architecture is manually defined/deployed and used. The client app is built using React and the Amplify libraries are installed and included using npm. Amplify Auth, Storage, and API are all configured using Amplify.configure() as detailed on this page [configure AWS](https://serverless-stack.com/chapters/configure-aws-amplify.html).\r\n\r\nWe use Cognito User Pools, User Groups, and Identity Pools to manage all of our app's users. When a new user signs up for our service using the web app, the new user is created in Cognito with the default policy we have defined for authenticated users. New users then have the option of creating a new 'Account' or joining an existing Account. Within our platform, Accounts represent an organization or group and are designed as a workspace for one or more users that need to share a set of resources such as images and other things associated with that account. When an account is created, a corresponding Cognito Group is created with the same name, a new Policy is defined and attached to the group allowing for access to certain S3 folders that will contain files accessible only by members of the group, and the Cognito user is then added to the Cognito group. Of course, any Cognitio user can belong to more than a single account (and therefore more than a single Cognito group).\r\n\r\nWhen an authenticated user is logged in, they have no issues using Storage.vault.put() to add files to their own private folder in S3. However, when we attempt to use Storage.put() to add files to the specific group/account folder defined in the access policy in the Cognito group they belong to, then receive a 403 Access Denied.\r\n\r\nI have checked to make sure the PUT storage request is generated properly and observed the request/response to make sure we are attempting to properly access the right S3 bucket and path (all good). So I am left scratching my head as to why the Cognito Group policy doesn't appear to be in effect for the given Cognito user who belongs to that Cognito group when attempting to access the specific resource in S3 allocated for that group when using Amplify.\r\n\r\nAny suggestions?\r\n\r\nThank you.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMDU4OQ==","author":{"login":"emmafass"},"title":"Change a field on a @model from one to many","body":"I have a table already set up in prod that is:\r\n\r\n```\r\ntype Person\r\n  @model\r\n  @auth(rules: [\r\n    {allow: owner, provider: userPools, operations: [read, create, update, delete]}\r\n  ]) {\r\n  id: ID!\r\n  firstname: String!\r\n  lastname: String!\r\n  loginemail: String!\r\n  role: Role!\r\n}\r\n\r\nenum Role {\r\n  student\r\n  teacher\r\n}\r\n```\r\n\r\nI am adding more roles to my application. For example I want to add a `tutor` role. Some teachers will need to have both a `tutor` and a `teacher` role.\r\n\r\nI need to update my schema to look like:\r\n```\r\ntype Person\r\n  @model\r\n  @auth(rules: [\r\n    {allow: owner, provider: userPools, operations: [read, create, update, delete]}\r\n  ]) {\r\n  id: ID!\r\n  firstname: String!\r\n  lastname: String!\r\n  loginemail: String!\r\n  role: [Role]\r\n}\r\n\r\nenum Role {\r\n  student\r\n  teacher\r\n  tutor\r\n}\r\n```\r\n\r\nI just tried updating my schema in a dev environment. This makes all current users have a `null` role. I cannot accidentally make a push like this in prod. \r\n\r\nHow do I change this part of my schema without overwriting the current data I have?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"r0zar"},"body":"You may want to take a look at https://github.com/aws-amplify/amplify-cli/issues/1407, it's related to your question about migrating data with amplify."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMDUxMA==","author":{"login":"Somtozech"},"title":"Specify current environment in customer resolver","body":"I am writing for a custom resolver for my Mutations. The custom resolver does a batch write for my POST schema.  The customer resolver requires me to specify the table name for dynamo DB. \r\nThe issue is that am using a multi-environment setup that has a dev and master. The current environment gets appended to the name of the table eg for dev the table name becomes Post-dev while for the master it becomes Post-master.\r\nSo whenever I switch to the master I have to change the table name to reference that of the master environment. And also have to do the same for dev.\r\n\r\nIs there any way I can make the table name dynamic to reference the correct table name for the current environment without having to edit the custom resolver?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"Somtozech"},"body":"Sample code\r\n## DEV ENVIRONMENT \r\n```\r\n#set($postsdata = [])\r\n#foreach($item in ${ctx.args.posts})\r\n    $util.qr($postsdata.add($util.dynamodb.toMapValues($item)))\r\n#end\r\n\r\n{\r\n    \"version\" : \"2018-05-29\",\r\n    \"operation\" : \"BatchPutItem\",\r\n    \"tables\" : {\r\n        \"Posts-dev\": $utils.toJson($postsdata)\r\n    }\r\n}\r\n```\r\n\r\n## MASTER ENVIRONMENT\r\n```\r\n#set($postsdata = [])\r\n#foreach($item in ${ctx.args.posts})\r\n    $util.qr($postsdata.add($util.dynamodb.toMapValues($item)))\r\n#end\r\n\r\n{\r\n    \"version\" : \"2018-05-29\",\r\n    \"operation\" : \"BatchPutItem\",\r\n    \"tables\" : {\r\n        \"Posts-master\": $utils.toJson($postsdata)\r\n    }\r\n}"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMDQyOA==","author":{"login":"iceback"},"title":"Is Identity Pool Required when using Cognito HostedUI to front single page app (serverless)","body":"I'm having a hard time getting from id/access/refresh tokens supplied by cognito to authenticating for serverless app.  Cannot construct Auth.CognitoUserSession(), Auth.currentAuthenticatedUser() blows up.  I seem to be finding only examples which use Identity Pools","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMDM0NA==","author":{"login":"4rocky4"},"title":"No scroll on AmplifySignUp - AmplifySignIn","body":"Hello,\r\nHow can I activate a scroll on AmplifySignUp or AmplifySignIn ?\r\nI wrapped my application with AmplifyAuthenticator but when I reduce the page (or display it on my mobile), there is no scroll so it's not possible to access to the bottom of the component.\r\n\r\n![NoScroll](https://user-images.githubusercontent.com/34491737/87933474-99ef0780-ca8d-11ea-9269-176c0ac2c28e.jpg)\r\n\r\nThanks for your help.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMDI0OA==","author":{"login":"ajitgoel"},"title":"graphql has changes but no changes detected when amplify push command run.","body":"I have made changes to my application's schema.graphql file and when i run the amplify push command, the system says \"no changes detected\". What could I be missing?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMDA1MQ==","author":{"login":"gtb104"},"title":"Auth related questions","body":"I'm rolling my own login UI so that we can do a little extra, and also get the styling to look exactly like UX would like. I've come across two issues so far that have me stumped\r\n\r\n1) I see that you can use `Auth.setPreferredMFA()` to set the desired MFA, but what can I use to get the list of available MFA for the user pool? The `Auth.getMFAOptions()` function is deprecated. What else do I use, or where else can I get it?\r\n\r\n2) If I've set a password recipe on my Cognito user pool, how can I get that recipe so that I can use it when a user has forgotten their password, or is setting their initial password? I see there's a `/user/describePasswordRules` endpoint, but you need to be logged in to use that. Is there an `Auth` function that I'm not seeing?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb245OTM1","author":{"login":"ajitgoel"},"title":"Correct way to re-init project","body":"I have a working application that I am unable to publish as the profile that I used to create the application is no longer valid(I had checked the secret key into github by mistake). In this scenario what is the correct way to reinitialize the application so I can publish it to AWS? i have also deleted the application artifacts in the cloud, when I was trying to fix the issue. ","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"ajitgoel"},"body":"I was able to get this working by getting the latest source code from git, running npm install, amplify init=>creating a new environment, amplify publish."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb245ODUw","author":{"login":"danielblignaut"},"title":"How to calculate userContextData for Dart implementation","body":"Hi, \r\n\r\nI'm currently working on a Dart implementation of Cognito and then AWS Amplify however I notice that there's no documentation around the UserContextData.EncodedData calculation and appears to be closed source.\r\n\r\nIs this for security through obscurity reasons and I should never expect assistance on this? Or is there someone who can help me out here to help the rest of the community!\r\n\r\nBest,\r\nDaniel","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb245NTk4","author":{"login":"andrewdavidcostello"},"title":"Verifying phone number (username) after updating attribute","body":"Title could be a bit misleading so apologies. The phone_number field is being used as the username and it needs to be allowed to be updated from an account page. A manual process is being used to manage the auth state.\r\n\r\nThe flow is like this:\r\n\r\n1. Call `Auth.updateUserAttributes(user, { phone_number })`\r\n2. Phone number is updated and user is updated in state (username does not update but the attributes do) which is fine\r\n3. The `phone_number` field is now no longer verified\r\n4. A form loads so the user can verify the phone number\r\n5. The user decides not to verify the phone number and proceeds to logout\r\n6. Now when they enter their phone_number they are sent a login confirmation code which is correct. However now the user no longer has a verified phone number. At this point they are currently being sent yet another code via text and asked to verify again, even though they have been allowed to login...\r\n\r\nSo there are a couple of questions here:\r\n\r\n1. Should a user that is required to have a verified phone number be allowed to login with an unverified one after update?\r\n2. If they are shouldn't it automatically become verified after logging in? (As the only alternative to a bad UX is to leave it unverified?)\r\n\r\nHope that makes sense and appreciate any thoughts and pointers.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"andrewdavidcostello"},"body":"Based on finding some comments elsewhere it seems like this requires a Pre Authentication Lambda setting up to deal with this scenario and the normal login one updating to ensure unverified numbers are not allowed."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb244NzM2","author":{"login":"dyson-yamashita"},"title":"How to save array values in DataStore.save","body":"Dear AWS Amplify team,\r\n\r\nI am currently trying to save using Amplify DataStore with Vue.js.\r\n\r\n- @aws-amplify/datastore: 2.2.4\r\n- @aws-amplify/core: 3.4.0\r\n\r\nI try to update item has editors field(this is array field) by below code:\r\n\r\n```\r\nsave: async function (data) {\r\n  const item = data.item\r\n   await DataStore.save(Item.copyOf(this.item, (updated) => {\r\n     updated.value = item.value\r\n}))\r\n```\r\nThe editors field is not updated, but editor field values are increased after saving.\r\n\r\n[Before]\r\n<img width=\"664\" alt=\"スクリーンショット 2020-07-05 9 58 39\" src=\"https://user-images.githubusercontent.com/4074527/86523346-2c948180-bea6-11ea-9d1b-457cd97b4773.png\">\r\n\r\n[After]\r\n<img width=\"672\" alt=\"スクリーンショット 2020-07-05 9 58 59\" src=\"https://user-images.githubusercontent.com/4074527/86523349-2ef6db80-bea6-11ea-83f2-6eb80abd73f1.png\">\r\n\r\nCould you tell me how to save avoid increasing values of not updated field?\r\n\r\nRegards,\r\nDyson","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"dyson-yamashita"},"body":"This problem was resolved in below versions\r\n- @aws-amplify/datastore: 2.2.6\r\n- @aws-amplify/core: 3.4.2\r\n\r\nThank you!"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb245Mzk4","author":{"login":"kldeb"},"title":"unauth Storage.get","body":"I have two front end applications using the same amplify backend. I'm using storage to manage images. \r\n\r\none front end can put and the other can only read. So i create the image public like so: \r\n\r\n```js\r\n      const imageResult = await Storage.put(imageName, blob, {\r\n        contentType: 'image/png',\r\n        level: 'public',\r\n      });\r\n```\r\n\r\n\r\nThen in the other app I'm trying to use Storage.get but it complains that there is no current user. I tried adding auth and getting a current unauth user but that's not working either. Does anyone have an example of how to do this?   \r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb245MzU4","author":{"login":"karrettgelley"},"title":"ACID Transactions with AppSync","body":"I have encountered a race condition in my app and I'm wondering if anyone in the community has come up with a way to solve similar issues. In my app I have events for which users can sign up. Each event has a capacity, or a maximum number of people who can sign up for it. A race condition occurs when multiple users sign up at the same time because they may encroach the capacity. In other words, I need an all-or-nothing transaction. I stumbled upon some documentation regarding [transactions with dynamodb](https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/transaction-example.html#transaction-example-Additional), but I'm wondering if anyone has tried this in the community. So, how have y'all dealt with race conditions in your apps, and if you've implemented transactions, how did you do it?\r\n\r\nI can share more details on my schema if need be","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb245MjU4","author":{"login":"mnatanbrito"},"title":"onCreate subscriptions won't fire","body":"Hi, folks!\r\nI've been struggling with this for some time now, so I could use some help.\r\n\r\nI can't get onCreate subscription for type `HealthPlan` working in my react-native app.\r\n\r\nBased on [Nader's example](https://github.com/dabit3/conference-app-in-a-box/blob/master/src/Discussion.js), \r\n\r\n__subscriptions.js__\r\n```\r\nexport const onCreateHealthPlan = /* GraphQL */ `\r\n  subscription OnCreateHealthPlan($owner: String!) {\r\n    onCreateHealthPlan(owner: $owner) {\r\n      id\r\n      name\r\n      type\r\n      owner\r\n    }\r\n  }\r\n`;\r\n```\r\n\r\n__Main.js__\r\n\r\n```\r\nimport { API, graphqlOperation } from 'aws-amplify';\r\nimport { onCreateHealthPlan } from './subscriptions.js';\r\n\r\nconst sub = \"cognitoSubField\";   // AMAZON_COGNITO_USER_POOLS auth\r\n\r\nAPI.graphql(\r\n          graphqlOperation(onCreateHealthPlan, {\r\n            owner: sub,\r\n          }),\r\n        ).subscribe({\r\n          next: response => {\r\n            console.log('next data received', response);\r\n          },\r\n          error: err => {\r\n            console.log('subscription error', err.message);\r\n          },\r\n          complete: () => {\r\n            console.log('finished');\r\n          },\r\n})\r\n```\r\n\r\n__Subscription.onCreateHealthPlan.req.vtl__\r\n```\r\n{\r\n    \"version\": \"2018-05-29\",\r\n    \"payload\": {}\r\n}\r\n````\r\n\r\n__Subscription.onCreateHealthPlan.res.vtl__\r\n```\r\n## [Start] Determine request authentication mode **\r\n#if( $util.isNullOrEmpty($authMode) && !$util.isNull($ctx.identity) && !$util.isNull($ctx.identity.sub) && !$util.isNull($ctx.identity.issuer) && !$util.isNull($ctx.identity.username) && !$util.isNull($ctx.identity.claims) && !$util.isNull($ctx.identity.sourceIp) && !$util.isNull($ctx.identity.defaultAuthStrategy) )\r\n  #set( $authMode = \"userPools\" )\r\n#end\r\n## [End] Determine request authentication mode **\r\n## [Start] Check authMode and execute owner/group checks **\r\n#if( $authMode == \"userPools\" )\r\n  ## No Static Group Authorization Rules **\r\n\r\n\r\n  ## [Start] Owner Authorization Checks **\r\n  #set( $isOwnerAuthorized = false )\r\n  ## Authorization rule: { allow: owner, ownerField: \"owner\", identityClaim: \"cognito:username\" } **\r\n  #set( $allowedOwners0 = $util.defaultIfNull($ctx.args.owner, null) )\r\n  #set( $identityValue = $util.defaultIfNull($ctx.identity.claims.get(\"username\"),\r\n                        $util.defaultIfNull($ctx.identity.claims.get(\"cognito:username\"), \"___xamznone____\")) )\r\n  #if( $util.isList($allowedOwners0) )\r\n    #foreach( $allowedOwner in $allowedOwners0 )\r\n      #if( $allowedOwner == $identityValue )\r\n        #set( $isOwnerAuthorized = true )\r\n      #end\r\n    #end\r\n  #end\r\n  #if( $util.isString($allowedOwners0) )\r\n    #if( $allowedOwners0 == $identityValue )\r\n      #set( $isOwnerAuthorized = true )\r\n    #end\r\n  #end\r\n  ## [End] Owner Authorization Checks **\r\n\r\n\r\n  ## [Start] Throw if unauthorized **\r\n  #if( !($isStaticGroupAuthorized == true || $isOwnerAuthorized == true) )\r\n    $util.unauthorized()\r\n  #end\r\n  ## [End] Throw if unauthorized **\r\n#end\r\n## [End] Check authMode and execute owner/group checks **\r\n\r\n$util.toJson(null)\r\n````\r\n\r\nEvery time the code runs, I get:\r\n\r\n`subscription error`\r\n\r\nlogged to the console.\r\n\r\nAnalyzing the console output, I found the following info:\r\n\r\n```\r\nLOG  [DEBUG] 39:51.456 AWSAppSyncRealTimeProvider - subscription message from AWS AppSyncRealTime: {\"type\":\"connection_ack\",\"payload\":{\"connectionTimeoutMs\":300000}}\r\nLOG  [DEBUG] 39:51.457 AWSAppSyncRealTimeProvider - Notifying connection successful\r\nLOG  [DEBUG] 39:51.459 AWSAppSyncRealTimeProvider - subscription message from AWS AppSync RealTime: {\"type\":\"ka\"}\r\nLOG  [DEBUG] 39:51.459 AWSAppSyncRealTimeProvider {\"id\": \"\", \"observer\": null, \"query\": \"\", \"variables\": {}}\r\nLOG  [DEBUG] 39:51.620 AWSAppSyncRealTimeProvider - subscription message from AWS AppSync RealTime: {\"id\":\"9f72da89-0d1d-4aa8-8457-78bb1832478b\",\"type\":\"error\",\"payload\":{\"errors\":[{\"errorType\":\"MappingTemplate\",\"message\":\"Value for field '$[operation]' not found.\"}]}}\r\nLOG  [DEBUG] 39:51.620 AWSAppSyncRealTimeProvider {\"id\": \"guid\", \"observer\": {\"_subscription\": {\"_cleanup\": [Function anonymous], \"_observer\": [Object], \"_queue\": undefined, \"_state\": \"ready\"}}, \"query\": \"subscription OnCreateHealthPlan($owner: String!) {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     \r\n    onCreateHealthPlan(owner: $owner) {\r\n        id\r\n        name\r\n        type\r\n        owner                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       \r\n    }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     }\", \"variables\": {\"owner\": \"cognitoSubField\"}}\r\nLOG  [DEBUG] 39:51.622 AWSAppSyncRealTimeProvider - Error while unsubscribing Error: Subscription never connected\r\nLOG  [DEBUG] 39:52.624 AWSAppSyncRealTimeProvider - closing WebSocket...\r\n```\r\n\r\nIt seems that this is the real error:\r\n`Value for field '$[operation]' not found`\r\n\r\nAny ideas of why this is happening? 😰 ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb245MTI1","author":{"login":"ionutmiftode"},"title":"Access multiple @model resources in lambda trigger","body":"Hello,\r\n\r\n![Selection_024](https://user-images.githubusercontent.com/6890762/86971276-8c767b00-c179-11ea-87b6-76f8909b60ef.png)\r\n\r\nI have a lambda that gets trigger when a graphql `@model` gets modified.\r\nWhat I want to do is to connect on other `@model`'s (dynamoDB tables) to have all the data that I need in the lambda trigger.\r\n\r\nHow I can do that? do I have to use a graphql client to make a api call to API_VEHICOOL_GRAPHQLAPIIDOUTPUT?\r\n\r\nAny response will be very appreciated!\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"ionutmiftode"},"body":"it seems it was a basic `dynamoDB.query()` to API_VEHICOOL_COOLERTABLE_NAME"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb245MjAw","author":{"login":"Rafcin"},"title":"Cognito and IAM 401 or not called.","body":"The issue is I have created a schema that utilizes cognito groups and IAM. I wanted to use IAM for general read access and cognito to allow specific users to perform action such as creating posts etc.\r\n \r\nMy current model uses the following auth.\r\n```\r\n@auth(\r\n  rules: \r\n    [\r\n      { allow: owner }\r\n      { allow: public, provider: iam, operations: [read] }\r\n      { allow: private }\r\n      { allow: groups, groups: [\"User\"], operations: [read] }\r\n      { allow: groups, groups: [\"RestaurantUser\"] }\r\n      { allow: groups, groups: [\"Admin\"] }\r\n    ]\r\n)\r\n```\r\n\r\nThe problem I run into is, I can't user Cognito and IAM. If try to set the authmode by doing \r\n``` Auth.currentAuthenticatedUser ? \"COGNITO...\" : \"IAM...\"```\r\n\r\nEven if it uses IAM it won't use IAM when its unauthenticated. Normally when using IAM it doesn't allow the authed user to makes calls, however the unauthed can. And the same is if you use cognito then authed users work and unauthed don't.\r\n\r\nThe one thing I noticed was if the user isn't in one of the 3 groups then the calls seem to work fine. I originally had read, write etc and the same issue persisted \"Permission Denied\" ","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"Rafcin"},"body":"It seems this issue is actually the result of guest credentials not generating for guest users. I looked at a few of my project and they all log credentials for guest users except for this project even though I have the unauthorized credentials active in cognito."}},{"node":{"author":{"login":"mauerbac"},"body":"HI @Rafcin - I'm going to move this to our discussion form as it seems you need help with the graphQL schema and are not reporting a bug. "}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb245MTk5","author":{"login":"nihp"},"title":"User can access the app after disabled the user by admin in cognito (using aws-amplify-react-native)","body":"I have disabled a user in cognito. But the user is already in the app. Here he not received any error and also it will allow him to use the app.\r\n\r\nHow can I make the user to out of the app immediately after the disable action in cognito?\r\n\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"mauerbac"},"body":"Hi @nihp - this sounds more like a question rather than a bug report. Can you provide more information? What is the error? "}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb245MDUx","author":{"login":"ruodingt"},"title":"Social Provider Bypassing hosted UI with federatedsignin","body":"# Use Case\r\nWe are using appsync with auth method CognitoUserPool.\r\n\r\nPreviously our our team has been using normal `Auth.signIn()`.\r\n\r\nWith Auth.signIn, the amplify SDK could automatically pickup the user pool user info and identity pool credential.\r\n\r\nWe don't want to use hosted UI since it will destroy our existing UI/UX flow.\r\n\r\n# We tried\r\nWe were expecting that `Auth.federatedSignin()` would have very similar behaviour such that the SDK could automatically pickup the user pool user info and identity pool credential.\r\n\r\nWe tried two approaches:\r\n\r\n1. Using Facebook SDK and federatedSignIn \r\n```\r\n this.amplify.auth().federatedSignIn('Facebook', facebookResponse, federatedUser)\r\n```\r\nOutcome: No User created in the User Pool, but got currentuserinfo and currentuserCredentials\r\n(No user in user pool but got identities in identity)\r\n\r\n 2. Facebook SDK and federatedSignIn with provider \r\n```\r\n this.amplify.auth().federatedSignIn({provider: 'Facebook'}, facebookResponse, federatedUser)\r\n```\r\n Outcome: new user was created in the user pool, but no access to currentuserinfo and currentuserCredentials.\r\n\r\nI see that there are 3 different implementations in the [doc](https://aws-amplify.github.io/amplify-js/api/classes/authclass.html#currentuserpooluser)\r\n\r\nBut I didn't expect that they lead to different behaviours. In fact, we are expecting that `auth().federatedSignIn` could behave like `Auth.signIn()`, in which there will be a user exist in a user pool and the Amplify SDK could pick up those user pool user info and identity pool credential\r\n\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb244OTI4","author":{"login":"maciulskis"},"title":"How to use DataStore before and after authentication?","body":"Hello. I'm trying implement an offline-first react native application using DataStore. Say we have auth setup through Cognito user pool and this basic schema:\r\n```\r\ntype Record @model @auth(rules: [{allow: owner}]) {\r\n  id: ID!\r\n\tnumber: Int!\r\n\towner: String\r\n}\r\n```\r\nIs it possible to implement a workflow, where a user could use the app without signing up or logging in, completely offline, performing CRUD operations, where data is persisted in DataStore? Later on, if he decides to sign up or log in, local and remote data should sync. Main issues I'm having right now are:\r\n1. If the user is not authenticated, created records are persisted in DataStore, but after authenticating, local data does not sync with remote. Application has to be completely restarted for sync to work.\r\n2. Creating a record while logged in, then logging out (or when the access token expires) and creating a record again causes an infinite loop in Amplify's lib, the APIClass.graphql function is being called over and over again with a mutation operation to create the record, thus freezing the UI.\r\n3. Performing a DataStore operation while user is not authenticated results in an unhandled promise rejections originating from Amplify Auth module.\r\n\r\nHere's a repo with the setup to reproduce described behaviour https://github.com/maciulskis/rn-datastore-example\r\n\r\nAmplify CLI version 4.21.3","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb244ODg0","author":{"login":"stayingcool"},"title":"total count of appsync serverless using aurora","body":"Hello All,\r\n\r\nHow can we get the total count of a type using appsync serverless (using aurora)? This is something I see in [Hasura called as Aggregate of results ](https://hasura.io/docs/1.0/graphql/manual/queries/pagination.html#fetch-limited-results-along-with-data-aggregated-over-all-results-e-g-total-count-in-the-same-query)?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb244Nzc5","author":{"login":"Zebara58"},"title":"Amplify Deploy Stuck - React App With Yarn","body":"I'm using yarn to setup the dependencies. I got the react amplify website to launch properly on local and I got the amplify authorization to work properly on localhost. I'm currently using the free tier. I am just trying to test deploying the app with Amplify now. I have the following code in the build settings in Amplify:\r\n`version: 1`\r\n`backend:`\r\n ` phases:`\r\n`    build:`\r\n`      commands:`\r\n`        - cd yarn-created-react-app-directory-name-here`\r\n`        # amplifyPush to create the aws-exports.js file`\r\n`        - amplifyPush --simple`\r\n`frontend:`\r\n`  phases:`\r\n`    # IMPORTANT - Please verify your build commands`\r\n`    preBuild:`\r\n`      commands:`\r\n`        - yarn install`\r\n`    build:`\r\n`      commands:`\r\n`        - yarn run build`\r\n`  artifacts:`\r\n`    # IMPORTANT - Please verify your build output directory`\r\n`    baseDirectory: ./`\r\n`    files:`\r\n`      - '**/*'`\r\n`  cache:`\r\n`    paths: []`\r\n\r\n\r\nThe build keeps gets stuck in the Deploy phase after about 40k \"Uploading\" / \"Skipping\" messages.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"sammartinez"},"body":"@Zebara58 This issue seems related to [Amplify Console](https://github.com/aws-amplify/amplify-console) I would highly recommend to reach out to them. cc @brene for visibility  "}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb244NTAz","author":{"login":"kimuhjin"},"title":"DynamoDB.scan Problem","body":"I Tried this code:\r\n\r\napp.get('/<YOUR_PATH>', function (req, res) {\r\nvar params = {\r\nTableName: tableName,\r\nSelect: 'ALL_ATTRIBUTES',\r\n};\r\ndynamodb.scan(params, (err, data) => {\r\nif (err) {\r\nres.json({ error: 'Could not load items: ' + err.message });\r\n}\r\nres.json({\r\ndata: data.Items.map(item => {\r\nreturn item;\r\n})\r\n});\r\n});\r\n});\r\n\r\nbut data returned not in ordered.\r\nis there have any solution to solve this problem?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"adrian-hc"},"body":"It sounds like you should try the \"query\" api instead of \"scan\". See [this](https://stackoverflow.com/a/21815354)"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb244ODEy","author":{"login":"davidgengenbach"},"title":"Single-Sign-On (SSO) via amplify auth","body":"Goal:\r\n1) Login user on custom UI via Amplify Auth (with MFA)\r\n2) After successful login which sets the `IdToken`, `AccessToken`, ... => I want to redirect to another application(**different domain**)  where the user should also be authenticated \r\n\r\nStep 1 is no problem - works fine. I get the `Access Token`, can change any attribute and everything is fine - **within this application**.\r\n\r\nStep 2 is a problem. I am not sure whether the `AccessToken` and `IdToken` are safe to be passed to another application.\r\nI think this flow is called `Implicit grant` and not encouraged?\r\n\r\nHints or help would be greatly appreciated!\r\n\r\n\r\nRelated: https://aws.amazon.com/blogs/mobile/understanding-amazon-cognito-user-pool-oauth-2-0-grants/","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb244NzM1","author":{"login":"marianolc"},"title":"Design help to create a Multi Tenant Table using the Primary Key + Sort Key in DataStore","body":"For example, using a Table that containts all the orders created for that User, something like this:\r\n\r\n```\r\ntype Order @model @auth(rules: [{allow:owner}])\r\n{\r\n  id: ID!\r\n  owner: String\r\n  total: Float\r\n  qty: Float\r\n  subtotal: Float\r\n  tax: Float\r\n  status: String\r\n  createdAt: String!\r\n  canceledAt: String\r\n  completedAt: String\r\n  customerId: ID\r\n  customerName: String\r\n  customerAddress: String\r\n}\r\n```\r\n\r\nSo, If i wanted to change it to use the multi tenant design and Using PK+ST to be better optimized should I change it for something like this?\r\n\r\n```\r\ntype Order @model @auth(rules: [{allow:owner}]) @key(fields: [\"owner\", \"id\"])\r\n{\r\n  id: ID!\r\n  owner: String\r\n  total: Float\r\n  qty: Float\r\n  subtotal: Float\r\n  tax: Float\r\n  status: String\r\n  createdAt: String!\r\n  canceledAt: String\r\n  completedAt: String\r\n  customerId: ID\r\n  customerName: String\r\n}\r\n```\r\n\r\n**Should the Owner by the Partition Key ? and the Id/number the Sort key?**\r\n\r\nThanks!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb244NzI1","author":{"login":"syang"},"title":"[Cloudfront with Amplify Storage] How to build an album application by serving photos through CloudFront?","body":"I am building an application using Amplify Storage, so that a signed-in user can upload his photos to S3 (in his own `protected` subfolder) and any users can view his photos.\r\n\r\nI think this session in the Amplify Storage document shows the solution https://docs.amplify.aws/lib/storage/getting-started/q/platform/js#using-amazon-s3, but the photo viewing logic shown in the doc is about directly accessing S3, which is probably not performant.\r\n\r\nI wonder if I can have my application read the photos through CloudFront instead of through S3 directly. Here are two concrete questions I have:\r\n\r\n- Is it possible to use Amplify Storage Js lib to access the CloudFront endpoint as mentioned above?\r\n\r\n- If not possible, is it possible to upload the S3 object using Amplify Storage JS lib and use AWS-SDK to access Cloudfront? (I guess it's theoretically possible, but I guess there must be a lot of hassle for me to find the right URL of the photos that I wanted to read, plug the hassle of setting up CloudFront/S3 connection through Cloudformation)\r\n\r\nLooks like my problem is quite similar with a discussion in Amplify-Cli repo https://github.com/aws-amplify/amplify-cli/issues/1910 and I am not sure if we can do better (simpler) than what @ehtulhaq suggested.\r\n\r\nThank for sharing your thoughts.","upvoteCount":8,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb244NjM2","author":{"login":"mbarinov"},"title":"Getting Access Keys for third-party OIDC provider","body":"Hi lads, the second day I can not understand how to obtain an access key for OIDC provider (twitch). Auth is working great, CognitoUser entity is available on the client-side. Maybe anybody faced such a problem before. Peace ✌️","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb244NTk0","author":{"login":"maximelebastard"},"title":"Why typescript codegen doesn't generates the graphql types ?","body":"Hello, in Typescript is there any reason why the graphql types are not generated in API.ts ? That would be super useful to detect regressions.\r\n\r\nFor example, let's say I have this schema.graphql\r\n```graphql\r\ntype Todo @model {\r\n  id: ID!\r\n  name: String!\r\n  description: String\r\n}\r\n```\r\n\r\nI'd love to get that type generated into my API.ts\r\n```typescript\r\ntype Todo = {\r\n  id: string,\r\n  name: string,\r\n  description?: string|null\r\n}\r\n```","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb244NDYx","author":{"login":"brandonvilla21"},"title":"How to add a description to a UserGroup using amplify auth update","body":"I'm creating my user groups from `amplify auth update` command. But now I want to add the description property for each group in order to be displayed in the AWS Cognito Dashboard:\r\n\r\n<img width=\"978\" alt=\"image\" src=\"https://user-images.githubusercontent.com/20288447/86321373-7bb88900-bbfe-11ea-9fb5-9f66b0d624a8.png\">\r\n\r\nThe problem is, when I add the description in the `template.json` and then I do `amplify push` this gets removed automatically:\r\n<img width=\"778\" alt=\"image\" src=\"https://user-images.githubusercontent.com/20288447/86321451-9f7bcf00-bbfe-11ea-9423-5b929a3f85e3.png\">\r\n\r\nHow can I add and persist the description property then?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb244NDU0","author":{"login":"sreimer15"},"title":"How to take cognito user session from amazon-cognito-identity-js and have it be managed by Amplify?","body":"Hi, \r\n\r\nI have created a separate app that handles authentication hosted on a web server, essentially a url where a user can authenticate through amplify. I have a web app that uses that seperate app for authentication and is redirected back to the web app with a set of cognito tokens, that set of cognito tokens is then used to create a session on the backend and is used as needed.\r\n\r\nI am now creating a react-native app, and want to use a similar flow (authentication through separate app, a redirect back into my native app), I can instantiate a session through amazon-cognito-identity-js, but I want to somehow pass that session into Amplify in order to have the amplify package manage the life cycle of the session.\r\n\r\nThere are many features within amplify that I want to use for the react native app, like aws pinpoint, but I do not want to reimplement my auth flow logic within my native app. Is there a way to take the id/access/refreshToken I am receiving through my redirect_url and to instantiate a session in aws amplify with it?\r\n\r\n\r\nThank you for any help you can be!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb244MDk1","author":{"login":"PedroBern"},"title":"Creating an already existent record with @key(fields: [\"someID\"]) does not raise error. Is it expected?","body":"Is it expected to not raising an error when creating a duplicate record when the hash key field is not id? Note that the second attempt to create the `Todo2` did not create a new record, but also did not return an error. See the following code.\r\n\r\nI have the following schema:\r\n\r\n```graphql\r\ntype Todo1 @model {\r\n  id: ID!\r\n  name: String\r\n}\r\n\r\ntype Todo2 @model @key(fields: [\"someID\"]){\r\n  someID: ID!\r\n  name: String\r\n}\r\n```\r\n\r\nRunning:\r\n\r\n```graphql\r\n# First run\r\nmutation createTodo1 {\r\n  createTodo1(input: {id: \"my-id\", name: \"name\"}) {\r\n    id\r\n  }\r\n}\r\n\r\n# OK\r\n\r\n# Second run\r\nmutation createTodo1 {\r\n  createTodo1(input: {id: \"my-id\", name: \"name\"}) {\r\n    id\r\n  }\r\n}\r\n\r\n# \"errorType\": \"DynamoDB:ConditionalCheckFailedException\"\r\n```\r\n But, running:\r\n\r\n```graphql\r\n# First run\r\nmutation createTodo2 {\r\n  createTodo2(input: {id: \"my-id\", name: \"name\"}) {\r\n    id\r\n  }\r\n}\r\n\r\n# OK\r\n\r\n# Second run\r\nmutation createTodo2 {\r\n  createTodo2(input: {id: \"my-id\", name: \"name\"}) {\r\n    id\r\n  }\r\n}\r\n\r\n# OK again! Is it expected?\r\n```\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb244MDIw","author":{"login":"kannieWeesNie"},"title":"update lambda function on backend not updating frontend","body":"hi\r\nam using storage in a Vue app. i created a lambda trigger (triggered when upload file to S3) and then updated the lambda function in the backend. if i upload file, it works. \r\n\r\nproblem is that the changes i made to the function are not updated in the frontend (function's index.js file). (i ran amplify pull --appId d73ox8pnts8im --envName dev) but it indicates | Function | S3Trigger2d214614 | No Change | awscloudformation |\r\n\r\nnow if i update the local function index.js and run amplify push, it overwrites the changes made to the function in the backend!\r\n\r\ndoes this mean that i may only make changes to the functions local index.js file?\r\n\r\nwhat about user, role, bucket policies? are the changes i make on the backend valid? will they be overwritten next time i run amplify push?\r\n\r\nappreciate any clarity on this \r\nthanks","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb244MDEy","author":{"login":"siddharthsharma94"},"title":"Amplify Auth with Cognito in Multiple Env's","body":"Hey! So I was wondering what would be the recommended approach to building an AWS Amplify React project with Auth in multiple environments.\r\n\r\nLet's say I want to have a Dev and Prod Env which is based on the Git env. Let's also say I want to be able to deploy feature branches. I have a Federated Oauth integration with Google and Fb and the redirect URL is my main URL. How would I build my app to allow multiple env auth? I'm not sure how to approach this since I want people on my team to be able to test out stuff in the Dev and Feature branch Env's.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb243OTc5","author":{"login":"naripok"},"title":"How to manage DataStore Sync when the is no support for IndexedDB?","body":"Is there a way to bypass local storage and translate DataStore saves directly into GraphQL mutations whenever there is no support  for IndexedDB, like in Tor browser (or firefox private mode)?\r\nDo I need to do the support detection and implement alternative calls on graphQL by hand?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb243ODU0","author":{"login":"sakhmedbayev"},"title":"Is this possible to DataStore.query not @model type?","body":"I have a graphql schema as follow:\r\n\r\n```\r\ntype Chapter { # notice not @model type\r\n  id: ID!\r\n  bookCode: String!\r\n  chapterNumber: String!\r\n  content: AWSJSON!\r\n}\r\n\r\ntype Query {\r\n  getChapter(\r\n    projectId: ID!\r\n    bookCode: String!\r\n    chapterNumber: String!\r\n  ): Chapter\r\n}\r\n```\r\n\r\nIs this possible to query `Chapter` using `DataStore.query`?\r\n\r\n```\r\n const chapterNet = await DataStore.query(Chapter, (c) =>\r\n        c.bookCode(\"eq\", `${bookCode} `).chapterNumber(\"eq\", chapterNumber)\r\n      );\r\n```","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb243NzU4","author":{"login":"yudao"},"title":"AUTH - Switch between groups","body":"Hi,\r\n\r\nI'm using different groups which each one get his own IAM policy (attached to a specific IAM role).\r\n\r\nI need to implements a\"switch\" between the groups associated to the user. He could switch between his ADMIN role to an EDITOR role, etc.\r\n\r\nHow can I switch between his groups without asking to re-authenticate him?\r\n\r\nI'm using only one Cognito User Pool and the standard authorizer.\r\n\r\nThx for your help.\r\n\r\nYu.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb243NzI2","author":{"login":"Dylan-Carriere"},"title":"API.get is not working and returns  \"<apiname> does not exist\"","body":"Hello, I am having an issue about my API.get function.\r\nIt always retrun <apiname> does not exist while the api name is specified in may aws-exports.js file.\r\nI do not know where the issue came from, here is my code to invoke the API : \r\n\r\n```\r\nconst apiName = \"testtrigger\";\r\n    const path = \"/test\"; \r\n    const myInit = {\r\n        headers: {}, \r\n        response: true, \r\n    };\r\n    API\r\n      .get(apiName, path, myInit)\r\n      .then(response => {\r\n        console.log(response);\r\n      })\r\n      .catch(error => {\r\n        console.log(error);\r\n    });\r\n```\r\n\r\nAnd the content of my aws-exports.js file for the api endpoint is : \r\n\r\n`\r\n\"aws_cloud_logic_custom\": [\r\n        {\r\n            \"name\": \"testtrigger\",\r\n            \"endpoint\": \"<apiUrl>\",\r\n            \"region\": \"eu-west-1\"\r\n        }\r\n    ],\r\n`\r\n\r\nThis is the error that I get `API testtrigger does not exist`\r\n\r\nI hope you guys can help me !","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb243NzA3","author":{"login":"MatteoInfi"},"title":"Post signup hook for Cognito","body":"Is there an hook for PostSignup? I need to get the userId, but in the pre-signup is not possible.\r\n\r\nThanks","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb243NjA3","author":{"login":"ayaankhan98"},"title":"aws-congito forgot password verification SerializationException error","body":"i was implementing the forgot password feature using angular9 and aws-amplify. After successful sending of verification code on user's email i have a route where the user enters this verification code along with the username and new password, in this route i am using \r\n```Auth.forgotPasswordSubmit(username, code, newPassword)``` \r\nif i define the verification code field as input type of number in the componet.html file i get this error\r\n```\r\nforgot-password-verification.component.ts:29 \r\n{code: \"SerializationException\", name: \"SerializationException\", message: \"class com.amazon.coral.value.json.numbers.TruncatingBigNumber can not be converted to an String\"}\r\n```\r\nbut if i change the verification field code as input type of text everything works fine, i am thinking that if we are getting the numeric verification code always from cognito then why can't i use numbers instead of text input","upvoteCount":0,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb243NTQ0","author":{"login":"JohnAtFenestra"},"title":"Created after Premium Support call: Jest test will not signIn after a signOut","body":"I am writing a set of end-to-end Jest tests to develop our authentication code. I have been fighting basic signIn for two days. Here is the latest problem scenario.\r\n\r\n1. Create a user\r\n2. SignIn\r\n3. Respond to NEW_PASSWORD_REQUIRED challenge\r\n4. SignOut\r\n5. SignIn using new credentials\r\n\r\nBlows up on step 5\r\n\r\nMy code\r\n\r\n```javascript\r\n  it('should create a new user', async () => {\r\n    const newUser = {\r\n      username: 'lisasimpson',\r\n      temporaryPassword: ******,\r\n      newPassword: ******,\r\n      name: 'Lisa Simpson',\r\n      email: 'john.elrick@gmail.com',\r\n      messageAction: 'SUPPRESS',\r\n    }\r\n\r\n    try {\r\n      const createdUser = await cognitoService.createUser(newUser)\r\n      expect(createdUser.User.Username).toEqual(newUser.username)\r\n      expect(createdUser.User.UserStatus).toEqual('FORCE_CHANGE_PASSWORD')\r\n      let user\r\n      user = await Auth.signIn(newUser.username, newUser.temporaryPassword)\r\n      expect(user.challengeName).toEqual('NEW_PASSWORD_REQUIRED')\r\n      console.log('starting complete')\r\n      if (user.challengeName === 'NEW_PASSWORD_REQUIRED') {\r\n        await Auth.completeNewPassword(user, newUser.temporaryPassword, {})\r\n        await Auth.changePassword(\r\n          user,\r\n          newUser.temporaryPassword,\r\n          newUser.newPassword\r\n        )\r\n      }\r\n      console.log('complete done')\r\n      await Auth.signOut()\r\n      user = null\r\n\r\n      console.log('Re Signin')\r\n      user = await Auth.signIn(newUser.username, newUser.newPassword) // BLOWS UP HERE!!!\r\n      console.log(user)\r\n\r\n      const session = await Auth.currentSession()\r\n      console.log(session.getIdToken().getJwtToken())\r\n      await cognitoService.deleteUser(newUser.username)\r\n    } catch (error) {\r\n      console.log('ERROR')\r\n      console.log(error)\r\n      console.log(error.stack)\r\n      fail(error)\r\n    }\r\n  })\r\n\r\n```\r\n\r\n```bash\r\njohn@john-onlogic:~/Documents/fenestra/naep/2021/DigitalFolders/cognito-sandbox$ jest\r\n  console.log\r\n    starting complete\r\n\r\n      at Object.<anonymous> (test/hello.spec.js:55:15)\r\n\r\n  console.log\r\n    complete done\r\n\r\n      at Object.<anonymous> (test/hello.spec.js:64:15)\r\n\r\n  console.log\r\n    Re Signin\r\n\r\n      at Object.<anonymous> (test/hello.spec.js:68:15)\r\n\r\n FAIL  test/hello.spec.js (5.573 s)\r\n  hello world\r\n    ✓ should detect existing user (254 ms)\r\n    ✓ should detect user does not exist (173 ms)\r\n    ✕ should create a new user (3312 ms)\r\n\r\n  ● hello world › should create a new user\r\n\r\n    NotAuthorizedException: Incorrect username or password.\r\n\r\n      36 |   })\r\n      37 | \r\n    > 38 |   it('should create a new user', async () => {\r\n         |   ^\r\n      39 |     const newUser = {\r\n      40 |       username: 'lisasimpson',\r\n      41 |       temporaryPassword: 'Naep$2020',\r\n\r\n      at new Spec (../../../../../../.nvm/versions/node/v12.16.3/lib/node_modules/jest-cli/node_modules/jest-jasmine2/build/jasmine/Spec.js:116:22)\r\n      at Suite.<anonymous> (test/hello.spec.js:38:3)\r\n      at Object.<anonymous> (test/hello.spec.js:25:1)\r\n\r\nTest Suites: 1 failed, 1 total\r\nTests:       1 failed, 2 passed, 3 total\r\nSnapshots:   0 total\r\nTime:        6.081 s\r\nRan all test suites.\r\n  console.log\r\n    ERROR\r\n\r\n      at Object.<anonymous> (test/hello.spec.js:76:15)\r\n\r\n  console.log\r\n    {\r\n      code: 'NotAuthorizedException',\r\n      name: 'NotAuthorizedException',\r\n      message: 'Incorrect username or password.'\r\n    }\r\n\r\n      at Object.<anonymous> (test/hello.spec.js:77:15)\r\n\r\n  console.log\r\n    undefined\r\n\r\n      at Object.<anonymous> (test/hello.spec.js:78:15)\r\n\r\n```\r\n\r\nI have confirmed using HostedUI that the user can log in with the new password. I have spent over an hour with Premium Support trying to troubleshoot the problem. Any suggestions as to what I may be missing?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb243NTM2","author":{"login":"leosoaivan"},"title":"How to globally sign out a user on \"forgot password\"","body":"I have a use case where I would like to globally sign-out a user from all devices/clients if a user changes their password through the \"forgot password\" flow. Presumably, this wouldn't be an issue if a user were to \"change password\", as I could assume a user is already authenticated and thus call `Auth.signOut({ global: true })`.\r\n\r\nIt doesn't appear that the [ForgotPassword](https://github.com/aws-amplify/amplify-js/blob/main/packages/aws-amplify-react/src/Auth/ForgotPassword.tsx) component from aws-amplify-react does this. Opening a browser and logging in, and opening another browser and confirming a new password doesn't invalidate the session in the first browser.\r\n\r\nI've tried hooking into the Cognito UserConfirmation trigger and calling `adminUserGlobalSignOut` based on the trigger source. CloudWatch logs indicate that `adminUserGlobalSignOut` is resolving successfully, but there is no difference client-side. `Auth.currentSession()` and `Auth.currentAuthenticatedUser()` both return without errors.\r\n\r\nInterestingly, I see that network calls to https://cognito-idp.us-east-1.amazonaws.com/ are returning with a 400 status and `{\"__type\":\"NotAuthorizedException\",\"message\":\"Access Token has been revoked\"}`, but I am unsure how I would hook into that.\r\n\r\nI am wondering if anyone else has come across this issue, or have a work-around.","upvoteCount":3,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb243NDY3","author":{"login":"abdsahin"},"title":"Headless CLI -- Auth question Do you want to configure Lambda Triggers for Cognito","body":"Hi All,\r\n\r\nLately whenever I do an \"amplify init\", the CLI is asking the following question\r\n\r\n```bash\r\n? Do you want to configure Lambda Triggers for Cognito? (Y/n)\r\n```\r\n\r\nIs there anyway to say No default to this question? I looked at the [headless CLI page](https://docs.amplify.aws/cli/usage/headless) and [examples](https://github.com/aws-amplify/amplify-cli/blob/master/packages/amplify-cli/sample-headless-scripts/headless_init_env.sh) but couldn't find an example for Cognito configuration.\r\n\r\nThanks","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb243Mzc2","author":{"login":"mtakac"},"title":"How to create HEAD request URL from URL returned by `Storage.get`?","body":"I'd like to check if the resource I uploaded to S3 using `Storage.put` was changed before downloading it. I am trying to use the HEAD request before actually downloading the resource to see if there's a new version since it was last downloaded.\r\n\r\nI have the URL of the resource, returned by `Storage.get` call, but I cannot figure out how to modify this URL in a way so that it can be used for HEAD request. If I just try to use the url returned from `Storage.get` for HEAD request, I get 403 as a response.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"sw-yx"},"body":"may need to presign URLs to get past the auth checks: https://github.com/aws-amplify/amplify-js/blob/main/packages/storage/src/providers/AWSS3Provider.ts#L189-L192\r\n\r\nbut at a higher level this (\"I'd like to check if the resource I uploaded to S3 using Storage.put was changed before downloading it.\") could be a feature request. does `Storage.list` not give you the info you need?"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb243NDU1","author":{"login":"kimfucious"},"title":"Do Amplify generated GraphQL statements work in all cases?","body":"I've been trying to figure out why certain GraphQL mutations aren't working in an app I've got involved in.\r\n\r\nToward that I've created a test project based on  these docs [here](https://docs.amplify.aws/cli/graphql-transformer/dataaccess), using Amplify CLI to add the API.\r\n\r\nI've copied the schema (cut and paste), and I've had Amplify CLI build the statements on `amplify push`\r\n```console\r\n? Do you want to update code for your updated GraphQL API Yes\r\n? Do you want to generate GraphQL statements (queries, mutations and subscription) based on your schema types?\r\nThis will overwrite your current graphql queries, mutations and subscriptions Yes\r\n```\r\nUsing the Warehouse / Employee relationship as an example, if I try to create a Employee (with a warehouseID) with the Amplify generated mutation, an error is thrown in the console:\r\n```console\r\nOne or more parameter values were invalid: Type mismatch for Index Key data Expected: S Actual: M IndexName: byWarehouse ...\r\n```\r\nHowever, if I create separate mutation (different from the generated one), as per the documentation mentioned prior, it works as expected. \r\n\r\n**So my question is**:  Are the generated statements supposed to work in all cases, including the [schema setup in the example](https://gist.github.com/dabit3/e0af16db09b6e206292d1c5cfc0d0a07), or do you sometimes need to create your own statements to get things to work?\r\n\r\nIf the answer is the latter, it would make sense why the generated statement is not working in this case; but if the answer is the former, I can't for the life of me figure out what to pass as the input to the generated `createEmployee` mutation.\r\n\r\nThanks in advance for any advice here.\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb243MzA0","author":{"login":"rudijs"},"title":"event.requestContext.identity.cognitoAuthenticationProvider Format","body":"Hi,\r\n\r\nI've noticed the string format of `event.requestContext.identity.cognitoAuthenticationProvider`has had two shapes in my AWS serverless lambda \r\n\r\nI'm not sure why that is, can anyone advise?\r\n\r\nThis is the format I saw and used initially  (sensitive data is obscured):\r\n\r\n `cognito-idp.ap-southeast-1.amazonaws.com/ap-southeast-1_xxxx,cognito-idp.ap-southeast-1.amazonaws.com/ap-southeast-1_aaaa:CognitoSignIn:qqqq-1111-2222-3333-rrrr`\r\n\r\nThis is what I've seen recently, it's switches back and forth\r\n\r\n`cognito-idp.ap-southeast-1.amazonaws.com/ap-southeast-1_xxxx,cognito-idp.ap-southeast-1.amazonaws.com/ap-southeast-1_aaaa:CognitoSignIn:qqqq-1111-2222-3333-rrrr,cognito-identity-aws-account-id:123456789`\r\n\r\nSometimes the string ends with the `cognito-identity-aws-account-id` and sometimes not.\r\n\r\nI'm not sure how or why the client javascript sometimes sends `cognito-identity-aws-account-id` and sometimes does not.\r\n\r\nMy application code extracts the data from the string, I'm expecting it to be consistent or at least understand why the format may differ.\r\n\r\nAny tips much appreciated.\r\n\r\nThanks.\r\n  ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb243MjE3","author":{"login":"kimfucious"},"title":"List files using Auth.list() on objects uploaded via Lambda via AWS.S3","body":"Hi there,\r\n\r\nHere's what I'm trying to do and confusing myself in the process.\r\n\r\nI have and app that uses a lambda to generate a PDF file and upload it in an S3 bucket.\r\n\r\nThe bucket is one that I've created using `amplify storage add`.\r\n\r\nBecause I'm in a lambda, I'm using `AWS.S3`, not Amplify.\r\n\r\nIt's a somewhat involved process, but the upload part of the lambda looks like this:\r\n```js\r\nconst uploadPdfToS3 = (buffer) => {\r\n  return new Promise((resolve, reject) => {\r\n    const uploadParams = {\r\n      ACL: \"private\",\r\n      Body: buffer,\r\n      Bucket: bucket,\r\n      ContentType: \"application/pdf\",\r\n      Key: `private/${req.body.id}/forms/${req.body.formId}_form.pdf`\r\n      // `req.body.id` is the cognitoUser username/sub of the user making this request \r\n    };\r\n    s3.upload(uploadParams, (error, response) => {\r\n      if (error) {\r\n        reject(error);\r\n      }\r\n      resolve(response.key);\r\n    });\r\n  });\r\n};\r\n```\r\nThe gist of the above is that I'm **trying** to save the file to a place where an authenticated Cognito user (auth is already setup and working via amplify auth), and only that user, can access it via Amplify in the app using, `Storage`.\r\n\r\nTo clarify: `req.body.id` is the `username` of the cognitoUser.\r\n\r\nUsers are created this site allowing emails as usernames, thus creating a (guid) as the username that matches `cognitoUser.attributes.sub`.\r\n\r\nIdeally, I'd like to perform a `Storage.list(\"forms/\", {level: \"private\"})` and get a list of all objects in that folder, but I can't seem to do that.\r\n\r\nTo be specific, I don't want the content of the `forms` folder, just the `keys`, so that I can know what forms are actually there or not.\r\n\r\nWhat I **can** do is perform individual gets, using `Storage.get(\"forms/someform.pdf\")`.  This will return an URL, with which I can use to retrieve an individual form.\r\n\r\nThe problem with that approach is that I don't know what forms will be in the `forms` folder at any given time for each user.\r\n\r\nI could write a function to get all possible forms (i.e. multiple get requests) that could be in the forms folder and then work from there (filtering blanks and such), but it seems inelegant.\r\n\r\nSo I post my question here, in hopes that some great mind might have a solution.\r\n\r\nThanks in advance for any constructive advice.\r\n\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"kimfucious"},"body":"I figured a few things out here, which I'll share in case someone comes along looking for this in the future.\r\n\r\n1.   Amplify `Storage.put()` uses the `identityId`, when saving files to S3.  This is **not** the same as `cognitoUser.attributes.sub`. \r\n2. You can get this, on the client-side, with `const {id} = await Auth.currentUserInfo();`.\r\n3.  You can then use this as a request parameter in the lambda function to put files (via AWS.S3) in the same path that Amplify uses on the client side.\r\n4. To get a listing of the users private files, from the client, you can run:\r\n ```js\r\nconst forms = await Storage.list(\"\", { level: \"private\" });\r\n```  \r\nThis will return an array with the keys (plus additional info) of all the user's private files.\r\n\r\nThe confusing bit for me here was the `\"\"`, as I was trying everything but that.  `\"/\"` doesn't work here."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNDQ0","author":{"login":"apoorvmote"},"title":"How to create product id that is serial with datastore? like 0001, 0002","body":"The actual product (or insert any type here) id will be `UUID` but I also want to create additional ID that must be auto generated and must be serial. \r\n\r\nIt's for react web app with datastore. \r\n\r\nDoes it have to be dynamodb streams with lambda function? Or is there any simpler solution?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"sw-yx"},"body":"just catching up on this. did you end up figuring it out?"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb243MDg4","author":{"login":"dan-didjatv"},"title":"Why does aws-amplify-angular include aws-amplify as a dev dependency?","body":"Any reason why this requires me to install the entire amplify stack in my dev environment when aws-amplify-angular doesn't require it production mode. This adds IDE overhead as it tries help me by indexing and caching modules I don't use for search and auto-complete and means I'm adding an unnecessary difference to how the app runs locally when I can easily debug it vs. when built for deployment. Neither issue is earth-shattering but given amplify has been designed to be modular, it seems like could easily be handled in a better way (and it's already listed as a peer dependency with a different version?)\r\n\r\nExample error f I don't install the full stack of amplify libraries I don't use:\r\n```\r\nERROR in The target entry-point \"aws-amplify-angular\" has missing dependencies:\r\n - @aws-amplify/storage\r\n - @aws-amplify/api\r\n - @aws-amplify/pubsub\r\n - @aws-amplify/interactions\r\n - @aws-amplify/xr\r\n```\r\nFrom `amplify-js/packages/aws-amplify-angular/package.json`:\r\n```\r\n  \"devDependencies\": {\r\n    ...\r\n    \"aws-amplify\": \"^3.0.17\",\r\n    ...\r\n  },\r\n  \"dependencies\": {\r\n    \"@aws-amplify/ui\": \"^2.0.2\",\r\n    \"rxjs-compat\": \"^6.2.1\"\r\n  },\r\n  \"peerDependencies\": {\r\n    \"aws-amplify\": \"^2.0.0\"\r\n  }\r\n```","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"sw-yx"},"body":"hey Dan - you might be using the [legacy](https://docs.amplify.aws/ui-legacy/q/framework/angular) version - what happens if you install the latest version instead? https://docs.amplify.aws/ui/q/framework/angular\r\n\r\n```bash\r\nyarn add aws-amplify @aws-amplify/ui-angular\r\n```"}},{"node":{"author":{"login":"dan-didjatv"},"body":"It looks like I don't really need either module? Reading the docs again it seems `aws-amplify-angular` is only if you want to reference Amplify APIs through a pre-built Angular service provider. That would be nice if the services were split up to match the modules (eg. AmplifyAuthService vs just the catch-all AmplifyService) but I added my own provider config and was able to remove this package completely.\r\n\r\nFor reference if others are interested, this what I did for the Auth and Hub classes:\r\n\r\n```ts\r\n// amplify.ts\r\nimport {Auth} from '@aws-amplify/auth';\r\nimport {Hub} from '@aws-amplify/core';\r\n\r\nexport const AMPLIFY_AUTH = new InjectionToken<string>('amplify-auth');\r\nexport const AMPLIFY_HUB = new InjectionToken<string>('amplify-hub');\r\n\r\nexport const AMPLIFY_PROVIDERS = [\r\n  { provide: AMPLIFY_AUTH, useValue: Auth },\r\n  { provide: AMPLIFY_HUB, useValue: Hub }\r\n]\r\n\r\n// some.module.ts\r\nimport { AMPLIFY_PROVIDERS } from './amplify';\r\n\r\n@NgModule({\r\n  declarations: [],\r\n  imports: [\r\n    CommonModule\r\n  ],\r\n  providers: AMPLIFY_PROVIDERS\r\n})\r\nexport class SomeModule { }\r\n\r\n// some.service.ts\r\n@Injectable()\r\nclass SomeService {\r\n  constructor(@Inject(AMPLIFY_AUTH) private amplifyAuth: AuthClass) {}\r\n}\r\n```"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMzI5","author":{"login":"mruzekw"},"title":"Allow GraphQL operation only for use in an AWS Lambda function","body":"Hi there,\r\n\r\nIs there a way to set the `@auth` config so that only an AWS Lambda can execute a certain operation? I know there's `allow: private` but I'm not sure if that fully covers it.\r\n\r\nThanks.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"sw-yx"},"body":"just catching up on this. did you end up figuring it out?"}},{"node":{"author":{"login":"mruzekw"},"body":"Hi @sw-yx, yes! I have an answer.\r\n\r\nThis will make sure only those with the proper IAM role can access this / perform these operations. Although I haven't been able to get this to work, you're suppose to able to attach the authRole (created by amplify) to Cognito groups to allow access through IAM.\r\n\r\nEither way, no Cognito user should be able to do these operations without the IAM role. Effectively giving you a way to scope GraphQL operations to just lambdas (which get their authoriation from other IAM policies).\r\n\r\n```\r\n@auth([\r\n  # Allow authenticated Cognito users to read this model\r\n  { allow: private, operations: [read]}\r\n  # Only allow IAM authenticated resources to create, update, and delete this model\r\n  { allow: private, provider: iam, operations: [create, update, delete] }\r\n])\r\n```\r\n\r\nHope that helps!\r\n"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNTM5","author":{"login":"rahulje9"},"title":"AWS cognito social login throwing NotAuthorizedException:does not have identity providers configured React Native","body":"Hi,\r\n I'm using user pool. I have completed signup with email now trying to implement social login.\r\nI'm using `Auth.federatedSignIn({ provider: 'Google' })` for google and \r\n`Auth.federatedSignIn({ provider: 'Facebook' });`.\r\nHere is my config for OAuth\r\n\r\n```\r\noauth: {\r\n            domain: '__domain__',\r\n            clientID: '__client id __',\r\n            scope: ['email', 'profile', 'openid'],\r\n            redirectSignIn: 'myapp://oauth/',\r\n            redirectSignOut: 'myapp://signout/',\r\n            responseType: 'code'\r\n          }\r\n```\r\n\r\nI have added google, Facebook id and secret in aws.\r\n\r\nBut in the hub listener, I'm getting the following error.\r\n```\r\nsignIn_failure [NotAuthorizedException: Identity pool - * poolid * does not \r\nhave identity providers configured.]\r\n```\r\n\r\nHowever, This worked at least once since in the user registered I have seen the Google and Facebook user details.\r\nI'm pretty much stuck at this point, any help would be appreciated.\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"sw-yx"},"body":"just catching up on this. did you end up figuring it out? you said you are using user pool but the error message says identity pool"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNDQ1","author":{"login":"MontoyaAndres"},"title":"Add @auth to existing model with data","body":"I have this model that was created without using @auth before and with the field `userId` created. Also, this model has data...\r\n\r\n![EVr0UeHXYAEVmIj](https://user-images.githubusercontent.com/15065852/79531719-cc293d00-8038-11ea-8070-e80644842d1d.png)\r\n\r\nSo, I added the @auth to this model in this way and I got this error when I run `amplify mock`:\r\n\r\n![EVr0UeKWoAAbb36](https://user-images.githubusercontent.com/15065852/79531817-04308000-8039-11ea-92d4-4a89e77f3acb.png)\r\n\r\nHow can I resolve it :)? Thanks!","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"sw-yx"},"body":"just catching up on this. interesting! did you end up figuring it out? can you provide a small repro so we can test it?"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNDQw","author":{"login":"mikemeyer30"},"title":"TypeError: _awsAmplify.default.configure is not a function with Jest","body":"I am currently trying to write tests for a component that uses amplify authentication.\r\nI created a mock for Amplify and it works for tests for my other components, but any tests written for components that are wrapped in <AuthContext.Consumer> fail with this error: \r\n\r\n<img width=\"672\" alt=\"Screen Shot 2020-04-16 at 7 12 30 PM\" src=\"https://user-images.githubusercontent.com/35384442/79515285-3977a680-8016-11ea-842f-2099e99e88a4.png\">\r\n; \r\n\r\nHere is what my mock looks like:\r\n<img width=\"389\" alt=\"Screen Shot 2020-04-16 at 7 24 04 PM\" src=\"https://user-images.githubusercontent.com/35384442/79515903-d7b83c00-8017-11ea-900b-d7286efae80d.png\">\r\n\r\n\r\nAmplify.configure is called in the root component of the app (App.js) , it's only when I try to test components wrapped in AuthContext.consumer that I get the error referring to amplify.configure.\r\n\r\nI've been looking for answers, and I've read that it's because I'm using Amplify in Node, but I wasn't sure if that was the case or there was something else I'm doing incorrectly? \r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"sw-yx"},"body":"yeah youre using amplify in Node. can you show how you `require` it? thats going to be the problem."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMjU5","author":{"login":"rooleek"},"title":"Can Amplify refresh refreshToken?","body":"Hi guys,\r\n\r\nI cannot find in reference of Cognito how to renew refreshToken except of singing in again.\r\nCan Amplify refresh refreshToken so user would not be forced to enter his credentials one more time? \r\n\r\nThanks\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"mg98"},"body":"Hello, why would you refresh a refresh token? You refresh your access token with your refresh token and that should already give you a new refresh token. When you idled for too long so your access token expired (like after an hour), it is legitimate that you need to sign in again with your credentials."}},{"node":{"author":{"login":"sw-yx"},"body":"@mauerbac i think that was the answer"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMjc0","author":{"login":"Neuroforge"},"title":"Client Subscriptions with DataStore for objects with children","body":"Hello,\r\n\r\nI am seeking help with a use case.\r\n\r\nWe have a parent object and a child object in the schema.\r\n```\r\n\r\ntype SchemaOne @model @auth(rules: [{ allow: owner }]) {\r\n   id: ID!\r\n   child: SchemaTwo @connection(name: \"SchemaConnection\") //Nullable\r\n}\r\n\r\ntype SchemaTwo @model @auth(rules: [{ allow: owner }]) {\r\n   id: ID!\r\n   parent: SchemaOne @connection(name: \"SchemaConnection\") //Not nullable.\r\n}\r\n```\r\n\r\nWe want to subscribe to the creation/update of SchemaOne.\r\n\r\n```\r\nDataStore.observe<LoadedFileDetailsSchema>(LoadedFileDetailsSchema).subscribe(schema =>{\r\n  // Do some stuff that needs to reference schema.child (Which is of type Schema2)\r\n})\r\n```\r\n\r\nIs there a way to save these at the same time with Datastore?\r\nIf not, how do we ensure SchemaTwo is created before on create SchemaOne subscription fires?\r\n\r\n```\r\nconst s1 = await DataStore.save<SchemaOne>(\r\n    new SchemaOne({\r\n    })\r\n  );\r\n\r\nconst s2 = await DataStore.save<SchemaTwo>(\r\n    new SchemaTwo({\r\nparent:s1\r\n    })\r\n  );\r\n```","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"sw-yx"},"body":"just catching up on this. interesting! did you end up figuring it out? the await solution looks good."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMjY3","author":{"login":"magjack"},"title":"Graphql Subscription with a Service worker ","body":"I was wondering on the possibility of being about to use a graphql subscription where all events are subscribed to by a service worker, which can then generate a notification. (https://aws-amplify.github.io/docs/js/service-workers). Is it possible to link the two ? ","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"sw-yx"},"body":"you can use Hub to send messages to your SWs https://docs.amplify.aws/lib/utilities/hub/q/platform/js"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMTc0","author":{"login":"ravyg"},"title":"Sending (metrics) records to pinpoint in multi-tenant architecture.","body":"We have a react based portal using amplify.js, which host multiple apps owned by various teams. We are looking for a solution to provide them with a way where they can see their own metrics. The idea is to use amplify analytics to send records to different AWS accounts pinpoints based on the app teams.     ","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"sw-yx"},"body":"just catching up on this. interesting! did you end up figuring it out?"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb242Njc3","author":{"login":"abdulelah1"},"title":"Signup method not executed","body":"This is my code here \r\n\r\n\r\n\r\n```\r\nvar AmazonCognitoIdentity = require('amazon-cognito-identity-js');\r\nvar CognitoUserPool = AmazonCognitoIdentity.CognitoUserPool;\r\nglobal.fetch = require('node-fetch');\r\nvar poolData = {\r\n    UserPoolId: 'I already put the user pool id here', // Your user pool id here\r\n    ClientId: 'I already put the client id here', // Your client id here\r\n};\r\n\r\nvar userPool = new AmazonCognitoIdentity.CognitoUserPool(poolData);\r\n\r\nvar attributeList = [];\r\n\r\n\r\nexports.handler = async (event) => { \r\n    const email = event.email;\r\n    const password = event.pass;\r\n    const fullName = event.fName;\r\n    const phone = event.phone;\r\n\r\n    const emailData = {\r\n        Name: 'email',\r\n        Value: email\r\n    };\r\n\r\n    const nameData = {\r\n        Name: 'name',\r\n        Value: fullName\r\n    };\r\n\r\n    const phoneData = {\r\n        Name: 'phone_number',\r\n        Value: phone\r\n    }\r\n    \r\n    const emailAttribute = new AmazonCognitoIdentity.CognitoUserAttribute(emailData);\r\n    const nameAttribuute = new AmazonCognitoIdentity.CognitoUserAttribute(nameData);\r\n    const phoneAttribute = new AmazonCognitoIdentity.CognitoUserAttribute(phoneData);\r\n    \r\n    attributeList.push(emailAttribute);\r\n    attributeList.push(nameAttribuute);\r\n    attributeList.push(phoneAttribute);\r\n    \r\n    console.log(\"We are out\");\r\n    \r\n    userPool.signUp(email, password, attributeList, null, function(err, result) {\r\n\tif (err) {\r\n\t\treturn console.error(err.message || JSON.stringify(err));\r\n\t}\r\n\tvar cognitoUser = result.user;\r\n\tconsole.log('user name is ' + cognitoUser.getUsername());\r\n});\r\n    console.log(\"Not Working\");\r\n}\r\n\r\n```\r\n\r\nAnd the output like this\r\n// INFO      We are out\r\n// INFO      Not Working\r\n\r\n\r\nWhich means that the signup not working and never executed for some reason\r\nThis code will run in aws lambda function, and I already check the request body and it is working. \r\n\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"sw-yx"},"body":"this needs more detail i'm afraid. if the code runs in an aws lambda, it is working as designed. where are you running it that it is failing?"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb242ODgx","author":{"login":"iaarnio"},"title":"Can GraphQL and REST API use the same custom domain?","body":"I have a project that uses AWS Amplify with GraphQL API. For hosting I have added custom domain for the project. All this is working fine.\r\n\r\nNow I have need to receive REST API call (from external system) in my application.\r\n\r\nAdding new REST API works using Amplify but the REST endpoint is only accessible by the default AWS generated domain. Not by my custom domain. Trying to add custom domain via API Gateway setup fails too.\r\n\r\nIs there any way to support both GraphQL and REST APIs in the same custom domain?","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb242NTY3","author":{"login":"lenarmazitov"},"title":"DataStore for large data storage (DynamoDb)","body":"Hello guys, I have a question.\r\nHow DataStore works with remote storage with huge amount of data?\r\nAs I know it uses DeltaSync to sync data and uses Scan operation on base table if there was no sync yet.\r\nAssume we write messenger application and have millions of users, is it reasonable to use DataStore?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zOTEy","author":{"login":"Johnniexson"},"title":"API.graphql(graphqlOperation(mutations.deleteTodo, id)) doesn't remove the todo from dynamoDB table","body":"Hello each time i run API.graphql(graphqlOperation(mutations.deleteTodo, id)), the data is not actually deleted it just set the _deleted field to true with ttl field, and whenever i do API.graphql(graphqlOperation(queries.listTodo)), it returns all todos including deleted ones. is there anyway i can delete the data completly from the DynamoDB table? or am i missing something??? Thanks. 🙏🙏","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"mkaschke"},"body":"mhhh, strange ... it is not the default behavior. I would recommend to remove the DB (amplify remove API) and create a new one(amplify add API). I take 5 minutes to do that. "}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb241NjM2","author":{"login":"ifmael"},"title":"Get all the data from amazon cognito","body":"\r\nI've created a schema \r\n```javascript\r\ntype S3Object {\r\n  bucket: String!\r\n  region: String!\r\n  key: String!\r\n}\r\n\r\ntype Content @model @auth(rules: [{allow: owner}])\r\n@searchable {\r\n  id: ID!\r\n  title: String!\r\n  subtitle: String\r\n  description: String!\r\n  url: String\r\n  image: S3Object!\r\n}\r\n```\r\nAlso, I've created a form to add data to the server. This works for every authenticated user that I've tried. \r\n\r\nNow, I would like to list all the content created for all user in the main page after a user login on the website. how can I do that?  \r\nI'm working with javascript and react and amazon cognito for authentication\r\n\r\n\r\n```javascript\r\n  async componentDidMount(){\r\n    const contents = await API.graphql(graphqlOperation(listContents))\r\n    console.log(contents);\r\n  }\r\n```\r\n\r\nThis snipped get the list of content create for the specific login user not for all.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"mkaschke"},"body":"@ifmael: try this, it works for me but I have to admit that I didn't fully understand it and \r\ncould find any good source that explains the auth topic within the schema. \r\n\r\n````\r\n@auth(rules: [\r\n  {allow: owner, operations: [create, delete]}\r\n])\r\n\r\n@model(subscriptions: {\r\n  onCreate: [\"onCreateReservation\"]\r\n  onDelete: [\"onDeleteReservation\"]\r\n  onUpdate: [\"onUpdateReservation\"]\r\n  level: public })\r\n````"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb242NDk4","author":{"login":"mkaschke"},"title":"Access other user's attributes (Cognito)","body":"Hello everyone,\r\n\r\nI am building an application with a buyer and a seller (simplified).\r\n\r\nCurrently, I am facing the issue that I try to access the other user's attributes from the Cognito user pool.\r\n\r\nSo the idea is: when the buyer would like to buy something (click on the buy button), I am storing a reference (e.g. cognitoID, IDToken, or something else?) to that user. With this reference, I would like to display the first name, last name, ... (user attributes) from the buyer in the seller's inbox.\r\n\r\nThe application stack is React(web) and AWS Amplify with a Dynamodb.\r\n\r\nA very simple solution would be to store all attributes from the buyer when he/she is clicking the buy button but there must be a better solution.\r\n\r\nMany thanks in advance\r\n\r\nPS. It seems pretty easy but I couldn't find a proper solution.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb242Mzg4","author":{"login":"BarbaraPruz"},"title":"Subscription errors for multi-tenant-like setup","body":"Quick version of question: Should I be able to set up subscriptions with\r\n`{allow: owner, ownerField: \"listGroup\", identityClaim:\"custom:groupname\"}`\r\n\r\nIf so, I need some help debugging the authorization error I get when trying to set up a subscription. Thanks!\r\n\r\nBackground: \r\n- Amplify with React using cognito user pools, graphql and dynamodb\r\n- Our users belong to customer groups. For each customer, data is private but all their users have RW access. So each user belongs to a cognito group corresponding to the customer.\r\n- when users are logged in, they need to see data updates being made by others in their group.\r\n\r\nWe tried multiple approaches - we could get the right data privacy access but never the subscriptions.  Current approach:\r\n- set up cognito user pool custom attribute that contains the group name\r\n- in schema.graphql \r\n`{allow: owner, ownerField: \"listGroup\", identityClaim:\"custom:groupname\"}`\r\n- subscription info from resulting schema:\r\n```\r\ntype Subscription {\r\n    onCreatePatient(listGroup: String!): Patient\r\n        @aws_subscribe(mutations: [\"createPatient\"])\r\n    onUpdatePatient(listGroup: String!): Patient\r\n        @aws_subscribe(mutations: [\"updatePatient\"])\r\n    onDeletePatient(listGroup: String!): Patient\r\n        @aws_subscribe(mutations: [\"deletePatient\"])\r\n}\r\n```\r\nIn appsync console, confirmed queries and mutations are working as expected. But no luck setting up subscription. Here is command\r\n`subscription {\r\n  onCreatePatient(listGroup:\"TestToothFairy\")\r\n  { id firstName }\r\n}`\r\nAnd error\r\n```\r\n\"errors\": [\r\n        {\r\n            \"message\": \"Connection failed: {\\\"errors\\\":[{\\\"errorType\\\":\\\"Unauthorized\\\",\\\"message\\\":\\\"Not Authorized to access onCreatePatient on type Subscription\\\"}]}\"\r\n        }\r\n    ]\r\n```\r\nAny clues on how to debug or fix? And definitely open to other approaches to meet our requirements.\r\nThanks","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb242Mzg0","author":{"login":"mithunkalan"},"title":"Login and refresh using tokens","body":"I have a large user base with really basic smart phones. Think Galaxy S1 with browser stock android 2.3.3 ginger bread.\r\nReactJS doesnt render for them. So i'm trying SSR to cut down the JS in the page. Next.js and Gatsby doesnt render either. Razzle is way too complicated and somewhat still in prototype. \r\n\r\nSo Im doing SSR using nodejs and express. \r\nI am able to login using amplify libs on the server  (Auth.signIn()).\r\nOn the client side, the user will go from page to page an before the HTML is sent, I do API queries and S3 gets. But if you reload the page, you're a 'new' user and need to login again.\r\n\r\nMy question:\r\nIf the user returns to the site, I have Auth.currentSession() tokens stored on their phones browser's localstorage. How can I log them back in using those tokens?\r\n\r\nI've looked at Auth class, no way to login via token or refresh the token. \r\nI've looked at the Credentials.set & that will only work if im doing federation.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb242Mzgx","author":{"login":"mogarick"},"title":"Is there a way to get more specific errors when graphql @auth directive fails?","body":"I’m using the following  versions for a React Native app (The amplify related libs omitted for brevity): \r\n* “@aws-amplify/api”: “^3.1.9”\r\n* “aws-amplify”: “^3.0.10”\r\n\r\n##  Brief scenario\r\nGiven I have users `prueba01` and `prueba02`, and one group named `prueba01_account_viewers`, where  `prueba01` is a member of: \r\n* If I create a **recordA1**  as `prueba02` and I include `prueba01_account_viewers ` in the record’s `viewers` list, and then update the same **recordA1** with the same `prueba02` it works as intended, in accordance with the directive rule `{ allow: owner, ownerField: “recordOwner” }`.\r\n* If I sign in with  `prueba01`  I can view the `recordA1` without a problem because `prueba01` is in its `viewers` group. So it works as intended by the directive `{ allow: groups, groupsField: \"viewers\", groupClaim: \"groupsEnrolledIn\",   operations: [read] }`\r\n* If I try to update **recordA1** using `prueba01` I get an error, as expected, because `prueba01` is not the `recordOwner` and the `viewers` group only has a `read` permission on the **recordA1** record. The thing is the error is kind of generic. This error is thrown for many different reasons as I could find by googling it, so it’s not specific for `@auth` directive rules failing.\r\n\r\nI want to correctly manage the `@auth` scenario to correctly notify the user that the cause is `prueba01` doesn’t have enough privileges/authorization to perform the update.\r\n\r\nSo I’d like to know if there’s a way to identify when an `@auth` directive error has ocurred.\r\n\r\n## Test Scenario Info\r\nHere is verbose info for an update scenario.\r\n\r\nI defined the next type in my amplify graphql schema (Complementary types not shown for brevity):\r\n\r\n``` graphql\r\ntype Animal\r\n  @model\r\n  @key(\r\n    name: \"byAccount\"\r\n    fields: [\"ownerAccount\"]\r\n    queryField: \"listAnimalsByOwnerAccount\"\r\n  )\r\n  @auth(\r\n    rules: [\r\n      # Allow read queries using IAM credentials.\r\n      { allow: private, provider: iam, operations: [read] }\r\n      { allow: owner, ownerField: \"recordOwner\" }\r\n      {\r\n        allow: groups\r\n        groupsField: \"admins\"\r\n        groupClaim: \"groupsEnrolledIn\"\r\n        operations: [read, update, delete]\r\n      }\r\n      {\r\n        allow: groups\r\n        groupsField: \"editors\"\r\n        groupClaim: \"groupsEnrolledIn\"\r\n        operations: [read, update]\r\n      }\r\n      {\r\n        allow: groups\r\n        groupsField: \"viewers\"\r\n        groupClaim: \"groupsEnrolledIn\"\r\n        operations: [read]\r\n      }\r\n    ]\r\n  ) {\r\n  id: ID!\r\n  name: String\r\n  # Electronic Identification Number\r\n  eid: String\r\n  registry: AnimalRegistry @connection\r\n  species: AnimalSpeciesEnum\r\n  breed: AnimalBreed @connection\r\n  sexType: SexTypeEnum\r\n  traits: String\r\n  birthdate: String\r\n  relatedPersons: [AnimalRelatedPerson!]\r\n    @connection(keyName: \"byAnimal\", fields: [\"id\"])\r\n  # User that owns the record.\r\n  recordOwner: String\r\n  # Account that owns the record\r\n  ownerAccount: String!\r\n  # groups access\r\n  admins: [String]\r\n  editors: [String]\r\n  viewers: [String]\r\n}\r\n```\r\n\r\nHere is the graphql query that amplify sends, as logged in CloudWatch\r\n\r\n``` graphql\r\nmutation UpdateAnimal($input: UpdateAnimalInput!, $condition: ModelAnimalConditionInput) {\r\n  updateAnimal(input: $input, condition: $condition) {\r\n    id\r\n    name\r\n    eid\r\n    registry {\r\n      id\r\n      registrar {\r\n        id\r\n        name\r\n        type\r\n      }\r\n    }\r\n    species\r\n    breed {\r\n      id\r\n      animalID\r\n      language\r\n      name\r\n      groupNumber\r\n      groupName\r\n      recordOwner\r\n    }\r\n    sexType\r\n    traits\r\n    birthdate\r\n    recordOwner\r\n    ownerAccount\r\n    admins\r\n    editors\r\n    viewers\r\n    relatedPersons {\r\n      items {\r\n        id\r\n        animalID\r\n        personID\r\n        relationRole\r\n        recordOwner\r\n      }\r\n      nextToken\r\n    }\r\n  }\r\n}\r\n, Operation: null, Variables: \r\n{\r\n    \"input\": {\r\n        \"recordOwner\": \"prueba02\",\r\n        \"ownerAccount\": \"Gf76LAgGzyKe\",\r\n        \"editors\": [],\r\n        \"viewers\": [\r\n            \"Gf76LAgGzyKe:VrOLstDpj0yt\"\r\n        ],\r\n        \"id\": \"47fc83c2-0048-494b-b16c-f1a672a44a9e\",\r\n        \"name\": \"Camilo\",\r\n        \"eid\": \"6784949\",\r\n        \"species\": \"dog\",\r\n        \"sexType\": \"male\",\r\n        \"traits\": \"Probando prueba\",\r\n        \"animalBreedId\": \"22c1d4b3-fed1-4312-bbac-d0cee043da68\"\r\n    }\r\n}\r\n```\r\n\r\nHere is the template file for the mutation above (`Mutation.updateAnimal.req.vtl` ):\r\n``` velocity\r\n## [Start] Determine request authentication mode **\r\n#if( $util.isNullOrEmpty($authMode) && !$util.isNull($ctx.identity) && !$util.isNull($ctx.identity.sub) && !$util.isNull($ctx.identity.issuer) && !$util.isNull($ctx.identity.username) && !$util.isNull($ctx.identity.claims) && !$util.isNull($ctx.identity.sourceIp) && !$util.isNull($ctx.identity.defaultAuthStrategy) )\r\n  #set( $authMode = \"userPools\" )\r\n#end\r\n## [End] Determine request authentication mode **\r\n## [Start] Check authMode and execute owner/group checks **\r\n#if( $authMode == \"userPools\" )\r\n  ## No Static Group Authorization Rules **\r\n\r\n\r\n  #if( ! $isStaticGroupAuthorized )\r\n    ## [Start] Dynamic group authorization checks **\r\n    #set( $groupAuthExpressions = [] )\r\n    #set( $groupAuthExpressionValues = {} )\r\n    #set( $groupAuthExpressionNames = {} )\r\n    ## Authorization rule: { allow: groups, groupsField: \"admins\", groupClaim: \"groupsEnrolledIn\"} **\r\n    #set( $userGroups = $util.defaultIfNull($ctx.identity.claims.get(\"groupsEnrolledIn\"), []) )\r\n    #if( $util.isString($userGroups) )\r\n      #if( $util.isList($util.parseJson($userGroups)) )\r\n        #set( $userGroups = $util.parseJson($userGroups) )\r\n      #else\r\n        #set( $userGroups = [$userGroups] )\r\n      #end\r\n    #end\r\n    #foreach( $userGroup in $userGroups )\r\n      $util.qr($groupAuthExpressions.add(\"contains(#groupsAttribute0, :group0$foreach.count)\"))\r\n      $util.qr($groupAuthExpressionValues.put(\":group0$foreach.count\", { \"S\": $userGroup }))\r\n    #end\r\n    #if( $userGroups.size() > 0 )\r\n      $util.qr($groupAuthExpressionNames.put(\"#groupsAttribute0\", \"admins\"))\r\n    #end\r\n    ## Authorization rule: { allow: groups, groupsField: \"editors\", groupClaim: \"groupsEnrolledIn\"} **\r\n    #set( $userGroups = $util.defaultIfNull($ctx.identity.claims.get(\"groupsEnrolledIn\"), []) )\r\n    #if( $util.isString($userGroups) )\r\n      #if( $util.isList($util.parseJson($userGroups)) )\r\n        #set( $userGroups = $util.parseJson($userGroups) )\r\n      #else\r\n        #set( $userGroups = [$userGroups] )\r\n      #end\r\n    #end\r\n    #foreach( $userGroup in $userGroups )\r\n      $util.qr($groupAuthExpressions.add(\"contains(#groupsAttribute1, :group1$foreach.count)\"))\r\n      $util.qr($groupAuthExpressionValues.put(\":group1$foreach.count\", { \"S\": $userGroup }))\r\n    #end\r\n    #if( $userGroups.size() > 0 )\r\n      $util.qr($groupAuthExpressionNames.put(\"#groupsAttribute1\", \"editors\"))\r\n    #end\r\n    ## [End] Dynamic group authorization checks **\r\n\r\n\r\n    ## [Start] Owner Authorization Checks **\r\n    #set( $ownerAuthExpressions = [] )\r\n    #set( $ownerAuthExpressionValues = {} )\r\n    #set( $ownerAuthExpressionNames = {} )\r\n    ## Authorization rule: { allow: owner, ownerField: \"recordOwner\", identityClaim: \"cognito:username\" } **\r\n    $util.qr($ownerAuthExpressions.add(\"#owner0 = :identity0\"))\r\n    $util.qr($ownerAuthExpressionNames.put(\"#owner0\", \"recordOwner\"))\r\n    $util.qr($ownerAuthExpressionValues.put(\":identity0\", $util.dynamodb.toDynamoDB($util.defaultIfNull($ctx.identity.claims.get(\"username\"), $util.defaultIfNull($ctx.identity.claims.get(\"cognito:username\"), \"___xamznone____\")))))\r\n    ## [End] Owner Authorization Checks **\r\n\r\n\r\n    ## [Start] Collect Auth Condition **\r\n    #set( $authCondition = $util.defaultIfNull($authCondition, {\r\n  \"expression\": \"\",\r\n  \"expressionNames\": {},\r\n  \"expressionValues\": {}\r\n}) )\r\n    #set( $totalAuthExpression = \"\" )\r\n    ## Add dynamic group auth conditions if they exist **\r\n    #if( $groupAuthExpressions )\r\n      #foreach( $authExpr in $groupAuthExpressions )\r\n        #set( $totalAuthExpression = \"$totalAuthExpression $authExpr\" )\r\n        #if( $foreach.hasNext )\r\n          #set( $totalAuthExpression = \"$totalAuthExpression OR\" )\r\n        #end\r\n      #end\r\n    #end\r\n    #if( $groupAuthExpressionNames )\r\n      $util.qr($authCondition.expressionNames.putAll($groupAuthExpressionNames))\r\n    #end\r\n    #if( $groupAuthExpressionValues )\r\n      $util.qr($authCondition.expressionValues.putAll($groupAuthExpressionValues))\r\n    #end\r\n    ## Add owner auth conditions if they exist **\r\n    #if( $totalAuthExpression != \"\" && $ownerAuthExpressions && $ownerAuthExpressions.size() > 0 )\r\n      #set( $totalAuthExpression = \"$totalAuthExpression OR\" )\r\n    #end\r\n    #if( $ownerAuthExpressions )\r\n      #foreach( $authExpr in $ownerAuthExpressions )\r\n        #set( $totalAuthExpression = \"$totalAuthExpression $authExpr\" )\r\n        #if( $foreach.hasNext )\r\n          #set( $totalAuthExpression = \"$totalAuthExpression OR\" )\r\n        #end\r\n      #end\r\n    #end\r\n    #if( $ownerAuthExpressionNames )\r\n      $util.qr($authCondition.expressionNames.putAll($ownerAuthExpressionNames))\r\n    #end\r\n    #if( $ownerAuthExpressionValues )\r\n      $util.qr($authCondition.expressionValues.putAll($ownerAuthExpressionValues))\r\n    #end\r\n    ## Set final expression if it has changed. **\r\n    #if( $totalAuthExpression != \"\" )\r\n      #if( $util.isNullOrEmpty($authCondition.expression) )\r\n        #set( $authCondition.expression = \"($totalAuthExpression)\" )\r\n      #else\r\n        #set( $authCondition.expression = \"$authCondition.expression AND ($totalAuthExpression)\" )\r\n      #end\r\n    #end\r\n    ## [End] Collect Auth Condition **\r\n  #end\r\n\r\n\r\n  ## [Start] Throw if unauthorized **\r\n  #if( !($isStaticGroupAuthorized == true || ($totalAuthExpression != \"\")) )\r\n    $util.unauthorized()\r\n  #end\r\n  ## [End] Throw if unauthorized **\r\n#end\r\n## [End] Check authMode and execute owner/group checks **\r\n\r\n\r\n\r\n#if( $authCondition && $authCondition.expression != \"\" )\r\n  #set( $condition = $authCondition )\r\n  #if( $modelObjectKey )\r\n    #foreach( $entry in $modelObjectKey.entrySet() )\r\n      $util.qr($condition.put(\"expression\", \"$condition.expression AND attribute_exists(#keyCondition$velocityCount)\"))\r\n      $util.qr($condition.expressionNames.put(\"#keyCondition$velocityCount\", \"$entry.key\"))\r\n    #end\r\n  #else\r\n    $util.qr($condition.put(\"expression\", \"$condition.expression AND attribute_exists(#id)\"))\r\n    $util.qr($condition.expressionNames.put(\"#id\", \"id\"))\r\n  #end\r\n#else\r\n  #if( $modelObjectKey )\r\n    #set( $condition = {\r\n  \"expression\": \"\",\r\n  \"expressionNames\": {},\r\n  \"expressionValues\": {}\r\n} )\r\n    #foreach( $entry in $modelObjectKey.entrySet() )\r\n      #if( $velocityCount == 1 )\r\n        $util.qr($condition.put(\"expression\", \"attribute_exists(#keyCondition$velocityCount)\"))\r\n      #else\r\n        $util.qr($condition.put(\"expression\", \"$condition.expression AND attribute_exists(#keyCondition$velocityCount)\"))\r\n      #end\r\n      $util.qr($condition.expressionNames.put(\"#keyCondition$velocityCount\", \"$entry.key\"))\r\n    #end\r\n  #else\r\n    #set( $condition = {\r\n  \"expression\": \"attribute_exists(#id)\",\r\n  \"expressionNames\": {\r\n      \"#id\": \"id\"\r\n  },\r\n  \"expressionValues\": {}\r\n} )\r\n  #end\r\n#end\r\n## Automatically set the updatedAt timestamp. **\r\n$util.qr($context.args.input.put(\"updatedAt\", $util.defaultIfNull($ctx.args.input.updatedAt, $util.time.nowISO8601())))\r\n$util.qr($context.args.input.put(\"__typename\", \"Animal\"))\r\n## Update condition if type is @versioned **\r\n#if( $versionedCondition )\r\n  $util.qr($condition.put(\"expression\", \"($condition.expression) AND $versionedCondition.expression\"))\r\n  $util.qr($condition.expressionNames.putAll($versionedCondition.expressionNames))\r\n  $util.qr($condition.expressionValues.putAll($versionedCondition.expressionValues))\r\n#end\r\n#if( $context.args.condition )\r\n  #set( $conditionFilterExpressions = $util.parseJson($util.transform.toDynamoDBConditionExpression($context.args.condition)) )\r\n  $util.qr($condition.put(\"expression\", \"($condition.expression) AND $conditionFilterExpressions.expression\"))\r\n  $util.qr($condition.expressionNames.putAll($conditionFilterExpressions.expressionNames))\r\n  $util.qr($condition.expressionValues.putAll($conditionFilterExpressions.expressionValues))\r\n#end\r\n#if( $condition.expressionValues && $condition.expressionValues.size() == 0 )\r\n  #set( $condition = {\r\n  \"expression\": $condition.expression,\r\n  \"expressionNames\": $condition.expressionNames\r\n} )\r\n#end\r\n#set( $expNames = {} )\r\n#set( $expValues = {} )\r\n#set( $expSet = {} )\r\n#set( $expAdd = {} )\r\n#set( $expRemove = [] )\r\n#if( $modelObjectKey )\r\n  #set( $keyFields = [] )\r\n  #foreach( $entry in $modelObjectKey.entrySet() )\r\n    $util.qr($keyFields.add(\"$entry.key\"))\r\n  #end\r\n#else\r\n  #set( $keyFields = [\"id\"] )\r\n#end\r\n#foreach( $entry in $util.map.copyAndRemoveAllKeys($context.args.input, $keyFields).entrySet() )\r\n  #if( !$util.isNull($dynamodbNameOverrideMap) && $dynamodbNameOverrideMap.containsKey(\"$entry.key\") )\r\n    #set( $entryKeyAttributeName = $dynamodbNameOverrideMap.get(\"$entry.key\") )\r\n  #else\r\n    #set( $entryKeyAttributeName = $entry.key )\r\n  #end\r\n  #if( $util.isNull($entry.value) )\r\n    #set( $discard = $expRemove.add(\"#$entryKeyAttributeName\") )\r\n    $util.qr($expNames.put(\"#$entryKeyAttributeName\", \"$entry.key\"))\r\n  #else\r\n    $util.qr($expSet.put(\"#$entryKeyAttributeName\", \":$entryKeyAttributeName\"))\r\n    $util.qr($expNames.put(\"#$entryKeyAttributeName\", \"$entry.key\"))\r\n    $util.qr($expValues.put(\":$entryKeyAttributeName\", $util.dynamodb.toDynamoDB($entry.value)))\r\n  #end\r\n#end\r\n#set( $expression = \"\" )\r\n#if( !$expSet.isEmpty() )\r\n  #set( $expression = \"SET\" )\r\n  #foreach( $entry in $expSet.entrySet() )\r\n    #set( $expression = \"$expression $entry.key = $entry.value\" )\r\n    #if( $foreach.hasNext() )\r\n      #set( $expression = \"$expression,\" )\r\n    #end\r\n  #end\r\n#end\r\n#if( !$expAdd.isEmpty() )\r\n  #set( $expression = \"$expression ADD\" )\r\n  #foreach( $entry in $expAdd.entrySet() )\r\n    #set( $expression = \"$expression $entry.key $entry.value\" )\r\n    #if( $foreach.hasNext() )\r\n      #set( $expression = \"$expression,\" )\r\n    #end\r\n  #end\r\n#end\r\n#if( !$expRemove.isEmpty() )\r\n  #set( $expression = \"$expression REMOVE\" )\r\n  #foreach( $entry in $expRemove )\r\n    #set( $expression = \"$expression $entry\" )\r\n    #if( $foreach.hasNext() )\r\n      #set( $expression = \"$expression,\" )\r\n    #end\r\n  #end\r\n#end\r\n#set( $update = {} )\r\n$util.qr($update.put(\"expression\", \"$expression\"))\r\n#if( !$expNames.isEmpty() )\r\n  $util.qr($update.put(\"expressionNames\", $expNames))\r\n#end\r\n#if( !$expValues.isEmpty() )\r\n  $util.qr($update.put(\"expressionValues\", $expValues))\r\n#end\r\n{\r\n  \"version\": \"2017-02-28\",\r\n  \"operation\": \"UpdateItem\",\r\n  \"key\": #if( $modelObjectKey ) $util.toJson($modelObjectKey) #else {\r\n  \"id\": {\r\n      \"S\": $util.toJson($context.args.input.id)\r\n  }\r\n} #end,\r\n  \"update\": $util.toJson($update),\r\n  \"condition\": $util.toJson($condition)\r\n}\r\n```\r\n\r\nHere is the requestMapping after the `Mutation.updateAnimal.req.vtl` has been processed, as logged in CloudWatch:\r\n\r\n``` json\r\n{\r\n  \"version\": \"2017-02-28\",\r\n  \"operation\": \"UpdateItem\",\r\n  \"key\": { \"id\": { \"S\": \"47fc83c2-0048-494b-b16c-f1a672a44a9e\" } },\r\n  \"update\": {\r\n    \"expression\": \"SET #eid = :eid, #traits = :traits, #recordOwner = :recordOwner, #__typename = :__typename, #sexType = :sexType, #ownerAccount = :ownerAccount, #animalBreedId = :animalBreedId, #viewers = :viewers, #species = :species, #name = :name, #editors = :editors, #updatedAt = :updatedAt REMOVE #birthdate, #animalRegistryId, #admins\",\r\n    \"expressionNames\": {\r\n      \"#eid\": \"eid\",\r\n      \"#traits\": \"traits\",\r\n      \"#birthdate\": \"birthdate\",\r\n      \"#recordOwner\": \"recordOwner\",\r\n      \"#__typename\": \"__typename\",\r\n      \"#animalRegistryId\": \"animalRegistryId\",\r\n      \"#sexType\": \"sexType\",\r\n      \"#ownerAccount\": \"ownerAccount\",\r\n      \"#animalBreedId\": \"animalBreedId\",\r\n      \"#viewers\": \"viewers\",\r\n      \"#species\": \"species\",\r\n      \"#name\": \"name\",\r\n      \"#admins\": \"admins\",\r\n      \"#editors\": \"editors\",\r\n      \"#updatedAt\": \"updatedAt\"\r\n    },\r\n    \"expressionValues\": {\r\n      \":eid\": { \"S\": \"6784949\" },\r\n      \":traits\": { \"S\": \"Probando prueba\" },\r\n      \":recordOwner\": { \"S\": \"prueba02\" },\r\n      \":__typename\": { \"S\": \"Animal\" },\r\n      \":sexType\": { \"S\": \"male\" },\r\n      \":ownerAccount\": { \"S\": \"Gf76LAgGzyKe\" },\r\n      \":animalBreedId\": { \"S\": \"22c1d4b3-fed1-4312-bbac-d0cee043da68\" },\r\n      \":viewers\": { \"L\": [{ \"S\": \"Gf76LAgGzyKe:VrOLstDpj0yt\" }] },\r\n      \":species\": { \"S\": \"dog\" },\r\n      \":name\": { \"S\": \"Camilo\" },\r\n      \":editors\": { \"L\": [] },\r\n      \":updatedAt\": { \"S\": \"2020-06-11T16:23:35.502Z\" }\r\n    }\r\n  },\r\n  \"condition\": {\r\n    \"expression\": \"( contains(#groupsAttribute0, :group01) OR contains(#groupsAttribute0, :group02) OR contains(#groupsAttribute0, :group03) OR contains(#groupsAttribute0, :group04) OR contains(#groupsAttribute1, :group11) OR contains(#groupsAttribute1, :group12) OR contains(#groupsAttribute1, :group13) OR contains(#groupsAttribute1, :group14) OR #owner0 = :identity0) AND attribute_exists(#id)\",\r\n    \"expressionNames\": {\r\n      \"#groupsAttribute0\": \"admins\",\r\n      \"#groupsAttribute1\": \"editors\",\r\n      \"#owner0\": \"recordOwner\",\r\n      \"#id\": \"id\"\r\n    },\r\n    \"expressionValues\": {\r\n      \":group01\": { \"S\": \"Gf76LAgGzyKe:VrOLstDpj0yt\" },\r\n      \":group02\": { \"S\": \"Gf76LAgGzyKe:3S-Oi1shMBui\" },\r\n      \":group03\": { \"S\": \"eMFUomHuGj8M:9PhlEdv7jmtX\" },\r\n      \":group04\": { \"S\": \"eMFUomHuGj8M:ufHqaTNG0nbo\" },\r\n      \":group11\": { \"S\": \"Gf76LAgGzyKe:VrOLstDpj0yt\" },\r\n      \":group12\": { \"S\": \"Gf76LAgGzyKe:3S-Oi1shMBui\" },\r\n      \":group13\": { \"S\": \"eMFUomHuGj8M:9PhlEdv7jmtX\" },\r\n      \":group14\": { \"S\": \"eMFUomHuGj8M:ufHqaTNG0nbo\" },\r\n      \":identity0\": { \"S\": \"prueba01\" }\r\n    }\r\n  }\r\n}\r\n```\r\n\r\nHere is the ResponseMapping, as logged in CloudWatch:\r\n\r\n``` json\r\n{\r\n    \"logType\": \"ResponseMapping\",\r\n    \"path\": [\r\n        \"updateAnimal\"\r\n    ],\r\n    \"fieldName\": \"updateAnimal\",\r\n    \"resolverArn\": \"arn:aws:appsync:us-west-2:520818527109:apis/hecc7cqrvfdapcjcxsdb766niu/types/Mutation/fields/updateAnimal\",\r\n    \"requestId\": \"1c05150c-a94a-4ae1-9679-14a5d7f2e3e2\",\r\n    \"context\": {\r\n        \"arguments\": {\r\n            \"input\": {\r\n                \"id\": \"47fc83c2-0048-494b-b16c-f1a672a44a9e\",\r\n                \"name\": \"Camilo\",\r\n                \"eid\": \"6784949\",\r\n                \"species\": \"dog\",\r\n                \"sexType\": \"male\",\r\n                \"traits\": \"Probando prueba\",\r\n                \"recordOwner\": \"prueba02\",\r\n                \"ownerAccount\": \"Gf76LAgGzyKe\",\r\n                \"editors\": [],\r\n                \"viewers\": [\r\n                    \"Gf76LAgGzyKe:VrOLstDpj0yt\"\r\n                ],\r\n                \"animalBreedId\": \"22c1d4b3-fed1-4312-bbac-d0cee043da68\",\r\n                \"updatedAt\": \"2020-06-11T16:23:35.502Z\",\r\n                \"__typename\": \"Animal\"\r\n            }\r\n        },\r\n        \"result\": {\r\n            \"eid\": \"6784949\",\r\n            \"traits\": \"Probando\",\r\n            \"recordOwner\": \"prueba02\",\r\n            \"__typename\": \"Animal\",\r\n            \"sexType\": \"male\",\r\n            \"ownerAccount\": \"Gf76LAgGzyKe\",\r\n            \"animalBreedId\": \"22c1d4b3-fed1-4312-bbac-d0cee043da68\",\r\n            \"createdAt\": \"2020-06-08T22:01:30.547Z\",\r\n            \"viewers\": [\r\n                \"Gf76LAgGzyKe:VrOLstDpj0yt\"\r\n            ],\r\n            \"species\": \"dog\",\r\n            \"name\": \"Camilo\",\r\n            \"id\": \"47fc83c2-0048-494b-b16c-f1a672a44a9e\",\r\n            \"editors\": [],\r\n            \"updatedAt\": \"2020-06-11T02:36:42.332Z\"\r\n        },\r\n        \"stash\": {},\r\n        \"error\": {\r\n            \"message\": \"The conditional request failed (Service: AmazonDynamoDBv2; Status Code: 400; Error Code: ConditionalCheckFailedException; Request ID: 7QQHUP5PCMLVDKAV39K4IGQI3VVV4KQNSO5AEMVJF66Q9ASUAAJG)\",\r\n            \"type\": \"DynamoDB:ConditionalCheckFailedException\"\r\n        },\r\n        \"outErrors\": []\r\n    },\r\n    \"fieldInError\": false,\r\n    \"errors\": [],\r\n    \"parentType\": \"Mutation\",\r\n    \"graphQLAPIId\": \"hecc7cqrvfdapcjcxsdb766niu\",\r\n    \"transformedTemplate\": \"{eid=6784949, traits=Probando, recordOwner=prueba02, __typename=Animal, sexType=male, ownerAccount=Gf76LAgGzyKe, animalBreedId=22c1d4b3-fed1-4312-bbac-d0cee043da68, createdAt=2020-06-08T22:01:30.547Z, viewers=[Gf76LAgGzyKe:VrOLstDpj0yt], species=dog, name=Camilo, id=47fc83c2-0048-494b-b16c-f1a672a44a9e, editors=[], updatedAt=2020-06-11T02:36:42.332Z}\"\r\n}\r\n```\r\n\r\nAnd here is the graphql response received on the app:\r\n\r\n```json\r\n{\r\n  \"data\": {\r\n    \"updateAnimal\": null\r\n  },\r\n  \"errors\": [\r\n    {\r\n      \"path\": [\r\n        \"updateAnimal\"\r\n      ],\r\n      \"data\": {\r\n        \"id\": \"47fc83c2-0048-494b-b16c-f1a672a44a9e\",\r\n        \"name\": \"Camilo\",\r\n        \"eid\": \"6784949\",\r\n        \"registry\": null,\r\n        \"species\": \"dog\",\r\n        \"breed\": null,\r\n        \"sexType\": \"male\",\r\n        \"traits\": \"Probando\",\r\n        \"birthdate\": null,\r\n        \"recordOwner\": \"prueba02\",\r\n        \"ownerAccount\": \"Gf76LAgGzyKe\",\r\n        \"admins\": null,\r\n        \"editors\": [],\r\n        \"viewers\": [\r\n          \"Gf76LAgGzyKe:VrOLstDpj0yt\"\r\n        ],\r\n        \"relatedPersons\": null\r\n      },\r\n      \"errorType\": \"DynamoDB:ConditionalCheckFailedException\",\r\n      \"errorInfo\": null,\r\n      \"locations\": [\r\n        {\r\n          \"line\": 2,\r\n          \"column\": 3,\r\n          \"sourceName\": null\r\n        }\r\n      ],\r\n      \"message\": \"The conditional request failed (Service: AmazonDynamoDBv2; Status Code: 400; Error Code: ConditionalCheckFailedException; Request ID: 7QQHUP5PCMLVDKAV39K4IGQI3VVV4KQNSO5AEMVJF66Q9ASUAAJG)\"\r\n    }\r\n  ]\r\n}\r\n\r\n```\r\nAs you can see there is no clear way to isolate the error as a, `@auth` directive related to lack of `update` permissions for the current user.\r\n\r\nIs there some way I can achieve this?\r\n\r\nThank you in advance.\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb242MzYx","author":{"login":"Blkc"},"title":"How to use AmplifyTheme for react native?","body":"According to [doc](https://docs.amplify.aws/ui/auth/authenticator/q/framework/react-native#using-withauthenticator-hoc), to change the colors I would need to use AmplifyTheme\r\n\r\nIn my code I have:\r\n\r\n```\r\nimport { withAuthenticator, AmplifyTheme } from 'aws-amplify-react-native';\r\n\r\n...\r\n\r\nconst theme = {\r\n  ...AmplifyTheme,\r\n  button: {\r\n    ...AmplifyTheme.button,\r\n    backgroundColor: '#1ab'\r\n  },\r\n  navBar: {\r\n    ...AmplifyTheme.navBar,\r\n    backgroundColor: \"#ffc0cb\"\r\n  }\r\n}\r\n\r\nexport default withAuthenticator(ProfileScreen, {\r\n  usernameAttributes: 'email',\r\n  signUpConfig: {\r\n    hiddenDefaults: ['phone_number']\r\n  },\r\n theme\r\n})\r\n```\r\n\r\n^ didn't work. So after some research, with the below approach I was able to change the color of the sign in button (albeit ugly and somehow the button loses all other styles)\r\n\r\n```\r\nconst theme = {\r\n  ...AmplifyTheme,\r\n  button: {\r\n    ...AmplifyTheme.button,\r\n    backgroundColor: '#1ab'\r\n  }\r\n}\r\nexport default withAuthenticator(ProfileScreen, false, [], null, theme)\r\n```\r\n![image](https://user-images.githubusercontent.com/7827466/84399992-7ce23180-abcf-11ea-886b-b31eadc2534d.png)\r\n\r\nBut the signup button's color is still orange?\r\n\r\n![image](https://user-images.githubusercontent.com/7827466/84400051-908d9800-abcf-11ea-8462-dc1678550884.png)\r\n\r\n\r\n\r\n\r\n\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"amhinson"},"body":"@Blkc It looks like the button is disabled, which has a different style object for the button [based on the code](https://github.com/aws-amplify/amplify-js/blob/master/packages/aws-amplify-react-native/src/AmplifyTheme.ts#L114).\r\n\r\nSo you can override this disabled button color as well by:\r\n\r\n```js\r\nconst theme = {\r\n  ...AmplifyTheme,\r\n  button: {\r\n    ...AmplifyTheme.button,\r\n    backgroundColor: '#1ab'\r\n  },\r\n  buttonDisabled: {\r\n    ...AmplifyTheme. buttonDisabled,\r\n    backgroundColor: '#1ab'\r\n  }\r\n}\r\n```\r\n\r\nWith that said, this is something we are looking to improve in the future."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb242MzA0","author":{"login":"kheriox-technologies"},"title":"Datastore / AppSync Authentication without using Amplify Auth","body":"We have an application which uses our custom auth service. It uses Cognito & Azure. We are not using Amplify Auth for some customisation reasons. We do get authenticated and get the tokens from Cognito.\r\n\r\nWe need to use these tokens with Datastore / AppSync. We want to use the token we generated with Datastore / AppSync.\r\n\r\nWe use `aws-exports` file generated by Amplify with `aws_appsync_authenticationType` set to `AMAZON_COGNITO_USER_POOLS`. Below is our exports file\r\n```\r\n{\r\n    \"aws_project_region\": \"ap-southeast-2\",\r\n    \"aws_appsync_graphqlEndpoint\": \"https://xxxxxxxxxx.appsync-api.ap-southeast-2.amazonaws.com/graphql\",\r\n    \"aws_appsync_region\": \"ap-southeast-2\",\r\n    \"aws_appsync_authenticationType\": \"AMAZON_COGNITO_USER_POOLS\"\r\n}\r\n```\r\nConfiguring Amplify using `Amplify.configure(aws-exports);`\r\nWe do `Datastore.save()` to save the items to offline database. \r\nHow do I pass in my jwtToken to Amplify config to be used by `Datastore.save()` ?","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMjIy","author":{"login":"masbaehr"},"title":"Why was aws-sdk v3 included while it's still in BETA? Is Amplify JS v3 considered production-stable?","body":"As it clearly states here: https://github.com/aws/aws-sdk-js-v3 it is in beta\r\nShould we really use v3 in production or is v2 amplify still recommended?\r\n\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"sammartinez"},"body":"Hello, for Amplify use cases using AWS SDK v3, they are supported for production use. We recommend to use v3 of Amplify as it is intended to be used in production."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNTQ0","author":{"login":"mk0y"},"title":"Confirm username on email verification redirect","body":"Hi, I already asked this question on SO: https://stackoverflow.com/questions/61599944/aws-amplify-confirm-signup-with-email-verification\r\n\r\nSo basically my `Auth.signUp` works, and Amplify is configured so that email is used as username. After I get email with confirmation link, I get redirected to URL which is defined in:\r\n1. team-provider-info.json, under \"categories\" -> \"function\" -> \"myproject0292ecd8CustomMessage\" -> REDIRECTURL \r\n2. nested-cloudformation-stack.yml, under \"Resources\" -> functionmyproject0292ecd8CustomMessage -> Properties -> Parameters -> REDIRECTURL\r\n\r\nLink from email redirects me to REDIRECTURL/my-redirect-path?username=653663f9-e36b-432d-9dac-08c8338a4444\r\nI'd like to know what this number is: **`653663f9-e36b-432d-9dac-08c8338a4444`**\r\nLooked everywhere but can't find any documentation on this. Should be important and easy to find as it's crucial for verifying users after signup process. Any ideas?\r\n\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"babyjesusQ"},"body":"I need help on getting my Facebook back in active please"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb240NDk1","author":{"login":"kerzmaximilian"},"title":"Datastore hydration not observable","body":"Dear AWS Amplify team, \r\n\r\nI am currently running into an issue during sign-in of an existing user for a react application. \r\n\r\nScenario:\r\n1. Using Auth a user is created on Cognito.\r\n2. After signup, the user is able to sign in and a profile is created via DataStore GraphQL Api in DynamoTables\r\n3. On sign out, `DataStore.clear()` is used to remove local data\r\n4. On subsequent sign-in and new session, a `DataStore.query(...)` will result in an empty array. Refreshing results in the array holding the anticipated Model. \r\n\r\nI assume this is has something to do with the hydration process. Is there a way to observe this, in order to avoid the need for refresh?\r\n\r\nBest,\r\nMax","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"isv485"},"body":"Hello, Max!\r\n\r\nI have similar issue with RN Application. In my context AWS Cloud keeps some shared information that is expected to be loaded as soon as existing user installs application and logs in with Cognito service. On first load, DataStore returns an empty array of my public data, but if application reloaded, data correctly updated with Cloud info. Logging user our and cleaning up DataStore, reproduces issue again. \r\nDear AWS Amplify/DataStore team, is there a way to observe store rehydration or force DataStore sync? By the way, using API.graphql query provides response from the cloud correctly.\r\n\r\nMax, were you able to find some workaround for this issue with DataStore? \r\n\r\nThanks,\r\nSerge \r\n"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb241Nzk2","author":{"login":"karrettgelley"},"title":"Triggering 'signUp' Event with Social Federation","body":"** Which Category is your question related to? **\r\nAuth\r\n\r\n** What AWS Services are you utilizing? **\r\nCognito User Pools\r\n\r\n** Provide additional details e.g. code snippets **\r\nIs there any way to trigger the 'signUp' event on the auth Hub listener? I am using the social federation sign up (i.e. Auth.federatedSignin()) with User Pools and I need some way to create a user in a dynamodb table upon sign up, but federatedSignin() only triggers the 'signIn' event. If not, is there any way I can add a custom field to a to the CognitoUser created by federatedSignin()? If I can't trigger the signUp event, I'd like to add a field on the cognito user that would allow me to determine if I need to create a dynamodb user.\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"ashika01"},"body":"@karrettgelley Moving issue to discussions to get help from the community. Your question is a little confusing. If you are using `Auth.federatedSignIn`, you are going to get a `signIn` event while listening."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb241NzE4","author":{"login":"ajitgoel"},"title":"Expose added public method in AWS lambda project as api","body":"Hello all, \r\nI have an existing AWS API gateway(payments api, payments path) which points to a .Net lambda function.\r\nIf I edit the .Net lambda function's class to add another public method, how do I expose it with a new path in the existing api, through aws amplify? \r\nSimilarly if I add another class(charges?) and a public method(ListAllCharges) to the .Net lambda function project, how do I expose it with a new path in the existing api, through aws amplify? \r\nI have fiddled with `amplify update api `and `amplify add function` commands but they do not seem to satisfy my needs.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb241NjI1","author":{"login":"Muttaki-Khan"},"title":"AWS amplify i18n internationalization","body":"I am using amplify i18n library for internationalization\r\n import { I18n } from '@aws-amplify/core';\r\n I18n.setLanguage('ch'); \r\nconst dict = { 'bh': { 'Hello there!': \"Apa khabar di sana!\" },\r\n 'ch': { 'Hello there!': \"你好！\" } };\r\nI18n.putVocabularies(dict);\r\nI18n.get('Hello there!');\r\n\r\nmy html heading is\r\n<h3>Hello there!</h3>\r\nso i want this Hello there! in chinese while loading my website i wrote this code\r\nBut how can i tell my html to show chinese???\r\nhow to call this I18n function","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb241NTgx","author":{"login":"mdunbavan"},"title":"How can I create users as an Admin and the user receives an email to sign with temp password and username?","body":"Hi, I am working on a Vue JS app with Amplify.\r\n\r\nI have an application that uses the Cognito SAAS sign up/out/in slightly differently.\r\n\r\nWe have an admin area where certain admin users need to be able to create users and the users get emails with a temp password to sign in and then carry on with editing their profile details such as photo, username, password etc.\r\n\r\nThe current issue is in Amplify/Cognito you need to have a verified email and that is only done once they have got through a certain flow in the process.\r\n\r\nIs there a way we can do that within Amplify, if not what workarounds have people done to get around this?\r\n\r\nThanks,\r\nMark","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb241NDgy","author":{"login":"weisisheng"},"title":"Anyone else experience VPN troubles + trying to hit endpoints?","body":"Not sure where to post this but suggested here.  After updating the amplify-sdk, cli, and amplify-js (I think) a few days ago, I am no longer able to reach some endpoints (us-west-2 and ap-southeast-1) nor the aws docs site.  Having used a VPN for years since in mainland China and AWS universe (serverless for 12 months or so while learning the framework), I have never seen this problem.  Googling doesn't help.  If I switch to google outline or lantern, I can reach them even though I have to fiddle with extra proxy settings at the command line.  Thanks in advance.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb241NDI5","author":{"login":"randalb1991"},"title":"Call an API protected by AWS IAM using Amplify","body":"Hi guys, \r\n\r\nI'am creating an App where my users can sign in using an Idendity Pool connected to a Cognito Pool User. I've applied a rule where the generation token depends on the Cognito group where the user is:\r\n\r\n![image](https://user-images.githubusercontent.com/10707967/83549924-56a0ff80-a506-11ea-9259-6e7a78783642.png)\r\n\r\nAs you can see, I have the admin and moderator groups&roles, where admin is allowed to do everything on my app, including S3 and invoke any API Gateway resource even if it is protected by AWS IAM, and moderator has all forbidden(just for troubleshooting proposal)\r\n\r\nBut once logged on My App using **Auth.signIn**, both roles get CognitoUser(with its idToken, refresh Token...) and using **Auth.currentCredentials()** it gets access_key, secret_key and session_token. I noticed that tokens are generated according the propers roles since my request agains S3 work as expected(allowed for admin and denied for moderators), but I'm having problem Invoking API Gateway using **API.get('xx','yy)** from 'aws-amplify'. I get an 403 unauthorized.\r\n\r\nAs far as I understand Amplify signed your request with the tokens obtained, but I've noticed that is not true, and you have to sign your request using:\r\n\r\n```\r\n            let access_info= {\r\n                access_key: credentials.accessKeyId,\r\n                secret_key: credentials.secretAccessKey,\r\n                session_token: credentials.sessionToken\r\n                }\r\n\r\n            let request = {\r\n                method:'GET',\r\n                url: awsConfing.API.endpoints[0].endpoint+'/xxxx/yyy'\r\n            }\r\n           Signer.signUrl(request, access_info)\r\n```\r\n\r\nDoes someone know how delegate the signing procedure in AWS Amplify? it is possible? Would I have to request new credentials every hours or it is managed by Amplify?  Could I invoke API Gateway Resources using ID token?\r\n\r\n\r\nIm trying to avoid using API Gateway Authorizers, since it can't different among users groups.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"randalb1991"},"body":"Problem solved adding the region in the config file:\r\n\r\n```\r\nconst  awsconfig = {\r\n    // OPTIONAL - if your API requires authentication \r\n    Auth: {\r\n        // REQUIRED - Amazon Cognito Identity Pool ID\r\n        identityPoolId: 'eu-west-1:xxxx',\r\n        // REQUIRED - Amazon Cognito Region\r\n        region: 'eu-west-1', \r\n        // OPTIONAL - Amazon Cognito User Pool ID\r\n        userPoolId: 'eu-west-xxxxx', \r\n        // OPTIONAL - Amazon Cognito Web Client ID (26-char alphanumeric string)\r\n        userPoolWebClientId: 'xxxxx',\r\n    },\r\n    API: {\r\n        endpoints: [\r\n            {\r\n                name: \"txxxx\",\r\n                endpoint: \"https://xxxxx.execute-api.eu-west-1.amazonaws.com\",\r\n                **region**: 'eu-west-1'\r\n            }\r\n        ]\r\n    },\r\n    Storage: {\r\n        AWSS3: {\r\n            bucket: 'xxx-bucket', //REQUIRED -  Amazon S3 bucket\r\n            region: 'eu-west-1', //OPTIONAL -  Amazon service region\r\n        }\r\n    }\r\n}\r\n```\r\n\r\nAccording AWS Amplify documentation region is a not mandatory parameter in aws-export.js when you add an existing API Gateway, but truly it is...  "}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb241MjM2","author":{"login":"mrgoos"},"title":"Using SAML for authentication","body":"Hi,\r\nIt seems like there isn't a clear doc in the new amplify website about how to use SAML (auth0 specifically) as identity provider.\r\nIt's clear about Facebook, Google and Amazon but what about SAML in general?\r\n\r\nI have setup whatever's needed on auth0 website and in Cognito but I'm having a hard time to find how to configure it through the cli or even manually.\r\n\r\nI have an angular 9 app but even a full general JS example could be good, hopefully an updated one.\r\n\r\nThanks.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"pmclachlan"},"body":"To initiate login, you need to call Auth.federatedSignIn, like:\r\n\r\n          const options: FederatedSignInOptionsCustom = {\r\n            customProvider: 'cognitoProvider'\r\n          }\r\n          let v = await Auth.federatedSignIn(options);\r\n\r\n\r\nYou also don't want it opening that pop-up all the time, so when initializing your app you need to start by asking if you're already signed in:\r\n\r\n   const cognitoUser: CognitoUser = await Auth.currentAuthenticatedUser();\r\n\r\n(this will throw an exception if not & return the user if so).\r\n\r\nAlso, on immediate redirect after a successful login, it is sometimes the case that .currentAuthenticatedUser() doesn't work but it's about to, like, really soon.  So you also need a \r\n\r\n    Hub.listen('auth', (data) => {\r\n      switch (data.payload.event) {\r\n        case 'signIn':\r\n          const cognitoUser:CognitoUser = data.payload.data;\r\n          // console.log('Hub: now the user is signed in: ' + data.payload.message);\r\n          setTimeout(()=> {\r\n              this.processCognitoUser(cognitoUser);\r\n            }, 50 //  we need to let the rest of the hub listeners process their events on login or our calls to them might not work\r\n          );\r\n          break;\r\n   }\r\n\r\ntype of thing.\r\n\r\nThat said, I didn't use auth0 directly, I was just using cognito & connecting it to Azure or Google or whatever SAML provider.\r\n"}},{"node":{"author":{"login":"pmclachlan"},"body":"I just use cognito by itself -- I'm less sure about auth0, sorry.  I would guess you'd need to go to the cognito console for your userpool and add a provider there for auth0 -- that provider will then have a name you can plug into the amplify code.  I think (in my poking) there is a bunch of docs about hooking auth0 up to cognito, so I bet you can find something.  Possibly what you're missing is that, as far as I know, one *has* to go through cognito for auth with amplify.  At some level this can be understood because the other AWS resources you're using need to authenticated access somehow, and cognito is how you provide that linkage."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb241NDcx","author":{"login":"grundmanise"},"title":"CacheUtils: getByteLength, is byte calculation correct?","body":"I was studying how the Cache module works, more specifically how it calculates byte size.\r\n\r\nAnd the calculation raised some concerns:\r\n```\r\nexport function getByteLength(str: string): number {\r\n\tlet ret: number = 0;\r\n\tret = str.length;\r\n\r\n\tfor (let i = str.length; i >= 0; i -= 1) {\r\n\t\tconst charCode: number = str.charCodeAt(i);\r\n\t\tif (charCode > 0x7f && charCode <= 0x7ff) {\r\n\t\t\tret += 1;\r\n\t\t} else if (charCode > 0x7ff && charCode <= 0xffff) {\r\n\t\t\tret += 2;\r\n\t\t}\r\n\t\t// trail surrogate\r\n\t\tif (charCode >= 0xdc00 && charCode <= 0xdfff) {\r\n\t\t\ti -= 1;\r\n\t\t}\r\n\t}\r\n\r\n\treturn ret;\r\n}\r\n```\r\nCode copied for the reference [from here](https://github.com/aws-amplify/amplify-js/blob/master/packages/cache/src/Utils/CacheUtils.ts#L35\r\n)\r\n\r\n**Concern 1.**\r\nECMAScript spec [defines String type as](https://www.ecma-international.org/ecma-262/10.0/index.html#sec-ecmascript-language-types-string-type):\r\n> The String type is the set of all ordered sequences of zero or more 16-bit unsigned integer values...\r\n\r\nSo each element occupies 2 bytes. That means the calculation is wrong as the math is: `string.length * 2`;\r\n\r\n**Concern 2.**\r\nIf I am missing something from the spec (please note), and engine could actually allocate less bytes per code point the calculation is still incorrect as:\r\n`if (charCode > 0x7f && charCode <= 0x7ff) { ret +=1 }` is wrong, `> 0x7f` takes 2 bytes:\r\n```\r\nnew Blob([String.fromCharCode(0x80)]).size === 2\r\n```\r\n\r\n\r\nAm I missing something?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb241Mzg5","author":{"login":"lenarmazitov"},"title":"DataStore TTL","body":"Hello guys.\r\nI have a question.\r\nDoes DataStore keeps all synced data in local storage forever?\r\nWhat if add TTL parameter when querying data for every model instance?\r\nAnd clear expired data from local storage along with sync process?","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb241MzI2","author":{"login":"LucasAndrad"},"title":"What's the difference between aws-amplify-react and @aws-amplify/ui-react ?","body":"What's the difference between`aws-amplify-react` and `@aws-amplify/ui-react` ?\r\n\r\nI saw my docs and places saying to use `aws-amplify-react` but here on the docs to get start I saw this package [@aws-amplify/ui-react](https://docs.amplify.aws/start/getting-started/setup/q/integration/react#install-amplify-libraries) to use the module `withAuthentication` (which `aws-amplify-react` also has)\r\n\r\nWhat's the difference between them? When should I use `aws-amplify-react` and when should I use `@aws-amplify/ui-react` ?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"LucasAndrad"},"body":"Someone already replied here;\r\nhttps://stackoverflow.com/questions/62142118/whats-the-difference-between-aws-amplify-react-and-aws-amplify-ui-react/62142309#62142309"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb240NDQy","author":{"login":"rajeshchoudhari147"},"title":"Unable to resolve \"./httpHandlerOptions\" from \"node_modules\\@aws-amplify\\storage\\lib-esm\\providers\\AWSS3Provider.js\"","body":"I'm creating a react native expo application with AWS. I got this error once I added storage to the amplify using amplify add storage.  ","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"DrWorkhard"},"body":"Got the same error"}},{"node":{"author":{"login":"mauerbac"},"body":"hi @rmit-s3705430-rajesh-choudhari - this is better suited as an Issue rather than a Discussion. I created on here -> https://github.com/aws-amplify/amplify-js/issues/5964 . Would you want to add any other details? "}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb241MjY5","author":{"login":"VTSingle"},"title":"Sign in with Apple Sheet shows null as the app name","body":"Hi everyone. \r\nWhen I try to use **Auth.federatedSignIn({provider: 'SignInWithApple'})** I am getting success, but I'm lose app name in modal window. \r\nCould you help me, how I can to get app name ? \r\n\r\n<img width=\"174\" alt=\"Screenshot at Jun 01 12-45-17\" src=\"https://user-images.githubusercontent.com/26880406/83397125-c380a080-a405-11ea-865b-99f99c94b685.png\">\r\n\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb240NTQx","author":{"login":"ranjeev75"},"title":"S3Image component does not display other users images","body":"I'm using these libraries to store and display images for other users:\r\n\r\n` \"aws-amplify\": \"2.2.2\",\r\n        \"aws-amplify-react-native\": \"^4.0.4\",`\r\n\r\n```\r\nimport { S3Image } from 'aws-amplify-react-native';\r\nimport { Storage } from 'aws-amplify';\r\n\r\nStorage.list('images/', { level: 'protected', identityId: 'abcd' }).then(// store response[]);\r\n\r\nimages.map(({ key }) => {\r\n    return (\r\n        <S3Image style={{ height: 100, width: 100}} level='protected' imgKey={key} identityId='abcd' \r\n    />);\r\n})\r\n```\r\n\r\nBut this results in an error as below:\r\n\r\n```\r\n<Error>\r\n<Code>NoSuchKey</Code>\r\n<Message>The specified key does not exist.</Message>\r\n<Key>\r\nprotected/efg/images/7ac121b2-ff9b-42e4-ace8-e3f7f6f0d8cb.jpg\r\n</Key>\r\n<RequestId>8F0BD626697304D7</RequestId>\r\n<HostId>\r\nxxxx\r\n</HostId>\r\n</Error>\r\n```\r\n\r\nWhere it has ignored the user `identityId` and has replaced it with the `identityId` of the current user. So it should be `protected/abcd/images/7ac121b2-ff9b-42e4-ace8-e3f7f6f0d8cb.jpg`\r\n\r\nI've followed the [docs](https://docs.amplify.aws/ui/storage/s3-image/q/framework/react-native), so not sure why this occurs?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"ranjeev75"},"body":"The docs state to get another users objects to use the `identityId`prop but I cannot see any reference to this in the [S3Image code](https://github.com/aws-amplify/amplify-js/blob/master/packages/aws-amplify-react-native/src/Storage/S3Image.tsx) :("}},{"node":{"author":{"login":"ashika01"},"body":"@ranjeev75 - do you actually see an image `protected/abcd/images/7ac121b2-ff9b-42e4-ace8-e3f7f6f0d8cb.jpg` in the s3 bucket?"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb241MjA1","author":{"login":"DavidTawil"},"title":"Default TOTP Customization throwing error \"Cannot read property 'length' of null\"","body":"I'm trying to fully customize the look of the Amplify Authenticator pages to look like my company's theme.\r\nSo far I've managed to customize the SignIn, ConfirmSignIn, ForgotPassword & RequireNewPassword.\r\nI've done it by overriding the defaults, hiding them and using the slot prop.\r\nSo far so good.\r\nNow I also need to use MFA so I'm trying to customize the TOTPSetup (& TOTPSetupComp, don't really know if that's necassery) in the same way that worked for the other components,\r\nbut I can't get the QRcode to be rendered at all.\r\nI keep getting the following error **TypeError: Cannot read property 'length' of null**.\r\n\r\nhere's my `CustomTOTPSetupComp.js ` \r\n\r\n\r\n```\r\nimport React from \"react\";\r\nimport { TOTPSetupComp } from \"aws-amplify-react\";\r\nimport { withStyles } from '@material-ui/core/styles';\r\nimport Card from '@material-ui/core/Card';\r\nimport CardActions from '@material-ui/core/CardActions';\r\nimport Button from '@material-ui/core/Button';\r\nimport { Grid, TextField, Typography } from '@material-ui/core';\r\nimport QRCode from 'qrcode.react';\r\nimport { totpQrcode } from '@aws-amplify/ui';\r\n\r\n\r\nclass CustomTOTPSetupComp extends TOTPSetupComp {\r\n  constructor(props) {\r\n    super(props);\r\n  }\r\n\r\n  componentDidMount = function () {\r\n    console.log('Componentdidmount');\r\n    this.setup();\r\n    });\r\n    \r\n};\r\n  \r\n  render() {\r\n\r\n    var code = this.state.code;\r\n    const { classes } = this.props;\r\n\r\n      return (  \r\n        <Grid container\r\n        spacing={0}\r\n        display=\"flex\"        \r\n        justify=\"center\"\r\n        alignItems=\"center\"\r\n        style={{ minHeight: '100vh' }}>\r\n                <Card className={classes.root} >                           \r\n                    <CardActions >\r\n                    <Grid container spacing={2} justify='center' direction=\"column\">\r\n                      <Grid item >\r\n                          <Typography variant=\"body1\" className={classes.header} fullWidth>\r\n                              Scan QR to get a verification code                              \r\n                          </Typography>\r\n                      </Grid>\r\n                      <Grid item className={totpQrcode}>\r\n                          <QRCode value={this.state.code}/>                         \r\n                      </Grid>\r\n                      <Grid item >\r\n                          <TextField \r\n                          fullWidth \r\n                          id=\"totpCode\" \r\n                          key=\"totpCode\" \r\n                          name=\"totpCode\"  \r\n                          label=\"Code\" \r\n                          variant=\"outlined\" \r\n                          type=\"password\" \r\n                          onChange={this.handleInputChange} \r\n                          required/>\r\n                      </Grid>                     \r\n                      <Grid item >\r\n                        <Button \r\n                          className={classes.confirmBtn} \r\n                          variant=\"contained\" \r\n                          color=\"primary\" \r\n                          type=\"submit\" \r\n                          fullWidth \r\n                          onClick={(event) => super.verifyTotpToken(event)}>\r\n                            Confirm\r\n                        </Button>\r\n                      </Grid>\r\n                    </Grid>\r\n                    </CardActions>              \r\n                  </Card>\r\n              </Grid>\r\n      );\r\n  }\r\n}\r\n\r\nexport default withStyles(useStyles)(CustomTOTPSetupComp);\r\n```\r\n\r\n\r\nand this is my `CustomTOTPSetup.js `\r\n\r\n```\r\nclass CustomTOTPSetup extends TOTPSetup {\r\n  constructor(props) {\r\n    super(props);\r\n    this._validAuthStates = [\"TOTPSetup\"];\r\n  }\r\n  showComponent() {\r\n      return <CustomTOTPSetupComp />\r\n  }\r\n}\r\n\r\nexport default CustomTOTPSetup;\r\n\r\n```\r\n\r\nThanks in advance!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb241MTAy","author":{"login":"pjohar"},"title":"Amplify point to wrong API","body":"We created an app using Amplify with React Native. \r\nFor adding API, we chose to add it from AppSync console - because we wanted to provision GraphQL queries for an existing DynamoDB table. https://docs.aws.amazon.com/appsync/latest/devguide/import-dynamodb.html\r\n\r\nI deleted an old API from the AppSync console, and added a new API with some changes. But the Amplify CLI is still trying to connect to old API, and gets an error when not able to fetch the API, because it does not exist.\r\n\r\n\r\nIn my local amplify-meta.json file, the api points to new API. \r\nBut the #current-cloud-backend/amplify-meta.json file still points to the old API.\r\n\r\n\r\nI tried amplify remove api, and then amplify push. But still the 'amplify status' says shows the api category. ","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"pjohar"},"body":"Here is the error message:\r\n\r\nUncaught (in promise) NotFoundException: GraphQL API ubl7fopas5e6pbihl4rkmr3yx4 not found.\r\n    at Object.o [as extractError] (https://d21i4kmlk61npv.cloudfront.net/8649469f7ec011c3e948562abac13b89ef1db83a/main.js:41:185728)\r\n    at constructor.a (https://d21i4kmlk61npv.cloudfront.net/8649469f7ec011c3e948562abac13b89ef1db83a/main.js:55:144551)\r\n    at constructor.callListeners (https://d21i4kmlk61npv.cloudfront.net/8649469f7ec011c3e948562abac13b89ef1db83a/main.js:55:147691)\r\n    at constructor.emit (https://d21i4kmlk61npv.cloudfront.net/8649469f7ec011c3e948562abac13b89ef1db83a/main.js:55:147402)\r\n    at constructor.emitEvent (https://d21i4kmlk61npv.cloudfront.net/8649469f7ec011c3e948562abac13b89ef1db83a/main.js:81:1391868)\r\n    at constructor.e (https://d21i4kmlk61npv.cloudfront.net/8649469f7ec011c3e948562abac13b89ef1db83a/main.js:81:1387510)\r\n    at n.runTo (https://d21i4kmlk61npv.cloudfront.net/8649469f7ec011c3e948562abac13b89ef1db83a/main.js:81:1440206)\r\n    at https://d21i4kmlk61npv.cloudfront.net/8649469f7ec011c3e948562abac13b89ef1db83a/main.js:81:1440411\r\n    at constructor.<anonymous> (https://d21i4kmlk61npv.cloudfront.net/8649469f7ec011c3e948562abac13b89ef1db83a/main.js:81:1387720)\r\n    at constructor.<anonymous> (https://d21i4kmlk61npv.cloudfront.net/8649469f7ec011c3e948562abac13b89ef1db83a/main.js:81:1391923)"}},{"node":{"author":{"login":"ashika01"},"body":"Hi, could you open an issue with amplify-cli team? https://github.com/aws-amplify/amplify-cli.\r\n\r\nSide Note: you could use `amplify pull` to pull in changes from backend. https://docs.amplify.aws/cli/start#amplify-pull"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb240Njg0","author":{"login":"ARChatco"},"title":"can you provide a valid hoc component example working for react native amplify 4.1.2","body":"tried many of theme and not working prperly the theme modification","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"amhinson"},"body":"This is something we are looking to improve in the future. However, does the [example from the documentation](https://docs.amplify.aws/ui/auth/authenticator/q/framework/react-native#using-withauthenticator-hoc) work for you?"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb240ODAy","author":{"login":"bbernays"},"title":"External Credentials with Amplify","body":"In 3.x.x Amplify removed support for `AWS.credentials` and `AWS.config`. In the [README.md](https://github.com/aws-amplify/amplify-js#amplify3xx-has-breaking-changes-please-see-the-breaking-changes-below) it says that a plan for handling this will be introduced post GA. \r\n\r\nIs there any timeline for this feature?\r\n\r\nWe are being forced to use Amplify 2.x.x in a new project as we have an external key management  tool.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb240NDUx","author":{"login":"jfharden"},"title":"Calling federatedSignIn leads to signin page with 401 and \"Login option is not available. Please try another one\"","body":"I've been setting up a react app to auth using the cognito hosted ui with a custom domain against a simple user pool (no other auth providers, just the user pool).\r\n\r\nWhen I call federatedSignIn the browser gets redirected to:\r\n\r\n`https://<hosted_ui_domain>/oauth2/authorize?....`\r\n\r\nwhich in turn redirects to \r\n\r\n`https://<hosted_ui_domain>/login?...`\r\n\r\nbut the login page is already a 401 error and displays the error message \"Login option is not available. Please try another one\"\r\n\r\n![Screenshot from 2020-05-24 13-05-33](https://user-images.githubusercontent.com/2170030/82753673-49c23480-9dbf-11ea-9045-d9981ad7b893.png)\r\n\r\nI'm not expecting there to be any authentication at this point, it's the sign in window after all.\r\n\r\nLogging in at this prompt works exactly as expected and redirects back to my app where the JWT tokens work for authing against api_gateway cognito protected endpoints.\r\n\r\nI had this all working with a domain which wasn't a custom domain for the hosted ui and was redirecting to 10.100.0.4. It's only since i switched to a custom domain this is happening\r\n\r\nI'm hoping someone can help me understand what misconfiguration I have to make it land on the login page with that error.\r\n\r\n\r\nIn my react app I have (I've trimmed this to just the relevant sections):\r\n\r\n```\r\nimport React from 'react';\r\nimport Amplify, { Auth, Hub } from 'aws-amplify';\r\nimport awsconfig from './awsconfig.json';\r\nimport awsauth from './awsauth.json';\r\n\r\nAmplify.configure(awsconfig);\r\nAuth.configure({ oauth: awsauth });\r\n\r\nclass AuthPanel extends React.Component {\r\n  state = {\r\n    user: null\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <p>\r\n          Not Logged in <button onClick={this.login.bind(this)}>Login</button>\r\n        </p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  login(e) {\r\n    Auth.federatedSignIn();\r\n  }\r\n\r\n  componentDidMount() {\r\n    Hub.listen(\"auth\", ({ payload: { event, data } }) => {\r\n      switch (event) {\r\n        case \"signIn\":\r\n          this.setState({ user: data });\r\n          break;\r\n        case \"signOut\":\r\n          this.setState({ user: null });\r\n          break;\r\n        default:\r\n          this.log(`Event ${event} received from hub auth, unknown event`);\r\n      }\r\n    });\r\n\r\n    Auth.currentAuthenticatedUser()\r\n      .then(user => this.setState({ user }))\r\n      .catch(() => this.log(\"Not signed in\"));\r\n  }\r\n\r\n  log(message) {\r\n    console.log(`AuthPanel: ${message}`);\r\n  }\r\n}\r\n\r\nexport default AuthPanel;\r\n```\r\n\r\nawsconfig.json:\r\n```\r\n{\r\n  \"Auth\": {\r\n    \"region\": \"eu-west-2\",\r\n    \"userPoolId\": \"<pool_id>\",\r\n    \"userPoolWebClientId\": \"<client_id>\",\r\n    \"mandatorySignIn\": false,\r\n    \"cookieStorage\": {\r\n      \"domain\": \"<app_domain>\",\r\n      \"path\": \"/\",\r\n      \"expires\": 365,\r\n      \"secure\": true\r\n    },\r\n    \"authenticationFlowType\": \"USER_PASSWORD_AUTH\"\r\n  }\r\n}\r\n```\r\n\r\nawsauth.json:\r\n```\r\n{\r\n  \"domain\": \"<hosted_ui_domain>\",\r\n  \"scope\": [\r\n    \"profile\",\r\n    \"openid\"\r\n  ],\r\n  \"redirectSignIn\": \"https://<app_domain>/index.html\",\r\n  \"redirectSignOut\": \"https://<app_domain>/index.html\",\r\n  \"responseType\": \"token\"\r\n}\r\n```\r\n\r\nMy cognito user pool is configured as follows:\r\n\r\nAttributes: Username login with \"Also allow sign in with verified email address\"\r\nCase insensitive\r\nNo required standard attributes\r\n\r\nDevices: User opt-in remember devices (I've tried with this off as well)\r\n\r\nApp client:\r\nEnable username password based authentication (ALLOW_USER_PASSWORD_AUTH\r\nEnable refresh token based authentication (ALLOW_REFRESH_TOKEN_AUTH)\r\n(All other auth flows disable, but I've tried with ALLOW_USER_SRP_AUTH on as well)\r\n\r\nApp client settings:\r\nEnabled Identity providers: Cognito user pool\r\nAllowed oauth flows:\r\nAuthorization code grant, implicit grant\r\nAllowed oauth scopes:\r\nopenid, profile\r\n\r\nAny help or suggestions would be greatly appreciated\r\n\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"odannyboy000"},"body":"This looks like a potential issue with Cognito, as I'm seeing this problem on all of my user pools right now. I haven't updated the aws amplify auth packages either.\r\n\r\n@jfharden Have you filed a support ticket with AWS?"}},{"node":{"author":{"login":"bklebe"},"body":"Same problem but using an existing user pool (i.e. not generated with Amplify CLI), and debugging against localhost currently: \r\n\r\n```javascript\r\nAmplify.configure({\r\n  Auth: {\r\n    region: '<region>',\r\n    userPoolId: '<user-pool-id>'\r\n    userPoolWebClientId: '<user-pool-web-client-id>'\r\n    oauth: {\r\n      domain: '<hosted-ui-domain>',\r\n      scope: [<scopes>],\r\n      redirectSignIn: '<localhost>',\r\n      redirectSignOut: '<localhost>',\r\n      responseType: 'token'\r\n    }\r\n  }\r\n});\r\n```\r\nLogs in and redirects back just fine but not sure why it's adding the errorMessage parameter when it redirects from `/oauth2/authorize` to `/login`. The request generated by the library when `Auth.federatedSignIn()` is called is \r\n```\r\nGET https://<domain-prefix>.auth.<region>.amazoncognito.com/oauth2/authorize\r\n?redirect_uri=<localhost>\r\n&response_type=token\r\n&client_id=<client-id>\r\n&identity_provider=COGNITO\r\n&scopes=<scopes>\r\n&state=<state>\r\n```\r\nand response:\r\n```\r\n302 https://<domain-prefix>.auth.<region>.amazoncognito.com/login\r\n?redirect_uri=<localhost>\r\n&response_type=token\r\n&client_id=<client-id>\r\n&identity_provider=COGNITO\r\n&scopes=<scopes>\r\n&state=<state>\r\n&errorMessage=Login+option+is+not+available.+Please+try+another+one\r\n```"}},{"node":{"author":{"login":"odannyboy000"},"body":"I created an AWS support ticket. There was an issue on the Cognito UI side that has been fixed by the team. Their response:\r\n\r\n> There was a mismatch on Cognito's backend. This issue affects anyone who uses Amplify SDK and federatedSignin, because SDK is adding identity_provider=COGNITO automatically.\r\n\r\n> Cognito service team just pushed a code change and this issue has been fixed. I have tested it and can confirm that I'm no longer seeing this error now."}},{"node":{"author":{"login":"jfharden"},"body":"@odannyboy000 Thank you for doing that.\r\n\r\nGood to know it's been fixed"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb240NjMx","author":{"login":"yvescoinpass"},"title":"How can I get a URL that never expire in AWS Amplify Storage.get API function?","body":"I am implementing a blogging platform which user has to upload images for each content. I am wondering if I can during the upload I can get the permanent URL of the image as a response from AWS Amplify Storage.get function?\r\n\r\nI want to know if this is a good idea?\r\n\r\n```\r\nStorage.get('img-sample.png', { expires: 9999999 })\r\n    .then(result => console.log(result))\r\n    .catch(err => console.log(err));\r\n```\r\n\r\nI wanted the URL because I will be saving it on the database. I don't want to call the Storage.get API function every time the post content is rendered because what if there are multiple images inside a post content. That will make the application less reliable I think.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb240NTg3","author":{"login":"berzavlu"},"title":"exist option to cancel all request?","body":"hello, in the new feature to cancel request https://github.com/aws-amplify/amplify-js/pull/5753\r\ni have a question/feature, exist te posibility to cancel all request in the network?\r\ni know now uses axios.cancel but axios have the option to assign same cancel token to all request and then use axios.cancel but here we can use something like API.cancelAll()?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb240NTQ5","author":{"login":"kannieWeesNie"},"title":"using amplif CLI - how to abort, cancel, exit or go back","body":"when using the CLI for example, to add or update AUTH a number of options are displayed in the terminal to which we need to respond, mostly with Y or N or enter, etc.\r\n\r\nif i enter N instead of Y and press enter and then realise my mistake, how can i cancel, redo, return, etc to correct my mistake without having to continue through the list?\r\n\r\nthanks","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb240NTQ3","author":{"login":"kannieWeesNie"},"title":"api.del() - how to use? how to identify item to delete?","body":"using amplify REST api, how to delete item?\r\n\r\ndocumentation states:\r\n`const apiName = 'MyApiName';\r\n    const path = '/path';\r\n    const myInit = { // OPTIONAL\r\n        headers: {} // OPTIONAL\r\n    }\r\n    return await API.del(apiName, path, myInit);`\r\n\r\nbut how do i identify the item that i want to delete?\r\n\r\nfor example, with GET i use \r\n   `   let path = \"/items/object/\" + 123456789;`\r\nto get the identified item (partition key = phone = 123456789) but this does not work with the code above\r\n\r\nthanks\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb240MzM4","author":{"login":"dogsonacid"},"title":"GraphQL error: Communication error while executing a request to Elasticsearch.","body":"any idea what the issue is here?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"dogsonacid"},"body":"it's intermittent , sometimes query works sometimes it fails. AWS issues?"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb240NDc1","author":{"login":"kjetilge"},"title":"ui-vue validation-errors usage","body":"So i tried this in a slot:\r\n```\r\n<amplify-authenticator\r\n:validation-errors=\"map\"\r\n>\r\n</amplify-sign-up>\r\n```\r\nand in methods:\r\n```\r\nmethods: {\r\n     map(message) {\r\n      console.log('mess', message)\r\n     if (/Username.*empty/i.test(message)) {\r\n        return 'My error message'\r\n      }\r\n      return message\r\n    }\r\n}\r\n```\r\n\r\nThis is not working. I expected the message to be changed.\r\nI can't find any documentation for how to get this to work.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"kjetilge"},"body":"The code above is wrong: It's like this:\r\n```\r\n<amplify-authenticator>\r\n<amplify-sign-up\r\n      :validation-errors=\"map\"\r\n>\r\n</amplify-sign-up>\r\n</amplify-authenticator>\r\n```"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb240NDcz","author":{"login":"ataravati"},"title":"Enforce phone number uniqueness","body":"I'm using AWS Amplify with email as username and I use phone number for MFA. But, I also need to make sure that phone number is always unique. Each user should sign up with a unique phone number. How can I enforce that?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb240MzY2","author":{"login":"nubpro"},"title":"Is it a must to setup 'Datastore.observe' for all tables?","body":"Question 1:\r\nAs per title, do I have to setup a subscription to observe every single tables that we're using?\r\nIf we didn't, will the client be in sync?\r\n\r\n-----------------------------------\r\nQuestion 2:\r\nCurrently, I'm facing an issue where I'm querying Table B, but the promise doesn't resolve until Table A has completed its sync. But please do note that I did not subscribe to Table B.\r\n\r\nHere's my use case:\r\nWe load all orders with `DataStore.query`. When a user press on the order, we will load order details which is resided on another table. We do this by querying the Order Details table. But the promises to the Order Details table takes a long time to resolve (1-5mins). During this time, we observed that the Order table is syncing with the backend. As I mention before, we did not setup an subscription to the Order Details table, would that be a problem?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb240MjEw","author":{"login":"mdoesburg"},"title":"External service data sync questions","body":"I am working on a React Native app using DataStore. Whenever the data gets updated in the cloud, an external service needs to be notified of the updated data.\r\n\r\n**Question 1:**\r\nWhat is the best way for the external service to be notified of data changes, or how can the service subscribe to said changes?\r\n\r\nWhat I've thought of so far:\r\n- DyamoDB streams\r\n\r\n**Question 2:**\r\nIn addition to the external service being notified or somehow subscribing to data changes, it also needs to be able to update the data. What is the best way for an external service to update the data?\r\n\r\nWhat I've thought of so far:\r\n- Through a Lambda which runs a mutation\r\n\r\nI guess I am really just wondering what the best way is to achieve the above things.\r\n","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb240MTc5","author":{"login":"ffxsam"},"title":"Full tabular sorting, Spring 2020 edition","body":"I've raised this topic quite a while ago, but a lot has changed with Amplify (and now there's DataStore!), so I wanted to revisit this. I've been using AppSync with Aurora Serverless (Postgres), which admittedly feels a bit like shoe-horning something to work properly. AppSync definitely seems to be built with DynamoDB as a 1st class citizen.\r\n\r\nThis is my use case:\r\n\r\nA user on my site will log in, and be able to see a paginated table view of their data, which might look something like this:\r\n\r\n| Name | Duration | Size | Uploaded | \r\n|------|----------|------|----------|\r\n| Main Theme | 2:38 | 38.7MB | 3/23/2020 8:38pm |\r\n| End Title | 1:13 | 17.2MB | 3/23/2020 8:59pm |\r\n\r\n**Page 1 of 30** &lt; &gt;\r\n\r\nUsers need to be able to sort any column, in either ascending or descending order, as well as paginate through this data. Furthermore, if they search this data by keyword, that result set could also be sorted and paginated.\r\n\r\nIs this possible yet, using Amplify? Literally this is the only reason I chose Postgres—believe me, I would rather be using DynamoDB, but as is the case with any product, user experience dictates the data architecture, not vice-versa.\r\n\r\nI'd appreciate any advice!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zODE2","author":{"login":"fboudra"},"title":"Migration from AmplifyEventBus to *AuthState*","body":"Using **Vue** framework, the migration doc is limited:\r\nhttps://docs.amplify.aws/ui/auth/authenticator/q/framework/vue#migration\r\n\r\nAmplifyEventBus isn't covered and doesn't exist anymore with @aws-amplify/ui-vue package.\r\nI found references to initialAuthState, handleAuthStateChange and Hub but without examples for using them with **Vue**.\r\n\r\nFor example, how to listen to Auth state and react to events change?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"fboudra"},"body":"Found https://github.com/aws-amplify/amplify-js/issues/2540\r\n\r\nI came to the conclusion AmplifyEventBus is deprecated in favor of using Hub.\r\nWith the new @aws-amplify/ui-vue components, the migration section of the documentation is lacking guidance and even Hub documentation is toward React. It will be nice to have an example using Hub and Vuex for Vue framework users."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb240MDA3","author":{"login":"samavedulark"},"title":"Authenticate user using SAML from electron app.","body":"Hi,\r\n\r\ni was able to access our application form web using SAML, with authentication is redirected to IDP and redircturi back to our application. where is in electron app, we were unable to login.\r\n\r\nIDP shall be same.\r\nWhat shall be the redirect uri?\r\nDo i need to change anything in coginto user pool.\r\n\r\nThanks\r\nRav\r\n\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zOTk1","author":{"login":"nihp"},"title":"How to enable mfa for a new user while Auth.signUp with userpool setting as optional","body":"I need to enable MFA for a user while Auth.signUp(). Here some users can able to get code while  registering and some are not able to register because they failed to receive code. \r\n\r\n**I have set MFA setting as optional**.  \r\n\r\nHere i have checked in user pool, for that user the MFA is not enabled. How can I know this in UI or how can I enable MFA for these users while signup using aws-amplify-react-native.\r\n\r\nCan anyone is there to clarify this? If I set this as optional does it send MFA for some users and not for all users?\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zODkx","author":{"login":"nihp"},"title":"How can I enable SMA MFA while signUp in aws-amplify-react-native (Some users not receiving the confirmation code)","body":"How can I enable SMS MFA for the user who is registering for the first time.\r\n\r\nHere some users can receive the code and some users not able to receive the code. \r\n\r\nHow can I trigger this if the MFA is not enabled while Auth.signUp in aws-amplify-react-native.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zODkw","author":{"login":"nihp"},"title":"Clarification: How can I know if the user received code while doing Auth.signUp in aws-amplify-react-native","body":"How can I know if the user received code while doing Auth.signUp in aws-amplify-react-native.\r\n\r\nI need to track the user received code or not while registration as a new user. Does aws-amplify-react-native has any methods to track or show any message for the user in UI?\r\n\r\nNote: I have registered as a new user i received code, but another one user tried to register but that one not received the confirmation code.\r\n\r\nAlso his MFA is not enabled.\r\n\r\nI need to know how the MFA will be enabled and why that user not received code?\r\n\r\nHow can I track this in a method to convey this to users?\r\n\r\nAny inputs on this will be appreciated\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNzcx","author":{"login":"bmilesp"},"title":"I18n constructor not fully instantiating object?","body":"Hello, I'm trying to instantiate the I18n object but it doesn't seem to recognize the I18n functions when I do so:\r\n\r\n```\r\nimport { I18n }  from '@aws-amplify/core';\r\nVue.use(I18n)\r\n\r\nconst i18n = new I18n({\r\n  language: \"en\"\r\n})\r\n```\r\n\r\nthen later in a function called during the mounted lifecycle callback:\r\n```\r\ni18n.get('Sign In')\r\n```\r\nThrows this error:\r\n\r\n```\r\ni18n.js?9225:91 Uncaught (in promise) TypeError: i18n.get is not a function\r\n```\r\n\r\nif i console.log(i18n) I can see the get() function in the constructor object:\r\nhttps://snipboard.io/bWoJvj.jpg\r\n\r\nBut it's not fully \"constructed\" it seems (for lack of a better term).\r\n\r\nNot sure why this is not working. If I use the Vue official vue-i18n package then i can instantiate the object in this way and use all of it's functions just fine, so I'm a bit at a loss as to why this isn't working for the Amplify I18n?\r\n\r\nAny help would be greatly appreciated!\r\n\r\n-bp\r\n\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"ericclemmons"},"body":"`I18n` operates as a singleton, so you don't need to worry about instantiating it:\r\n> https://github.com/aws-amplify/amplify-js/blob/e8b63af76498ff88c0c2be43024487adaef6fe42/packages/core/src/I18n/index.ts\r\n\r\nYou're likely wanting to use `I18n.get('Sign In')`:\r\n> https://docs.amplify.aws/lib/utilities/i18n/q/platform/js"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zODEz","author":{"login":"tombrouwer"},"title":"UnauthorizedException with Cognito user pool","body":"I am trying to do my first GraphQL request to a custom mutation. But I get a 401 UnauthorizedException, i tried a lot, searched a lot, but didn't solve it yet. Is there a way to get more info about the failed request (why is my token not valid?).\r\n\r\n## Set Up:\r\nI have a repository with **backend** info. Like functions, Auth en a GraphQL API.\r\n\r\n- The default auth mode is `AWS_IAM`, additional is `AMAZON_COGNITO_USER_POOLS`.\r\n- I created a custom mutation in the top of my schema.graphql file.\r\n```\r\ntype Mutation {\r\n  setUp(\r\n      businessName: String!\r\n      businessAddress: String!\r\n      creditCardLinkNumber: String!\r\n      ): String\r\n      @function(name: \"setUpAccount-${env}\")\r\n      @auth(rules: [{ allow: groups, groups: [\"no_user\"] }])\r\n}\r\n```\r\nThe resolver and builded schema generated by the CLI looks fine. See below.\r\n\r\nI have a repo with my **frontend** application (this will be multiple soon). Only Amplify hosting is used.\r\n- I use the aws-export.js from my backend repo in to setup Amplify in Vue. \r\n- I changed `\"aws_appsync_authenticationType\": \"AWS_IAM\"` to `\"aws_appsync_authenticationType\": \"AMAZON_COGNITO_USER_POOLS\"`. This results in sending the `Authorization` header in the request. I checked the token, it sends the group \"no_user\" in the groups claim:\r\n```\r\n\"cognito:groups\": [\r\n    \"no_user\"\r\n],\r\n```\r\n**The header:**\r\n```\r\nauthorization: eyJ..................long token without prefix bearer\r\n```\r\n\r\n**It is not Authorized, but I do not know why.**\r\n\r\nAmplify tells me (output in js from API.graphql method):\r\n```\r\n{ \"data\": {}, \"errors\": [ { \"message\": \"Request failed with status code 401\" } ] }\r\n```\r\n\r\nResponse of request tells me:\r\n```\r\n{\r\n  \"errors\" : [ {\r\n    \"errorType\" : \"UnauthorizedException\",\r\n    \"message\" : \"Valid authorization header not provided.\"\r\n  } ]\r\n}\r\n```\r\n\r\n#### Generated resolver\r\n```\r\n## [Start] Static Group Authorization Checks **\r\n#set($setUp_isStaticGroupAuthorized = $util.defaultIfNull(\r\n            $setUp_isStaticGroupAuthorized, false))\r\n## Authorization rule: { allow: groups, groups: [\"no_user\"], groupClaim: \"cognito:groups\" } **\r\n#set( $userGroups = $util.defaultIfNull($ctx.identity.claims.get(\"cognito:groups\"), []) )\r\n#set( $allowedGroups = [\"no_user\"] )\r\n#foreach( $userGroup in $userGroups )\r\n  #if( $allowedGroups.contains($userGroup) )\r\n    #set( $setUp_isStaticGroupAuthorized = true )\r\n    #break\r\n  #end\r\n#end\r\n## [End] Static Group Authorization Checks **\r\n\r\n\r\n## [Start] Throw if unauthorized **\r\n#if( $setUp_isStaticGroupAuthorized == false )\r\n  $util.unauthorized()\r\n#end\r\n## [End] Throw if unauthorized **\r\n\r\n## [Start] Stash resolver specific context.. **\r\n$util.qr($ctx.stash.put(\"typeName\", \"Mutation\"))\r\n$util.qr($ctx.stash.put(\"fieldName\", \"setUp\"))\r\n{}\r\n## [End] Stash resolver specific context.. **\r\n```\r\n\r\n#### Generated schema for this mutation\r\n```\r\ntype Mutation {\r\n  setUp(businessName: String!, businessAddress: String!, creditCardLinkNumber: String!): String @aws_cognito_user_pools\r\n.... more mutaions\r\n```\r\n\r\n\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNTA4","author":{"login":"veproza"},"title":"AuthError - not been configured correctly logged when Auth module is not imported","body":"**Describe the bug**\r\nWhen Auth module is not imported anywhere in project, an AuthError is logged into console, confusing newcomers\r\n_(note that I encountered it on React Experimental brach, but I don't expect it to be a factor)_\r\n\r\n**To Reproduce**\r\nCreate a tiny demo where `Auth` is not used, e.g.\r\n\r\n```javascript\r\nimport React from \"react\";\r\nimport Amplify from \"@aws-amplify/core\";\r\nimport {AmplifyAuthenticator} from \"@aws-amplify/ui-react\";\r\nimport awsconfig from './aws-exports';\r\n\r\nAmplify.configure(awsconfig);\r\n\r\nconst Authenticated = (props) => {\r\n    return (\r\n        <AmplifyAuthenticator usernameAlias=\"email\">\r\n            {props.children}\r\n        </AmplifyAuthenticator>\r\n    );\r\n};\r\nexport default Authenticated; // or render\r\n```\r\n\r\n**Expected behavior**\r\nConsole does not contain any error logs\r\n\r\n**Code Snippet**\r\nSee above for not-working code. All it takes to get rid of the issue is to import `Auth` anywhere in the code while making sure it does not get tree-shaked for never using it, eg:\r\n```javascript\r\nimport React, {FunctionComponent} from \"react\";\r\nimport Amplify from \"@aws-amplify/core\";\r\nimport {Auth} from 'aws-amplify';\r\nimport {AmplifyAuthenticator} from \"@aws-amplify/ui-react\";\r\nimport awsconfig from './aws-exports';\r\n\r\nAmplify.configure(awsconfig);\r\n\r\n\r\nconst Authenticated: FunctionComponent = (props) => {\r\n    Auth.currentAuthenticatedUser(); // noop because of bug in Amplify requiring Auth is imported.\r\n                                     // otherwise a AuthError - Amplify has not been configured correctly will be thrown\r\n    return (\r\n        <AmplifyAuthenticator usernameAlias=\"email\">\r\n            {props.children}\r\n        </AmplifyAuthenticator>\r\n    );\r\n};\r\nexport default Authenticated;\r\n```\r\n**Screenshots**\r\n![image](https://user-images.githubusercontent.com/1926602/80993155-e33e9c00-8e3a-11ea-8f1f-9fc134316f04.png)\r\n\r\n**What is Configured?**\r\nAWS Exports\r\n   ```\r\nconst awsmobile = {\r\n    \"aws_project_region\": \"eu-central-1\",\r\n    \"aws_appsync_graphqlEndpoint\": \"https://xxx.appsync-api.eu-central-1.amazonaws.com/graphql\",\r\n    \"aws_appsync_region\": \"eu-central-1\",\r\n    \"aws_appsync_authenticationType\": \"AMAZON_COGNITO_USER_POOLS\",\r\n    \"aws_cognito_identity_pool_id\": \"eu-central-1:xxx\",\r\n    \"aws_cognito_region\": \"eu-central-1\",\r\n    \"aws_user_pools_id\": \"eu-central-xxx\",\r\n    \"aws_user_pools_web_client_id\": \"xxx\",\r\n    \"oauth\": {}\r\n};\r\n```\r\n  \r\n<details>\r\n  <summary><strong>Environment</strong></summary>\r\n\r\n<!-- Please run the following command inside your project and copy/paste the output into the codeblock: -->\r\n\r\n```\r\n  System:\r\n    OS: Linux 4.4 Ubuntu 18.04.1 LTS (Bionic Beaver)\r\n    CPU: (4) x64 Intel(R) Core(TM) i5-6600K CPU @ 3.50GHz\r\n    Memory: 1.88 GB / 15.96 GB\r\n    Container: Yes\r\n    Shell: 4.4.19 - /bin/bash\r\n  Binaries:\r\n    Node: 11.13.0 - ~/.nvm/versions/node/v11.13.0/bin/node\r\n    npm: 6.7.0 - ~/.nvm/versions/node/v11.13.0/bin/npm\r\n  npmPackages:\r\n    @aws-amplify/api: ^3.1.9 => 3.1.9\r\n    @aws-amplify/datastore: ^2.0.10 => 2.0.10\r\n    @aws-amplify/pubsub: ^3.0.10 => 3.0.10\r\n    @aws-amplify/ui-react: ^0.2.5 => 0.2.5\r\n    @reach/router: ^1.3.3 => 1.3.3\r\n    @testing-library/jest-dom: ^4.2.4 => 4.2.4\r\n    @testing-library/react: ^9.5.0 => 9.5.0\r\n    @testing-library/user-event: ^7.2.1 => 7.2.1\r\n    @types/jest: ^24.9.1 => 24.9.1\r\n    @types/node: ^12.12.37 => 12.12.37\r\n    @types/reach__router: ^1.3.5 => 1.3.5\r\n    @types/react: ^16.9.34 => 16.9.34\r\n    @types/react-dom: ^16.9.7 => 16.9.7\r\n    aws-amplify: ^3.0.10 => 3.0.10\r\n    ini: ^1.3.5 => 1.3.5\r\n    inquirer: ^6.5.1 => 6.5.2\r\n    node-sass: ^4.14.0 => 4.14.0\r\n    react: 0.0.0-experimental-e5d06e34b => 0.0.0-experimental-e5d06e34b\r\n    react-bem-helper: ^1.4.1 => 1.4.1\r\n    react-dom: 0.0.0-experimental-e5d06e34b => 0.0.0-experimental-e5d06e34b\r\n    react-scripts: 3.4.1 => 3.4.1\r\n    source-map-explorer: ^2.4.2 => 2.4.2\r\n    typescript: ^3.7.5 => 3.7.5\r\n```\r\n\r\n</details>","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"jordanranz"},"body":"Hey @veproza, `AmplifyAuthenticator` uses the Amplify Auth category under the hood. To configure the Auth category properly you must either configure Amplify using the module in `aws-amplify`:\r\n```\r\nimport Amplify from \"aws-amplify\";\r\nimport {AmplifyAuthenticator} from \"@aws-amplify/ui-react\";\r\nimport awsconfig from './aws-exports';\r\n\r\nAmplify.configure(awsconfig);\r\n```\r\nor\r\n```\r\nimport Auth from \"@aws-amplify/auth\";\r\nimport {AmplifyAuthenticator} from \"@aws-amplify/ui-react\";\r\nimport awsconfig from './aws-exports';\r\n\r\nAuth.configure(awsconfig);\r\n```\r\n\r\nCan you point me to the documentation you are following that guides you to the broken configuration?"}},{"node":{"author":{"login":"Johnniexson"},"body":"I'm still stuck with this error, tried everything but not working."}},{"node":{"author":{"login":"veproza"},"body":"Hi @jordanranz , I'm aware of the config, my *To reproduce* code does contain the `Amplify.configure` call.\r\n\r\nThe code itself is not from guides, it's from after I got relatively comfortable and started restructuring the app into smaller pieces. The component mentioned is supposed to be a wrapper \"guarding\" the inner application only for logged in users and displaying login screen for all other. But I wrote this component before needing any `Auth` methods, and the app started logging the error because of that. After adding `Auth`, the error disappeared, but I think the app should be working even without `Auth` specifically imported."}},{"node":{"author":{"login":"Johnniexson"},"body":"Configuring Amplify like this, i get the AuthError:\r\n\r\n```\r\nimport Amplify from \"aws-amplify\";\r\nimport awsconfig from \"./aws-exports\";\r\n\r\nAmplify.configure(awsconfig);\r\n```\r\n\r\nBut importing like this, i dont get the error.\r\n\r\n```\r\nimport Amplify from \"@aws-amplify/core\";\r\nimport awsconfig from \"./aws-exports\";\r\n\r\nAmplify.configure(awsconfig);\r\n```\r\n\r\nAny reason for this please and does it make any difference?"}},{"node":{"author":{"login":"veproza"},"body":"Oh I see! I imported Amplify from `@aws-amplify/core`, but I should be using `aws-amplify`! Now it works even without importing `Auth`.\r\n\r\nThis happened due to combination of IDE's automatic import and lack of correct import specification in the DataStore docs (https://docs.amplify.aws/lib/datastore/sync/q/platform/js#connect-your-app). Since I started working with Amplify using only DataStore, I couldn't find where to source `Amplify` from correctly, so I let the IDE figure it out - and it worked, for the most part, up until now.\r\n\r\nSo I'd propose adding a line `import Amplify from \"aws-amplify\";` to the last code example at https://docs.amplify.aws/lib/datastore/sync/q/platform/js#existing-backend, that should help some newcomers with fancy IDEs :-)"}},{"node":{"author":{"login":"Johnniexson"},"body":"> Oh I see! I imported Amplify from `@aws-amplify/core`, but I should be using `aws-amplify`! Now it works even without importing `Auth`.\r\n> \r\n> This happened due to combination of IDE's automatic import and lack of correct import specification in the DataStore docs (https://docs.amplify.aws/lib/datastore/sync/q/platform/js#connect-your-app). Since I started working with Amplify using only DataStore, I couldn't find where to source `Amplify` from correctly, so I let the IDE figure it out - and it worked, for the most part, up until now.\r\n> \r\n> So I'd propose adding a line `import Amplify from \"aws-amplify\";` to the last code example at https://docs.amplify.aws/lib/datastore/sync/q/platform/js#existing-backend, that should help some newcomers with fancy IDEs :-)\r\n\r\n@veproza but i still get the error while importing from from aws-amplify like \r\n`import Amplify from \"aws-amplify\";`"}},{"node":{"author":{"login":"veproza"},"body":"@Johnniexson It's weird that what fixed it for me broke it for you and vice versa. Is there any minimal code example you could share? Can't it be some timing issue, that you're calling `.configure` after some other call in another module already tried to use some `Auth` method? Easiest way to check would be `console.log` something at the `Amplify.configure` line and seeing if the AuthError happens before or after that log..."}},{"node":{"author":{"login":"Johnniexson"},"body":"> @Johnniexson It's weird that what fixed it for me broke it for you and vice versa. Is there any minimal code example you could share? Can't it be some timing issue, that you're calling `.configure` after some other call in another module already tried to use some `Auth` method? Easiest way to check would be `console.log` something at the `Amplify.configure` line and seeing if the AuthError happens before or after that log...\r\n\r\n@veproza  I Just tried the console log thing, the `Amplify.configure()` runs before any other thing in the app. I'm using angular on ionic."}},{"node":{"author":{"login":"veproza"},"body":"@Johnniexson Sorry, that's the only thing that occurred to me. I don't know Angular or Ionic, so I won't be able to help you."}},{"node":{"author":{"login":"Johnniexson"},"body":"@veproza  no probs, thanks for your time. But how any idea on diff btw configuring using Amplify from \"@aws-amplify/core\" and from \"aws-amplify\"??"}},{"node":{"author":{"login":"Amplifiyer"},"body":"@Johnniexson, the only difference is that importing Amplify from `aws-amplify` by default imports the Auth module and `Amplify.configure()` then successfully configure it. However importing from `@aws-amplify/core` does not do any of that.  See ref below\r\n\r\nhttps://github.com/aws-amplify/amplify-js/blob/50bb84995a7b15d969f0b0ce10e6b254ec95c94b/packages/aws-amplify/src/index.ts#L18-L23\r\n\r\nI'm looking for a fix that should make importing from `@aws-amplify/core` work as well as long as Auth is imported somewhere in your app (either through the UI-component packages such as `ui-react` or direct import in any of your other files)"}},{"node":{"author":{"login":"Johnniexson"},"body":"> @Johnniexson, the only difference is that importing Amplify from `aws-amplify` by default imports the Auth module and `Amplify.configure()` then successfully configure it. However importing from `@aws-amplify/core` does not do any of that. See ref below\r\n> \r\n> https://github.com/aws-amplify/amplify-js/blob/50bb84995a7b15d969f0b0ce10e6b254ec95c94b/packages/aws-amplify/src/index.ts#L18-L23\r\n> \r\n> I'm looking for a fix that should make importing from `@aws-amplify/core` work as well as long as Auth is imported somewhere in your app (either through the UI-component packages such as `ui-react` or direct import in any of your other files)\r\n\r\nIt works fine while importing from \"@aws-amplify/core\" without any error, but importing from \"aws-amplify\" throws the AuthError. My only problem is that i'm unsure if importing and configuring using \"@aws-amplify/core\" might break something else as i use other aws services such as api and storage in the app."}},{"node":{"author":{"login":"jordanranz"},"body":"I am going to move this thread to a discussion."}},{"node":{"author":{"login":"jordanranz"},"body":"@Johnniexson can you describe your file structure a bit. In which file are you executing the following configuration?:\r\n```\r\nimport Amplify from \"aws-amplify\";\r\nimport awsconfig from \"./aws-exports\";\r\n\r\nAmplify.configure(awsconfig);\r\n```\r\n\r\nAre you using the `amplify-authenticator` components? If so which npm package are you using?\r\n"}},{"node":{"author":{"login":"Johnniexson"},"body":"This throws AuthError:\r\n\r\n```\r\nimport Amplify from \"aws-amplify\";\r\nimport awsconfig from \"./aws-exports\";\r\n\r\nAmplify.configure(awsconfig);\r\n```\r\n\r\nBut this dosen't:\r\n\r\n```\r\nimport Amplify from \"@aws-amplify/core\";\r\nimport awsconfig from \"./aws-exports\";\r\n\r\nAmplify.configure(awsconfig);\r\n```\r\n\r\nHere is my app.module.ts file:\r\n\r\n```\r\nimport { AmplifyAngularModule, AmplifyService } from 'aws-amplify-angular';\r\n\r\n@NgModule({\r\n  ...\r\n  imports: [\r\n    ...\r\n    AmplifyAngularModule\r\n  ],\r\n  ...\r\n  providers: [\r\n    ...\r\n    AmplifyService\r\n  ]\r\n  ...\r\n});\r\n```\r\n\r\nWith the AmplifyService from the amplify-angular module, i can access Api, Auth, Storage, etc from my components."}},{"node":{"author":{"login":"Johnniexson"},"body":"@sammartinez the change you made was to the docs, how does it fix the issue cus i still get the AuthError even after importing exactly the way twas done in the docs."}},{"node":{"author":{"login":"jonmifsud"},"body":"Seems we're getting the same error on our end. I'm setup with a working project. Tried to get a colleague to setup amplify with the same project; she had to use `import Amplify from \"@aws-amplify/core\";` to get it working.\r\n"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNzAx","author":{"login":"Johnniexson"},"title":"API queries returns limited data items","body":"Hello guys, i have this model: \r\n\r\n```\r\ntype Todo\r\n @model\r\n @key(\r\n    name: \"byUser\"\r\n    fields: [\"userId\"]\r\n    queryField: \"todosByUser\"\r\n  ) {\r\n  id: ID!\r\n  userId: ID!\r\n  content: String!\r\n}\r\n\r\ntype User @model {\r\n  id: ID!\r\n  name: String!\r\n  todos: [Todo] @connection(keyName: \"byUser\", fields: [\"id\"])\r\n}\r\n```\r\n\r\nThe issue i have is that anytime i query any user data, with: \r\n`const userData = await API.graphql(graphqlOperation(queries.getUser, {id: userId}));`\r\n\r\n `userData.todos.items` only return maximum of 10items even though i have more than 10 items in the todo table created by the specified user.\r\n\r\nAny reason for this? Thanks in anticipation.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"undefobj"},"body":"Default limit is 10 items. You can pass in a higher limit and paginate through by using the nextToken argument."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNjU2","author":{"login":"Johnniexson"},"title":"Amplify codegen for Angular does not generate importable mutations, queries and subscriptions","body":"Hello guys, how come on `amplify codegen` for angular projects the generated statements in the generated graphql folder are mutations.graphql, queries.graphql, schema.json, subscriptions.graphql.\r\n\r\nLooking into these files the statements are not exported while using Angular as preferred language as when asked `? Choose the code generation language target: angular(or your preferred language target)` so there is no way to import them in my component in other to use then like this as stated by the docs [here:](https://docs.amplify.aws/lib/graphqlapi/getting-started/q/platform/js#enable-queries-mutations-and-subscriptions)\r\n\r\nimport * as mutations from './graphql/mutations';\r\nimport * as subscriptions from './graphql/subscriptions';\r\n\r\nasync create() {\r\n  const todo = { name: \"My first todo\", description: \"Hello world!\" };\r\n\r\n   /* create a todo */\r\n  await API.graphql(graphqlOperation(mutations.createTodo, {input: todo}));\r\n}\r\n\r\nOR\r\n\r\nconst subscription = API.graphql(graphqlOperation(subscriptions.OnCreateTodo, variables));","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNjQz","author":{"login":"asparamancer"},"title":"Changing defaultCountryCode","body":"How can I change defaultCountryCode in AmplifySignUp?\r\n\r\nI can do: \r\n```\r\n<AmplifySignUp\r\n        slot=\"sign-up\"\r\n        usernameAlias=\"email\"\r\n        formFields={[\r\n          {\r\n            type: \"name\",\r\n            label: \"Your full name\",\r\n            placeholder: \"First Last\",\r\n            required: true,\r\n          }, ... \r\n``` \r\nfor other formFields items but can't see how to do it for defaultCountryCode","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTQ2","author":{"login":"shahid285"},"title":"Unable to get the Global Secondary Index query to work","body":"Hi All, I am new to AWS ans also AWSAPPSync. I am trying to fetch records from DynamoDB using GSI, post seeing multiple post here suggesting GSI as the way to achieve consistency in results.\r\nI did create a GSI index for my table, and then proceed to write the query in request mapping template. post writing the query, i am getting 'MappingTemplate' Error as below\r\n![image](https://user-images.githubusercontent.com/64884440/82039274-60330680-96c2-11ea-91e4-627c80d15891.png)\r\nI am sharing my table here, and also the GSI been created for reference, along with the request and response template from the resolver.\r\n![image](https://user-images.githubusercontent.com/64884440/82039468-a5efcf00-96c2-11ea-864f-5e5316131b3e.png)\r\n![image](https://user-images.githubusercontent.com/64884440/82042163-0f71dc80-96c7-11ea-98e3-c997a9904c10.png)\r\n![image](https://user-images.githubusercontent.com/64884440/82042207-231d4300-96c7-11ea-9bb5-2356d4474766.png)\r\n\r\n![image](https://user-images.githubusercontent.com/64884440/82039817-2e6e6f80-96c3-11ea-90a1-bcd261f5ad45.png)\r\n\r\nI have been trying to run this for over a week now, and i have failed. I request anyone's help here to understand what am i doing wrong, and what needs to be done.\r\nThanks in Advance!\r\nShahid Nawaz\r\n\r\n\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"shahid285"},"body":"After putting an exhausting effort i found the reason and also got the thing working finally.\r\nThe problem was i removed the hash next to brand in expression attribute\r\nAlso found out that primary Key cannot be used in Filter and neither sort key\r\nThe following is the request mapping template and the results\r\n![image](https://user-images.githubusercontent.com/64884440/82051487-929b2e80-96d7-11ea-96ae-16b5dbb90422.png)\r\n![image](https://user-images.githubusercontent.com/64884440/82051533-ae063980-96d7-11ea-9018-e39265a9e125.png)\r\n\r\nThis thread can be closed \r\n\r\nThanks \r\nShahid Nawaz\r\n\r\n\r\n"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTQ5","author":{"login":"sonphnt"},"title":"Amplify Analytics with Pinpoint security issue in single page app","body":"Hi,\r\n\r\nI have configured successfully Amplify Analytics and AWS Pinpoint in my VueJs app for UnauthorizedAccess. The question is what happens if someone steals my \"identityPoolId\" and \"appId\" of Pinpoint values from the browsers. And they use those settings in their app for any purposes to make my analytics completely imprecise.\r\n\r\nI can not find any settings in PinPoint with \"Allow domain\" only for my site to avoid other domains using it.\r\n\r\n\r\n","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzk5","author":{"login":"emmi"},"title":"Ability to hide the toast or customize it","body":"Related to @amplify-js/ui-components amplify-toast\r\n\r\nHi, is there a way to hide the toast message bar that's shown on top of the page when ever error message arrive? I would like to display the error messages closer to the form and also have the messages translated to Finnish instead of English. Also the ability to customise the css would be amazing. \r\n\r\nIs there any ways to do this with the current version or should I look into making my own PR about this? ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zNTMw","author":{"login":"sakhmedbayev"},"title":"How to make DataStore to work with Gatsby.js","body":"Has anyone successfully made DataStore work with Gatsby.js? What does it take? Do you have an example?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMTUz","author":{"login":"TimNZ"},"title":"Number of Cognito calls triggered by Auth.signIn()","body":"EIGHT - 8 - Cognito API calls triggered by Auth.signIn(username,password) on fresh load of app, with Device tracking enabled.\r\n\r\n2 calls are for Device tracking.\r\n\r\nIs 6 calls (when device tracking disabled) normal?\r\n\r\nOnly 4 if Auth.signIn() called when already signed in.\r\n\r\nAfter Auth.signOut(), Auth.signIn() results in 6/8 calls again.\r\n\r\n```\r\n      Auth.configure(\r\n      {\r\n          mandatorySignIn: false,\r\n          region: amplifyConfig.auth.REGION,\r\n          userPoolId: amplifyConfig.auth.USER_POOL_ID,\r\n          identityPoolId: amplifyConfig.auth.IDENTITY_POOL_ID,\r\n          userPoolWebClientId: amplifyConfig.auth.APP_CLIENT_ID\r\n      })\r\n\r\n```\r\n\r\n```\r\n    userSignIn({email,password})\r\n    {\r\n      return Auth.signIn(email,password)\r\n    }\r\n\r\n```\r\n\r\n![image](https://user-images.githubusercontent.com/1051701/81659520-e61a3c00-948d-11ea-8f34-4371b3a6928e.png)\r\n\r\n# 1)\r\n![image](https://user-images.githubusercontent.com/1051701/81658255-b3bc0f00-948c-11ea-9f7e-37328e236841.png)\r\n\r\n# 2)\r\n![image](https://user-images.githubusercontent.com/1051701/81658294-bd457700-948c-11ea-84ae-457694e4f78f.png)\r\n\r\n# 3)\r\n![image](https://user-images.githubusercontent.com/1051701/81658361-cdf5ed00-948c-11ea-8be9-9fe150259b7a.png)\r\n\r\n# 4)\r\n![image](https://user-images.githubusercontent.com/1051701/81658430-df3ef980-948c-11ea-8c66-dcd98b3492f4.png)\r\n\r\n# 5)\r\n![image](https://user-images.githubusercontent.com/1051701/81658459-e6660780-948c-11ea-9e8c-a26b8ef05a8a.png)\r\n\r\n# 6)\r\n![image](https://user-images.githubusercontent.com/1051701/81658552-fc73c800-948c-11ea-9747-ffe9e06ecc2a.png)\r\n\r\n# 7)\r\n![image](https://user-images.githubusercontent.com/1051701/81658581-04cc0300-948d-11ea-82ff-fd91b11a5178.png)\r\n\r\n# 8)\r\n![image](https://user-images.githubusercontent.com/1051701/81658644-11505b80-948d-11ea-8a00-06b03c4a1cd1.png)\r\n\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"elorzafe"},"body":"@TimNZ thanks for pointing this out, I merged a PR that avoid refresh token and I can look the ones you mention too. "}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMTk1","author":{"login":"amerida63"},"title":"Problem SignIn with Apple at the User Pool level","body":"Anything new with the login functionality with apple at the User Pool level, I'm trying to implement it with Swift, (Mobile only). I have configured the entire environment but it does not work.\r\n\r\nI really don't know if I have to update the awsconfiguration.json (but every time I generate it, it doesn't update it for me) I don't know what apple keys should I put it, if anyone can help me it would be great.\r\n\r\nI am trying to use the same approach that I use for google and facebook, but the\r\n\r\ngetIdentityId()\r\n\r\nfunction always fails.\r\n\r\nI will leave here the code of what I am trying to do, see if my info is incorrect and can help me.\r\n\r\n```\r\n` \r\n// identityProvider =\"SignInWithApple\"  I have also tried  \"appleid.apple.com\"\r\n// accesToken = \"appleIDCredential.identityToken\" I use the one that returns the login with apple\r\n\r\nAWSMobileClient.default().federatedSignIn(providerName: identityProvider, token: accesToken) { (userState, error)  in\r\n            \r\n            guard error == nil, let userState = userState else {\r\n                completion(false)\r\n                return\r\n            }\r\n            switch userState {\r\n            case .signedOut, .signedOutFederatedTokensInvalid, .signedOutUserPoolsTokenInvalid, .guest, .unknown:\r\n                completion(false)\r\n                return\r\n            // Now we are signed in we need to check whether this is really a new user or not\r\n            case .signedIn:\r\n                completion(true)\r\n          //This function always returns me correctly, and indicates that the session is started.\r\n            }\r\n        }\r\n\r\n//But when call this function. \r\n let identityTask: AWSTask = AWSMobileClient.default().getIdentityId()\r\n\r\n override public func getIdentityId() -> AWSTask<NSString> {\r\n        guard self.internalCredentialsProvider != nil else {\r\n            return AWSTask(error: AWSMobileClientError.cognitoIdentityPoolNotConfigured(message: \"Cannot get identityId since cognito credentials configuration is not available.\"))\r\n        }\r\n        let identityFetchTaskCompletionSource: AWSTaskCompletionSource<NSString> = AWSTaskCompletionSource()\r\n        self.internalCredentialsProvider?.getIdentityId().continueWith(block: { (task) -> Any? in\r\n            if let error = task.error {\r\n                if error._domain == AWSCognitoCredentialsProviderHelperErrorDomain\r\n                    && error._code == AWSCognitoCredentialsProviderHelperErrorType.identityIsNil.rawValue {\r\n\r\n All the time it enters here, so it does not return a valid result.\r\n\r\n                    identityFetchTaskCompletionSource.set(error: AWSMobileClientError.identityIdUnavailable(message: \"Fetching identity id on another thread failed. Please retry by calling `getIdentityId()` method.\"))\r\n                } else {\r\n                    identityFetchTaskCompletionSource.set(error: error)\r\n                }\r\n            } else if let result = task.result {\r\n                identityFetchTaskCompletionSource.set(result: result)\r\n            }\r\n            return nil\r\n        })\r\n        \r\n        return identityFetchTaskCompletionSource.task\r\n    }\r\n`\r\n```","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"mauerbac"},"body":"Is this your issue? https://github.com/aws-amplify/amplify-js/issues/5723"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzU1","author":{"login":"Danielduel"},"title":"Lambda templates","body":"Have you some thoughts about providing typescript and/or deno lambdas straight from cli?\r\nLike adding additional step to `amplify function add` (and updating it)\r\nWould it be welcomed feature?\r\n\r\n... edgecase: when user is updating lambda and language was changed - just move lambas `src/` into `old_{previous_language}_src_{timestamp}/` and create new src folder from template.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"Danielduel"},"body":"I am moving this discussion into amplify-cli repo."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzAz","author":{"login":"nubpro"},"title":"[DataStore] Why is query the way it is?","body":"I'm kinda of flustered using Datastore at this point, there's certain stuff that I don't understand especially the syntax **query**.\r\n\r\nHere is the use case:\r\n1. Login with amplify.\r\n2. Query a model after logged in.\r\n3. Returns data.\r\n4. Logout.\r\n5. Clear datastore after logged out.\r\n6. Returns to login page.\r\n7. Proceed to login again.\r\n8. Query the same model.\r\n9. Returns [] (an empty array).\r\n\r\nI'm expecting it to return data, just like in step 3.\r\nBut instead, it doesn't and I had to subscribe to the same model in order to get the expected data.\r\n\r\nThe question is, why does query behaves like this? Am I missing something here?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"manueliglesias"},"body":"Hi @nubpro \r\n\r\nI think the issue here is that you might be querying the DataStore before it syncs with the backend and that's why you receive an empty array back.\r\n\r\nYou can try observing your model, e.g.\r\n\r\n```typescript\r\nconst items = [];\r\n\r\nconst subscription = DataStore.observe(Note, c => c.content(\"contains\", \"a\")).subscribe(({element, opType}) => {\r\n  if(opType === OpType.INSERT) {\r\n    items.push(element);\r\n  \r\n    if(items.length === 10) {\r\n      console.log(items);\r\n\r\n      subscription.unsubscribe();\r\n    }\r\n  }\r\n});\r\n```\r\n\r\nBTW, this is an issue we are aware of and we are working on it, you'll be able to listen for DataStore events to, e.g. defer querying until the sync is done. You can follow progress on that here: https://github.com/aws-amplify/amplify-js/issues/5077"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzM3","author":{"login":"yonnyviz"},"title":"Angular Amplify Authentication - Can't get session to persist","body":"👋  Hi Guys\r\n\r\nI'm trying to implement the amplify auth on an angular project, I'm following [the Sign up, Sign in & Sign out documentation from Amplify](https://docs.amplify.aws/lib/auth/emailpassword/q/platform/js) but I can't get the authenticated user session to persists. When I perform the Auth.currentAuthenticatedUser() function I get that user is not authenticated 😭. \r\n\r\nWould like to know your thoughts on what is the best approach to implement amplify auth on angular. Do I need to store sessions tokens on local storage or that is not necessary?.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMzIz","author":{"login":"OElesin"},"title":"How to invoke SageMaker endpoint from AmplifyJS","body":"How do I invoke a SageMaker endpoint using AmplifyJS? Is there any documentation about this?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMjgy","author":{"login":"myfairshare"},"title":"Two user type Sign up","body":"Lets say I'm developing an app like Uber where I have 2 types of user, I want **drivers** to register and I want **customers** to register.  \r\n\r\nSo I understand I will need 2 user groups in my user pool, one for drivers and one for customers.\r\n\r\nWould both user types register with cognito and then after registering and sign in they are presented with another screen where they select their use case and then a lambda function is used to put the user in the correct group based on their selection.  \r\n\r\nI'm a little bit unsure of this step so any thoughts welcome, thank you!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMTY3","author":{"login":"zerox92"},"title":"TypeError: Cannot read property 'type' of undefined","body":"Hello,\r\n\r\nI have updated the schema.graphql file and I am trying to complie it but I am getting the following error:\r\n\r\nTypeError: Cannot read property 'type' of undefined\r\n\r\nI am trying to implement many-to-many using two 1-M @connections, an @key, and a joining @model as explained [here](https://docs.amplify.aws/cli/graphql-transformer/directives#many-to-many-connections):\r\n\r\nBelow is my schema:\r\n\r\n```\r\ntype User @model {\r\n  email: String!\r\n  firstName: String!\r\n  lastName: String!\r\n  isJobSeeker: Boolean\r\n  age: Int\r\n  mobile: String\r\n  address: String\r\n  userJobList: [UserJobs] @connection(keyName: \"byUserJobs\", fields: [\"email\"] )\r\n}\r\n\r\ntype UserJobs \r\n  @model(queries: null)\r\n  @key(name: \"byUserJobs\", fields:[\"emailID\", \"jobsID\"])\r\n  @key(name: \"byJob\", fields:[\"jobsID\", \"emailID\"]) {\r\n\tid:ID!\r\n\temailID: String!\r\n\tjobsID: String!\r\n\tuser: User! @connection(fields: [\"emailID\"])\r\n\tjob: Job! @connection(fields: [\"jobsID\"])\r\n}\r\n\r\ntype Job @model {\r\n\tjobID: String!\r\n\tisVolunteerJob: Boolean!\r\n\torgName: String\r\n\tjobType: String\r\n\tstartDate: String\r\n\tendDate: String\r\n\tnoOfHours: Int\r\n\tstartTime: String\r\n\tendTime: String\r\n\tdescription: String\r\n\tamount: Int\r\n\taddress: String\r\n\tuserList: [UserJobs] @connection(keyName: \"byJob\", fields: [\"jobID\"])\r\n}\r\n```\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yODg3","author":{"login":"michaelmerrill"},"title":"Amplify SSR Progress","body":"I wanted to check in about the SSR work happening on this library. I know @ericclemmons has been making a lot of progress lately and I just wanted to say thank you for all your hard work!\r\n\r\nI'm curious how getting the current session will work with SSR. Since the server doesn't have access to the cookie storage it will need to get the cookie from the request header. Do you plan on having the `getCurrentUser()` method take a request argument? Something like this maybe?\r\n\r\n```(javascript)\r\nconst userPool = new AmazonCognitoIdentity.CognitoUserPool(poolData);\r\nconst cognitoUser = userPool.getCurrentUser({ req });\r\n```\r\n\r\nI think it's helpful to see how the end user might be using this so here is an example using NextJS. \r\n\r\n```(javascript)\r\n// auth.js\r\nexport const getCurrentSession = async ({ req }) => {\r\n  const cognitoUser = userPool.getCurrentUser({ req });\r\n\r\n  if (cognitoUser != null) {\r\n    return new Promise((resolve, reject) => {\r\n      cognitoUser.getSession((err, session) => {\r\n        if (err) return reject(err);\r\n        if (!session.isValid()) {\r\n          resolve(null);\r\n        }\r\n        resolve(session);\r\n      });\r\n    });\r\n  }\r\n  return null;\r\n};\r\n```\r\n```(javascript)\r\n// SomePage.js\r\nexport async function getServerSideProps({ req, res }) {\r\n  const session = await getCurrentSession({ req });\r\n\r\n  if (!session) {\r\n    res.writeHead(302, {\r\n      Location: \"/signin\",\r\n    });\r\n    \r\n    res.end();\r\n  }\r\n\r\n  return {\r\n    props: {},\r\n  };\r\n}\r\n```","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"ericclemmons"},"body":"We haven't settled on the API usage yet, but we'll be documenting it in https://github.com/aws-amplify/amplify-js/issues/5435 once we're done identifying how our APIs will need to accommodate the `req` (or even the `res`) objects.\r\n"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMTAy","author":{"login":"tcodes0"},"title":"JWT with AppSync & Cognito","body":"I'm stuck in an authentication problem to hit my graphql API using AppSync. API is set to default authorization of cognito userpools. Basically I want to support third party login (facebook/apple) which return me a JWT. Sending this JWT as `Authorization` header doesn't work and results in a 401, every single time I tried. Tried digging docs and setting API to OpenId Connect default authentication, nothing works.\r\n\r\nI'm currently exploring how to get a cognito JWT from a third party JWT.\r\n\r\n```ts\r\nconst cognitoUser = new Cognito.CognitoUser(userData)\r\nconst session = await new Promise<Cognito.CognitoUserSession>((resolve, reject) => {\r\n  cognitoUser?.authenticateUser(authenticationDetails, {\r\n    onSuccess: function (result) {\r\n      AWS.config.region = config.region\r\n      AWS.config.credentials = new AWS.CognitoIdentityCredentials({\r\n        IdentityPoolId: `${config.region}:${config.identityPoolId}`,\r\n        Logins: {\r\n          [config.identityPoolLoginKey]: result.getIdToken().getJwtToken(),\r\n        },\r\n      })\r\n// This works\r\nconst jwt = session.getAccessToken().getJwtToken()\r\n\r\n//But this does not\r\nconst facebookJwt = /* login with facebook, get JWT */\r\n AWS.config.credentials = new AWS.CognitoIdentityCredentials({\r\n  IdentityPoolId: 'IDENTITY_POOL_ID',\r\n  Logins: {\r\n    'graph.facebook.com': facebookJwt\r\n  }\r\n});\r\nAWS.config.credentials.get(function(){\r\n  //How to get a cognito.session with this info? I want to call session.getAccessToken().getJwtToken()\r\n});\r\n```\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24zMDQ0","author":{"login":"muriloSanto"},"title":"Have anyone tried using AWS Lambda Proxy with RDS","body":"Have anyone tried using AWS Lambda Proxy with RDS to reuse connections?\r\n\r\nI'm not able to select any RDS instance when trying to add new Proxy to lambda function.\r\n\r\nAlready tried launching RDS instaces from multiple versions, instance types, engines, and nothing.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yOTQw","author":{"login":"ajitgoel"},"title":"Return only some information in graphqlOperation operation.","body":"I have the following working  code that return all the information related to user profile. How can I change the code to return only including  id, userId, vocabularies(since the Vocabulary screen only requires Vocabulary related information)? \r\n\r\n**~\\src\\views\\pages\\Vocabulary.vue:**\r\n```\r\nconst userId='AWS_Cognito_Guid';\r\nconst listUserProfilesFilter={userId:{eq:userId}};\r\nconst result = await API.graphql(graphqlOperation(listUserProfiles, {filter: listUserProfilesFilter}));\r\n```\r\n\r\n**~\\src\\graphql\\queries.js**\r\n\r\n```\r\nexport const listUserProfiles = /* GraphQL */ `\r\n  query ListUserProfiles(\r\n    $filter: ModelUserProfileFilterInput\r\n    $limit: Int\r\n    $nextToken: String\r\n  ) {\r\n    listUserProfiles(filter: $filter, limit: $limit, nextToken: $nextToken) {\r\n      items {\r\n        id\r\n        userId\r\n        fullName\r\n        billingAddress\r\n        country\r\n        vatNumber\r\n        notificationTranscriptsCompleted\r\n        notificationTranscriptsError\r\n        vocabularies\r\n        owner\r\n      }\r\n      nextToken\r\n    }\r\n  }\r\n`;\r\n```","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"ajitgoel"},"body":"I was able to fix this issue by duplicating the query, rename exported const name ONLY, adjust content, use new one"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNzc3","author":{"login":"BryceAMcDaniel"},"title":"Aws table structure","body":"Recently read that DynamoDB suggests a Single Table schema. Should this be implemented with Amplify? Does Amplify do anything under the hood to improve my multi table schema?\r\n\r\nJust getting into NoSQL and DynamoDB, so forgive the uneducated questions.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"aaronfay"},"body":"This has been discussed a bit, you can [find the discussion here](https://github.com/aws-amplify/amplify-cli/issues/431#issuecomment-444303514)."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNjc1","author":{"login":"fireflysemantics"},"title":"Updating Amplify Auth Redirect URIs?","body":"When typing `amplify update auth` it used to ask if I wanted to update the redirect URIs.\r\n\r\nHowever now it only gives these options:\r\n\r\n```\r\nUsing service: Cognito, provided by: awscloudformation\r\n What do you want to do? \r\n  Apply default configuration with Social Provider (Federation) \r\n  Walkthrough all the auth configurations \r\n  Create or update Cognito user pool groups \r\n❯ Create or update Admin queries API \r\n\r\n```\r\n\r\nHow do we get it to update the redirect URLs only? Can we just edit the configuration directly and run `amplify push`?\r\n\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"Johnniexson"},"body":"@fireflysemantics What version of amplify cli are you using?"}},{"node":{"author":{"login":"fireflysemantics"},"body":"```\r\nole@mkt:~/Github/slice$ amplify --version\r\n4.18.0\r\n\r\n```"}},{"node":{"author":{"login":"fireflysemantics"},"body":"So I had no choice but to select the option:\r\n\r\n> Apply default configuration with Social Provider (Federation)\r\n\r\nAfter that I had to go and change the Google authorized Javascript Origins and Authorized Redirect URIs and the app worked.\r\n\r\nNow It's giving me all the options again:\r\n\r\n```\r\nUsing service: Cognito, provided by: awscloudformation\r\n What do you want to do? (Use arrow keys)\r\n❯ Apply default configuration without Social Provider (Federation) \r\n  Walkthrough all the auth configurations \r\n  Add/Edit signin and signout redirect URIs \r\n  Update OAuth social providers \r\n  Create or update Cognito user pool groups \r\n  Create or update Admin queries API \r\n\r\n```\r\n\r\nWhich is good, but seems like there is a bug here ..."}},{"node":{"author":{"login":"fireflysemantics"},"body":"I think there's a bug here.  If I complete update auth then I get all the options.  However if I hit `ctrl-c` to exit, and do `amplify update auth` again, I no longer get the option to change the redirect URIs."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNjc5","author":{"login":"Johnniexson"},"title":"Fields with @connection directives returns undefined when dataStore is queried.","body":"Hello guys, i'm having some issues with datastore query as all my fields with `@connection` directives are missing when data is been queried. \r\n\r\nHere is my schema:\r\n\r\n```\r\ntype User @model {\r\n  id: ID!\r\n  cognitoId: ID!\r\n  user_name: String!\r\n  institution: Institution @connection(name: \"userInstitution\")\r\n  createdAt: String\r\n}\r\n\r\ntype Institution @model {\r\n  id: ID!\r\n  institutionUserId: ID!\r\n  user: User! @connection(name: \"userInstitution\", keyField: \"institutionUserId\")\r\n  tertiary: [Tertiary] @connection(name: \"tertiaryInstitution\")\r\n}\r\n\r\ntype Tertiary @model {\r\n  id: ID!\r\n  userId: ID!\r\n  institutionId: ID!\r\n  institution: Institution @connection(name: \"tertiaryInstitution\", keyField: \"institutionId\")\r\n  name: String!\r\n  department: String!\r\n}\r\n```\r\n\r\nPS: institutionUserId field disapear from the generated model once i run `amplify codegen models`\r\n\r\nI added new user, institution and tertiary like this with dataStore:\r\n\r\n```\r\nasync createData(data) {\r\n  const newUser = await DataStore.save(\r\n        new User({\r\n          cognitoId: data.cognitoId,\r\n          user_name: data.user_name,\r\n        })\r\n      );\r\n\r\n      const newInstitution = await DataStore.save(\r\n        new Institution({\r\n          user: newUser,\r\n        })\r\n      );\r\n\r\n     const newTertiary = await DataStore.save(\r\n            new Tertiary({\r\n              userId: newUser.id,\r\n              institutionId: newInstitution.id,\r\n              name: data.institution.name,\r\n              department: data.institution.department\r\n            })\r\n          );\r\n}\r\n```\r\n\r\nThe problem now is with querying data like:\r\n\r\n```\r\nasync getData(uid, instID, tertID) {\r\n    const user = await DataStore.query<User>(User, uid);\r\n\r\n    console.log(user.institution)          //output: undefined\r\n   \r\n    const institution= await DataStore.query<Institution>(Institution, instID);\r\n\r\n    console.log(institution.user)           //output: undefined\r\n    console.log(institution.tertiary)       //output: []\r\n\r\n\r\n    const tertiary= await DataStore.query<Tertiary>(Tertiary, tertID);\r\n\r\n    console.log(tertiary.institution)        //output: undefined\r\n  }\r\n```\r\n\r\nPls any help with this issue will be appriciated or am i doing something wrong in the data access and structure pattern? Thanks","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"iartemiev"},"body":"Hey @Johnniexson. Bi-directional relations are not currently supported in DataStore, so you should be able to get `institution.user` but not `user.institution`. \r\n\r\nWhen creating a Tertiary record, pass it `newInstitution` instead of the `id`, i.e.\r\n```js\r\nconst newTertiary = await DataStore.save(\r\n  new Tertiary({\r\n    userId: newUser.id,\r\n    institution: newInstitution,\r\n    name: data.institution.name,\r\n    department: data.institution.department\r\n  })\r\n);\r\n```\r\nThen you'll be able to get the institution with:\r\n```js\r\nconst tertiary = await DataStore.query<Tertiary>(Tertiary, tertID);\r\nconsole.log(tertiary.institution)\r\n```\r\n\r\nIf you would like to return an array of all tertiary institutions linked to an institution, I would go with this approach: https://docs.amplify.aws/lib/datastore/relational/q/platform/js#querying-relations\r\n\r\nSo in your case, it would be:\r\n```js\r\nconst tertiaryByInstitution = (await DataStore.query<Tertiary>(Tertiary)).filter((t) => t.institution.id === tertID);\r\n```\r\n\r\nSimilarly for getting an institution by user:\r\n```js\r\nconst userInstitution = (await DataStore.query<Institution>(Institution)).find((i) => i.user.id === uid);\r\n```"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNjU2","author":{"login":"lukeramsden"},"title":"One-to-one mapping between API model and Cognito User?","body":"I'm using the GraphQL API and Cognito User Pools, and I'd like to have a \"UserProfile\" model to store all user-related data that does not fit in to the standard OIDC claims (things like S3 objects and complex one-to-many relationships), so obviously I start with this:\r\n\r\n```gql\r\ntype UserProfile @model @auth(rules: [{allow: owner}]) {\r\n  id: ID!\r\n  profilePicture: S3Object\r\n}\r\n```\r\n\r\nWhich works but is a one-to-many relationship - I could just _not do that_, at the client level, but that's just morally wrong. So my question is - what would be the idiomatic way to achieve a one-to-one mapping with a Cognito user?\r\n\r\nMy initial assumption was to make the \"owner\" field unique, but it seems there is no directive for unique fields, only obscure StackOverflow answers talking about pipeline resolvers etc. but that seems like a lot of unnecessary overhead and code to maintain, as well as the CLI seemingly not supporting pipeline resolvers just yet (#1055), making me even less inclined to go down that route considering it would mean manually configuring Cloudformation (I think?).\r\n\r\nAn alternative thought would be to have a \"ProfilePicture\" model that is owned by a user, and then various other models for specific things that they own, but then that still begs the question of **how to enforce a user can only have one row of a model?** This may be a solved issue but I have not been able to find an answer thus far.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"lukeramsden"},"body":"I must've been tired yesterday as I somehow didn't consider making the owner the primary key. I did try that, but this error message must've thrown me off:\r\n```\r\nFailed to start API Mock endpoint Attempting to edit the key schema of the UserProfileTable table in the UserProfile stack. \r\nCause: Adding a primary @key directive to an existing @model. \r\nHow to fix: Remove the @key directive or provide a name e.g @key(name: \"ByStatus\", fields: [\"status\"]).\r\n```\r\nI sort-of have my answer because that is a one-to-one with the Cognito use, but it's not an ideal solution, and I am absolutely astounded that there's no way to make a field unique - that seems like a core requirement for a database... but from what I can tell, the reason for this is making a field unique in DynamoDB is non-trivial due to it not being a \"real\" database, which really begs the question as to why on earth anybody would consider using DynamoDB to power the core API of their project if you can't do something as simple as a unique field (I say that while using this DynamoDB-backed API for my production app at work, but that's work I guess!). Hopefully anybody trying to do what I did with a UserProfile model stumbles across this and they don't have to waste time trying to figure it out, so here's my model, waiting to have actual data added to it:\r\n\r\n```gql\r\ntype UserProfile\r\n  @model(queries: {list: \"profile\"}, subscriptions: null)\r\n  @key(fields: [\"owner\"])\r\n  @auth(rules: [{allow: owner}]) {\r\n  owner: String!\r\n  createdAt: AWSDate! @auto # @auto directive is from graphql-auto-transformer\r\n  updatedAt: AWSDate! @auto\r\n}\r\n```"}},{"node":{"author":{"login":"lukeramsden"},"body":"Also interesting to note is that with the above model, a create and an update seemingly become the same thing, the only difference being which xAt date field is changed."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMTc0","author":{"login":"tomeraz"},"title":"How to match Cognito userpool userId to Cognito identityPool IdentityId?","body":"Is there a way to know the signup email or userpool userId from an cognito identity id?\r\nOr perhaps getting cognito identity id from a userpool userId ?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"kannieWeesNie"},"body":"will any of the Auth class functions help? see them here https://aws-amplify.github.io/amplify-js/api/classes/authclass.html#currentauthenticateduser"}},{"node":{"author":{"login":"mrichman"},"body":"If you call `Auth.currentUserInfo()` the response contains both the cognito identity id and user pool id:\r\n\r\n```\r\nAuth.currentUserInfo().then(info => {\r\n  // info contains both the identity id and user pool id\r\n  console.log(JSON.stringify(info));\r\n});\r\n```"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNTk2","author":{"login":"camilobern"},"title":"Deferring user verification","body":"Hi,\r\n\r\nIs it possible to defer user verification post sign up?\r\n\r\nCurrently we have set verification to \"No Verification\" in the corresponding user pool, but it looks like this still puts the user in the confirmSignUp state; unable to authenticate or to verify (did not receive SMS code).\r\n\r\nOur thought was that by disabling verification a user can auto-login after sign up, and can then verify their email or phone number in the future.\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"camilobern"},"body":"We have set up a pre-signup lambda trigger that auto verifies user email/phone number in order to let users sign in without required verification, which is not ideal. We would prefer to defer verification until after a user has signed in.\r\n\r\nThe other problem though is that we are still taken to the confirmSignUp state right after sign up, even though there is a lambda trigger confirming the user. This is due to the fact that the sign up implementation always directs the user to the confirmSignUp state:\r\n\r\n ```\r\nAuth.signUp(signup_info)\r\n .then(function (data) {\r\n _this.setState({ requestPending: false });\r\n // @ts-ignore\r\n _this.changeState('confirmSignUp', data.user.username);\r\n })\r\n```\r\n\r\nSo now a user would need to hit cancel on the verify code page (or hit refresh) to get directed to the signin page, where we were expecting auto sign-in to occur instead."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNjQ2","author":{"login":"kannieWeesNie"},"title":"PubSub -how to use cognito authorized subscribe and publish to IoT","body":"i want a cognito authorized user to be able to publish and subscribe to AWS IoT using Amplify PubSub but am having difficulty doing so.\r\n\r\ni use javascript (inside a Vue app)\r\n\r\ni have successfully managed to publish and subscribe to AWS IoT using the aws-iot-device-sdk so all the policies, etc are working.\r\n\r\nhere's the code i'm using with PubSub:\r\n\r\nconst region = \"eu-west-1\";\r\nconst endpoint = \"blahBlah-ats.iot.eu-west-1.amazonaws.com\";\r\nconst currentlySubscribedTopic = \"myTopic\";\r\n\r\n\r\n// Apply plugin with configuration\r\nAmplify.addPluggable(\r\n  new AWSIoTProvider({\r\n    aws_pubsub_region: region,\r\n    // aws_pubsub_endpoint: \"blahBlah-ats.iot.eu-west-1.amazonaws.com\"\r\n    // aws_pubsub_endpoint: 'wss://xxxxxxxxxxxxx.iot.<YOUR-IOT-REGION>.amazonaws.com/mqtt',\r\n    aws_pubsub_endpoint: \"wss://\" + endpoint + \"/mqtt\"\r\n  })\r\n);\r\n\r\nto subscribe:\r\n\r\nPubSub.subscribe(currentlySubscribedTopic).subscribe({\r\n            next: data => console.log(\"Message received\", data),\r\n            error: error => console.error(error),\r\n            close: () => console.log(\"Done\")\r\n          });\r\n\t\t  \r\nto publish I call this method:\r\n\r\nasync publishMessage() {\r\n      console.log(\"publishing message...\");\r\n      await PubSub.publish(currentlySubscribedTopic, {\r\n        msg: \"Hello to all subscribers!\"\r\n      });\r\n      console.log(\"published..\");\r\n    }\r\n\t\r\nunfortunately nothing happens (not even errors), so I am obviously doing something wrong.\r\n\r\nhow do i actually make the connection? is there a connect() function?\r\n\r\nhow do i incorporate the cognito credentials? i have tried this inside Auth.currentSession():\r\n\r\nAWS.config.update({\r\n          region: \"eu-west-1\",\r\n          credentials: new AWS.CognitoIdentityCredentials({\r\n            IdentityPoolId: \"eu-west-1:blahBlah87a-9e0b-blahdf976e\",\r\n            Logins: {\r\n              // optional tokens, used for authenticated login\r\n              \"cognito-idp.eu-west-1.amazonaws.com/eu-west-1_blahBlahBlah\r\n                session.idToken.jwtToken\r\n            }\r\n          })\r\n        });\r\n\t\t\r\nand can use AWS.config.credentials.get() to get the credentials but don't know how to use them to make the connection. \r\n\r\ni'd appreciate some help as to how to do this.\r\n\r\nthanks\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNjI0","author":{"login":"azizur"},"title":"Amplify Libraries (API module): centrally configure Amplify for modularized imports","body":"I am trying to find some docs on how to configuring AWS Amplify for modularized imports.\r\n\r\nHow do I configure Amplify centrally, so that modules can pick up the configuration later in React App?\r\n\r\n**Expected:**\r\nConfigure Amplify via the `@aws-amplify/core` module. \r\n```\r\n// index.js\r\n\r\nimport { Amplify } from '@aws-amplify/core';\r\n...\r\nconst AmplifyConfig = {API:{...}, Auth:{...}}\r\nAmplify.configure(AmplifyConfig); \r\n``` \r\n\r\nThen use modules like this:\r\n```\r\n// component.js\r\n\r\nimport { API } from '@aws-amplify/api';\r\n...\r\n// inside an async function\r\nconst data = await API.get(API_NAME, path, EXTRA_PARAMS); // returns \"API not configured\"\r\n```\r\n\r\n**Actual:**\r\nI am getting `API not configured` error.\r\n\r\n**Workaround:**\r\nIf I change my code in `index.js` to the following it works.\r\n```diff\r\n// index.js\r\n\r\n- import { Amplify } from '@aws-amplify/core';\r\n+ import { API } from '@aws-amplify/api';\r\n...\r\nconst AmplifyConfig = {API:{...}, Auth:{...}}\r\n- Amplify.configure(AmplifyConfig);\r\n+ API.configure(AmplifyConfig);\r\n```\r\nI am wondering why the first approach is not working.\r\n\r\nI tried the using only the `@aws-amplify/auth` module using central configuration in `@aws-amplify/core` and it works fine. Not sure if I should be raising this as a bug with the `@aws-amplify/api` module.\r\n\r\nInterested to hear your thoughts @mbahar @wlee221 @dabit3 since you thought about how [AWS Amplify Modularization](https://github.com/aws-amplify/amplify-js/wiki/Amplify-Modularization) would work.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNDI4","author":{"login":"ajitgoel"},"title":"Questions on verifying password, syncing CurrentAuthenticatedUser","body":"** Which Category is your question related to? **\r\nAuth and credentials\r\n\r\n** What AWS Services are you utilizing? **\r\nCognito\r\n\r\n** Provide additional details e.g. code snippets **\r\nHi!\r\nI want to give my users the ability to change their password. They will have to enter their old password and their new desired password. \r\na. What is the recommended way to verify his old password? \r\nb. After the user has changed his password, does the system need to do something to sync the Auth.CurrentAuthenticatedUser()? I am asking as the code below works the first time and then fails with the error `{\"code\":\"NotAuthorizedException\",\"name\":\"NotAuthorizedException\",\"message\":\"Incorrect username or password.\"}`\r\n\r\n```\r\nasync changePassword() \r\n    {\r\n      try \r\n      {\r\n        const user=await Auth.currentAuthenticatedUser();\r\n        //ToDo: check if old password is valid or not. \r\n        const result=await Auth.changePassword(user, this.oldPassword, this.newPassword);\r\n        this.$router.push('/user-settings').catch(() => {});  \r\n      } \r\n      catch (error) \r\n      {\r\n        console.log(`error: ${JSON.stringify(error)}`);\r\n      };\r\n```","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"kimfucious"},"body":"Hi @ajitgoel \r\n\r\nHave you made sure that when you're submitting the second time, that `this.oldPassword` is actually the new password from the initial change?"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNTUz","author":{"login":"victoryurkin"},"title":"How to Create \"Account > Users\" Authorization Rules in Schema?","body":"Let say I have the following schema.graphql:\r\n\r\n```\r\ntype Account @model {\r\n  id: ID!\r\n  title: String!\r\n  users: [User] @connection(name: \"AccountUsers\")\r\n}\r\n\r\ntype User @model {\r\n  id: ID!\r\n  name: String!\r\n  account: Account @connection(name: \"AccountUsers\")\r\n}\r\n```\r\n\r\nThe goal is to allow each User from the Account to have access to this Account entity and to the other users from that Account using **Amazon Cognito User Pools**.\r\n\r\nFor example, I have a Settings screen where I'd like to show the account title and the list of users from your account.\r\n\r\nPretty common case, I assume, but didn't find much information... Thanks in advance for any help!","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yNDIz","author":{"login":"kimfucious"},"title":"graphQL operations do not always result in equivalent subscription events","body":"The below describes the functionality of a toy React app, created with Amplify:\r\n- API (graphQL/AppSync)\r\n- Lambda trigger function that receives a stream from a DynamoDB table\r\n- DynamoDB table created during API creation.\r\n\r\n**tl;dr:** I've answered this [below](https://github.com/aws-amplify/amplify-js/discussions/5667#discussioncomment-8612).\r\n\r\nThe app looks kinda like this:\r\n\r\n![cloud-arch](https://user-images.githubusercontent.com/26792769/80924075-3c61ed80-8db1-11ea-8697-2f67bd297207.png)\r\n\r\nThe drawing is actually wrong, because the return from the Lambda now goes through AppSync, not directly to DynamoDB, so that I can pickup `update` events that are delivered to subscribers.  I've lost the original drawing, and I'm too lazy to recreate it right now.\r\n\r\nIn short, here's what happens:\r\n- A user will enter a value in the UI of a React App\r\n- That value is part of a `Thing` that gets created with a mutation\r\n- DynamoDB sends `Things` to a Lambda via a stream\r\n- The Lambda uses the initial value `Thing` (`event.dynamodb.NewImage.value`) to perform a calculation and update another property in that `Thing`.\r\n- It then performs an update mutation, which AppSync uses to update the `Thing` in the DynamoDB table.\r\n- I've setup subscriptions in the client app for create, update, and deletion of `Thing`.\r\n- When a new `Thing` is created, it's displayed in the UI of the owner, and the create subscription populates that on other clients as well\r\n- After the lambda finishes, the update subscriptions populate clients with the updated `Thing`\r\n- A deletions work the same.\r\n\r\n**Problem 1**\r\nAll of this works as expected, most of the time on single one-at-a-time operations, except every once in a while, update subscriptions do not come through.  \r\n\r\nI check the Lambda, and there are no errors.  And the expected result value (after Lambda has run) is correctly stored in DynamoDB.\r\n\r\nThe update subscription event, is just not received.  Sometimes not only on some clients; other times, on all clients.  \r\n\r\nCreation and deletion subscriptions appear to work 100% of the time by all clients (except in the scenario described in Problem 2).\r\n\r\n**Question 1**\r\nIs this simply the nature of how things work and I should somehow program around this, or is there something I can do to improve the \"deliverability\" of update subscriptions.  Where can I look to see what might be causing the problem.\r\n\r\n**Problem 2**\r\nThis is similar to problem one, but the issue seems to be exacerbated when things speed up.\r\n\r\nIn other words, If I perform multiple operations rapidly, I don't receive a one-to-one subscription for every operation.\r\n\r\nFor example, in the below code, all `Things` are deleted in rapid succession:\r\n```js\r\n  const handleClearPersistedData = async () => {\r\n    const deleteItem = async (id) => {\r\n      try {\r\n        const response = await API.graphql(\r\n          graphqlOperation(mutations.deleteThing, {\r\n            input: { id }\r\n          })\r\n        );\r\n        return response;\r\n      } catch (e) {\r\n        console.log(e);\r\n      }\r\n    };\r\n\r\n    const pendingDelete = things.map((item) => deleteItem(item.id));\r\n    console.log(\"Awaiting deletion promises...\");\r\n    const deletePromises = await Promise.all(pendingDelete);\r\n    console.log(\"Promises fulfilled!\", deletePromises);\r\n    setThings([]);\r\n  };\r\n```\r\nOn the initiating client everything looks okay, because, the local state array that is holding the `Things` is emptied, if the function runs w/o an error.\r\n\r\nOn other clients, a single deletion subscription event is received, leaving the client out of sync with what's in the DynamoDB table, which is empty at this point.\r\n\r\n**Question 2**\r\nSimilar to Question 1, though I've also read about the \"new\" real-time endpoint [here](https://aws.amazon.com/blogs/mobile/appsync-realtime/), which seems like overkill for a tiny little demo app.\r\n\r\nThe thing is that this app is doing really small stuff.  The max deletions has been ten, so my assumption is that I'm doing something dumb or missing some key point.\r\n\r\nWhere can I look, read about, learn more about how to get subscriptions to work consistently?\r\n\r\nThanks in advance for any insights on this.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"kimfucious"},"body":"Okay, answering my own question here:\r\n\r\nThe idea of using `[things]` as the second argument in the `useEffect` hooks is flawed.\r\n\r\nThe key here is to use `useReducer` to manage things in state, and create the subscription only once, using `[]` as the second argument.\r\n\r\nI learned this from an excellent write-up by @dabit3 found [here](https://medium.com/open-graphql/react-hooks-for-graphql-3fa8ebdd6c62) (see Subscriptions section).\r\n\r\nIronically, I was initially doing `[things]` based on an earlier gist: [here](https://gist.github.com/dabit3/ee8f489ebc208502ab9351809e96e70d)\r\n\r\nRegardless, implementing the custom React hook as described, completely resolved all of the issues that I described above.\r\n\r\nHere's the custom React hook should anyone be interested:\r\n```js\r\nimport { useEffect, useReducer } from \"react\";\r\nimport * as queries from \"../graphql/queries\";\r\nimport * as subscriptions from \"../graphql/subscriptions\";\r\nimport API, { graphqlOperation } from \"@aws-amplify/api\";\r\n\r\nconst initialState = { things: [] };\r\n\r\nconst reducer = (state, action) => {\r\n  switch (action.type) {\r\n    case \"SET_THINGS\":\r\n      return { things: action.payload };\r\n\r\n    case \"ADD_THINGS\":\r\n      return { things: [...state.things, action.payload] };\r\n\r\n    case \"DELETE_THINGS\":\r\n      return {\r\n        things: state.things.filter((item) => item.id !== action.payload.id)\r\n      };\r\n\r\n    case \"UPDATE_THING\":\r\n      console.log(action.payload);\r\n      return {\r\n        things: state.things.map((item) => {\r\n          if (item.id === action.payload.id) {\r\n            // TODO:  This is a hack because, for some reason, owner is lost when receiving a subscription fix when you figure it out!\r\n            return { ...action.payload, owner: item.owner };\r\n          } else {\r\n            return item;\r\n          }\r\n        })\r\n      };\r\n\r\n    default:\r\n      break;\r\n  }\r\n};\r\n\r\nexport const useSubscription = () => {\r\n  const [state, dispatch] = useReducer(reducer, initialState);\r\n\r\n  useEffect(() => {\r\n    API.graphql(graphqlOperation(queries.listThings)).then(\r\n      (thingData) => {\r\n        dispatch({\r\n          type: \"SET_THINGS\",\r\n          payload: thingData.data.listThings.items\r\n        });\r\n      }\r\n    );\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const subscription = API.graphql(\r\n      graphqlOperation(subscriptions.onCreateThing)\r\n    ).subscribe({\r\n      next: (data) => {\r\n        const {\r\n          value: {\r\n            data: { onCreateThing }\r\n          }\r\n        } = data;\r\n        dispatch({ type: \"ADD_THING\", payload: onCreateThing });\r\n      }\r\n    });\r\n    return () => subscription.unsubscribe();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const subscription = API.graphql(\r\n      graphqlOperation(subscriptions.onDeleteThing)\r\n    ).subscribe({\r\n      next: (data) => {\r\n        const {\r\n          value: {\r\n            data: { onDeleteThing }\r\n          }\r\n        } = data;\r\n        dispatch({ type: \"DELETE_THING\", payload: onDeleteThing });\r\n      }\r\n    });\r\n    return () => subscription.unsubscribe();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const subscription = API.graphql(\r\n      graphqlOperation(subscriptions.onUpdateThing)\r\n    ).subscribe({\r\n      next: (data) => {\r\n        const {\r\n          value: {\r\n            data: { onUpdateThing }\r\n          }\r\n        } = data;\r\n        dispatch({ type: \"UPDATE_THING\", payload: onUpdateThing });\r\n      }\r\n    });\r\n    return () => subscription.unsubscribe();\r\n  }, []);\r\n\r\n  return state.things;\r\n};\r\n```"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMzM2","author":{"login":"mrichman"},"title":"Storage.put and Cognito identity confusion","body":"I’m trying to understand why, with a Cognito-authenticated ID, `Storage.put` is uploading to `/private/<identityid>/foo.txt`. I guess I’m expecting it to go to `/private/<cognito:sub>/foo.txt`.\r\n\r\n(I have `Storage.configure({ level: 'private', track: true });` in my `main.js`).\r\n\r\nIn other words, I see this in S3:\r\n\r\n`/private/us-east-1:c1ecd265-dead-beef-cafe-fa0cffa42ff1/foo.txt`\r\n\r\nbut I was expecting:\r\n\r\n`/private/688746f8-dead-beef-cafe-0c3de99fff98/foo.txt`\r\n\r\nWhere the latter is the Cognito user pool user's `sub` attribute.\r\n\r\nPerhaps I don't quite understand the magic mapping between user pool id and identity id.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"undefobj"},"body":"Fine grained IAM policies (which is what S3 uses) are only supported for Identity Pool IDs right now. The Cognito team is looking at supporting User Pool subs in the future but until that happens we must use IdentityIDs."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMjA5","author":{"login":"dittmarconsulting"},"title":"Can not connect to AWS Amplify PubSub -> Socket error:undefined","body":"I've been trying out all ways to get the **Amplify/PubSub** working without any luck. It seems all the documentation are rather outdated.\r\n\r\nHere is what I have done so far. Please note all hashes are made up ;-)\r\n\r\n1. Created a fresh React Native app\r\n2. Installed amplify packages\r\n3. Installed Amplify CLI\r\n4. Invoked `$ amplify configure`\r\n5. Invoked `$ amplify init`\r\n6. Invoked `$ amplify add auth`\r\n7. Invoked `$ amplify push`, which created the `aws-exports.js` object\r\n8. Created a super simple component\r\n```\r\n    import React from 'react';\r\n    import { View } from 'react-native';\r\n\r\n    import Amplify, { PubSub } from 'aws-amplify';\r\n    import { AWSIoTProvider } from '@aws-amplify/pubsub/lib/Providers';\r\n\r\n    import awsmobile from './aws-exports';\r\n\r\n    Amplify.configure({\r\n      Auth: {\r\n        mandatorySignIn: false,\r\n        region: awsmobile.aws_cognito_region,\r\n        userPoolId: awsmobile.aws_user_pools_id,\r\n        identityPoolId: awsmobile.aws_cognito_identity_pool_id,\r\n        userPoolWebClientId: awsmobile.aws_user_pools_web_client_id,\r\n      },\r\n      Analytics: {\r\n        disabled: true,\r\n      },\r\n    });\r\n\r\n    Amplify.addPluggable(\r\n      new AWSIoTProvider({\r\n        aws_pubsub_region: 'ap-southeast-2',\r\n        aws_pubsub_endpoint:\r\n      'wss://a123456789d-ats.iot.ap-southeast-2.amazonaws.com/mqtt',\r\n      })\r\n    );\r\n\r\n    Amplify.Logger.LOG_LEVEL = 'DEBUG';\r\n\r\n    function _subscribe() {\r\n      PubSub.subscribe('topic1').subscribe({\r\n        next: (data) => console.log(JSON.stringify(data, null, 2)),\r\n        error: (error) => console.log(JSON.stringify(error, null, 2)),\r\n        close: () => console.log('Done'),\r\n      });\r\n    }\r\n\r\n    function App() {\r\n      _subscribe();\r\n      return <View />;\r\n    }\r\n\r\n    export default App;\r\n```\r\n\r\n9. I attached AWS root certificate to my iPhone (see below)\r\n\r\n<img src=\"https://i.stack.imgur.com/uJiqs.jpg\" width=\"300\" />\r\n\r\n10.Create a IAM policy for AWS IoT\r\n\r\n - `IoTAppPolicy`\r\n - `iot:*`\r\n - `arn:aws:iot:ap-southeast-2:1234567890:*`\r\n\r\n11.Attach the `aws_cognito_identity_pool_id` to the policy\r\n```\r\naws iot attach-principal-policy --policy-name IoTAppPolicy --principal ap-southeast-2:db4567bc-1234-5678-9876-543ae2e123b2\r\n```\r\n\r\n12.Attach Policies to `Auth Role`\r\n\r\n - `AWSIoTDataAccess`\r\n - `AWSIoTConfigAccess`\r\n\r\nYet, when I run the app I get the following error log\r\n\r\n```\r\n    [DEBUG] 17:43.434 PubSub - subscribe options undefined\r\n    [DEBUG] 17:43.435 MqttOverWSProvider - Subscribing to topic(s) topic1\r\n    [DEBUG] 17:43.436 Credentials - getting credentials\r\n    [DEBUG] 17:43.436 Credentials - picking up credentials\r\n    [DEBUG] 17:43.437 Credentials - getting new cred promise\r\n    [DEBUG] 17:43.437 Credentials - checking if credentials exists and not expired\r\n    [DEBUG] 17:43.438 Credentials - need to get a new credential or refresh the existing one\r\n    [DEBUG] 17:43.438 AuthClass - Getting current user credentials\r\n    [DEBUG] 17:43.466 AuthClass - failed to get or parse item aws-amplify-federatedInfo SyntaxError: Unexpected token u in JSON at position 0\r\n        at JSON.parse (<anonymous>)\r\n        at AuthClass.<anonymous> (Auth.js:1233)\r\n        at step (tslib.js:139)\r\n        at Object.next (tslib.js:120)\r\n        at fulfilled (tslib.js:110)\r\n        at tryCallOne (core.js:37)\r\n        at core.js:123\r\n        at JSTimers.js:277\r\n        at _callTimer (JSTimers.js:135)\r\n        at _callImmediatesPass (JSTimers.js:183)\r\n    [DEBUG] 17:43.466 AuthClass - Getting current session\r\n    [DEBUG] 17:43.467 AuthClass - Failed to get user from user pool\r\n    [DEBUG] 17:43.467 AuthClass - Failed to get the current user No current user\r\n    [DEBUG] 17:43.467 AuthClass - getting session failed No current user\r\n    [DEBUG] 17:43.467 Credentials - setting credentials for guest\r\n    [DEBUG] 17:43.785 Credentials - Failed to load credentials Promise {_40: 1, _65: 3, _55:   Promise, _72: null}\r\n    [DEBUG] 17:43.788 Signer {region: \"ap-southeast-2\", service: \"iotdevicegateway\"}\r\n    [DEBUG] 17:43.796 MqttOverWSProvider - Creating new MQTT client 38da11d8-ba08-47c8-a6de-9e739ab4c14f\r\n    SocketRocket: In debug mode.  Allowing connection to any root cert\r\n    {\r\n      \"provider\": {\r\n        \"_config\": {\r\n          \"Auth\": {\r\n            ...\r\n          },\r\n          \"Analytics\": {\r\n            ...\r\n          },\r\n          \"aws_pubsub_region\": \"ap-southeast-2\",\r\n          \"aws_pubsub_endpoint\": \"wss://a123456789d-ats.iot.ap-southeast-2.amazonaws.com/mqtt\",\r\n          \"clientId\": \"...\"\r\n        },\r\n        \"_clientsQueue\": {\r\n          \"promises\": {}\r\n        },\r\n        \"_topicObservers\": {},\r\n        \"_clientIdObservers\": {}\r\n      },\r\n      \"error\": {\r\n        \"errorCode\": 7,\r\n        \"errorMessage\": \"AMQJS0007E Socket error:undefined.\"\r\n      }\r\n    }\r\n    [DEBUG] 17:44.453 MqttOverWSProvider - Unsubscribing from topic(s) topic1\r\n```\r\n\r\nAny idea why I can't connect to the topic?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"dittmarconsulting"},"body":"I finally figured it out. [Here the solution](https://stackoverflow.com/questions/61501005/can-not-connect-to-aws-amplify-pubsub-socket-errorundefined/61555722)"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMzQ1","author":{"login":"avlonder"},"title":"AppSync subscriptions vs Pinpoint sendUsersMessages","body":"Hello everyone,\r\nI'm working on a social app where users can send group and event invitations to each other. I use Cognito user pools, DynamoDB tables and AppSync queries/mutations. But I'm somewhat confused whether I should use AppSync subscriptions, a dynamoDB data stream that triggers a Lambda function that emits Pinpoint push notifications, or even a combination of both to send the invitations... What do you think is the best approach for my use case?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMzE3","author":{"login":"mlafo"},"title":"How to use Predictions with bytes type","body":"I try to use Predictions with bytes type source but I can't provide the good type.\r\n\r\nImage is coming from react-native-camera.\r\n\r\n`      const image = await camera.takePictureAsync({\r\n        quality: 1,\r\n        fixOrientation: true,\r\n        forceUpOrientation: true,\r\n        base64: true,\r\n      });\r\n`\r\n\r\nImage has in return uri or base64.\r\nI need to pass image to Prediction but I always get an \"Input source is not configured correctly\" error.\r\nbytes param accept Buffer, arrayBuffer ,Blob or string\r\nI tried a lot of things... \r\n\r\n`      await Predictions.identify({\r\n        text: {\r\n          source : {\r\n          bytes: myBytesImage,\r\n         },\r\n        },\r\n      })\r\n        .then((res) => this.setState({ res: res }))\r\n        .catch((err) => this.setState({ err: err }));`\r\n\r\nDoes anyone know how to do that, or is there a bug ?\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMzEx","author":{"login":"devth"},"title":"Identity provider (Facebook) does not show on hosted Cognito UI","body":"I originally setup auth via `amplify auth add` and went through the process to configure \"Login with Amazon\" and Google. These both worked, and both showed up. \r\n\r\nI then used `amplify auth update` to add Facebook and remove the others. **The problem is, Facebook login does not show up on my hosted UI:**\r\n\r\n![image](https://user-images.githubusercontent.com/86107/80811262-c1b38b00-8b82-11ea-874e-f93effe91223.png)\r\n\r\nI then used `amplify auth update` to add Amazon and Google back in:\r\n\r\n![image](https://user-images.githubusercontent.com/86107/80811346-ec054880-8b82-11ea-9f5d-19fbdb872449.png)\r\n\r\nSo I now have all 3 configured. The hosted UI updated:\r\n\r\n![image](https://user-images.githubusercontent.com/86107/80811651-90878a80-8b83-11ea-8e3f-ee041e148238.png)\r\n\r\n\r\nbut it does not include Facebook. I am able to force Facebook login with:\r\n\r\n```typescript\r\n            <Button\r\n              className={cx(classes.brandButton)}\r\n              onClick={() => Auth.federatedSignIn({provider: 'Facebook'})}\r\n            >\r\n              Continue with Facebook\r\n            </Button>\r\n```\r\n\r\nthis works. It takes me to Facebook's authorize screen, redirects back to my app, and allows me to get the user's email provided by FB.\r\n\r\nI ran `amplify push` after each change, and committed changes in git and pushed to master, causing an amplify deploy.\r\n\r\nHow do I get FB to show up on the hosted UI? 🤔 ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMjYy","author":{"login":"Hideman85"},"title":"How to set awscloudformation provider lambda runtime?","body":"I try to find any doc to configure awscloudformation provider with no success.\r\n\r\nMy issue is when I want to deploy a GraphQl api I have the issue:\r\n```\r\nThe runtime parameter of nodejs8.10 is no longer supported for creating or updating AWS Lambda functions. We recommend you use the new runtime (nodejs12.x) while creating or updating functions.\r\n```\r\n\r\nAfter figure out where this is set I try to replace it by node12 but when I push this is overwritten...\r\nThis value is in the file `amplify/backend/awscloudformation/nested-cloudformation-stack.yml` so I presume awscloudformation provider is responsible of.\r\nNo where else in the app this value is set. ","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"RossWilliams"},"body":"There is a guide [here](https://aws-amplify.github.io/docs/cli/lambda-node-version-update) to resolve your issue."}},{"node":{"author":{"login":"Hideman85"},"body":"According to the guide you referred to me this is fix with the version 4.10.0.\r\nI checked my version and was 3.17.0 and it's appear that's because the package name changed from aws-amplify to @aws-amplify/cli\r\nRemoving the old one and installing the new one effectively sole my issue.\r\nThank you."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMjM3","author":{"login":"kkrzyzek"},"title":"Amplify - Chatbot UI Component - voice interaction - response playback","body":"Hi all,\r\n\r\nI am working on a react-native app integrated with Amplify where I have setup Chatbot UI component, based on following tutorial: https://docs.amplify.aws/ui/interactions/chatbot/q/framework/react-native\r\n\r\nMy bot works fine with text input, but I have an issue with voice interaction. \r\nThe postContent method of AWS Lex (which Amplify uses) gets processed properly, but the bot audio output is not being played: I am getting following warning: \r\n\r\n```\r\nTypeError: The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type object\r\nTypeError: The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type object\r\n    at from (http://192.168.1.3:8081/index.bundle?platform=ios&dev=true&minify=false:400183:11)\r\n    at Function.Buffer.from (http://192.168.1.3:8081/index.bundle?platform=ios&dev=true&minify=false:400187:12)\r\n    at ChatBot.submit$ (http://192.168.1.3:8081/index.bundle?platform=ios&dev=true&minify=false:399637:31)\r\n    at tryCatch (http://192.168.1.3:8081/index.bundle?platform=ios&dev=true&minify=false:29884:19)\r\n    at Generator.invoke [as _invoke] (http://192.168.1.3:8081/index.bundle?platform=ios&dev=true&minify=false:30060:24)\r\n    at Generator.prototype.<computed> [as next] (http://192.168.1.3:8081/index.bundle?platform=ios&dev=true&minify=false:29927:23)\r\n    at tryCatch (http://192.168.1.3:8081/index.bundle?platform=ios&dev=true&minify=false:29884:19)\r\n    at invoke (http://192.168.1.3:8081/index.bundle?platform=ios&dev=true&minify=false:29960:22)\r\n    at http://192.168.1.3:8081/index.bundle?platform=ios&dev=true&minify=false:29970:15\r\n    at tryCallOne (http://192.168.1.3:8081/index.bundle?platform=ios&dev=true&minify=false:3859:14)\r\n```\r\nwhich is caused by the incorrect format of audioStream object I am getting in response from Lex:\r\n\r\n**audioStream\":{\"_data\":{\"size\":21831,\"blobId\":\"9EA11F3F-EF21-46E8-9742-169E1F1AE1B5\",\"offset\":0,\"type\":\"audio/mpeg\",\"name\":\"content.mp3\",\"__collector\":null}}**\r\n\r\nIt does not contain the content of audioStream and Amplify Chatbot UI component tries to read it in:\r\n**node_modules/aws-amplify-react-native/dist/Interactions/ChatBot.js**\r\nline187: `const data = Buffer.from(response.audioStream).toString('base64');`\r\n\r\nFull response payload from Lex PostContent method:\r\n`{\"$metadata\":{\"httpStatusCode\":200,\"httpHeaders\":{\"x-amz-lex-message\":\"You successfully entered following problem description: I don't know\",\"x-amz-lex-session-id\":\"2020-04-30T11:35:44.009Z-dzXNTxpD\",\"connection\":\"keep-alive\",\"content-type\":\"audio/mpeg\",\"date\":\"Thu, 30 Apr 2020 11:38:56 GMT\",\"x-amz-lex-slots\":\"eyJQcm9ibGVtRGVzY3JpcHRpb24iOiJJIGRvbid0IGtub3cifQ==\",\"transfer-encoding\":\"Identity\",\"x-amz-lex-dialog-state\":\"Fulfilled\",\"x-amzn-requestid\":\"9085d91c-d985-4b9e-9539-39a8f65ce4a0\",\"x-amz-lex-intent-name\":\"ProblemDesc\"},\"requestId\":\"9085d91c-d985-4b9e-9539-39a8f65ce4a0\",\"retries\":0,\"totalRetryDelay\":0},\"__type\":\"PostContentResponse\",\"audioStream\":{\"_data\":{\"size\":21831,\"blobId\":\"9EA11F3F-EF21-46E8-9742-169E1F1AE1B5\",\"offset\":0,\"type\":\"audio/mpeg\",\"name\":\"content.mp3\",\"__collector\":null}},\"contentType\":\"audio/mpeg\",\"dialogState\":\"Fulfilled\",\"intentName\":\"ProblemDesc\",\"message\":\"You successfully entered following problem description: I don't know\",\"sessionId\":\"2020-04-30T11:35:44.009Z-dzXNTxpD\",\"slots\":\"eyJQcm9ibGVtRGVzY3JpcHRpb24iOiJJIGRvbid0IGtub3cifQ==\"}`\r\n\r\nWhy am I not getting the encoded audioStream file content in response from Lex and only metadata about audio file?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMDg1","author":{"login":"Nutriadmin"},"title":"How to automatically convert empty strings to null when saving data to DynamoDB","body":"When I run a mutation like:\r\n\r\n```\r\nmutation {\r\n  updateClient(input: {\r\n    id: \"7f7ca844-e030-4e2d-9561-5e23a5911d38\",\r\n    name: \"\"\r\n  }) {\r\n    id\r\n    name\r\n  }\r\n}\r\n```\r\n\r\nI get an error message because the string for `name` is empty:\r\n\r\n```One or more parameter values were invalid: An AttributeValue may not contain an empty string```\r\n\r\nIt seems DynamoDB cannot store empty strings, but it can store the value `null`. My question is, do we have a way of automatically converting empty strings passed to AppSync as part of a mutation from the app into `null` values?\r\n\r\nApparently there is an option: `convertEmptyValues: true` for the DynamoDB client: \r\n[reference link](https://docs.aws.amazon.com/AWSJavaScriptSDK/latest/AWS/DynamoDB/DocumentClient.html) - do we have the same option when using Amplify/AppSync?\r\n\r\nI've been searching over the web for hours and couldn't find this mentioned anywhere in the Amplify Docs or in the issues reported in the repo. Any help is appreciated. I hope there is a better solution other than manually processing the data from the forms in our app before executing each mutation.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"Nutriadmin"},"body":"I think the solution would be to write a custom resolver. The resolver would do the same as the default resolver, but additionally cast empty strings to null values. I'm learning about resolvers from [this page](https://docs.amplify.aws/cli/graphql-transformer/resolvers) and will write my own over the next few days. If someone has had my same issue and has a better or alternative solution it would be great to hear."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMjQ3","author":{"login":"nihp"},"title":"Clarification: Can I able to navigate inside the app after successfull signUp in aws-amplify-react-native","body":"I have customized my UI screens and using Auth.SignUp for signIn. Here I need to navigate inside the screen.\r\n\r\nHow can I change the state after signUp. \r\n\r\nNow, for the signedIn it allows the user inside the app, but how can I change this for success signUp?\r\n\r\n```\r\n  Auth.confirmSignUp(users, confirmationCode, {\r\n  }).then(data => {\r\n    this.props.onStateChange('signIn',{})\r\n    console.log(data)\r\n  })\r\n  .catch(err => {\r\n \r\n}\r\n```","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"rpostulart"},"body":"We have create a base app, maybe you can look into that: \r\nhttps://github.com/alowa-apps/baseApp\r\n\r\nYou can use the hub.listen, you can see it here:\r\nhttps://github.com/alowa-apps/baseApp/blob/master/App.js"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMjA1","author":{"login":"ernestostifano"},"title":"How to trigger lambda function on user request.","body":"Hi! I can’t find any reference in docs about how to access user requests/responses (like with CloudFront lambda@edge triggers).\r\n\r\nI need to dynamically set some headers and change resources representations.\r\n\r\nIs there some way to do that? Can I use a custom CloudFront distribution and therefore be able to set triggers on requests?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMTcw","author":{"login":"jts-mjanda"},"title":"React Native Typescript Issues","body":"I've recently begun a new react native project. Following standard documentation:\r\n\r\nnpx react-native init MyApp --template react-native-template-typescript\r\n\r\nThe project compiles via TSC command without any issues\r\n\r\nAfter successful setup I add the amplify package via:\r\n\r\nnpm install aws-amplify\r\n\r\nI add exactly 1 line of code to the index.js:\r\n\r\nimport {Auth} from \"aws-amplify\";\r\n\r\nCompile now has 3 sets of issues:\r\n\r\n1. error TS2304: Cannot find name 'xxxxx' where xxxxx is ServiceWorker, File, Cache, and Storage\r\n2. error TS2580: Cannot find name 'Buffer'. Do you need to install type definitions for node? Try `npm i @types/node`\r\n3. TS2688: Cannot find type definition file for 'node'.\r\n\r\nAdding the @types/node to the project clears up 2 and 3 above which 1 still remaining an issue\r\n\r\nWhat is the recommended solution for 1? A custom type file?\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"jts-mjanda"},"body":"tcconfig:\r\n\r\n\r\n{\r\n  \"compilerOptions\": {\r\n    /* Basic Options */\r\n    \"target\": \"esnext\",                       /* Specify ECMAScript target version: 'ES3' (default), 'ES5', 'ES2015', 'ES2016', 'ES2017','ES2018' or 'ESNEXT'. */\r\n    \"module\": \"commonjs\",                     /* Specify module code generation: 'none', 'commonjs', 'amd', 'system', 'umd', 'es2015', or 'ESNext'. */\r\n    \"lib\": [\"es6\"],                           /* Specify library files to be included in the compilation. */\r\n    \"allowJs\": true,                          /* Allow javascript files to be compiled. */\r\n    // \"checkJs\": true,                       /* Report errors in .js files. */\r\n    \"jsx\": \"react-native\",                    /* Specify JSX code generation: 'preserve', 'react-native', or 'react'. */\r\n    // \"declaration\": true,                   /* Generates corresponding '.d.ts' file. */\r\n    // \"sourceMap\": true,                     /* Generates corresponding '.map' file. */\r\n    // \"outFile\": \"./\",                       /* Concatenate and emit output to single file. */\r\n    // \"outDir\": \"./\",                        /* Redirect output structure to the directory. */\r\n    // \"rootDir\": \"./\",                       /* Specify the root directory of input files. Use to control the output directory structure with --outDir. */\r\n    // \"removeComments\": true,                /* Do not emit comments to output. */\r\n    \"noEmit\": true,                           /* Do not emit outputs. */\r\n    // \"incremental\": true,                   /* Enable incremental compilation */\r\n    // \"importHelpers\": true,                 /* Import emit helpers from 'tslib'. */\r\n    // \"downlevelIteration\": true,            /* Provide full support for iterables in 'for-of', spread, and destructuring when targeting 'ES5' or 'ES3'. */\r\n    \"isolatedModules\": true,                  /* Transpile each file as a separate module (similar to 'ts.transpileModule'). */\r\n\r\n    /* Strict Type-Checking Options */\r\n    \"strict\": true,                           /* Enable all strict type-checking options. */\r\n    // \"noImplicitAny\": true,                 /* Raise error on expressions and declarations with an implied 'any' type. */\r\n    // \"strictNullChecks\": true,              /* Enable strict null checks. */\r\n    // \"strictFunctionTypes\": true,           /* Enable strict checking of function types. */\r\n    // \"strictPropertyInitialization\": true,  /* Enable strict checking of property initialization in classes. */\r\n    // \"noImplicitThis\": true,                /* Raise error on 'this' expressions with an implied 'any' type. */\r\n    // \"alwaysStrict\": true,                  /* Parse in strict mode and emit \"use strict\" for each source file. */\r\n\r\n    /* Additional Checks */\r\n    // \"noUnusedLocals\": true,                /* Report errors on unused locals. */\r\n    // \"noUnusedParameters\": true,            /* Report errors on unused parameters. */\r\n    // \"noImplicitReturns\": true,             /* Report error when not all code paths in function return a value. */\r\n    // \"noFallthroughCasesInSwitch\": true,    /* Report errors for fallthrough cases in switch statement. */\r\n\r\n    /* Module Resolution Options */\r\n    \"moduleResolution\": \"node\",               /* Specify module resolution strategy: 'node' (Node.js) or 'classic' (TypeScript pre-1.6). */\r\n    \"baseUrl\": \"./\",                          /* Base directory to resolve non-absolute module names. */\r\n    // \"paths\": {},                           /* A series of entries which re-map imports to lookup locations relative to the 'baseUrl'. */\r\n    // \"rootDirs\": [],                        /* List of root folders whose combined content represents the structure of the project at runtime. */\r\n    // \"typeRoots\": [],                       /* List of folders to include type definitions from. */\r\n    // \"types\": [],                           /* Type declaration files to be included in compilation. */\r\n    \"allowSyntheticDefaultImports\": true,     /* Allow default imports from modules with no default export. This does not affect code emit, just typechecking. */\r\n    \"esModuleInterop\": true                   /* Enables emit interoperability between CommonJS and ES Modules via creation of namespace objects for all imports. Implies 'allowSyntheticDefaultImports'. */\r\n    // \"preserveSymlinks\": true,              /* Do not resolve the real path of symlinks. */\r\n\r\n    /* Source Map Options */\r\n    // \"sourceRoot\": \"./\",                    /* Specify the location where debugger should locate TypeScript files instead of source locations. */\r\n    // \"mapRoot\": \"./\",                       /* Specify the location where debugger should locate map files instead of generated locations. */\r\n    // \"inlineSourceMap\": true,               /* Emit a single file with source maps instead of having a separate file. */\r\n    // \"inlineSources\": true,                 /* Emit the source alongside the sourcemaps within a single file; requires '--inlineSourceMap' or '--sourceMap' to be set. */\r\n\r\n    /* Experimental Options */\r\n    // \"experimentalDecorators\": true,        /* Enables experimental support for ES7 decorators. */\r\n    // \"emitDecoratorMetadata\": true,         /* Enables experimental support for emitting type metadata for decorators. */\r\n  },\r\n  \"exclude\": [\r\n    \"node_modules\", \"babel.config.js\", \"metro.config.js\", \"jest.config.js\"\r\n  ]\r\n}\r\n"}},{"node":{"author":{"login":"jts-mjanda"},"body":"node version 12.16.2"}},{"node":{"author":{"login":"jts-mjanda"},"body":"Issue #976 does not really address this issue"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMTM0","author":{"login":"karrettgelley"},"title":"Multiple Frontends Multiple Environments Workflow","body":"Is there any good documentation on a realistic workflow using multiple frontends in multiple environments? I have a react app with all of the amplify files in one repo, and I'm starting a new react native app in another repo. I understand how to pull the exports file and do codegen in the react native repo, but I don't understand how I can have different branches hooked up to different environments at the same time.\r\nFor instance, I want my project structure to look like this:\r\n```\r\nreact-repo (master branch) -> amplify master env\r\nreact-repo (dev branch) -> amplify dev env\r\nreact-repo (feature branch) -> amplify feature env\r\n\r\nreact-native-repo (master branch) -> amplify master env\r\nreact-native-repo (dev branch) -> amplify dev env\r\nreact-native-repo (feature branch) -> amplify feature env\r\n```\r\n\r\nI won't talk about the react repo now, because I have multi-env down to this end, but how can I make sure my dev branch on the RN repo is connected to the dev env when I merge changes from a feature branch? Do I have to run amplify pull <env> in order for the RN app to be connected to the proper amplify environment? How are y'all handling this on your teams?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNjcz","author":{"login":"sri7vasu"},"title":"AmplifyAuthenticator customize validation modal positioning and width","body":"Im using SignUp form like this using React (Typescript) and AmplifyAuthenticator like this below:\r\n\r\n```\r\nimport React from \"react\";\r\nimport {AuthState} from \"@aws-amplify/ui-components\"\r\nimport {\r\n  AmplifySignUp,\r\n  AmplifyAuthenticator,\r\n  AmplifySignOut,\r\n} from \"@aws-amplify/ui-react\";\r\n\r\nfunction SignUp() {\r\n  return (\r\n    <AmplifyAuthenticator initialAuthState={AuthState.SignUp}>\r\n      <AmplifySignUp\r\n        headerText=\"Sign Up\"\r\n        usernameAlias=\"email\"\r\n        slot=\"sign-up\"\r\n        ></AmplifySignUp>\r\n      <div>\r\n        My App\r\n        <AmplifySignOut></AmplifySignOut>\r\n      </div>\r\n    </AmplifyAuthenticator>\r\n  );\r\n}\r\nexport default SignUp;\r\n```\r\nThe functionality and validations are working fine , i placed the signup forum in middle right of my page and still when there is a validation error it shows on top of the page and that too wide as shown in the figure. \r\n<img width=\"1440\" alt=\"Screen Shot 2020-04-21 at 3 36 26 PM\" src=\"https://user-images.githubusercontent.com/5733652/79911721-6cd77e00-83e6-11ea-9ea3-7c4aa4ac781e.png\">\r\n\r\nHow can i customize the position of the validation error and then also reduce the width ?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"ashika01"},"body":"@sri7vasu : The component might not be completely possible right now. What are your thoughts here? what is your expectation? "}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMjY4","author":{"login":"24jr"},"title":"@key in graphQL not working properly","body":"If I add `@key( fields: [\"id\", \"username\"])` the getUser requires both id and username rather than require id and have username be used like eq or gt like it used to. Like this\r\n\r\n```\r\ngetUser(id: ID!, username: String!): User\r\n```\r\n\r\nAlso when I add `@key(name: \"byUsername\", fields: [\"username\", \"createdAt\"])` no query byUsername gets added to my schema like used to happen on previous versions.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"RossWilliams"},"body":"If you don’t give a key a name, that key is used on the primary table. If you want to access a model using a key, you need to specify the “queryField” property, not the name property.\r\n\r\nWorking as intended."}},{"node":{"author":{"login":"24jr"},"body":"Oh ok you're right I was thinking “queryField” only needed to be provided if you wanted a custom name. \r\n\r\nBut my question on the no name one still remains. The second field is just a sort key right but it generates `getUser(id: ID! username: String!): User` and I wouldn't think the sort field would be a requirement for getUser. Expected just  `getUser(id: ID!): User` \r\n\r\nPerhaps this usage is more of like a non-unique two part id. Like` id: cloudy time: 15049494` and `id: cloudy time: 16049494` or something\r\n\r\nSo this is with both. Figured I would only need one but no big deal. I don't really need the createdAt just threw that on cause I could\r\n```\r\n@key(fields: [\"id\", \"username\"])\r\n@key(name: \"byUsername\", fields: [\"username\", \"createdAt\"], queryField: \"usersByUsername\")\r\n```\r\n<img width=\"342\" alt=\"Screen Shot 2020-04-27 at 7 25 55 PM\" src=\"https://user-images.githubusercontent.com/34662182/80430590-03abab00-88bd-11ea-983f-1f42882a535e.png\">\r\n"}},{"node":{"author":{"login":"24jr"},"body":"Also for named @key's can you not just remove those and add new ones. I keep having errors and just deleting entire api and pushing new from start to get new changes. Its fine now with no users but of course I can't delete all the users in a year if I want to change a named key\r\n\r\nI see how the primary key shouldn't be changed but the named ones are just extras and seem like they should be changeable "}},{"node":{"author":{"login":"RossWilliams"},"body":"You are trying to access a single item. If you specify a sort key on a table, to access a unique value you must specify the partition key and the sort key. Otherwise you could have multiple users with the same ID field. Not a bug.\r\n\r\nFor your latest question, you cannot change a @key that specifies the key structure for the primary table (includes LSIs). You can remove and add named keys (one at a time) that create GSIs. If you try to do more than one GSI operation (add or remove at once on a table, (unless you are creating a fresh table) the operation will fail."}},{"node":{"author":{"login":"24jr"},"body":"Okay I was initially thinking sort key was strictly for listing data and still required unique ids but makes sense. Thanks for your clarification on all this!"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMTEy","author":{"login":"tabrza"},"title":"Cannot effectively style Chatbot Component in react","body":"**Describe the bug**\r\nI am unable to style the chatbot component to the point of targeting to the granular point of input styling and response styling.\r\n\r\n**I tried two approaches:**\r\n\r\n**Approach one**\r\nUse and override amplifytheme. I tried playing around with different sections but only ever affect the overall styling. And not to the point where i could for example create a border around the input and response text.\r\n```\r\nconst myTheme = {\r\n  ...AmplifyTheme,\r\n  container:{\r\n    ...AmplifyTheme.container\r\n  },\r\n  sectionHeader: {\r\n    ...AmplifyTheme.sectionHeader,\r\n    padding: '1%',\r\n    /*border-radius: 5px 5px 0' 0',*/\r\n    backgroundColor:'white',\r\n    color: '#000',\r\n    fontSize: '120%',\r\n    position:'fixed',\r\n    top: '0',\r\n    height: '7%',\r\n    // // width: '100%',\r\n    zIndex: '10001',\r\n    borderBottom: '0.5px solid #e6e6e6',\r\n  },\r\n  input:{\r\n    ...AmplifyTheme.input,\r\n    display: 'block',\r\n    width: '100%',\r\n    padding: '16px',\r\n    fontSize: '14px',\r\n    fontFamily: `\"Amazon Ember\", Arial`,\r\n    color: '#152939',\r\n    backgroundColor: '#fff',\r\n    backgroundImage: 'none',\r\n    border: '1px solid #C4C4C4',\r\n    borderRadius: '3px',\r\n    boxSizing: 'border-box',\r\n    marginBottom: '10px',\r\n  },\r\n  button:{\r\n    ...AmplifyTheme.button,\r\n    backgroundColor:'green',\r\n    color: 'blue'\r\n\r\n  },\r\n  navButton:{\r\n    ...AmplifyTheme.navButton,\r\n    backgroundColor:'green',\r\n\r\n  },\r\n  formSection:{\r\n    width: '100%',\r\n    // itemMe: 'blue',\r\n    itemBot: 'red',\r\n    listItemsRed:'green'\r\n  },\r\n  sectionBody: {\r\n    // ...AmplifyTheme.sectionBody,\r\n    itemBot: 'red',\r\n    marginTop:'2%',\r\n    marginLeft:'4%',\r\n    marginBottom:'15%',\r\n    input:'red',\r\n    itemMe:'green',\r\n    m:'blue',\r\n    color:'orange',\r\n  },\r\n  sectionFooter: {\r\n    padding: '.5% 1%',\r\n    /*border-radius: 0 0 5px 5px;*/\r\n    backgroundColor: 'white',\r\n    color: '#FB2700',\r\n    fontSize: '120%',\r\n    // position: 'fixed',\r\n    bottom: '0',\r\n    width: '99%',\r\n    height: '5%',\r\n    zIndex: '10002',\r\n    button: 'blue'\r\n    // boxShadow: '0 16px 24px 2px rgba(0, 0, 0, 0.14), 0 8px 10px -5px rgba(0, 0, 0, 0.2)'\r\n  }\r\n};\r\n```\r\n\r\n\r\n**approach two**\r\nin approach two, i tried importing through scss but to no avail - no effect on the styling at all:\r\n\r\n```\r\n\r\n.amplify-authenticator {\r\n  width: 400px;\r\n  padding: 1em;\r\n  margin: 0 auto;\r\n}\r\n\r\n.amplify-form-input {\r\n  width: 40%;\r\n  margin: 0.5em;\r\n  padding: 0.5em;\r\n  font-size: 15px;\r\n}\r\n\r\n.amplify-form-body {\r\n  padding: 1.5em;\r\n}\r\n\r\n.amplify-form-row {\r\n  display: 'flex';\r\n}\r\n\r\n.amplify-form-cell-left {\r\n  float: left;\r\n  margin: 8px 0 8px 8px;\r\n}\r\n\r\n.amplify-form-cell-right {\r\n  float:right;\r\n  margin: 8px 8px 8px 0;\r\n}\r\n\r\n.amplify-form-link {\r\n  cursor: pointer;\r\n}\r\n\r\n.amplify-form-link:hover {\r\n  color: darkorange;\r\n}\r\n\r\n.amplify-form-button {\r\n  margin: 0.4em 0 0 0.5em;\r\n  padding: 0.5em;\r\n  border: 1px solid silver;\r\n  background-color: #FEFEFE;\r\n  cursor: pointer;\r\n}\r\n\r\n.amplify-form-button:hover {\r\n  color: darkorange;\r\n}\r\n\r\n.amplify-greeting-sign-out {}\r\n\r\n.amplify-footer {\r\n  clear: both;\r\n}\r\n\r\n.amplify-form-message-error {\r\n  margin: 0.5em 0 0.5em 2em;\r\n  clear: both;\r\n  color: orangered;\r\n}\r\n\r\n/** Storage Components **/\r\n\r\n.amplify-photo-picker-container {\r\n  width: 400px;\r\n  margin: 0 auto;\r\n  padding: 1em;\r\n}\r\n\r\n.amplify-photo-picker-preview {\r\n  width: 90%;\r\n}\r\n\r\n.amplify-album-container {\r\n  width: 400px;\r\n  margin: 0 auto;\r\n  padding: 1em;\r\n}\r\n\r\n.amplify-image-container {\r\n  width:80px;\r\n}\r\n\r\n.amplify-image {\r\n  width:80px;\r\n  transition: width 0.5s;\r\n  cursor: pointer;\r\n}\r\n\r\n.amplify-image:hover {\r\n  width:128px;\r\n}\r\n\r\n.amplify-interactions-input{\r\n  font-size: 20px;\r\n  color: #3498db;\r\n}\r\n\r\n.amplify-interactions-response{\r\n  font-size: 20px;\r\n  color: #e74c3c;\r\n}\r\n\r\nimg{\r\n  width: 43%;\r\n}\r\n```\r\n\r\nrender looks like this:\r\n```\r\n  render() {\r\n    return (\r\n    <div className=\"App\">\r\n      <div class=\"row\">\r\n\r\n        <div id=\"chat-header\">\r\n          <span id=\"chat-text\">TestBot</span>\r\n        </div>\r\n\r\n        <div id=\"webchat\"role=\"main\">\r\n        <ChatBot\r\n          title=\"Bot\"\r\n          botName=\"flowerbot_dev\"\r\n          // theme={myTheme}\r\n          welcomeMessage=\"Welcome, how can I help you today?\"\r\n          clearOnComplete={true}\r\n          conversationModeOn={true}\r\n        />\r\n        </div>\r\n\r\n        <div id=\"chat-footer\" >\r\n          <span id=\"chat-link\">\r\n            <a href=\"\"> Lex bot</a>\r\n          </span>\r\n        </div>\r\n\r\n      </div>\r\n\r\n    </div>\r\n    );\r\n  }\r\n```\r\n\r\n\r\n**Looks like this**\r\n\r\n![image](https://user-images.githubusercontent.com/21217850/79328762-05c25100-7f30-11ea-8e91-9a1f001be44b.png)\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"tabrza"},"body":"essentially, it would be nice to know how to style the Chatbot component to the point where i could style the button, the input container, the messages, show an icon, time message was sent etc. to make it look like the way it does on this page: https://aws-amplify.github.io/media/ui_library"}},{"node":{"author":{"login":"ericclemmons"},"body":"@jordanranz With `aws-amplify-react` being in maintenance mode, how should we address overriding styles for those projects?\r\n\r\nPotential solutions:\r\n\r\n- Port `ChatBot` to `@aws-amplify/ui-components` (including `@aws-amplify/ui-react`)\r\n- Remove hashes from CSS modules, so that `Section__container___3YYTG` becomes `Section__container`.  This would allow customers to override classes after including `import '@aws-amplify/ui/dist/style.css';`.\r\n\r\n\tYes, this can [pose a problem for semver](https://twitter.com/ericclemmons/status/1255196146202370049), but with components being in maintenance mode, this can reduce backwards-compatibility work for us.\r\n\r\n    > https://github.com/aws-amplify/amplify-js/blob/a53f3510ca2a3d48a9fa5c1937fe5b748b934be2/packages/amplify-ui/webpack.config.js#L47-L52"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNjcx","author":{"login":"ctlai95"},"title":"How to show multiple upload progress in React?","body":"I have a component that uploads files using `Storage.put()` on submit. I can see its progress in the `progressCallback` parameter. I also have a state hook that keeps track of the ongoing uploads.\r\n\r\n```typescript\r\nconst [uploads, setUploads] = useState();\r\n\r\nconst onSubmit = (file: File) => {\r\n  Storage.put(file.name, file, {\r\n    progressCallback: (progress: any) => {\r\n      console.log(uploads); // always empty\r\n      setUploads({\r\n        ...uploads,\r\n        [filename]: (progress.loaded / progress.total) * 100\r\n      });\r\n    }\r\n  });\r\n}\r\n```\r\n\r\nThe issue I'm having is trying to accumulate the uploads into a state variable so that I can render some progress bars with that information. But the `progressCallback` function doesn't seem to have context to know about the current state of the component, and always tries to append the current progress to an empty object `{}`. Are there any workarounds for this?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"jordanranz"},"body":"Hey @ctlai95,\r\n\r\nCan you provide either a sample application or `App` code to provide context on how you are using this inside of a functional component?"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMTg3","author":{"login":"karrettgelley"},"title":"Client Logging","body":"In my React app there are times when it would be nice to be able to send error logs to the cloud for mining later on. Does anyone know how to send errors to an aws service (cloudwatch?) instead of just logging it to the console?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"jordanranz"},"body":"Hey @karrettgelley,\r\n\r\nThere has been discussion and a tracked feature request for this functionality here:\r\nhttps://github.com/aws-amplify/amplify-js/issues/3524\r\n\r\nThough this is not directly supported out of the box for the Logger, you may be able to extend the Logger and implement the functionality."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNzEz","author":{"login":"ambriglia"},"title":"Graphql nested nextToken query","body":"I am trying to write one query, as opposed to many, to get some information I need utilizing graphql. Here is an example query I am working with... \r\n\r\n```\r\ngetLibrary(id: $libraryId) {\r\n      id\r\n      shelves (limit: $shelfLimit, nextToken: $shelfNextToken) {\r\n        items {\r\n          id\r\n          books(limit: $bookLimit, nextToken: $bookNextToken) {\r\n            items {\r\n              id\r\n              title\r\n              author\r\n            }\r\n            nextToken\r\n          }\r\n        }\r\n        nextToken\r\n      }\r\n    }\r\n```\r\n\r\nI am trying to get all books for a specific library. Can I use a query like the one I have above and make multiple api calls with different nested next tokens? Or do I have to create multiple graphql queries like so...\r\n\r\n```\r\ngetLibrary(id: $libraryId) {\r\n      id\r\n      shelves (limit: $shelfLimit, nextToken: $shelfNextToken) {\r\n        items {\r\n          id\r\n        }\r\n        nextToken\r\n      }\r\n    }\r\n```\r\n\r\nGet all shelves for the library and then get all books per shelf...\r\n\r\n```\r\ngetShelf(id: $shelfId) {\r\n      id\r\n      books(limit: $bookLimit, nextToken: $bookNextToken) {\r\n          items {\r\n            id\r\n            title\r\n            author\r\n          }\r\n          nextToken\r\n       }\r\n    }\r\n```\r\n\r\n","upvoteCount":2,"comments":{"edges":[{"node":{"author":{"login":"RossWilliams"},"body":"Option 1 works."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMDEw","author":{"login":"cdm430"},"title":"What is the difference between Auth.currentCredentials and Auth.currentUserCredentials","body":"I assume that `Auth.currentUserCredentials` returns tokens that correspond to the authenticated role? \r\n\r\nWhat happens when the default auth mode is not userpools, but IAM. Will `Auth.currentUserCredentials` still return authenticated credentials and `Auth.currentCredentials` still return unauthenticated credentials?\r\n\r\nWhen making calls like `storage.get()`, will the credentials for the pre-signed url always be the ones returned from `Auth.currentUserCredentials`? Or is there a fallback to the unauthenticated credentials?\r\n\r\nThanks!","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xOTM1","author":{"login":"hiroyukinuri"},"title":"Multi tab login/logout implementation?","body":"I was wondering if there's a way or plans to integrate multi-tab login/logout like Firebase Auth?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"RossWilliams"},"body":"you can do it yourself in a few lines of code using BroadcastChannel, or you can pass messages between tabs using localstorage event listeners."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNTM1","author":{"login":"Tamanko"},"title":"Auth.currentAuthenticatedUser() returns null after SignIn","body":"I have an app that I have no issue signing into but after it signs in successfully, running the Auth.currentAuthenticatedUser() returns null.\r\n\r\nWhat I am I doing wrong? \r\n\r\nHere is the current code I am using\r\n`\r\nasync function handleSubmit(event) {\r\n    event.preventDefault();\r\n    \r\n    try {\r\n      await Auth.signIn({\r\n        username: (getFieldValue('email')),\r\n        password: (getFieldValue('password'))\r\n      }).then(user => console.log(user))\r\n      \r\n      Auth.currentAuthenticatedUser({\r\n        bypassCache: false\r\n      })\r\n      .then(user=> alert(JSON.stringify(user)));\r\n      \r\n      validateFields((err, values) => {\r\n        if(err)\r\n        {\r\n          notification.error({\r\n            message: 'Error',\r\n            description: Object.values(err)[0].errors[0].message,          \r\n          });\r\n        }\r\n`","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"Tamanko"},"body":"Is anyone able to help me with this? I posted 6 days ago and have not gotten any response"}},{"node":{"author":{"login":"antikvarBE"},"body":"Recently upgraded all versions of aforementioned modules but am still getting the same error. Any thoughts anyone? Bumping this up a bit."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xODQ4","author":{"login":"keponk"},"title":"Change/Update source repo","body":"I've renamed the source repo my aplify project was connected to. I can't seem to find a way to update this on the project.\r\n\r\nThere is no configuration change whatsoever other than the repo name in CodeCommit. Is there a way to update the project or do I need to create one from scratch?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"keponk"},"body":"Lonjg story short we created a new project for the newly renamed git repo.\r\n\r\nAlso we needed to recreate the amplify envs but this may have had more to do with my limited knowledge of the tool. In any case, a project from scratch seems like a good idea given that the configs are already saved. It took only 5mins to recreate the envs."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xOTUx","author":{"login":"syang"},"title":"Can Amplify 'manual setup' override or change the Cognito configuration on AWS console?","body":"I am using Amplify's manual setup https://aws-amplify.github.io/docs/js/authentication#manual-setup:\r\n\r\n        ......\r\n        oauth: {\r\n            domain: 'your_cognito_domain',\r\n            scope: ['phone', 'email', 'profile', 'openid', 'aws.cognito.signin.user.admin'],\r\n            redirectSignIn: 'http://localhost:3000/',\r\n            redirectSignOut: 'http://localhost:3000/',\r\n            responseType: 'code'\r\n        }\r\n\r\nAnd my Cognito User Pool Console was configured as follows:\r\n\r\n![Screen Shot 2020-04-26 at 7 38 35 AM](https://user-images.githubusercontent.com/188004/80310775-47a19180-8791-11ea-8a58-4e2b59a395fb.png)\r\n\r\nSo we can see _**responseType: 'code'**_ in the Amplify manual setup config is conflicting to the User Pool Console configuration. What behavior would the result in? Will my app get a 'code' or 'token' response type?\r\n\r\n\r\nI also see my app's scope             **_scope: ['phone', 'email', 'profile', 'openid', 'aws.cognito.signin.user.admin'],_** is conflicting my User Pool Console configuration, what scope will my app get?\r\n\r\nI think the question is boiled down to which one will be the ultimate truth for my app, Amplify configure (in the client code) or my User Pool configure (in the AWS console).\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24yMDAw","author":{"login":"nuthankumarhr"},"title":"Greetings header in withAuthenticator is taking unnecessary space","body":"\r\n![WhatsApp Image 2020-04-25 at 10 24 56 PM](https://user-images.githubusercontent.com/64323880/80285678-2d8d9200-8744-11ea-92b6-4e7134a03a90.jpeg)\r\n\r\n\r\nis there any solution to this problem??? ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xOTA2","author":{"login":"rahulje9"},"title":"AWS Pubsub Publish no internet case","body":"Hi,\r\n\r\nI have created a React Native IOT application which uses pubsub to publish the changes made in the app. I have an issue when I try to update the value while I don't have internet reachability the pubsub is getting publish success rather than publish fail. to recreate my issue while using the app, just remove the network cable from modem so that you won't get internet connectivity while the wifi is still on. I tried to get the success message from the method and I'm getting `[undefined]`.","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xODQw","author":{"login":"rberger"},"title":"Latest version of @aws-amplify causes The required JS dependency \"http2\" is not available","body":"With my package.json having something like:\r\n```\r\n{\r\n    \"dependencies\": {\r\n        \"aws-amplify\": \"^3.0.8\",\r\n        \"aws-amplify-react\": \"^4.1.7\",\r\n        \"highlight.js\": \"9.15.10\",\r\n        \"react\": \"16.9.0\",\r\n        \"react-dom\": \"16.9.0\",\r\n        \"react-highlight.js\": \"1.0.7\"\r\n}\r\n```\r\n\r\nI get the following when the program is built:\r\n```\r\nThe required JS dependency \"http2\" is not available, it was required by \"node_modules/@aws-sdk/node-http-handler/build/node-http2-handler.js\".\r\n```\r\n\r\nIf I switch back to an earlier version:\r\n```\r\n{\r\n    \"dependencies\": {\r\n        \"aws-amplify\": \"^2.2.7\",\r\n        \"aws-amplify-react\": \"^3.1.0\",\r\n        \"highlight.js\": \"9.15.10\",\r\n        \"react\": \"16.9.0\",\r\n        \"react-dom\": \"16.9.0\",\r\n        \"react-highlight.js\": \"1.0.7\"\r\n    }\r\n```\r\n\r\nEverything works right.\r\n\r\n* node --version: v14.0.0\r\n* npm --version 6.14.4\r\n\r\nI am running this with [shadow-cljs](http://shadow-cljs.org), but I hope that is not the issue.\r\n\r\nAlso with the latest version I get a bunch of npm warns when first doing `npm install`:\r\n```\r\nnpm WARN aws-amplify-react@4.1.7 requires a peer of @aws-amplify/analytics@^2.0.0 but none is installed. You must install peer dependencies yourself.\r\nnpm WARN aws-amplify-react@4.1.7 requires a peer of @aws-amplify/api@^2.0.0 but none is installed. You must install peer dependencies yourself.\r\nnpm WARN aws-amplify-react@4.1.7 requires a peer of @aws-amplify/auth@^2.0.0 but none is installed. You must install peer dependencies yourself.\r\nnpm WARN aws-amplify-react@4.1.7 requires a peer of @aws-amplify/core@^2.0.0 but none is installed. You must install peer dependencies yourself.\r\nnpm WARN aws-amplify-react@4.1.7 requires a peer of @aws-amplify/interactions@^2.0.0 but none is installed. You must install peer dependencies yourself.\r\nnpm WARN aws-amplify-react@4.1.7 requires a peer of @aws-amplify/storage@^2.0.0 but none is installed. You must install peer dependencies yourself.\r\nnpm WARN aws-amplify-react@4.1.7 requires a peer of @aws-amplify/xr@1.1.5 but none is installed. You must install peer dependencies yourself.\r\nnpm WARN @aws-amplify/api@3.1.7 requires a peer of @aws-amplify/pubsub@^2.1.1 but none is installed. You must install peer dependencies yourself.\r\nnpm WARN @aws-amplify/core@3.2.4 requires a peer of @react-native-community/netinfo@^5.5.0 but none is installed. You must install peer dependencies yourself.\r\nnpm WARN @aws-amplify/api-graphql@1.0.9 requires a peer of @aws-amplify/pubsub@^2.1.1 but none is installed. You must install peer dependencies yourself.\r\n```\r\n\r\nWith the older versions of aws-amplify and was-amplify-react I get only a few. I have no idea what to do about these ether.\r\n```\r\nnpm WARN aws-amplify-react@3.1.9 requires a peer of @aws-amplify/ui@^2.0.0 but none is installed. You must install peer dependencies yourself.\r\nnpm WARN @aws-amplify/api@2.2.1 requires a peer of @aws-amplify/pubsub@^1.2.4 but none is installed. You must install peer dependencies yourself.\r\nnpm WARN @aws-amplify/core@2.3.0 requires a peer of @react-native-community/netinfo@^5.5.0 but none is installed. You must install peer dependencies yourself.\r\n```\r\n\r\nAny help would be appreciated!!!\r\nThanks","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"rberger"},"body":"With the help Thomas Heller (author of shadow-cljs). Seems that a node require in `@aws-sdk/node-http-handler/build/node-http2-handler.js` was leaking into the npm requires (or something like that, I didn't completely understand the relationship)\r\n\r\nI was able to fix the issue of http2 require leaking out by adding `:js-options {:resolve {\"http2\" false}}` to the shadow-cljs.edn build block. (Heres a snippet of the fixed shadow-cljs.edn):\r\n\r\n```\r\n{:deps   true\r\n\r\n :nrepl {:port 8777}\r\n\r\n  :builds** {:app {:target          :browser\r\n                :output-dir      \"resources/public/js/compiled\"\r\n                :asset-path      \"/js/compiled\"\r\n                :modules         {:app {:init-fn omnyway.mock-checkout-page.core/init\r\n                                        :preloads [devtools.preload\r\n                                                   day8.re-frame-10x.preload]}}\r\n                :dev             {:compiler-options {:closure-defines {re-frame.trace.trace-enabled?        true\r\n                                                                       day8.re-frame.tracing.trace-enabled? true}}}\r\n                :devtools        {:http-root    \"resources/public\"\r\n                                  :http-port    8280\r\n                                  }\r\n                :js-options {:resolve {\"http2\" false}}}}}\r\n```\r\n\r\n"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xODUy","author":{"login":"vaclav-slavik"},"title":"Customizing input and button font family in authenticator web components","body":"I'm struggling to find a way to customize `Authenticator` components to use desired font for form inputs and buttons.\r\n\r\nI'm using `--amplify-font-family` css property to set the font family for `Authenticator` component. However, as inputs and buttons do not have explicitly defined font-family in css, I end up with those using default client font (apple system font in my case).\r\n\r\n<img width=\"1680\" alt=\"obrazek\" src=\"https://user-images.githubusercontent.com/14313898/80210105-73a70080-8633-11ea-9132-c2cfa0d33e68.png\">\r\n\r\nThe proposed solution would be to set the `font-family` in `AmplifyInput` and `AmplifyButton` web components to `inherit` or explicitly use `--amplify-font-family` css property so it uses the same fonts all over the `Authenticator` component.\r\n\r\n![obrazek](https://user-images.githubusercontent.com/14313898/80210397-ff209180-8633-11ea-85e5-47b4958976ab.png)\r\n\r\nWould this make any sense?\r\n\r\nThanks for you time and effort and for Amplify initiative","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xODI5","author":{"login":"danrivett"},"title":"The Network is Not Reliable: Auth Retry approach?","body":"I'm trying to understand two things:\r\n\r\n1. Does this Amplify JS library handle request retries automatically for certain classes of transient errors such as network errors?\r\n    1. If so, I'd love to know more details so I can avoid duplicating handling (and likely in a much worse manner)\r\n    2. If not, why not? Genuinely. For example the `Auth.signUp()` function abstracts a lot of the underlying network requests away, so I would think that for non-application, network errors, it would be its responsibility to retry, supporting some optional configuration to tune that if desired.\r\n    3. As a big class of usage of this library is from mobile apps which are notorious for having spotty connectivity, I think it would be a big win to have some automatic retry capability built in if not already present.\r\n\r\n2. If the requestor is on the hook to determine which errors to retry and retry all retryable errors, does anyone have any strategy recommendations on what errors to retry, and what errors to not retry etc.?\r\n    1. From browsing this repo, it appears that network errors - going off [here](https://github.com/aws-amplify/amplify-js/blob/master/packages/amazon-cognito-identity-js/src/Client.js#L92-L94) at least - are reported with a `code: 'NetworkError'` field on the error returned.\r\n    2. So my naive thoughts would be to retry for errors returned with that particular `code` value, and not retry others, but I'm not sure if that is sufficient for all network errors, or if there are other error codes that are also retryable; if there's any documentation around this that would be helpful.\r\n\r\nSpecifically I'm looking at retry approaches to the `Auth` methods such as:\r\n\r\n- `Auth.signUp()`\r\n- `Auth.signIn()`\r\n- `Auth.signOut()`\r\n- etc...\r\n\r\nBut of course it applies to many other service calls.","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xODEz","author":{"login":"albertbenitez"},"title":"The new @aws-amplify/ui-vue has features missing","body":"I've been playing with the **amplify-authenticator** and **amplify-sign-in** components but the Properties like: \r\n- federated\r\n- formFields\r\n- handleAuthStateChange\r\n- handleSubmit\r\n\r\nThey are not working or they lack documentation to make it work.\r\nAnyone having the same issues with the **Vue** components?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"albertbenitez"},"body":"This seems to fix the issue, for almost all of them\r\nhttps://github.com/aws-amplify/amplify-js/issues/5363#issuecomment-618627713\r\n\r\n- federated\r\n- ~~formFields~~\r\n- ~~handleAuthStateChange~~\r\n- ~~handleSubmit~~\r\n"}},{"node":{"author":{"login":"albertbenitez"},"body":"Federated issue solved in the new docs:\r\nhttps://github.com/aws-amplify/amplify-js/tree/master/packages/amplify-ui-components#amplify-authenticator-federated"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNzIy","author":{"login":"Jun711"},"title":"Is there a page that lists what need to be done when updating?","body":"I am using aws-amplify 1.1.24. \r\nI just checked today. It is now aws-amplify@3.0.8 and it was aws-amplify@2.3.0 23 days ago and it was aws-amplify@1.3.3 on Jan 10\r\n\r\nIs there any breaking changes? \r\nHow do I check? ","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"mauerbac"},"body":"@Jun711 - Hello! Good question. Breaking changes for 3.X.X are listed here: https://github.com/aws-amplify/amplify-js#notice"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xODAx","author":{"login":"justinneff"},"title":"How to refresh credentials after 50 minutes?","body":"In the recent PR #4205, it indicates that it should refresh the credentials 50 minute after they were issued. However, I'm having difficulties actually getting this to happen. My AWSAppSyncClient is configured to set the auth header following the [Cognito User Pool example in the docs](https://docs.amplify.aws/lib/graphqlapi/authz/q/platform/js#cognito-user-pools).\r\n\r\nBased on what I am seeing `Auth.currentSession()` isn't refreshing the token until after they expire not 10 minutes before as I would have expected based on the PR change.\r\n\r\nAm I missing something here?","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMjY0OA==","author":{"login":"Groot90"},"title":"Problems with callback url being on different domain than SPA","body":"** Which Category is your question related to? **\r\nAuth\r\n** What AWS Services are you utilizing? **\r\nCognito\r\n** Provide additional details e.g. code snippets **\r\nI'm trying to have a single Cognito User Pools auth sign in callback url ( redirectSignIn in Amplify's terms). However, the app I'm building needs to be able to run from multiple (many) domains.\r\n\r\nI'm not sure why it doesn't seem to be possible to have Amplify.Auth.oAuth.redirectSignIn url hosted on a different domain than  the React application (SPA)? \r\n\r\nWhat if the React app needs to be run from multiple domains? I see that customState parameter can be used to identify the actual domain sending the login request, but I'm having issues when trying that approach. Any time I get a redirect back from the central callback url to the React App, React app fails with the following JS error:\r\n\r\nEVENT AUTH HUB: index.js:115\r\nObject { event: \"customOAuthState\", data: \"http__colon____forward____forward__localhost__colon__3001\", message: \"State for user Google_111083168159815163414\" }\r\nindex.js:116\r\n[DEBUG] 25:10.750 AuthClass - Error in cognito hosted auth response DOMException: \"The operation is insecure.\"\r\n\r\nIt seems to be generated by replaceState() in this file\r\nhttps://github.com/aws-amplify/amplify-js/blob/cf8738ac5e7961a163ce158a7383bc27f693475f/packages/auth/src/Auth.ts\r\n\r\n(line 1886),  function _handleAuthResponse\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"Groot90"},"body":"To add some more context here:\r\nI'm trying to implement \"State\" parameters redirection, described here, using Amplify + Cognito User Pools:\r\nhttps://auth0.com/docs/users/guides/redirect-users-after-login#keep-reading\r\n\r\nThis replaceState() call seems to be added on April 8, 2019, here:\r\nhttps://github.com/aws-amplify/amplify-js/blob/76cde598c30ee8049798e5988261db9165cc775e/packages/auth/src/Auth.ts\r\n\r\nThis issue could be related as well:\r\nhttps://github.com/aws-amplify/amplify-js/issues/4388\r\n\r\nBTW, I'm using federatedSign() with Google as IdP, and I'm also sending customState string.\r\nThe login seems to work when I disable Hub.listener() and window.LOG_LEVEL.\r\n\r\nOverall, this replaceState() call seems to be forcing callback url (redirectSignIn) to be on the very same domain as the React app itself. Is there any workaround for this limitation? "}},{"node":{"author":{"login":"Groot90"},"body":"The code change in PR #5062 seems to be working - callback url on another domain can be used this way. However, I'd like to hear your comments on this issue. I'm wondering why this is needed? Was this intended behavior or a bug? Thank you!"}},{"node":{"author":{"login":"AntonioAngelino"},"body":"We have exactly the same use case and issue described by @Groot90 !\r\nWe need to redirect the user to a route that is not `oauth.redirectSignIn`.\r\n\r\nI'd suggest implementing the solution explained by @hotgazpacho here: https://github.com/aws-amplify/amplify-js/issues/3391 \r\n> I would expect that the location would not be replaced on successful federated sign in, OR, allow consumers to configure (preferably at call time) the URL to redirect to after successful sign in, keeping it separate from the callback URL.\r\n\r\n\r\n"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNjk2","author":null,"title":"I'm trying to fetch row from the dynamodb table","body":"Here is my lambda function for get request\r\n\r\n\r\napp.get(path + hashKeyPath + sortKeyPath, function(req, res) {\r\n  var params = {};\r\n  if (userIdPresent && req.apiGateway) {\r\n    params[partitionKeyName] = req.apiGateway.event.requestContext.identity.cognitoIdentityId || UNAUTH;\r\n  } else {\r\n    params[partitionKeyName] = req.params[partitionKeyName];\r\n    try {\r\n      params[partitionKeyName] = convertUrlType(req.params[partitionKeyName], partitionKeyType);\r\n    } catch(err) {\r\n      res.statusCode = 500;\r\n      res.json({error: 'Wrong column type ' + err});\r\n    }\r\n  }\r\n  if (hasSortKey) {\r\n    try {\r\n      params[sortKeyName] = convertUrlType(req.params[sortKeyName], sortKeyType);\r\n    } catch(err) {\r\n      res.statusCode = 500;\r\n      res.json({error: 'Wrong column type ' + err});\r\n    }\r\n  }\r\n\r\n  let getItemParams = {\r\n    TableName: tableName,\r\n    Key: params\r\n  }\r\n\r\n  dynamodb.get(getItemParams,(err, data) => {\r\n    if(err) {\r\n      res.statusCode = 500;\r\n      res.json({error: 'Could not load items: ' + err.message});\r\n    } else {\r\n      if (data.Item) {\r\n        res.json(data.Item);\r\n      } else {\r\n        res.json(data) ;\r\n      }\r\n    }\r\n  });\r\n});\r\n\r\n\r\nHere is my code :\r\nin app.js\r\n async componentDidMount(){\r\n    Auth.currentAuthenticatedUser()\r\n      .then(user => {\r\n        \r\n        const details = user.attributes;\r\n        this.setState({name: details.name})\r\n        this.setState({email: details.email})\r\n        this.setState({phone: details.phone_number})\r\n        this.setState({id: details.sub})\r\n        console.log(this.state.id)\r\n\r\n        const hashkeypath = '/:' +this.state.id;\r\n        API.get('applicantprofessionaldetails', `/details` + hashkeypath  )\r\n          .then( response => {\r\n            console.log('response from db', response)\r\n          })\r\n      })\r\n  }\r\n\r\nwith the above code I get 304 (a empty array)","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNjgz","author":{"login":"kennand"},"title":"When using Amplify JS, how does the \"Do you want to remember your user's devices?\" in Cognito dashboard function?","body":"Hi - when using Amplify JS, how does the \"Do you want to remember your user's devices?\" in Cognito dashboard function? Should I leave it off? It seems like my localstorage persists either way...","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNjQ0","author":{"login":"thesmeexperts"},"title":"Authenticator component customisation","body":"Hello,\r\n\r\nI've decided to upgrade aws-amplify to the lastest version and remove soon deprecated aws-amplify-react library from my project. \r\n\r\nThe problem that I ran into is that I am no longer able to pass a list of auth components.\r\n\r\n**Before the upgrade I could simply do this:** \r\nexport default withAuthenticator(App, false, [\r\n  SignIn ,\r\n  ConfirmSignIn ,\r\n  VerifyContact ,\r\n  ForgotPassword ,\r\n  RequireNewPassword ,\r\n  ConfirmSignUp ,\r\n  Loading ,\r\n]);\r\n\r\nAfter the upgrade, this no longer works. I tried to find something in the documentation but miserably failed. Could anyone help me out with an example of how to configure withAuthenticator with only components that I need? \r\n\r\nMany thanks\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMzU0","author":{"login":"Johnniexson"},"title":"Accessing unprotected data from the DynamoDB table with DataStore.","body":"Hello, In one of my amplify projects, i'm using cognito user pool for authentication and it seems the user must be authenticated to access any of the AWS service such as reading from the DynamoDB table. But on my landing page, i need to retrieve some public data from the database before authenticating the user, also i have a protected route that can only be accessed based on the data provided by an unauthenticated user, i use this data to query the DynamoDB table to grant access to the route. But AWS deny access (see screenshot below)\r\n![amplify error](https://user-images.githubusercontent.com/33484116/79339400-bcb6d080-7f20-11ea-8b1c-ae9b98efca00.jpg)\r\n. Any way i can fix this? Kind regards.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"dabit3"},"body":"Hey John,\r\n\r\nYou can create a public REST API & connected Lambda function that you can give read access to the DynamoDB table if you'd like, or if you are using GraphQL / AppSync, you can use multi-auth (authenticated + unauthenticated access).\r\n\r\nhttps://docs.amplify.aws/lib/graphqlapi/query-data?platform=js#custom-authorization-mode"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMTgw","author":{"login":"karrettgelley"},"title":"Storage Configuration with Modular Imports","body":"How do I configure the Storage module if I'm using modular imports? I keep getting this weird error 'No Credentials' whenever I tried to call Storage.put(). My issue seems to be related to a few old issues (#3744, #5354), but I can't get my app to work with any of the solutions. It seems like the new modular imports require me to configure Storage in some particular way, but I can't find any documentation on it. \r\n\r\nCan any one help? I provided some pictures of my current setup below\r\n\r\nDebug Logs (while calling Storage.put)\r\n![Screen Shot 2020-04-11 at 4 23 51 AM](https://user-images.githubusercontent.com/31458115/79040282-129c1900-7bad-11ea-9185-5d9021e9ad49.png)\r\n\r\nindex.js (at root of app)\r\n![Screen Shot 2020-04-11 at 4 30 25 AM](https://user-images.githubusercontent.com/31458115/79040311-2f385100-7bad-11ea-977b-5f43ac1bc1c7.png)\r\n\r\npackage.json\r\n![Screen Shot 2020-04-11 at 4 32 31 AM](https://user-images.githubusercontent.com/31458115/79040365-80484500-7bad-11ea-9e87-6b92a6279aef.png)\r\n\r\nThe call to Storage.put looks something like this:\r\nimport Storage from '@aws-amplify/storage';\r\n...\r\nasync function uploadPic() {\r\n    await Storage.put('/pictures/testpic', <an image file>, { level: 'protected', contentType: <image file type>});\r\n}","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"karrettgelley"},"body":"I solved this by uninstalling the storage module and reinstalling."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNjE5","author":{"login":"VicFrolov"},"title":"API (GraphQL) - How do you create many connections to one Photo schema object?","body":"Let's say you have a Product and a Brand. Product has an array of photos, and brand has both a \"cover\" photo, and then also another array of photos:\r\n```\r\ntype Product {\r\n  id: ID!\r\n  photos: [Photo] @connection(name: \"ProductPhotos\")\r\n}\r\n\r\ntype Brand {\r\n  id: ID!\r\n  coverPhoto: Photo @connection(name: \"BrandCoverPhoto\")\r\n  photos: [Photo] @connection(name: \"BrandPhotos\")\r\n}\r\n\r\ntype Photo {\r\n  id: ID!\r\n  bucket: String!\r\n  fullsize: PhotoS3Info!\r\n  thumbnail: PhotoS3Info!\r\n  brandCoverPhoto: Brand @connection(name: \"BrandCoverPhoto\")\r\n  brandPhotos: Brand @connection(name: \"BrandPhotos\")\r\n  productPhotos: Product @connection(name: \"ProductPhotos\")\r\n}\r\n```\r\n\r\nIf this is correct, this feels like Photo will become pretty bloated, especially if you have a bunch of other models that require photos, but perhaps this is the best practice approach?\r\n\r\nIf this is not correct, how would you make one type of Photo, that can be shared by a large list of types, e.g. Product, Brand, User, Seller, Buyer, etc, that only have access to their respective photos in the schema?\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"mauerbac"},"body":"Hi @VicFrolov - this seems like a great GraphQL general question. I'll convert this to a discussion. "}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMzc0","author":{"login":"JohnAtFenestra"},"title":"AppSync Javascript PWA client not persisting queued mutations after close","body":"I am opening this question after a discussion with AWS Premium Support.\r\n\r\n# Background\r\n\r\nThis is proof-of-concept demonstration of a design solution which uses the following:\r\n\r\n- Quasar/Vue PWA client app\r\n- AppSync endpoint\r\n- Lambda resolvers\r\n- Resolvers communicate via HTTPS with REST API used to talk to an on-premises SQL Server database\r\n\r\nThere is one query and one mutation:\r\n\r\n```javascript\r\nexport const getSchool = /* GraphQL */ `\r\n  query GetSchool($schoolId: ID!) {\r\n    getSchool(schoolId: $schoolId) {\r\n      schoolId\r\n      schoolName\r\n      schoolAddress1\r\n      schoolCity\r\n      schoolState\r\n      schoolZipcode\r\n    }\r\n  }\r\n`;\r\n\r\nexport const updateSchool = /* GraphQL */ `\r\n  mutation UpdateSchool($input: SchoolInput) {\r\n    updateSchool(input: $input) {\r\n      schoolId\r\n      schoolName\r\n      schoolAddress1\r\n      schoolCity\r\n      schoolState\r\n      schoolZipcode\r\n    }\r\n  }\r\n`;\r\n```\r\nWe are using the Amplify SDK to support offline mode. AppSync is configured for offline:\r\n\r\n```javascript\r\n...\r\nconst options = {\r\n  defaultOptions: {\r\n    watchQuery: {\r\n      fetchPolicy: 'cache-and-network'\r\n    },\r\n    connectToDevTools: true, // Remove this for production use\r\n    disableOffline: false\r\n  }\r\n}\r\n\r\nconst client = new AWSAppSyncClient(config, options)\r\n...\r\n```\r\n\r\nThe mutation is being wrapped in ```buildMutation```\r\n\r\n```javascript\r\n    updateSchool() {\r\n      this.$apollo.mutate(buildMutation(\r\n        this.$apollo,\r\n        gql(updateSchool),\r\n        {\r\n          inputType: gql(inputSchool),\r\n          variables: {\r\n            input: this.buildSchoolUpdatesInput()\r\n          }\r\n        },\r\n      )).then(data => console.log(data))\r\n      this.commitSchoolUpdates()\r\n    }\r\n```\r\n# The Problem\r\n\r\nThere are 5 scenarios we are testing:\r\n\r\n1. When the app is connected to the Internet, changing a field value and clicking update (calls updateSchool) updates the database. **This works**\r\n2. If the app is disconnected from the Internet, changing a field value and clicking update updates the current state of the app. The mutation is queued and sent when the network connection is reenabled. **This works**\r\n3. If the app is started with the Internet disconnected, the data should load from the local store. **This works**\r\n4. If the app is disconnected from the Internet, changing a field value and clicking update updates the current state of the app. If the app is then closed and reopened, with the network disconnected, the state should include the queued mutation. **This does not work**\r\n\r\n5. If the app is disconnected from the Internet, changing a field value and clicking update updates the current state of the app. If the app is then closed, the network reconnected, and the app reopened the mutation queue should update the database. **Blocked by 4**\r\n\r\n# What I have done so far\r\n\r\nIn addition to the support call with AWS Premium, I have reviewed the documentation at:\r\n\r\nhttps://aws-amplify.github.io/docs/js/api#client-architecture\r\n\r\nThis documentation appears to suggest that step 4 should work.\r\n\r\n# The Question\r\n\r\nIs the failure of scenario 4 working as designed? Is there some additional configuration necessary to persist the mutation queue? Am I missing something obvious?\r\n\r\nThank you","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"JohnAtFenestra"},"body":"For the record, I resolved this at least partially by abandoning ```buildMutation``` and implementing my own ```optimisticResponse``` and update routines. It turns out that, at least in my application (see above), ```buildMutation``` returns a ```null``` for ```optimisticResponse```.\r\n\r\nThe next issue I am dealing with is an apparent race condition where if one follows this sequence, the display shows the previous state rather than the mutated, even though the mutation is executed correctly. A refresh displays the correct information from the server.\r\n\r\n1. Disconnect from network\r\n0. Enter an update and save it. The saved update is recorded as an enqueued mutation\r\n0. Shut down the machine (in this case a VM)\r\n0. Reconnect the network\r\n0. Restart the machine\r\n0. Reopen the app\r\n\r\nBecause of the current design of the app, the main page shows immediately. As I follow the sequence, the ```getSchool``` query fires off on page load **_before_** the enqueued mutation is sent to the server. Therefore, the reactive elements display the stale data from the server even as the same application is sending an update. I'll be investigating this one tomorrow."}},{"node":{"author":{"login":"JohnAtFenestra"},"body":"For the historical record, I've opened a new support case with AWS Premium Support, Amplify Framework, to address this issue. From what I can tell, I have uncovered an edge case bug."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNTg2","author":{"login":"chai86"},"title":"How do I get the 'id' of a database entry from a userName field?","body":"@iartemiev I'm using AWS Amplify on my react native app, DynamoDB through GraphQL\r\n\r\nI want to do something seemingly so simple, but i am a bit lost as to how to do it: I have a table with user information already in it. Here's the Schema:\r\n\r\n\r\n    type Users @model {\r\n      id: ID!\r\n      userName: String\r\n      firstname: String\r\n      weblink: String\r\n      email: String\r\n      mobileNum: String\r\n     .\r\n     .\r\n     .\r\n    }\r\n    \r\n    \r\n    //**Here's my current Query.js**\r\n    export const getUsers = `query GetUsers($id: ID!) {\r\n      getUsers(id: $id) {\r\n        id\r\n        userName\r\n        firstname\r\n        weblink\r\n        email\r\n        .\r\n        .\r\n        .\r\n      }\r\n    }\r\n    `;\r\n\r\nThis table is populated in DynamoDB when i check my AWS console. What i need is to be able to get the id from the table using the userName (not vice versa). The id is generated when i createUser() and it's used throughout my app to get all my user's information. However when a user signs in on a new phone, this id isn't available anymore. So when they sign in via Cognito, i do know the userName and all i need to do is retrieve this id. Because there's only one unique **userName**, it should only return one **id**\r\n\r\nHere's what i'm thinking so far: use a GSI (global secondary index). So change my schema to: \r\n\r\n\r\n    type Users @model\r\n        @key(\r\n           name: \"ByUsername\"\r\n           fields: [\"userName\"]\r\n           queryField: \"getIdFromUserName\"\r\n        )  \r\n    {\r\n      id: ID!\r\n      userName: String\r\n      firstname: String\r\n      weblink: String\r\n      email: String\r\n      mobileNum: String\r\n     .\r\n     .\r\n     .\r\n    }\r\n\r\n\r\nThen call in my app:\r\n\r\n    const data = await API.graphql(graphqlOperation(getIdFromUserName, { userName }));\r\n\r\n\r\n5 questions: \r\n\r\n1) Is there a simpler way than GSI? e.g. create a Mutation to query getUsers by userName instead of id\r\n\r\n2) Is that how you add the GSI? Or is it more robust to do it in the AWS console?\r\n\r\n3) What should my **Query.js** then look like?\r\n\r\n4) Do i need to make a custom resolver, or is this sufficient?\r\n\r\n5) Am i missing anything else, or can i just \r\n\r\n    amplify push  ?\r\n\r\n","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNTc1","author":{"login":"saevarb"},"title":"DataStore observe for connected objects returns shallow objects","body":"I have a model which serves as a M-M model with two connections. `Foo`, `Bar` and the M-M model `FooBar` which is roughly\r\n\r\n```graphql\r\ntype FooBar @model {\r\n   id: ID!\r\n   foo: Foo @connection\r\n   bar: Bar @connection\r\n}\r\n```\r\n\r\nWhen I create a new connection, the subscription receives an `INSERT` and then an `UPDATE` with timestamps and such, but both times, the object only contains `fooId` and `barId` with the respective IDs, but not the actual nested objects. This is problematic because when I then filter `fooBars.filter(fb => fb.foo.id === someFoo.id)`, the object that I just added to my local state from the subscription event is not included because its nested object isn't there. \r\n\r\nI have noticed that when I call `DataStore.save`, the returned object does contain the nested objects, and I have found that I can likewise do `DataStore.query(FooBar, msg.element.id)` to retrieve it. If I do the latter, can I be relatively sure that I'm hitting the data store cache instead of performing a network request? ","upvoteCount":1,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNDA4","author":{"login":"bregan"},"title":"Does DataSture in React app have to be run in a browser or can it be run under jest in tests.","body":"Summary:\r\nDoes DataStore have to be run in an actual browser?  I am trying to run it under jest in a create-react-app project and it is not working. Just in the tests.  The app itself is working fine.  Also using the API.graphql also works fine in the tests.\r\n\r\nLonger description with examples:\r\nI have a Amplify React app setup using DataStore.  The app is working fine and when running the server I am get a list of Expenses from the datastore.  But when I try to set up automated tests in jest, the DataStore will not work.\r\n\r\nIn the automated tests the API.graphql fetches the same data successfully.\r\n\r\nI spent some time googling for examples and found nothing showing DataStore being run in jest automated test. Either directly or rendering the dom using @testing-library/react.\r\n\r\nI have attached two example of my tests below\r\n\r\nExample 1 : API.graphql (works fine),  DataSture (fails with Node not supported see below test for output.)\r\n-------------------------------------------------------------------------------------\r\nimport React from \"react\";\r\nimport Amplify, {API, graphqlOperation} from \"aws-amplify\";\r\nimport '@testing-library/jest-dom/extend-expect'\r\n\r\nimport awsExports from \"../aws-exports.js\";\r\nimport {DataStore} from \"@aws-amplify/datastore\";\r\nimport {Expense} from '../models';\r\n\r\nimport { listExpenses} from \"../graphql/queries\";\r\n\r\nAmplify.configure(awsExports);\r\n\r\ntest('test API  ', async () => {\r\n\r\n\tconst expenses = await API.graphql(graphqlOperation(listExpenses, {limit: 100}))\r\n\r\n\texpect(expenses.data.listExpenses.items.length).toBe(2);\r\n\r\n});\r\n\r\ntest('should load expenses directly', async () =>{\r\n\r\n\t\tconst expenses = await DataStore.query(Expense);\r\n\r\n\t\texpect(expenses.length).toBe(2);\r\n\t}\r\n)\r\n\r\nOutput:\r\n  ● should load expenses directly\r\n\r\n    Node is not supported\r\n\r\n      21 | test('should load expenses directly', async () =>{\r\n      22 | \r\n    > 23 |              const expenses = await DataStore.query(Expense);\r\n         |                                               ^\r\n      24 | \r\n      25 |              expect(expenses.length).toBe(2);\r\n      26 |      }\r\n\r\n--------------------------  ● should load expenses directly\r\n\r\n    Node is not supported\r\n\r\n      21 | test('should load expenses directly', async () =>{\r\n      22 | \r\n    > 23 |              const expenses = await DataStore.query(Expense);\r\n         |                                               ^\r\n      24 | \r\n      25 |              expect(expenses.length).toBe(2);\r\n      26 |      }\r\n  ● should load expenses directly\r\n\r\n    Node is not supported\r\n\r\n      21 | test('should load expenses directly', async () =>{\r\n      22 | \r\n    > 23 |              const expenses = await DataStore.query(Expense);\r\n         |                                               ^\r\n      24 | \r\n      25 |              expect(expenses.length).toBe(2);\r\n      26 |      }\r\n  ● should load expenses directly\r\n\r\n    Node is not supported\r\n\r\n      21 | test('should load expenses directly', async () =>{\r\n      22 | \r\n    > 23 |              const expenses = await DataStore.query(Expense);\r\n         |                                               ^\r\n      24 | \r\n      25 |              expect(expenses.length).toBe(2);\r\n      26 |      }\r\n\r\n--------------------------------------------------------------------------------------------------------\r\n\r\nExample 2  @testing-library/react\r\n\r\nimport React from \"react\";\r\nimport Amplify from \"aws-amplify\";\r\nimport { render, fireEvent, waitFor, screen } from '@testing-library/react'\r\nimport '@testing-library/jest-dom/extend-expect'\r\n\r\nimport awsExports from \"../aws-exports.js\";\r\nimport DisplayExpense from './DisplayExpenses.js';\r\n\r\nAmplify.configure(awsExports);\r\n\r\n\r\ntest('should load expenses', async () => {\r\n\r\n\tconst {getByText} = render(<DisplayExpense />)\r\n\r\n\tconst text = getByText('Loading expenses!');  // this is found\r\n\r\n\t// the data query is automatically called and then the proper page gets rendered\r\n\t// But this times out.  In the app once the data is fetched this will be display\r\n\tawait waitFor(() => getByText('Expenses'), {timeout: 8000});\r\n\r\n});\r\n\r\n","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"iartemiev"},"body":"We're actively working on Node/SSR support for Datastore.\r\n\r\nIn the mean time, you should be able to get unblocked by adding this: https://github.com/dumbmatter/fakeIndexedDB#with-jest to your jest config."}},{"node":{"author":{"login":"bregan"},"body":"Yes, adding in the fakeIndexedDB worked well.\r\n\r\nthank you for your quick response.\r\n"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xNDI1","author":{"login":"Tom-RulesCube"},"title":"Attempting to use Datastore from Node.js command line app which results in \"Error: Node is not supported\"","body":"Attempting to use Datastore from Node.js command line app which results in \"Error: Node is not supported\" \r\n\r\nThat seems pretty clear, but, is there any way to hack around this?","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"iartemiev"},"body":"We're aware of this issue and are actively looking into it. Please track the progress here: https://github.com/aws-amplify/amplify-js/issues/1613#issuecomment-609053106"}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMzgz","author":{"login":"karrettgelley"},"title":"Multiple Environments Workflow","body":"I have been using multiple environments with amplify for a while now and there's one thing that bugs me. I'll illustrate this point with an example:\r\nSuppose you have a master and dev environment with amplify and a dev and master branch on git. The environments have both been initialized properly and do not have any resources associated with them. Now suppose I want to add an Auth resource on the dev branch/env with `amplify add auth, amplify push`. I test it out locally and then I want to merge these changes to master. So I `git checkout master, git merge dev, amplify env checkout master, amplify push`. Great, now the master environment has an auth resource. However, now my master branch on git has new changes! More specifically, the team-provider-info.json file has added a few lines indicating that the master environment has an auth resource now. If I simply amend these changes to the merge `git commit --amend`, my master branch will be updated properly, but now my dev branch is 1 commit behind master. I can fix this (probably by merging master into dev `git checkout dev, git merge master, git push`), but my git history is very odd now. And what if someone else pushed to dev before I can make this hotfix? This is a situation I face every time I want to add Storage, API, Auth, etc. to my app. It's wastes build minutes, introduces synchronization errors, and it's very annoying. Has anyone else noticed this, and if so, how did you fix it?\r\n\r\ntldr How do you iteratively add aws resources without messing up team-provider-info.json?","upvoteCount":2,"comments":{"edges":[]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMTcz","author":{"login":"sammartinez"},"title":"Does anyone have any samples that they like for Amplify JS?","body":"I was curious what others are using for samples of Amplify JS.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"mauerbac"},"body":"Hey @sammartinez - we have resources on our [community site](https://amplify.aws/community/resources). I'm also a fan of Nader's [repo](https://github.com/dabit3/awesome-aws-amplify). Let me know if this helps! "}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb24xMjA5","author":{"login":"karrettgelley"},"title":"Social Federation with Custom Domain","body":"Does anyone know how to set up social federation with my own custom domain? I followed @dabit3 's great tutorial about [amplify authentication](https://dev.to/dabit3/the-complete-guide-to-user-authentication-with-the-amplify-framework-2inh), but it doesn't mention how to hook up a custom domain. In my master env, when I run amplify status I get an oauth endpoint like http://XXX.master.auth.us-west.cognito.com. That endpoint is then supposed to be entered into the google/facebook app. But how do I tell amplify and the google/facebook apps to use my custom domain instead? By the way, my custom domain is registered in Route 53 and set up in the amplify console.","upvoteCount":1,"comments":{"edges":[{"node":{"author":{"login":"karrettgelley"},"body":"Nevermind, I figured it out: Register a domain with aws and then create a hosted zone. Finally, go to the amplify console and configure the domain in the 'domain management tab'. Here's the tutorial I found for [linking a custom domain to aws amplify](https://dev.to/dabit3/how-to-deploy-a-custom-domain-name-with-the-amplify-console-in-under-two-minutes-jhh)."}}]}}},{"node":{"id":"MDEwOkRpc2N1c3Npb241Nzkx","author":{"login":"apoorvmote"},"title":"How to create REST API at different AWS region from Graphql API?","body":"** Which Category is your question related to? **\r\nLambda Function\r\n** What AWS Services are you utilizing? **\r\nCognito, AppSync, Rest API, Lambda\r\n** Provide additional details e.g. code snippets **\r\nI want to send SMS notificiation via AWS SNS but my region doesn't support SMS notifications via SNS. I need to create lambda at different region. \r\n\r\nHow do I create REST API via amplify and specify different region from my graphql API?\r\n","upvoteCount":1,"comments":{"edges":[]}}}]}